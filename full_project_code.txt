
====================================================================
📁 Directory: G:\FINALCODE
--------------------------------------------------------------------
Contents:
.idea
backend
frontend
full_project_code.txt
README.md

====================================================================
📁 Directory: G:\FINALCODE\backend
--------------------------------------------------------------------
Contents:
.gitattributes
.github
.gitignore
.gitkeep
.mvn
mvnw
mvnw.cmd
pom.xml
src
target

====================================================================
📄 File: G:\FINALCODE\backend\.gitattributes
--------------------------------------------------------------------
/mvnw text eol=lf
*.cmd text eol=crlf

--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\backend\.github
--------------------------------------------------------------------
Contents:
java-upgrade

====================================================================
📁 Directory: G:\FINALCODE\backend\.github\java-upgrade
--------------------------------------------------------------------
Contents:
.gitignore
20251103051453
20251104035746

====================================================================
📄 File: G:\FINALCODE\backend\.github\java-upgrade\.gitignore
--------------------------------------------------------------------

*

--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\backend\.github\java-upgrade\20251103051453
--------------------------------------------------------------------
Contents:
logs
progress.md

====================================================================
📁 Directory: G:\FINALCODE\backend\.github\java-upgrade\20251103051453\logs
--------------------------------------------------------------------
Contents:
0.log

====================================================================
📄 File: G:\FINALCODE\backend\.github\java-upgrade\20251103051453\logs\0.log
--------------------------------------------------------------------
2025-11-03T05:14:53.780Z [INFO] ----------------------invoke generate_upgrade_plan_for_java_project----------------------
2025-11-03T05:14:53.781Z [INFO] [Tool.invoke]({name: generate_upgrade_plan_for_java_project, input: {
  "projectPath": "g:\\CapsFinal\\backend",
  "targetJavaVersion": "21"
}}).
2025-11-03T05:14:53.782Z [INFO] [Plan.tryStartTask]({tool:generate_upgrade_plan_for_java_project, nextTask:{type:undefined, tool:undefined}}
2025-11-03T05:14:53.782Z [INFO] [Plan.tryStartTask]: no next task, create new one.
2025-11-03T05:14:53.783Z [INFO] [Plan.createTaskAtStart]({tool: generate_upgrade_plan_for_java_project, input: {
  "projectPath": "g:\\CapsFinal\\backend",
  "targetJavaVersion": "21",
  "sessionId": "20251103051453"
}}).
2025-11-03T05:14:53.785Z [INFO] [Plan.tryStartTask]: starting task generatePlan
2025-11-03T05:14:53.785Z [INFO] [Task.start](): Starting task generatePlan
2025-11-03T05:14:53.787Z [INFO] [Task.start](1): Started task generatePlan
2025-11-03T05:14:54.571Z [INFO] [Tool.invoke] validate GitHub Copilot license.
2025-11-03T05:15:29.129Z [INFO] Copilot user info:{
  "access_type_sku": "free_limited_copilot",
  "analytics_tracking_id": "4697fb2576b19c2bdfe7ad0bc4807eb7",
  "assigned_date": "2025-10-11T17:16:14+05:30",
  "can_signup_for_limited": false,
  "chat_enabled": true,
  "copilot_plan": "individual",
  "organization_login_list": [],
  "organization_list": [],
  "limited_user_quotas": {
    "chat": 130,
    "completions": 3982
  },
  "limited_user_subscribed_day": 11,
  "limited_user_reset_date": "2025-11-11",
  "monthly_quotas": {
    "chat": 500,
    "completions": 4000
  }
}
2025-11-03T05:15:29.131Z [WARN] "GitHub Copilot app modernization - upgrade for Java" and its tools are only available for GitHub Copilot "Pro", "Pro+", "Business" and "Enterprise" plans.
2025-11-03T05:15:29.131Z [ERROR] [Tool.invoke] error occurs when invoking tool generate_upgrade_plan_for_java_project: UnsupportedCopilotPlanError: "GitHub Copilot app modernization - upgrade for Java" and its tools are only available for GitHub Copilot "Pro", "Pro+", "Business" and "Enterprise" plans.. Please upgrade your GitHub Copilot plan to use this feature or upgrading this project using other tools you prefer..
2025-11-03T05:15:29.133Z [INFO] [Task.complete](1): Completing task generatePlan
2025-11-03T05:15:29.134Z [INFO] ----------------------invoked generate_upgrade_plan_for_java_project----------------------
2025-11-03T05:15:29.134Z [INFO] [Task.complete](1): Completed task generatePlan

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\.github\java-upgrade\20251103051453\progress.md
--------------------------------------------------------------------
# Upgrade Progress

  ### ❗ Generate Upgrade Plan
  
  <details>
      <summary>[ click to toggle details ]</summary>
  
  #### Errors
  - "GitHub Copilot app modernization - upgrade for Java" and its tools are only available for GitHub Copilot "Pro", "Pro+", "Business" and "Enterprise" plans.. Please upgrade your GitHub Copilot plan to use this feature or upgrading this project using other tools you prefer.
  </details>
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\backend\.github\java-upgrade\20251104035746
--------------------------------------------------------------------
Contents:
logs
progress.md

====================================================================
📁 Directory: G:\FINALCODE\backend\.github\java-upgrade\20251104035746\logs
--------------------------------------------------------------------
Contents:
0.log

====================================================================
📄 File: G:\FINALCODE\backend\.github\java-upgrade\20251104035746\logs\0.log
--------------------------------------------------------------------
2025-11-04T03:57:46.357Z [INFO] ----------------------invoke generate_upgrade_plan_for_java_project----------------------
2025-11-04T03:57:46.367Z [INFO] [Tool.invoke]({name: generate_upgrade_plan_for_java_project, input: {
  "projectPath": "g:\\CapsFinal\\backend",
  "targetJavaVersion": "21"
}}).
2025-11-04T03:57:46.368Z [INFO] [Plan.tryStartTask]({tool:generate_upgrade_plan_for_java_project, nextTask:{type:undefined, tool:undefined}}
2025-11-04T03:57:46.368Z [INFO] [Plan.tryStartTask]: no next task, create new one.
2025-11-04T03:57:46.369Z [INFO] [Plan.createTaskAtStart]({tool: generate_upgrade_plan_for_java_project, input: {
  "projectPath": "g:\\CapsFinal\\backend",
  "targetJavaVersion": "21",
  "sessionId": "20251104035746"
}}).
2025-11-04T03:57:46.370Z [INFO] [Plan.tryStartTask]: starting task generatePlan
2025-11-04T03:57:46.370Z [INFO] [Task.start](): Starting task generatePlan
2025-11-04T03:57:46.371Z [INFO] [Task.start](1): Started task generatePlan
2025-11-04T03:57:46.411Z [INFO] [Tool.invoke] validate GitHub Copilot license.
2025-11-04T03:57:46.872Z [INFO] Copilot user info:{
  "access_type_sku": "free_limited_copilot",
  "analytics_tracking_id": "4697fb2576b19c2bdfe7ad0bc4807eb7",
  "assigned_date": "2025-10-11T17:16:14+05:30",
  "can_signup_for_limited": false,
  "chat_enabled": true,
  "copilot_plan": "individual",
  "organization_login_list": [],
  "organization_list": [],
  "limited_user_quotas": {
    "chat": 120,
    "completions": 3752
  },
  "limited_user_subscribed_day": 11,
  "limited_user_reset_date": "2025-11-11",
  "monthly_quotas": {
    "chat": 500,
    "completions": 4000
  }
}
2025-11-04T03:57:46.873Z [WARN] "GitHub Copilot app modernization - upgrade for Java" and its tools are only available for GitHub Copilot "Pro", "Pro+", "Business" and "Enterprise" plans.
2025-11-04T03:57:46.873Z [ERROR] [Tool.invoke] error occurs when invoking tool generate_upgrade_plan_for_java_project: UnsupportedCopilotPlanError: "GitHub Copilot app modernization - upgrade for Java" and its tools are only available for GitHub Copilot "Pro", "Pro+", "Business" and "Enterprise" plans.. Please upgrade your GitHub Copilot plan to use this feature or upgrading this project using other tools you prefer..
2025-11-04T03:57:46.874Z [INFO] [Task.complete](1): Completing task generatePlan
2025-11-04T03:57:46.874Z [INFO] ----------------------invoked generate_upgrade_plan_for_java_project----------------------
2025-11-04T03:57:46.875Z [INFO] [Task.complete](1): Completed task generatePlan

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\.github\java-upgrade\20251104035746\progress.md
--------------------------------------------------------------------
# Upgrade Progress

  ### ❗ Generate Upgrade Plan
  
  <details>
      <summary>[ click to toggle details ]</summary>
  
  #### Errors
  - "GitHub Copilot app modernization - upgrade for Java" and its tools are only available for GitHub Copilot "Pro", "Pro+", "Business" and "Enterprise" plans.. Please upgrade your GitHub Copilot plan to use this feature or upgrading this project using other tools you prefer.
  </details>
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\.gitignore
--------------------------------------------------------------------
HELP.md
target/
.mvn/wrapper/maven-wrapper.jar
!**/src/main/**/target/
!**/src/test/**/target/

### STS ###
.apt_generated
.classpath
.factorypath
.project
.settings
.springBeans
.sts4-cache
.idea/runConfigurations/
### IntelliJ IDEA ###
.idea
*.iws
*.iml
*.ipr

### NetBeans ###
/nbproject/private/
/nbbuild/
/dist/
/nbdist/
/.nb-gradle/
build/
!**/src/main/**/build/
!**/src/test/**/build/

### VS Code ###
.vscode/

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\.gitkeep
--------------------------------------------------------------------

--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\backend\.mvn
--------------------------------------------------------------------
Contents:
wrapper

====================================================================
📁 Directory: G:\FINALCODE\backend\.mvn\wrapper
--------------------------------------------------------------------
Contents:
maven-wrapper.properties

====================================================================
📄 File: G:\FINALCODE\backend\.mvn\wrapper\maven-wrapper.properties
--------------------------------------------------------------------
distributionType=only-script
distributionUrl=https://repo.maven.apache.org/maven2/org/apache/maven/apache-maven/3.9.11/apache-maven-3.9.11-bin.zip

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\mvnw
--------------------------------------------------------------------
#!/bin/sh
# ----------------------------------------------------------------------------
# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at
#
#    http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.
# ----------------------------------------------------------------------------

# ----------------------------------------------------------------------------
# Apache Maven Wrapper startup batch script, version 3.3.3
#
# Optional ENV vars
# -----------------
#   JAVA_HOME - location of a JDK home dir, required when download maven via java source
#   MVNW_REPOURL - repo url base for downloading maven distribution
#   MVNW_USERNAME/MVNW_PASSWORD - user and password for downloading maven
#   MVNW_VERBOSE - true: enable verbose log; debug: trace the mvnw script; others: silence the output
# ----------------------------------------------------------------------------

set -euf
[ "${MVNW_VERBOSE-}" != debug ] || set -x

# OS specific support.
native_path() { printf %s\\n "$1"; }
case "$(uname)" in
CYGWIN* | MINGW*)
  [ -z "${JAVA_HOME-}" ] || JAVA_HOME="$(cygpath --unix "$JAVA_HOME")"
  native_path() { cygpath --path --windows "$1"; }
  ;;
esac

# set JAVACMD and JAVACCMD
set_java_home() {
  # For Cygwin and MinGW, ensure paths are in Unix format before anything is touched
  if [ -n "${JAVA_HOME-}" ]; then
    if [ -x "$JAVA_HOME/jre/sh/java" ]; then
      # IBM's JDK on AIX uses strange locations for the executables
      JAVACMD="$JAVA_HOME/jre/sh/java"
      JAVACCMD="$JAVA_HOME/jre/sh/javac"
    else
      JAVACMD="$JAVA_HOME/bin/java"
      JAVACCMD="$JAVA_HOME/bin/javac"

      if [ ! -x "$JAVACMD" ] || [ ! -x "$JAVACCMD" ]; then
        echo "The JAVA_HOME environment variable is not defined correctly, so mvnw cannot run." >&2
        echo "JAVA_HOME is set to \"$JAVA_HOME\", but \"\$JAVA_HOME/bin/java\" or \"\$JAVA_HOME/bin/javac\" does not exist." >&2
        return 1
      fi
    fi
  else
    JAVACMD="$(
      'set' +e
      'unset' -f command 2>/dev/null
      'command' -v java
    )" || :
    JAVACCMD="$(
      'set' +e
      'unset' -f command 2>/dev/null
      'command' -v javac
    )" || :

    if [ ! -x "${JAVACMD-}" ] || [ ! -x "${JAVACCMD-}" ]; then
      echo "The java/javac command does not exist in PATH nor is JAVA_HOME set, so mvnw cannot run." >&2
      return 1
    fi
  fi
}

# hash string like Java String::hashCode
hash_string() {
  str="${1:-}" h=0
  while [ -n "$str" ]; do
    char="${str%"${str#?}"}"
    h=$(((h * 31 + $(LC_CTYPE=C printf %d "'$char")) % 4294967296))
    str="${str#?}"
  done
  printf %x\\n $h
}

verbose() { :; }
[ "${MVNW_VERBOSE-}" != true ] || verbose() { printf %s\\n "${1-}"; }

die() {
  printf %s\\n "$1" >&2
  exit 1
}

trim() {
  # MWRAPPER-139:
  #   Trims trailing and leading whitespace, carriage returns, tabs, and linefeeds.
  #   Needed for removing poorly interpreted newline sequences when running in more
  #   exotic environments such as mingw bash on Windows.
  printf "%s" "${1}" | tr -d '[:space:]'
}

scriptDir="$(dirname "$0")"
scriptName="$(basename "$0")"

# parse distributionUrl and optional distributionSha256Sum, requires .mvn/wrapper/maven-wrapper.properties
while IFS="=" read -r key value; do
  case "${key-}" in
  distributionUrl) distributionUrl=$(trim "${value-}") ;;
  distributionSha256Sum) distributionSha256Sum=$(trim "${value-}") ;;
  esac
done <"$scriptDir/.mvn/wrapper/maven-wrapper.properties"
[ -n "${distributionUrl-}" ] || die "cannot read distributionUrl property in $scriptDir/.mvn/wrapper/maven-wrapper.properties"

case "${distributionUrl##*/}" in
maven-mvnd-*bin.*)
  MVN_CMD=mvnd.sh _MVNW_REPO_PATTERN=/maven/mvnd/
  case "${PROCESSOR_ARCHITECTURE-}${PROCESSOR_ARCHITEW6432-}:$(uname -a)" in
  *AMD64:CYGWIN* | *AMD64:MINGW*) distributionPlatform=windows-amd64 ;;
  :Darwin*x86_64) distributionPlatform=darwin-amd64 ;;
  :Darwin*arm64) distributionPlatform=darwin-aarch64 ;;
  :Linux*x86_64*) distributionPlatform=linux-amd64 ;;
  *)
    echo "Cannot detect native platform for mvnd on $(uname)-$(uname -m), use pure java version" >&2
    distributionPlatform=linux-amd64
    ;;
  esac
  distributionUrl="${distributionUrl%-bin.*}-$distributionPlatform.zip"
  ;;
maven-mvnd-*) MVN_CMD=mvnd.sh _MVNW_REPO_PATTERN=/maven/mvnd/ ;;
*) MVN_CMD="mvn${scriptName#mvnw}" _MVNW_REPO_PATTERN=/org/apache/maven/ ;;
esac

# apply MVNW_REPOURL and calculate MAVEN_HOME
# maven home pattern: ~/.m2/wrapper/dists/{apache-maven-<version>,maven-mvnd-<version>-<platform>}/<hash>
[ -z "${MVNW_REPOURL-}" ] || distributionUrl="$MVNW_REPOURL$_MVNW_REPO_PATTERN${distributionUrl#*"$_MVNW_REPO_PATTERN"}"
distributionUrlName="${distributionUrl##*/}"
distributionUrlNameMain="${distributionUrlName%.*}"
distributionUrlNameMain="${distributionUrlNameMain%-bin}"
MAVEN_USER_HOME="${MAVEN_USER_HOME:-${HOME}/.m2}"
MAVEN_HOME="${MAVEN_USER_HOME}/wrapper/dists/${distributionUrlNameMain-}/$(hash_string "$distributionUrl")"

exec_maven() {
  unset MVNW_VERBOSE MVNW_USERNAME MVNW_PASSWORD MVNW_REPOURL || :
  exec "$MAVEN_HOME/bin/$MVN_CMD" "$@" || die "cannot exec $MAVEN_HOME/bin/$MVN_CMD"
}

if [ -d "$MAVEN_HOME" ]; then
  verbose "found existing MAVEN_HOME at $MAVEN_HOME"
  exec_maven "$@"
fi

case "${distributionUrl-}" in
*?-bin.zip | *?maven-mvnd-?*-?*.zip) ;;
*) die "distributionUrl is not valid, must match *-bin.zip or maven-mvnd-*.zip, but found '${distributionUrl-}'" ;;
esac

# prepare tmp dir
if TMP_DOWNLOAD_DIR="$(mktemp -d)" && [ -d "$TMP_DOWNLOAD_DIR" ]; then
  clean() { rm -rf -- "$TMP_DOWNLOAD_DIR"; }
  trap clean HUP INT TERM EXIT
else
  die "cannot create temp dir"
fi

mkdir -p -- "${MAVEN_HOME%/*}"

# Download and Install Apache Maven
verbose "Couldn't find MAVEN_HOME, downloading and installing it ..."
verbose "Downloading from: $distributionUrl"
verbose "Downloading to: $TMP_DOWNLOAD_DIR/$distributionUrlName"

# select .zip or .tar.gz
if ! command -v unzip >/dev/null; then
  distributionUrl="${distributionUrl%.zip}.tar.gz"
  distributionUrlName="${distributionUrl##*/}"
fi

# verbose opt
__MVNW_QUIET_WGET=--quiet __MVNW_QUIET_CURL=--silent __MVNW_QUIET_UNZIP=-q __MVNW_QUIET_TAR=''
[ "${MVNW_VERBOSE-}" != true ] || __MVNW_QUIET_WGET='' __MVNW_QUIET_CURL='' __MVNW_QUIET_UNZIP='' __MVNW_QUIET_TAR=v

# normalize http auth
case "${MVNW_PASSWORD:+has-password}" in
'') MVNW_USERNAME='' MVNW_PASSWORD='' ;;
has-password) [ -n "${MVNW_USERNAME-}" ] || MVNW_USERNAME='' MVNW_PASSWORD='' ;;
esac

if [ -z "${MVNW_USERNAME-}" ] && command -v wget >/dev/null; then
  verbose "Found wget ... using wget"
  wget ${__MVNW_QUIET_WGET:+"$__MVNW_QUIET_WGET"} "$distributionUrl" -O "$TMP_DOWNLOAD_DIR/$distributionUrlName" || die "wget: Failed to fetch $distributionUrl"
elif [ -z "${MVNW_USERNAME-}" ] && command -v curl >/dev/null; then
  verbose "Found curl ... using curl"
  curl ${__MVNW_QUIET_CURL:+"$__MVNW_QUIET_CURL"} -f -L -o "$TMP_DOWNLOAD_DIR/$distributionUrlName" "$distributionUrl" || die "curl: Failed to fetch $distributionUrl"
elif set_java_home; then
  verbose "Falling back to use Java to download"
  javaSource="$TMP_DOWNLOAD_DIR/Downloader.java"
  targetZip="$TMP_DOWNLOAD_DIR/$distributionUrlName"
  cat >"$javaSource" <<-END
	public class Downloader extends java.net.Authenticator
	{
	  protected java.net.PasswordAuthentication getPasswordAuthentication()
	  {
	    return new java.net.PasswordAuthentication( System.getenv( "MVNW_USERNAME" ), System.getenv( "MVNW_PASSWORD" ).toCharArray() );
	  }
	  public static void main( String[] args ) throws Exception
	  {
	    setDefault( new Downloader() );
	    java.nio.file.Files.copy( java.net.URI.create( args[0] ).toURL().openStream(), java.nio.file.Paths.get( args[1] ).toAbsolutePath().normalize() );
	  }
	}
	END
  # For Cygwin/MinGW, switch paths to Windows format before running javac and java
  verbose " - Compiling Downloader.java ..."
  "$(native_path "$JAVACCMD")" "$(native_path "$javaSource")" || die "Failed to compile Downloader.java"
  verbose " - Running Downloader.java ..."
  "$(native_path "$JAVACMD")" -cp "$(native_path "$TMP_DOWNLOAD_DIR")" Downloader "$distributionUrl" "$(native_path "$targetZip")"
fi

# If specified, validate the SHA-256 sum of the Maven distribution zip file
if [ -n "${distributionSha256Sum-}" ]; then
  distributionSha256Result=false
  if [ "$MVN_CMD" = mvnd.sh ]; then
    echo "Checksum validation is not supported for maven-mvnd." >&2
    echo "Please disable validation by removing 'distributionSha256Sum' from your maven-wrapper.properties." >&2
    exit 1
  elif command -v sha256sum >/dev/null; then
    if echo "$distributionSha256Sum  $TMP_DOWNLOAD_DIR/$distributionUrlName" | sha256sum -c - >/dev/null 2>&1; then
      distributionSha256Result=true
    fi
  elif command -v shasum >/dev/null; then
    if echo "$distributionSha256Sum  $TMP_DOWNLOAD_DIR/$distributionUrlName" | shasum -a 256 -c >/dev/null 2>&1; then
      distributionSha256Result=true
    fi
  else
    echo "Checksum validation was requested but neither 'sha256sum' or 'shasum' are available." >&2
    echo "Please install either command, or disable validation by removing 'distributionSha256Sum' from your maven-wrapper.properties." >&2
    exit 1
  fi
  if [ $distributionSha256Result = false ]; then
    echo "Error: Failed to validate Maven distribution SHA-256, your Maven distribution might be compromised." >&2
    echo "If you updated your Maven version, you need to update the specified distributionSha256Sum property." >&2
    exit 1
  fi
fi

# unzip and move
if command -v unzip >/dev/null; then
  unzip ${__MVNW_QUIET_UNZIP:+"$__MVNW_QUIET_UNZIP"} "$TMP_DOWNLOAD_DIR/$distributionUrlName" -d "$TMP_DOWNLOAD_DIR" || die "failed to unzip"
else
  tar xzf${__MVNW_QUIET_TAR:+"$__MVNW_QUIET_TAR"} "$TMP_DOWNLOAD_DIR/$distributionUrlName" -C "$TMP_DOWNLOAD_DIR" || die "failed to untar"
fi

# Find the actual extracted directory name (handles snapshots where filename != directory name)
actualDistributionDir=""

# First try the expected directory name (for regular distributions)
if [ -d "$TMP_DOWNLOAD_DIR/$distributionUrlNameMain" ]; then
  if [ -f "$TMP_DOWNLOAD_DIR/$distributionUrlNameMain/bin/$MVN_CMD" ]; then
    actualDistributionDir="$distributionUrlNameMain"
  fi
fi

# If not found, search for any directory with the Maven executable (for snapshots)
if [ -z "$actualDistributionDir" ]; then
  # enable globbing to iterate over items
  set +f
  for dir in "$TMP_DOWNLOAD_DIR"/*; do
    if [ -d "$dir" ]; then
      if [ -f "$dir/bin/$MVN_CMD" ]; then
        actualDistributionDir="$(basename "$dir")"
        break
      fi
    fi
  done
  set -f
fi

if [ -z "$actualDistributionDir" ]; then
  verbose "Contents of $TMP_DOWNLOAD_DIR:"
  verbose "$(ls -la "$TMP_DOWNLOAD_DIR")"
  die "Could not find Maven distribution directory in extracted archive"
fi

verbose "Found extracted Maven distribution directory: $actualDistributionDir"
printf %s\\n "$distributionUrl" >"$TMP_DOWNLOAD_DIR/$actualDistributionDir/mvnw.url"
mv -- "$TMP_DOWNLOAD_DIR/$actualDistributionDir" "$MAVEN_HOME" || [ -d "$MAVEN_HOME" ] || die "fail to move MAVEN_HOME"

clean || :
exec_maven "$@"

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\mvnw.cmd
--------------------------------------------------------------------
<# : batch portion
@REM ----------------------------------------------------------------------------
@REM Licensed to the Apache Software Foundation (ASF) under one
@REM or more contributor license agreements.  See the NOTICE file
@REM distributed with this work for additional information
@REM regarding copyright ownership.  The ASF licenses this file
@REM to you under the Apache License, Version 2.0 (the
@REM "License"); you may not use this file except in compliance
@REM with the License.  You may obtain a copy of the License at
@REM
@REM    http://www.apache.org/licenses/LICENSE-2.0
@REM
@REM Unless required by applicable law or agreed to in writing,
@REM software distributed under the License is distributed on an
@REM "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
@REM KIND, either express or implied.  See the License for the
@REM specific language governing permissions and limitations
@REM under the License.
@REM ----------------------------------------------------------------------------

@REM ----------------------------------------------------------------------------
@REM Apache Maven Wrapper startup batch script, version 3.3.3
@REM
@REM Optional ENV vars
@REM   MVNW_REPOURL - repo url base for downloading maven distribution
@REM   MVNW_USERNAME/MVNW_PASSWORD - user and password for downloading maven
@REM   MVNW_VERBOSE - true: enable verbose log; others: silence the output
@REM ----------------------------------------------------------------------------

@IF "%__MVNW_ARG0_NAME__%"=="" (SET __MVNW_ARG0_NAME__=%~nx0)
@SET __MVNW_CMD__=
@SET __MVNW_ERROR__=
@SET __MVNW_PSMODULEP_SAVE=%PSModulePath%
@SET PSModulePath=
@FOR /F "usebackq tokens=1* delims==" %%A IN (`powershell -noprofile "& {$scriptDir='%~dp0'; $script='%__MVNW_ARG0_NAME__%'; icm -ScriptBlock ([Scriptblock]::Create((Get-Content -Raw '%~f0'))) -NoNewScope}"`) DO @(
  IF "%%A"=="MVN_CMD" (set __MVNW_CMD__=%%B) ELSE IF "%%B"=="" (echo %%A) ELSE (echo %%A=%%B)
)
@SET PSModulePath=%__MVNW_PSMODULEP_SAVE%
@SET __MVNW_PSMODULEP_SAVE=
@SET __MVNW_ARG0_NAME__=
@SET MVNW_USERNAME=
@SET MVNW_PASSWORD=
@IF NOT "%__MVNW_CMD__%"=="" ("%__MVNW_CMD__%" %*)
@echo Cannot start maven from wrapper >&2 && exit /b 1
@GOTO :EOF
: end batch / begin powershell #>

$ErrorActionPreference = "Stop"
if ($env:MVNW_VERBOSE -eq "true") {
  $VerbosePreference = "Continue"
}

# calculate distributionUrl, requires .mvn/wrapper/maven-wrapper.properties
$distributionUrl = (Get-Content -Raw "$scriptDir/.mvn/wrapper/maven-wrapper.properties" | ConvertFrom-StringData).distributionUrl
if (!$distributionUrl) {
  Write-Error "cannot read distributionUrl property in $scriptDir/.mvn/wrapper/maven-wrapper.properties"
}

switch -wildcard -casesensitive ( $($distributionUrl -replace '^.*/','') ) {
  "maven-mvnd-*" {
    $USE_MVND = $true
    $distributionUrl = $distributionUrl -replace '-bin\.[^.]*$',"-windows-amd64.zip"
    $MVN_CMD = "mvnd.cmd"
    break
  }
  default {
    $USE_MVND = $false
    $MVN_CMD = $script -replace '^mvnw','mvn'
    break
  }
}

# apply MVNW_REPOURL and calculate MAVEN_HOME
# maven home pattern: ~/.m2/wrapper/dists/{apache-maven-<version>,maven-mvnd-<version>-<platform>}/<hash>
if ($env:MVNW_REPOURL) {
  $MVNW_REPO_PATTERN = if ($USE_MVND -eq $False) { "/org/apache/maven/" } else { "/maven/mvnd/" }
  $distributionUrl = "$env:MVNW_REPOURL$MVNW_REPO_PATTERN$($distributionUrl -replace "^.*$MVNW_REPO_PATTERN",'')"
}
$distributionUrlName = $distributionUrl -replace '^.*/',''
$distributionUrlNameMain = $distributionUrlName -replace '\.[^.]*$','' -replace '-bin$',''

$MAVEN_M2_PATH = "$HOME/.m2"
if ($env:MAVEN_USER_HOME) {
  $MAVEN_M2_PATH = "$env:MAVEN_USER_HOME"
}

if (-not (Test-Path -Path $MAVEN_M2_PATH)) {
    New-Item -Path $MAVEN_M2_PATH -ItemType Directory | Out-Null
}

$MAVEN_WRAPPER_DISTS = $null
if ((Get-Item $MAVEN_M2_PATH).Target[0] -eq $null) {
  $MAVEN_WRAPPER_DISTS = "$MAVEN_M2_PATH/wrapper/dists"
} else {
  $MAVEN_WRAPPER_DISTS = (Get-Item $MAVEN_M2_PATH).Target[0] + "/wrapper/dists"
}

$MAVEN_HOME_PARENT = "$MAVEN_WRAPPER_DISTS/$distributionUrlNameMain"
$MAVEN_HOME_NAME = ([System.Security.Cryptography.SHA256]::Create().ComputeHash([byte[]][char[]]$distributionUrl) | ForEach-Object {$_.ToString("x2")}) -join ''
$MAVEN_HOME = "$MAVEN_HOME_PARENT/$MAVEN_HOME_NAME"

if (Test-Path -Path "$MAVEN_HOME" -PathType Container) {
  Write-Verbose "found existing MAVEN_HOME at $MAVEN_HOME"
  Write-Output "MVN_CMD=$MAVEN_HOME/bin/$MVN_CMD"
  exit $?
}

if (! $distributionUrlNameMain -or ($distributionUrlName -eq $distributionUrlNameMain)) {
  Write-Error "distributionUrl is not valid, must end with *-bin.zip, but found $distributionUrl"
}

# prepare tmp dir
$TMP_DOWNLOAD_DIR_HOLDER = New-TemporaryFile
$TMP_DOWNLOAD_DIR = New-Item -Itemtype Directory -Path "$TMP_DOWNLOAD_DIR_HOLDER.dir"
$TMP_DOWNLOAD_DIR_HOLDER.Delete() | Out-Null
trap {
  if ($TMP_DOWNLOAD_DIR.Exists) {
    try { Remove-Item $TMP_DOWNLOAD_DIR -Recurse -Force | Out-Null }
    catch { Write-Warning "Cannot remove $TMP_DOWNLOAD_DIR" }
  }
}

New-Item -Itemtype Directory -Path "$MAVEN_HOME_PARENT" -Force | Out-Null

# Download and Install Apache Maven
Write-Verbose "Couldn't find MAVEN_HOME, downloading and installing it ..."
Write-Verbose "Downloading from: $distributionUrl"
Write-Verbose "Downloading to: $TMP_DOWNLOAD_DIR/$distributionUrlName"

$webclient = New-Object System.Net.WebClient
if ($env:MVNW_USERNAME -and $env:MVNW_PASSWORD) {
  $webclient.Credentials = New-Object System.Net.NetworkCredential($env:MVNW_USERNAME, $env:MVNW_PASSWORD)
}
[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
$webclient.DownloadFile($distributionUrl, "$TMP_DOWNLOAD_DIR/$distributionUrlName") | Out-Null

# If specified, validate the SHA-256 sum of the Maven distribution zip file
$distributionSha256Sum = (Get-Content -Raw "$scriptDir/.mvn/wrapper/maven-wrapper.properties" | ConvertFrom-StringData).distributionSha256Sum
if ($distributionSha256Sum) {
  if ($USE_MVND) {
    Write-Error "Checksum validation is not supported for maven-mvnd. `nPlease disable validation by removing 'distributionSha256Sum' from your maven-wrapper.properties."
  }
  Import-Module $PSHOME\Modules\Microsoft.PowerShell.Utility -Function Get-FileHash
  if ((Get-FileHash "$TMP_DOWNLOAD_DIR/$distributionUrlName" -Algorithm SHA256).Hash.ToLower() -ne $distributionSha256Sum) {
    Write-Error "Error: Failed to validate Maven distribution SHA-256, your Maven distribution might be compromised. If you updated your Maven version, you need to update the specified distributionSha256Sum property."
  }
}

# unzip and move
Expand-Archive "$TMP_DOWNLOAD_DIR/$distributionUrlName" -DestinationPath "$TMP_DOWNLOAD_DIR" | Out-Null

# Find the actual extracted directory name (handles snapshots where filename != directory name)
$actualDistributionDir = ""

# First try the expected directory name (for regular distributions)
$expectedPath = Join-Path "$TMP_DOWNLOAD_DIR" "$distributionUrlNameMain"
$expectedMvnPath = Join-Path "$expectedPath" "bin/$MVN_CMD"
if ((Test-Path -Path $expectedPath -PathType Container) -and (Test-Path -Path $expectedMvnPath -PathType Leaf)) {
  $actualDistributionDir = $distributionUrlNameMain
}

# If not found, search for any directory with the Maven executable (for snapshots)
if (!$actualDistributionDir) {
  Get-ChildItem -Path "$TMP_DOWNLOAD_DIR" -Directory | ForEach-Object {
    $testPath = Join-Path $_.FullName "bin/$MVN_CMD"
    if (Test-Path -Path $testPath -PathType Leaf) {
      $actualDistributionDir = $_.Name
    }
  }
}

if (!$actualDistributionDir) {
  Write-Error "Could not find Maven distribution directory in extracted archive"
}

Write-Verbose "Found extracted Maven distribution directory: $actualDistributionDir"
Rename-Item -Path "$TMP_DOWNLOAD_DIR/$actualDistributionDir" -NewName $MAVEN_HOME_NAME | Out-Null
try {
  Move-Item -Path "$TMP_DOWNLOAD_DIR/$MAVEN_HOME_NAME" -Destination $MAVEN_HOME_PARENT | Out-Null
} catch {
  if (! (Test-Path -Path "$MAVEN_HOME" -PathType Container)) {
    Write-Error "fail to move MAVEN_HOME"
  }
} finally {
  try { Remove-Item $TMP_DOWNLOAD_DIR -Recurse -Force | Out-Null }
  catch { Write-Warning "Cannot remove $TMP_DOWNLOAD_DIR" }
}

Write-Output "MVN_CMD=$MAVEN_HOME/bin/$MVN_CMD"

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\pom.xml
--------------------------------------------------------------------
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
		 xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">
	<modelVersion>4.0.0</modelVersion>
	<parent>
		<groupId>org.springframework.boot</groupId>
		<artifactId>spring-boot-starter-parent</artifactId>
		<version>3.5.5</version>
		<relativePath/>
	</parent>
	<groupId>com.smartretail</groupId>
	<artifactId>backend</artifactId>
	<version>0.0.1-SNAPSHOT</version>
	<name>backend</name>
	<description>Demo project for Spring Boot</description>
	<properties>
		<java.version>17</java.version>
	</properties>
	<dependencies>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-data-mongodb</artifactId>
		</dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-security</artifactId>
		</dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-web</artifactId>
		</dependency>
        <dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-oauth2-client</artifactId>
		</dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-devtools</artifactId>
			<scope>runtime</scope>
			<optional>true</optional>
		</dependency>
		<dependency>
			<groupId>org.projectlombok</groupId>
			<artifactId>lombok</artifactId>
			<version>1.18.34</version>
			<scope>provided</scope>
		</dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-test</artifactId>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>org.springframework.security</groupId>
			<artifactId>spring-security-test</artifactId>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>io.jsonwebtoken</groupId>
			<artifactId>jjwt-api</artifactId>
			<version>0.11.5</version>
		</dependency>
		<dependency>
			<groupId>io.jsonwebtoken</groupId>
			<artifactId>jjwt-impl</artifactId>
			<version>0.11.5</version>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>io.jsonwebtoken</groupId>
			<artifactId>jjwt-jackson</artifactId> <version>0.11.5</version>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-validation</artifactId>
		</dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-mail</artifactId>
		</dependency>
		<dependency>
			<groupId>org.junit.jupiter</groupId>
			<artifactId>junit-jupiter</artifactId>
			<version>5.10.0</version>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>com.itextpdf</groupId>
			<artifactId>itext7-core</artifactId>
			<version>7.2.6</version>
			<type>pom</type>
		</dependency>

		<dependency>
			<groupId>org.mockito</groupId>
			<artifactId>mockito-core</artifactId>
			<version>5.12.0</version>
			<scope>test</scope>
		</dependency>
		
		<dependency>
			<groupId>org.mockito</groupId>
			<artifactId>mockito-junit-jupiter</artifactId>
			<version>5.12.0</version>
			<scope>test</scope>
		</dependency>

		<dependency>
			<groupId>com.opencsv</groupId>
			<artifactId>opencsv</artifactId>
			<version>5.9</version>
		</dependency>

		<dependency>
			<groupId>commons-fileupload</groupId>
			<artifactId>commons-fileupload</artifactId>
			<version>1.6.0</version>
		</dependency>

		<dependency>
			<groupId>com.sun.mail</groupId>
			<artifactId>javax.mail</artifactId>
			<version>1.6.2</version>
		</dependency>

		<dependency>
			<groupId>com.fasterxml.jackson.core</groupId>
			<artifactId>jackson-databind</artifactId>
			<version>2.15.2</version>
		</dependency>

		<dependency>
			<groupId>nl.martijndwars</groupId>
			<artifactId>web-push</artifactId>
			<version>5.1.1</version>
		</dependency>
		
		</dependencies>
	<build>
		<plugins>
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-compiler-plugin</artifactId>
				<configuration>
					<annotationProcessorPaths>
						<path>
							<groupId>org.projectlombok</groupId>
							<artifactId>lombok</artifactId>
							<version>1.18.34</version>
						</path>
					</annotationProcessorPaths>
                    <source>21</source>
                    <target>21</target>
                </configuration>
			</plugin>
			<plugin>
				<groupId>org.springframework.boot</groupId>
				<artifactId>spring-boot-maven-plugin</artifactId>
				<configuration>
					<excludes>
						<exclude>
							<groupId>org.projectlombok</groupId>
							<artifactId>lombok</artifactId>
						</exclude>
					</excludes>
				</configuration>
			</plugin>
		</plugins>
	</build>
</project>
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\backend\src
--------------------------------------------------------------------
Contents:
main
test

====================================================================
📁 Directory: G:\FINALCODE\backend\src\main
--------------------------------------------------------------------
Contents:
java
resources

====================================================================
📁 Directory: G:\FINALCODE\backend\src\main\java
--------------------------------------------------------------------
Contents:
com

====================================================================
📁 Directory: G:\FINALCODE\backend\src\main\java\com
--------------------------------------------------------------------
Contents:
smartretail

====================================================================
📁 Directory: G:\FINALCODE\backend\src\main\java\com\smartretail
--------------------------------------------------------------------
Contents:
backend

====================================================================
📁 Directory: G:\FINALCODE\backend\src\main\java\com\smartretail\backend
--------------------------------------------------------------------
Contents:
analytics
BackendApplication.java
config
controller
dto
exception
models
repository
security
service

====================================================================
📁 Directory: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\analytics
--------------------------------------------------------------------
Contents:
.env
__pycache__
app.py
requirements.txt
translations.py

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\analytics\.env
--------------------------------------------------------------------
MONGO_URI=mongodb+srv://admin:SuperS3cr3tPassword@cluster0.xo5fnfx.mongodb.net/smartretail?
DB_NAME=smartretail
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\analytics\__pycache__
--------------------------------------------------------------------
Contents:
translations.cpython-311.pyc

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\analytics\__pycache__\translations.cpython-311.pyc
--------------------------------------------------------------------
[BINARY FILE - CONTENT NOT SHOWN]
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\analytics\app.py
--------------------------------------------------------------------
from flask import Flask, jsonify, request
from flask_cors import CORS
from flask_pymongo import PyMongo
import pandas as pd
from datetime import datetime
from dotenv import load_dotenv
from dateutil import parser
import os
from translations import get_translation as t  # <-- NEW IMPORT

# -----------------------
# Initialization
# -----------------------
load_dotenv()
app = Flask(__name__)
CORS(app)

# MongoDB Config
app.config["MONGO_URI"] = os.getenv("MONGO_URI")
db_name = os.getenv("DB_NAME")
mongo = PyMongo(app)
db = mongo.cx[db_name]

# -----------------------
# Helper Functions
# -----------------------
def normalize_bills(raw_bills):
    """Normalize bills into a consistent DataFrame"""
    records = []
    for bill in raw_bills:
        # Prefer 'createdAt'
        bill_date = bill.get("createdAt") or bill.get("date")
        if isinstance(bill_date, dict) and "$date" in bill_date:
            bill_date = bill_date["$date"]
        bill_date = pd.to_datetime(bill_date)

        total = bill.get("totalAmount") or bill.get("total", 0)
        items = bill.get("items", [])
        for item in items:
            qty = item.get("quantity") or item.get("qty", 0)
            price = item.get("price", 0)
            product_id = item.get("productId") or item.get("product_id") or item.get("id")
            name = item.get("name") or item.get("productName") or "Unknown Product"

            # Only add records with valid data
            if qty > 0 and price > 0:
                records.append({
                    "date": bill_date,
                    "productId": str(product_id) if product_id else "unknown",
                    "name": name,
                    "qty": qty,
                    "price": price,
                    "revenue": price * qty,
                    "total": total
                })

    df = pd.DataFrame(records)
    print(f"📦 Normalized {len(df)} item records from {len(raw_bills)} bills")
    if not df.empty:
        print(f"   Products found: {df['name'].unique().tolist()[:5]}")
    return df


def get_filtered_bills():
    """Apply date filtering if provided"""
    start_str = request.args.get("startDate")
    end_str = request.args.get("endDate")

    query = {}
    if start_str and end_str:
        try:
            start_dt = datetime.strptime(start_str, "%Y-%m-%d")
            end_dt = datetime.strptime(end_str, "%Y-%m-%d").replace(hour=23, minute=59, second=59)
            query["createdAt"] = {"$gte": start_dt, "$lte": end_dt}
            print(f"✅ Filtering bills between {start_dt} → {end_dt}")
        except ValueError:
            print("❌ Invalid date format received")
            return jsonify({"error": "Invalid date format. Use YYYY-MM-DD"}), 400

    bills = list(db.bills.find(query))
    print(f"📊 Found {len(bills)} bills matching the criteria")
    return bills

# -----------------------
# API Endpoints
# -----------------------

@app.route("/")
def home():
    return jsonify({"status": "Analytics API running 🚀"})


@app.route("/analytics/daily")
def daily_sales():
    raw_bills = get_filtered_bills()
    df = normalize_bills(raw_bills)
    if df.empty:
        return jsonify({
            "daily": [],
            "weekly": [],
            "monthly": [],
            "top_products": [],
            "revenue_trend": [],
            "summary": {
                "total_revenue": 0,
                "total_orders": 0,
                "total_products_sold": 0
            },
            "message": "No billing data"
        }), 200


    summary = (
        df.groupby(df["date"].dt.date)["revenue"]
        .sum()
        .reset_index()
        .rename(columns={"date": "day", "revenue": "totalSales"})
    )
    summary["day"] = summary["day"].astype(str)
    return jsonify(summary.to_dict(orient="records"))


@app.route("/analytics/monthly")
def monthly_sales():
    raw_bills = get_filtered_bills()
    df = normalize_bills(raw_bills)
    if df.empty:
        return jsonify({
            "daily": [],
            "weekly": [],
            "monthly": [],
            "top_products": [],
            "revenue_trend": [],
            "summary": {
                "total_revenue": 0,
                "total_orders": 0,
                "total_products_sold": 0
            },
            "message": "No billing data"
        }), 200


    summary = (
        df.groupby(df["date"].dt.to_period("M"))["revenue"]
        .sum()
        .reset_index()
    )
    summary["date"] = summary["date"].astype(str)
    summary = summary.rename(columns={"date": "month", "revenue": "totalSales"})
    return jsonify(summary.to_dict(orient="records"))


@app.route("/analytics/weekly")
def weekly_sales():
    raw_bills = get_filtered_bills()
    df = normalize_bills(raw_bills)
    if df.empty:
        return jsonify({
            "daily": [],
            "weekly": [],
            "monthly": [],
            "top_products": [],
            "revenue_trend": [],
            "summary": {
                "total_revenue": 0,
                "total_orders": 0,
                "total_products_sold": 0
            },
            "message": "No billing data"
        }), 200


    summary = (
        df.groupby(df["date"].dt.to_period("W"))["revenue"]
        .sum()
        .reset_index()
    )
    summary["date"] = summary["date"].astype(str)
    summary = summary.rename(columns={"date": "week", "revenue": "totalSales"})
    return jsonify(summary.to_dict(orient="records"))


@app.route("/analytics/top-products")
def top_products():
    """Get top products filtered by date range"""
    raw_bills = get_filtered_bills()
    df = normalize_bills(raw_bills)
    if df.empty:
        return jsonify({
            "daily": [],
            "weekly": [],
            "monthly": [],
            "top_products": [],
            "revenue_trend": [],
            "summary": {
                "total_revenue": 0,
                "total_orders": 0,
                "total_products_sold": 0
            },
            "message": "No billing data"
        }), 200


    # Fetch all products for name and category lookup
    products = list(db.products.find({}))
    products_df = pd.DataFrame(products)

    # Merge bill data with product data
    merged = df.merge(
        products_df[["productId", "name", "category"]],
        on="productId",
        how="left",
        suffixes=("_bill", "_prod")
    )

    # Combine names (prefer bill name, fallback to product name)
    merged["name"] = merged["name_bill"].combine_first(merged["name_prod"])
    merged["category"] = merged["category"].fillna("Unknown")

    # Aggregate by product
    summary = (
        merged.groupby(["productId", "name", "category"])
        .agg({"qty": "sum", "revenue": "sum"})
        .reset_index()
        .sort_values("revenue", ascending=False)
        .head(10)
    )

    print(f"🏆 Top {len(summary)} products calculated")
    return jsonify(summary.to_dict(orient="records"))


@app.route("/analytics/revenue-trend")
def revenue_trend():
    """Get revenue trend filtered by date range"""
    raw_bills = get_filtered_bills()
    df = normalize_bills(raw_bills)
    if df.empty:
        return jsonify({
            "daily": [],
            "weekly": [],
            "monthly": [],
            "top_products": [],
            "revenue_trend": [],
            "summary": {
                "total_revenue": 0,
                "total_orders": 0,
                "total_products_sold": 0
            },
            "message": "No billing data"
        }), 200

    trend = (
        df.groupby(df["date"].dt.date)["revenue"]
        .sum()
        .reset_index()
        .rename(columns={"date": "day", "revenue": "totalRevenue"})
    )
    trend["day"] = trend["day"].astype(str)
    return jsonify(trend.to_dict(orient="records"))


@app.route("/analytics/report")
def sales_report():
    """Comprehensive sales report filtered by date range"""
    raw_bills = get_filtered_bills()
    df = normalize_bills(raw_bills)
    if df.empty:
        return jsonify({
            "daily": [],
            "weekly": [],
            "monthly": [],
            "top_products": [],
            "revenue_trend": [],
            "summary": {
                "total_revenue": 0,
                "total_orders": 0,
                "total_products_sold": 0
            },
            "message": "No billing data"
        }), 200


    # Fetch all products for name and category lookup
    products = list(db.products.find({}))
    products_df = pd.DataFrame(products)

    # ----- Daily -----
    daily = (
        df.groupby(df["date"].dt.date)["revenue"]
        .sum()
        .reset_index()
        .rename(columns={"date": "day", "revenue": "totalSales"})
    )
    daily["day"] = daily["day"].astype(str)

    # ----- Weekly -----
    weekly = (
        df.groupby(df["date"].dt.to_period("W"))["revenue"]
        .sum()
        .reset_index()
    )
    weekly["date"] = weekly["date"].astype(str)
    weekly = weekly.rename(columns={"date": "week", "revenue": "totalSales"})

    # ----- Monthly -----
    monthly = (
        df.groupby(df["date"].dt.to_period("M"))["revenue"]
        .sum()
        .reset_index()
    )
    monthly["date"] = monthly["date"].astype(str)
    monthly = monthly.rename(columns={"date": "month", "revenue": "totalSales"})

    # ----- Top Products (filtered by date range) -----
    merged = df.merge(
        products_df[["productId", "name", "category"]],
        on="productId",
        how="left",
        suffixes=("_bill", "_prod")
    )
    merged["name"] = merged["name_bill"].combine_first(merged["name_prod"])
    merged["category"] = merged["category"].fillna("Unknown")

    top_products = (
        merged.groupby(["productId", "name", "category"])
        .agg({"qty": "sum", "revenue": "sum"})
        .reset_index()
        .sort_values("revenue", ascending=False)
        .head(10)
    )

    # ----- Revenue Trend (filtered by date range) -----
    trend = (
        df.groupby(df["date"].dt.date)["revenue"]
        .sum()
        .reset_index()
        .rename(columns={"date": "day", "revenue": "totalRevenue"})
    )
    trend["day"] = trend["day"].astype(str)

    # ----- Combine Report -----
    report = {
        "daily": daily.to_dict(orient="records"),
        "weekly": weekly.to_dict(orient="records"),
        "monthly": monthly.to_dict(orient="records"),
        "top_products": top_products.to_dict(orient="records"),
        "revenue_trend": trend.to_dict(orient="records"),
        "summary": {
            "total_revenue": float(df["revenue"].sum()),
            "total_orders": int(len(raw_bills)),
            "total_products_sold": int(df["qty"].sum())
        }
    }

    print(f"📈 Report generated with {len(top_products)} top products")
    return jsonify(report)


@app.route("/analytics/report/text")
def sales_report_text():
    # --- NEW: Get language from header ---
    # Get 'en', 'hi', 'mr', 'te' from 'hi-IN,hi;q=0.9,en-US;q=0.8,en;q=0.7'
    lang = request.headers.get('Accept-Language', 'en').split(',')[0].split('-')[0]
    # --- End NEW ---

    raw_bills = get_filtered_bills()
    products = list(db.products.find({}))
    df = normalize_bills(raw_bills)

    if df.empty:
        return jsonify({
            "daily": [],
            "weekly": [],
            "monthly": [],
            "top_products": [],
            "revenue_trend": [],
            "summary": {
                "total_revenue": 0,
                "total_orders": 0,
                "total_products_sold": 0
            },
            "message": "No billing data"
        }), 200

    products_df = pd.DataFrame(products)

    # ---- Summary ----
    total_revenue = float(df["revenue"].sum())
    total_orders = int(len(raw_bills))
    total_products_sold = int(df["qty"].sum())

    # ---- Daily ----
    daily = (
        df.groupby(df["date"].dt.date)["revenue"]
        .sum()
        .reset_index()
        .rename(columns={"date": "day", "revenue": "totalSales"})
    )
    daily["day"] = daily["day"].astype(str)
    best_day = daily.loc[daily["totalSales"].idxmax()]

    # ---- Weekly ----
    weekly = (
        df.groupby(df["date"].dt.to_period("W"))["revenue"]
        .sum()
        .reset_index()
    )
    weekly["date"] = weekly["date"].astype(str)
    best_week = weekly.loc[weekly["revenue"].idxmax()]

    # ---- Monthly ----
    monthly = (
        df.groupby(df["date"].dt.to_period("M"))["revenue"]
        .sum()
        .reset_index()
    )
    monthly["date"] = monthly["date"].astype(str)
    best_month = monthly.loc[monthly["revenue"].idxmax()]

    # ---- Top Products ----
    merged = df.merge(
        products_df[["productId", "name", "category"]],
        on="productId",
        how="left",
        suffixes=("_bill", "_prod")
    )
    merged["name"] = merged["name_bill"].combine_first(merged["name_prod"])
    merged["category"] = merged["category"].fillna("Unknown")

    top_products = (
        merged.groupby(["productId", "name", "category"])
        .agg({"qty": "sum", "revenue": "sum"})
        .reset_index()
        .sort_values("revenue", ascending=False)
        .head(3)
    )

    # ---- Generate Plain Text Report (TRANSLATED) ----
    report_lines = []
    report_lines.append(t(lang, 'report_title'))
    report_lines.append(t(lang, 'total_revenue').format(total_revenue=total_revenue))
    report_lines.append(t(lang, 'total_orders').format(total_orders=total_orders))
    report_lines.append(t(lang, 'total_products_sold').format(total_products_sold=total_products_sold))
    report_lines.append(t(lang, 'best_day').format(best_day=best_day['day'], total_sales=best_day['totalSales']))
    report_lines.append(t(lang, 'best_week').format(best_week=best_week['date'], revenue=best_week['revenue']))
    report_lines.append(t(lang, 'best_month').format(best_month=best_month['date'], revenue=best_month['revenue']))

    report_lines.append(t(lang, 'top_products_title'))
    for _, row in top_products.iterrows():
        report_lines.append(
            t(lang, 'top_product_line').format(name=row['name'], category=row['category'], qty=row['qty'], revenue=row['revenue'])
        )
    # --- End of modifications ---

    return jsonify({"report": " ".join(report_lines)})

# -----------------------
# Run Server
# -----------------------
if __name__ == "__main__":
    app.run(port=5001, debug=True)
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\analytics\requirements.txt
--------------------------------------------------------------------
Flask
flask-cors
flask-pymongo
pandas
python-dotenv
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\analytics\translations.py
--------------------------------------------------------------------
# NEW FILE
translations = {
    "en": {
        "report_title": "📊 Sales Analysis Report",
        "total_revenue": "Total revenue generated: ₹{total_revenue:,.2f}.",
        "total_orders": "Total number of orders: {total_orders}.",
        "total_products_sold": "Total products sold: {total_products_sold}.",
        "best_day": "Best performing day: {best_day} (₹{total_sales:.2f}).",
        "best_week": "Best week: {best_week} (₹{revenue:.2f}).",
        "best_month": "Best month: {best_month} (₹{revenue:.2f}).",
        "top_products_title": "Top selling products:",
        "top_product_line": "- {name} ({category}) sold {qty} units, revenue {revenue:.2f}"
    },
    "hi": {
        "report_title": "📊 बिक्री विश्लेषण रिपोर्ट",
        "total_revenue": "कुल राजस्व उत्पन्न: ₹{total_revenue:,.2f}।",
        "total_orders": "ऑर्डर की कुल संख्या: {total_orders}।",
        "total_products_sold": "कुल बिके उत्पाद: {total_products_sold}।",
        "best_day": "सबसे अच्छा प्रदर्शन करने वाला दिन: {best_day} (₹{total_sales:.2f})।",
        "best_week": "सबसे अच्छा सप्ताह: {best_week} (₹{revenue:.2f})।",
        "best_month": "सबसे अच्छा महीना: {best_month} (₹{revenue:.2f})।",
        "top_products_title": "सबसे ज्यादा बिकने वाले उत्पाद:",
        "top_product_line": "- {name} ({category}) ने {qty} इकाइयाँ बेचीं, राजस्व {revenue:.2f}"
    },
    "mr": {
        "report_title": "📊 विक्री विश्लेषण अहवाल",
        "total_revenue": "एकूण महसूल: ₹{total_revenue:,.2f}।",
        "total_orders": "एकूण ऑर्डरची संख्या: {total_orders}।",
        "total_products_sold": "एकूण विकलेली उत्पादने: {total_products_sold}।",
        "best_day": "सर्वोत्तम कामगिरीचा दिवस: {best_day} (₹{total_sales:.2f}).",
        "best_week": "सर्वोत्तम आठवडा: {best_week} (₹{revenue:.2f}).",
        "best_month": "सर्वोत्तम महिना: {best_month} (₹{revenue:.2f}).",
        "top_products_title": " सर्वाधिक विकली जाणारी उत्पादने:",
        "top_product_line": "- {name} ({category}) ने {qty} युनिट्स विकले, महसूल {revenue:.2f}"
    },
    "te": {
        "report_title": "📊 అమ్మకాల విశ్లేషణ నివేదిక",
        "total_revenue": "మొత్తం ఆదాయం: ₹{total_revenue:,.2f}।",
        "total_orders": "మొత్తం ఆర్డర్ల సంఖ్య: {total_orders}।",
        "total_products_sold": "మొత్తం అమ్ముడైన ఉత్పత్తులు: {total_products_sold}।",
        "best_day": "ఉత్తమ పనితీరు కనబరిచిన రోజు: {best_day} (₹{total_sales:.2f}).",
        "best_week": "ఉత్తమ వారం: {best_week} (₹{revenue:.2f}).",
        "best_month": "ఉత్తమ నెల: {best_month} (₹{revenue:.2f}).",
        "top_products_title": "అత్యధికంగా అమ్ముడైన ఉత్పత్తులు:",
        "top_product_line": "- {name} ({category}) {qty} యూనిట్లు అమ్ముడయ్యాయి, ఆదాయం {revenue:.2f}"
    }
}

def get_translation(lang_code, key):
    """
    Fetches a translation string for a given language and key.
    Falls back to English if the language or key is not found.
    """
    # Use 'en' as default
    lang = lang_code if lang_code in translations else "en"

    # Get the dictionary for the language
    lang_dict = translations.get(lang)

    # Get the specific string, falling back to English if the key is missing
    translation_string = lang_dict.get(key)
    if translation_string is None:
        # Fallback to English if key doesn't exist in the target language
        translation_string = translations.get("en", {}).get(key, key)

    return translation_string
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\BackendApplication.java
--------------------------------------------------------------------
package com.smartretail.backend;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.scheduling.annotation.EnableScheduling;

@SpringBootApplication
@EnableScheduling
public class BackendApplication {
	public static void main(String[] args) {
		SpringApplication.run(BackendApplication.class, args);
	}
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\config
--------------------------------------------------------------------
Contents:
AppConfig.java
DuplicateResourceException.java
GlobalExceptionHandler.java
GridFSConfig.java
I18nConfig.java
InsufficientStockException.java
ResourceNotFoundException.java
SecurityConfig.java

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\config\AppConfig.java
--------------------------------------------------------------------
package com.smartretail.backend.config;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder; // <-- NEW IMPORT
import org.springframework.security.crypto.password.PasswordEncoder; // <-- NEW IMPORT
import org.springframework.web.client.RestTemplate;

@Configuration
public class AppConfig {
    @Bean
    public RestTemplate restTemplate() {
        return new RestTemplate();
    }

    // --- ADD THIS BEAN ---
    @Bean
    public PasswordEncoder passwordEncoder() {
        return new BCryptPasswordEncoder();
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\config\DuplicateResourceException.java
--------------------------------------------------------------------
package com.smartretail.backend.config;

import lombok.Getter;

// DuplicateResourceException.java
@Getter
public class DuplicateResourceException extends RuntimeException {
    private final String messageKey;
    private final String resourceId;

    public DuplicateResourceException(String messageKey, String resourceId) {
        super("Duplicate resource: " + resourceId);
        this.messageKey = messageKey;
        this.resourceId = resourceId;
    }

}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\config\GlobalExceptionHandler.java
--------------------------------------------------------------------
package com.smartretail.backend.config;

import com.smartretail.backend.exception.ProductNotFoundException;
import org.springframework.context.MessageSource;
import org.springframework.context.NoSuchMessageException;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.web.HttpRequestMethodNotSupportedException;
import org.springframework.web.bind.annotation.ControllerAdvice;
import org.springframework.web.bind.annotation.ExceptionHandler;
import org.springframework.web.context.request.WebRequest;

import java.util.HashMap;
import java.util.Map;
import java.util.MissingResourceException;

@ControllerAdvice
public class GlobalExceptionHandler {

    private final MessageSource messageSource;

    public GlobalExceptionHandler(MessageSource messageSource) {
        this.messageSource = messageSource;
    }

    @ExceptionHandler(NoSuchMessageException.class)
    public ResponseEntity<Map<String, String>> handleNoSuchMessageException(NoSuchMessageException ex, WebRequest request) {
        Map<String, String> errorResponse = new HashMap<>();
        request.getLocale();
        String locale = request.getLocale().toString();
        errorResponse.put("error", "Missing message: " + ex.getMessage() + " for locale: " + locale);
        return new ResponseEntity<>(errorResponse, HttpStatus.INTERNAL_SERVER_ERROR);
    }

    @ExceptionHandler(HttpRequestMethodNotSupportedException.class)
    public ResponseEntity<Map<String, String>> handleMethodNotSupportedException(HttpRequestMethodNotSupportedException ex, WebRequest request) {
        Map<String, String> errorResponse = new HashMap<>();
        errorResponse.put("error", "Request method '" + ex.getMethod() + "' is not supported for this endpoint");
        return new ResponseEntity<>(errorResponse, HttpStatus.METHOD_NOT_ALLOWED);
    }

    @ExceptionHandler(IllegalArgumentException.class)
    public ResponseEntity<Map<String, String>> handleIllegalArgumentException(IllegalArgumentException ex, WebRequest request) {
        Map<String, String> errorResponse = new HashMap<>();
        errorResponse.put("error", ex.getMessage());
        return new ResponseEntity<>(errorResponse, HttpStatus.BAD_REQUEST);
    }

    @ExceptionHandler(DuplicateResourceException.class)
    public ResponseEntity<Map<String, String>> handleDuplicateResourceException(DuplicateResourceException ex, WebRequest request) {
        Map<String, String> errorResponse = new HashMap<>();
        errorResponse.put("error", messageSource.getMessage(ex.getMessage(), new Object[]{ex.getResourceId()}, request.getLocale()));
        return new ResponseEntity<>(errorResponse, HttpStatus.BAD_REQUEST);
    }

    @ExceptionHandler(ResourceNotFoundException.class)
    public ResponseEntity<Map<String, String>> handleResourceNotFoundException(ResourceNotFoundException ex, WebRequest request) {
        Map<String, String> errorResponse = new HashMap<>();
        errorResponse.put("error", messageSource.getMessage(ex.getMessage(), new Object[]{ex.getResourceId()}, request.getLocale()));
        return new ResponseEntity<>(errorResponse, HttpStatus.NOT_FOUND);
    }

    @ExceptionHandler(ProductNotFoundException.class)
    public ResponseEntity<Map<String, String>> handleProductNotFoundException(ProductNotFoundException ex, WebRequest request) {
        Map<String, String> errorResponse = new HashMap<>();
        errorResponse.put("error", ex.getMessage());
        return new ResponseEntity<>(errorResponse, HttpStatus.NOT_FOUND);
    }

    @ExceptionHandler(MissingResourceException.class)
    public ResponseEntity<Map<String, String>> handleMissingResourceException(MissingResourceException ex, WebRequest request) {
        Map<String, String> errorResponse = new HashMap<>();
        errorResponse.put("error", "Resource not found: " + ex.getMessage());
        return new ResponseEntity<>(errorResponse, HttpStatus.INTERNAL_SERVER_ERROR);
    }

    @ExceptionHandler(RuntimeException.class)
    public ResponseEntity<Map<String, String>> handleRuntimeException(RuntimeException ex, WebRequest request) {
        Map<String, String> errorResponse = new HashMap<>();
        errorResponse.put("error", ex.getMessage());
        return new ResponseEntity<>(errorResponse, HttpStatus.BAD_REQUEST);
    }

    @ExceptionHandler(Exception.class)
    public ResponseEntity<Map<String, String>> handleAllExceptions(Exception ex, WebRequest request) {
        Map<String, String> errorResponse = new HashMap<>();
        String errorMessage = messageSource.getMessage("error.generic", null, request.getLocale());
        errorResponse.put("error", errorMessage + ": " + ex.getMessage());
        return new ResponseEntity<>(errorResponse, HttpStatus.INTERNAL_SERVER_ERROR);
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\config\GridFSConfig.java
--------------------------------------------------------------------
package com.smartretail.backend.config;

import com.mongodb.client.MongoClient;
import com.mongodb.client.gridfs.GridFSBucket;
import com.mongodb.client.gridfs.GridFSBuckets;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

@Configuration
public class GridFSConfig {
    @Bean
    public GridFSBucket gridFSBucket(MongoClient mongoClient) {
        return GridFSBuckets.create(mongoClient.getDatabase("smartretail"));
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\config\I18nConfig.java
--------------------------------------------------------------------
package com.smartretail.backend.config;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.support.ReloadableResourceBundleMessageSource;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;
import org.springframework.web.servlet.i18n.AcceptHeaderLocaleResolver;

import java.util.Arrays;
import java.util.Locale;

@Configuration
public class I18nConfig implements WebMvcConfigurer {

    @Bean
    public ReloadableResourceBundleMessageSource messageSource() {
        ReloadableResourceBundleMessageSource messageSource = new ReloadableResourceBundleMessageSource();
        messageSource.setBasename("classpath:messages");
        messageSource.setDefaultEncoding("UTF-8");
        messageSource.setDefaultLocale(Locale.ENGLISH);
        messageSource.setCacheSeconds(3600); // Cache for 1 hour
        messageSource.setFallbackToSystemLocale(false);
        return messageSource;
    }

    @Bean
    public AcceptHeaderLocaleResolver localeResolver() {
        AcceptHeaderLocaleResolver resolver = new AcceptHeaderLocaleResolver();
        resolver.setSupportedLocales(Arrays.asList(
                Locale.ENGLISH,
                Locale.forLanguageTag("hi"), // Hindi
                Locale.forLanguageTag("mr"), // Marathi
                Locale.forLanguageTag("te"), // Telugu
                Locale.US // Fallback
        ));
        resolver.setDefaultLocale(Locale.ENGLISH);
        return resolver;
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\config\InsufficientStockException.java
--------------------------------------------------------------------
package com.smartretail.backend.config;

import lombok.Getter;

// InsufficientStockException.java
@Getter
public class InsufficientStockException extends RuntimeException {
    private final String productId;

    public InsufficientStockException(String productId) {
        super("Insufficient stock for product: " + productId);
        this.productId = productId;
    }

}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\config\ResourceNotFoundException.java
--------------------------------------------------------------------
package com.smartretail.backend.config;

import lombok.Getter;

// ResourceNotFoundException.java
@Getter
public class ResourceNotFoundException extends RuntimeException {
    private final String messageKey;
    private final String resourceId;

    public ResourceNotFoundException(String messageKey, String resourceId) {
        super("Resource not found: " + resourceId);
        this.messageKey = messageKey;
        this.resourceId = resourceId;
    }

}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\config\SecurityConfig.java
--------------------------------------------------------------------
package com.smartretail.backend.config;

import com.smartretail.backend.security.CustomOAuth2AuthenticationSuccessHandler;
import com.smartretail.backend.security.JwtAuthenticationFilter;
import com.smartretail.backend.service.UserService;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Lazy;
import org.springframework.security.authentication.AuthenticationManager;
import org.springframework.security.config.annotation.authentication.configuration.AuthenticationConfiguration;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.config.annotation.web.configurers.AbstractHttpConfigurer;
import org.springframework.security.config.http.SessionCreationPolicy;
import org.springframework.security.web.SecurityFilterChain;
import org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter;
import org.springframework.web.cors.CorsConfiguration;
import org.springframework.web.cors.CorsConfigurationSource;
import org.springframework.web.cors.UrlBasedCorsConfigurationSource;

import java.util.Arrays;

@Configuration
@EnableWebSecurity
public class SecurityConfig {

    private final JwtAuthenticationFilter jwtAuthFilter;
    private final UserService userService;
    private final CustomOAuth2AuthenticationSuccessHandler oAuth2SuccessHandler;

    public SecurityConfig(JwtAuthenticationFilter jwtAuthFilter,
                          @Lazy UserService userService,
                          CustomOAuth2AuthenticationSuccessHandler oAuth2SuccessHandler) {
        this.jwtAuthFilter = jwtAuthFilter;
        this.userService = userService;
        this.oAuth2SuccessHandler = oAuth2SuccessHandler;
    }

    @Bean
    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
        http
                .cors(cors -> cors.configurationSource(corsConfigurationSource()))
                .authorizeHttpRequests(auth -> auth
                        .requestMatchers("/static/**", "/css/**", "/js/**", "/images/**").permitAll()
                        .requestMatchers("/api/auth/**", "/error", "/static/**", "/", "/index.html", "/favicon.ico", "/login/oauth2/**", "/oauth2/**").permitAll()
                        .requestMatchers("/api/bills/{billId}/pdf").permitAll()

                        // Allow anyone to GET product images
                        .requestMatchers(org.springframework.http.HttpMethod.GET, "/api/products/image/**").permitAll()

                        // This rule now correctly secures the other product endpoints
                        .requestMatchers("/api/products/**", "/api/bills/**").hasAnyRole("MANAGER","OWNER")

                        // --- ADD THIS LINE ---
                        .requestMatchers(org.springframework.http.HttpMethod.POST, "/api/customers/send-email").hasAnyRole("MANAGER", "OWNER")

                        .requestMatchers("/api/customers/**").hasAnyRole("MANAGER", "CASHIER", "OWNER")
                        .requestMatchers("/api/reports/**").hasAnyRole("MANAGER", "OWNER")
                        .requestMatchers("/api/users/**").hasRole("OWNER")
                        .anyRequest().authenticated()
                )
                .csrf(AbstractHttpConfigurer::disable)
                .formLogin(AbstractHttpConfigurer::disable)
                .httpBasic(AbstractHttpConfigurer::disable)
                .sessionManagement(session -> session.sessionCreationPolicy(SessionCreationPolicy.STATELESS))
                .addFilterBefore(jwtAuthFilter, UsernamePasswordAuthenticationFilter.class)

                // --- OAUTH2 LOGIN CONFIG ---
                .oauth2Login(oauth2 -> {
                    oauth2.successHandler(oAuth2SuccessHandler);
                });

        return http.build();
    }

    @Bean
    public CorsConfigurationSource corsConfigurationSource() {
        CorsConfiguration configuration = new CorsConfiguration();
        configuration.setAllowedOrigins(Arrays.asList("https://your-vercel-app.vercel.app", "http://localhost:3000", "http://localhost:5173", "http://localhost:8080"));
        configuration.setAllowedMethods(Arrays.asList("GET", "POST", "PUT", "DELETE", "OPTIONS"));
        configuration.setAllowedHeaders(Arrays.asList("Authorization", "Content-Type", "Accept-Language"));
        configuration.setAllowCredentials(true);
        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();
        source.registerCorsConfiguration("/**", configuration);
        return source;
    }

    @Bean
    public AuthenticationManager authenticationManager(AuthenticationConfiguration authenticationConfiguration) throws Exception {
        return authenticationConfiguration.getAuthenticationManager();
    }
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\controller
--------------------------------------------------------------------
Contents:
AnalyticsController.java
AuthController.java
BillController.java
CustomerController.java
NotificationController.java
PaymentController.java
ProductController.java
PushNotificationController.java
ReportController.java
SyncController.java
UserController.java

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\controller\AnalyticsController.java
--------------------------------------------------------------------
package com.smartretail.backend.controller;

import com.smartretail.backend.service.AnalyticsService;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.web.bind.annotation.*;

import java.util.Map;

@RestController
@RequestMapping("/api/analytics")
public class AnalyticsController {
    private final AnalyticsService analyticsService;

    public AnalyticsController(AnalyticsService analyticsService) {
        this.analyticsService = analyticsService;
    }

    @GetMapping("/report")
    @PreAuthorize("hasAnyRole('OWNER','MANAGER')")
    public ResponseEntity<?> getReport(
            @RequestParam(required = false) String startDate,
            @RequestParam(required = false) String endDate) {
        try {
            Object data = analyticsService.getReport(startDate, endDate);
            return ResponseEntity.ok(data);
        } catch (Exception e) {
            return ResponseEntity.status(HttpStatus.SERVICE_UNAVAILABLE)
                    .body(Map.of("error", "Analytics service unavailable: " + e.getMessage()));
        }
    }

    @GetMapping("/report/text")
    @PreAuthorize("hasAnyRole('OWNER','MANAGER')")
    public ResponseEntity<?> getTextReport(
            @RequestParam(required = false) String startDate,
            @RequestParam(required = false) String endDate) {
        try {
            Object data = analyticsService.getTextReport(startDate, endDate);
            return ResponseEntity.ok(data);
        } catch (Exception e) {
            return ResponseEntity.status(HttpStatus.SERVICE_UNAVAILABLE)
                    .body(Map.of("error", "Analytics service unavailable: " + e.getMessage()));
        }
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\controller\AuthController.java
--------------------------------------------------------------------
package com.smartretail.backend.controller;

import com.smartretail.backend.dto.LoginRequest;
import com.smartretail.backend.dto.LoginResponse;
import com.smartretail.backend.dto.SignupRequest;
import com.smartretail.backend.models.User;
import com.smartretail.backend.service.AuthService;
import jakarta.validation.Valid;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

import java.util.HashMap;
import java.util.Map;

@RestController
@RequestMapping("/api/auth")
public class AuthController {
    private final AuthService authService;

    public AuthController(AuthService authService) {
        this.authService = authService;
    }

    @PostMapping("/signup")
    public ResponseEntity<?> signup(@Valid @RequestBody SignupRequest request) {
        User user = authService.signup(request);
        Map<String, Object> response = new HashMap<>();
        response.put("message", "User registered successfully");
        response.put("userId", user.getId());
        response.put("email", user.getEmail());
        return ResponseEntity.status(201).body(response);
    }

    @PostMapping("/login")
    public ResponseEntity<?> login(@Valid @RequestBody LoginRequest request) {
        LoginResponse loginResponse = authService.login(request);
        return ResponseEntity.ok(loginResponse);
    }

    @PostMapping("/refresh")
    public ResponseEntity<?> refreshToken(@RequestBody String refreshToken) {
        String newAccessToken = authService.refreshToken(refreshToken);
        Map<String, String> response = new HashMap<>();
        response.put("accessToken", newAccessToken);
        return ResponseEntity.ok(response);
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\controller\BillController.java
--------------------------------------------------------------------
package com.smartretail.backend.controller;

import com.fasterxml.jackson.core.type.TypeReference;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.opencsv.bean.CsvToBeanBuilder;
import com.smartretail.backend.models.Bill;
import com.smartretail.backend.service.BillService;
import com.smartretail.backend.service.PdfService;
import lombok.Getter;
import lombok.Setter;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.context.MessageSource;
import org.springframework.context.i18n.LocaleContextHolder;
import org.springframework.http.*;
import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.web.bind.annotation.*;
import org.springframework.web.multipart.MultipartFile;

import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.text.SimpleDateFormat;
import java.util.*;

@RestController
@RequestMapping("/api/bills")
@PreAuthorize("permitAll()")
@CrossOrigin(origins = "*")
public class BillController {

    private static final Logger logger = LoggerFactory.getLogger(BillController.class);
    private final BillService billService;
    private final PdfService pdfService;
    private final MessageSource messageSource;
    private final ObjectMapper objectMapper;

    public BillController(BillService billService, PdfService pdfService, MessageSource messageSource) {
        this.billService = billService;
        this.pdfService = pdfService;
        this.messageSource = messageSource;
        this.objectMapper = new ObjectMapper();
    }

    // ✅ Create a new bill
    @PostMapping
    public ResponseEntity<Map<String, Object>> createBill(@RequestBody Bill bill) {
        Locale locale = LocaleContextHolder.getLocale();
        logger.info("[BILL CONTROLLER] Creating bill request received: {}", bill.getBillId());

        // Defensive validation
        if (bill.getItems() == null || bill.getItems().isEmpty()) {
            return ResponseEntity.badRequest()
                    .body(Map.of("error", "Bill items cannot be empty"));
        }

        // ✅ Ensure total is recalculated even if frontend didn't send it
        bill.setTotalAmount(bill.calculateTotal());

        // Save using service
        Bill createdBill = billService.createBill(bill, locale);

        // ✅ Generate PDF access token for immediate download
        String pdfToken = billService.generatePdfAccessToken(createdBill.getBillId());

        logger.info("[BILL CONTROLLER] Bill {} created successfully. Total = ₹{}",
                createdBill.getBillId(), createdBill.getTotalAmount());

        // Return bill along with PDF token
        Map<String, Object> response = new HashMap<>();
        response.put("bill", createdBill);
        response.put("pdfAccessToken", pdfToken);
        response.put("pdfDownloadUrl", "/api/bills/" + createdBill.getBillId() + "/pdf?token=" + pdfToken);

        return new ResponseEntity<>(response, HttpStatus.CREATED);
    }

    // ✅ Get bill by ID
    @GetMapping("/{billId}")
    public ResponseEntity<Bill> getBillById(@PathVariable String billId) {
        Locale locale = LocaleContextHolder.getLocale();
        logger.debug("[BILL CONTROLLER] Fetching bill: {}", billId);
        Bill bill = billService.getBillById(billId, locale);
        return ResponseEntity.ok(bill);
    }

    // ✅ Get all bills
    @GetMapping
    public ResponseEntity<List<Bill>> getAllBills() {
        logger.debug("[BILL CONTROLLER] Fetching all bills");
        List<Bill> bills = billService.getAllBills();
        return ResponseEntity.ok(bills);
    }

    // ✅ Generate PDF access token for existing bill
    @PostMapping("/{billId}/generate-token")
    public ResponseEntity<Map<String, String>> generatePdfToken(@PathVariable String billId) {
        Locale locale = LocaleContextHolder.getLocale();
        logger.info("[BILL CONTROLLER] Generating PDF token for bill: {}", billId);

        // Verify bill exists
        billService.getBillById(billId, locale);

        String pdfToken = billService.generatePdfAccessToken(billId);

        Map<String, String> response = new HashMap<>();
        response.put("billId", billId);
        response.put("pdfAccessToken", pdfToken);
        response.put("pdfDownloadUrl", "/api/bills/" + billId + "/pdf?token=" + pdfToken);

        return ResponseEntity.ok(response);
    }

    // ✅ Generate Bill PDF (Optimized version)
    @GetMapping(value = "/{billId}/pdf", produces = MediaType.APPLICATION_PDF_VALUE)
    public ResponseEntity<byte[]> downloadBillPdf(@PathVariable String billId,
                                                  @RequestParam(required = false) String token) {
        Locale locale = LocaleContextHolder.getLocale();
        logger.info("[BILL CONTROLLER] Generating PDF for Bill ID: {}", billId);

        // Token validation – allow download only with a valid token
        if (token == null || !billService.validatePdfAccessToken(billId, token)) {
            logger.warn("[BILL CONTROLLER] Invalid or missing token for Bill {}", billId);
            return ResponseEntity.status(HttpStatus.FORBIDDEN)
                    .body(null);
        }

        try {
            Bill bill = billService.getBillById(billId, locale);
            byte[] pdfBytes = pdfService.generateBillPdf(bill, locale);

            HttpHeaders headers = new HttpHeaders();
            headers.setContentType(MediaType.APPLICATION_PDF);
            headers.setContentDispositionFormData("attachment", "Bill_" + billId + ".pdf");
            headers.setCacheControl("no-cache, no-store, must-revalidate");
            headers.add(HttpHeaders.ACCESS_CONTROL_EXPOSE_HEADERS, "Content-Disposition");

            logger.info("[BILL CONTROLLER] PDF generated successfully for Bill ID: {}", billId);
            return new ResponseEntity<>(pdfBytes, headers, HttpStatus.OK);
        } catch (Exception e) {
            logger.error("[BILL CONTROLLER] Error generating PDF for Bill {}: {}", billId, e.getMessage());
            return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).build();
        }
    }

    // ✅ Resend Bill Email
    @PostMapping("/resend-email/{billId}")
    public ResponseEntity<?> resendBillEmail(@PathVariable String billId) {
        Locale locale = LocaleContextHolder.getLocale();
        try {
            logger.info("[BILL CONTROLLER] Resend request received for bill: {}", billId);
            Bill bill = billService.getBillById(billId, locale);

            if (bill == null) {
                logger.warn("[BILL CONTROLLER] Bill not found: {}", billId);
                return ResponseEntity.status(404)
                        .body(Map.of("error", "Bill not found: " + billId));
            }

            billService.resendBillEmail(bill, locale);
            logger.info("[BILL CONTROLLER] Bill email resent successfully for: {}", billId);

            // Generate new token for the resent email
            String newToken = billService.generatePdfAccessToken(billId);

            return ResponseEntity.ok(Map.of(
                    "message", "Bill email resent successfully",
                    "pdfAccessToken", newToken
            ));

        } catch (RuntimeException e) {
            logger.error("[BILL CONTROLLER] Failed to resend bill email: {}", e.getMessage());
            return ResponseEntity.badRequest()
                    .body(Map.of("error", "Failed to resend bill email"));
        }
    }

    // ✅ Bulk upload (CSV)
    @PostMapping("/bulk")
    public ResponseEntity<Map<String, Object>> bulkUploadBills(
            @RequestPart("file") MultipartFile file) {
        Locale locale = LocaleContextHolder.getLocale();
        logger.info("[BILL CONTROLLER] Starting bulk upload");

        if (file == null || file.isEmpty()) {
            throw new IllegalArgumentException(messageSource.getMessage("file.missing", null, locale));
        }

        String filename = file.getOriginalFilename();
        if (filename == null || !filename.toLowerCase().endsWith(".csv")) {
            throw new IllegalArgumentException(messageSource.getMessage("file.invalid.format", null, locale));
        }

        Map<String, Object> result = new HashMap<>();
        List<Map<String, Object>> successfulBills = new ArrayList<>();
        List<String> skippedBills = new ArrayList<>();
        List<String> errorMessages = new ArrayList<>();

        // DateFormat for 'createdAt' field
        SimpleDateFormat df = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss.SSS'Z'");
        df.setTimeZone(TimeZone.getTimeZone("UTC"));

        try (BufferedReader reader = new BufferedReader(new InputStreamReader(file.getInputStream()))) {
            List<BillCsvBean> csvBeans = new CsvToBeanBuilder<BillCsvBean>(reader)
                    .withType(BillCsvBean.class)
                    .withIgnoreLeadingWhiteSpace(true)
                    .withIgnoreEmptyLine(true)
                    .build()
                    .parse();

            for (int i = 0; i < csvBeans.size(); i++) {
                BillCsvBean csvBean = csvBeans.get(i);
                int row = i + 2;

                try {
                    if (csvBean.getBillId() == null || csvBean.getBillId().trim().isEmpty()) {
                        errorMessages.add("Row " + row + ": Missing billId");
                        continue;
                    }

                    if (billService.existsByBillId(csvBean.getBillId())) {
                        skippedBills.add("Row " + row + ": Duplicate bill ID " + csvBean.getBillId());
                        continue;
                    }

                    // Parse JSON items
                    List<Bill.BillItem> items = objectMapper.readValue(
                            csvBean.getItems(),
                            new TypeReference<List<Bill.BillItem>>() {}
                    );

                    Bill bill = new Bill();
                    bill.setBillId(csvBean.getBillId());
                    bill.setAddedBy(csvBean.getAddedBy());
                    Bill.CustomerInfo info = new Bill.CustomerInfo();
                    info.setMobile(csvBean.getCustomerMobile());
                    bill.setCustomer(info);
                    bill.setItems(items);

                    // Parse and set createdAt from CSV
                    try {
                        if (csvBean.getCreatedAt() != null && !csvBean.getCreatedAt().trim().isEmpty()) {
                            bill.setCreatedAt(df.parse(csvBean.getCreatedAt()));
                        } else {
                            bill.setCreatedAt(new Date()); // Fallback to now
                        }
                    } catch (Exception e) {
                        logger.warn("Row " + row + ": Invalid date format for " + csvBean.getCreatedAt() + ". Defaulting to now.");
                        bill.setCreatedAt(new Date());
                    }

                    bill.setTotalAmount(bill.calculateTotal());

                    Bill saved = billService.createBill(bill, locale, true); // Use sync mode for bulk upload

                    // Generate token for each successful bill
                    String pdfToken = billService.generatePdfAccessToken(saved.getBillId());

                    Map<String, Object> billResponse = new HashMap<>();
                    billResponse.put("bill", saved);
                    billResponse.put("pdfAccessToken", pdfToken);
                    successfulBills.add(billResponse);

                } catch (Exception e) {
                    errorMessages.add("Row " + row + ": " + e.getMessage());
                }
            }

        } catch (Exception e) {
            errorMessages.add("File processing failed: " + e.getMessage());
        }

        result.put("successful", successfulBills.size());
        result.put("skipped", skippedBills.size());
        result.put("errors", errorMessages.size());
        result.put("successfulBills", successfulBills);
        result.put("skippedDetails", skippedBills);
        result.put("errorDetails", errorMessages);

        return new ResponseEntity<>(result, HttpStatus.CREATED);
    }

    @Getter
    @Setter
    public static class BillCsvBean {
        private String billId;
        private String customerMobile;
        private String items;
        private String createdAt;
        private String addedBy;
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\controller\CustomerController.java
--------------------------------------------------------------------
package com.smartretail.backend.controller;

import com.smartretail.backend.dto.CustomEmailRequest; // <-- ADDED IMPORT
import com.smartretail.backend.models.Bill;
import com.smartretail.backend.models.Customer;
import com.smartretail.backend.service.CustomerService;
import com.smartretail.backend.service.ReminderService;
import jakarta.validation.Valid;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.format.annotation.DateTimeFormat;
import org.springframework.http.ResponseEntity;
import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.web.bind.annotation.*;

import java.util.Date;
import java.util.List;
import java.util.Locale;
import java.util.Map;

@RestController
@RequestMapping("/api/customers")
public class CustomerController {

    private static final Logger logger = LoggerFactory.getLogger(CustomerController.class);

    private final CustomerService customerService;
    private final ReminderService reminderService;

    public CustomerController(CustomerService customerService, ReminderService reminderService) {
        this.customerService = customerService;
        this.reminderService = reminderService;
    }

    @PostMapping
    @PreAuthorize("hasAnyRole('OWNER', 'MANAGER', 'CASHIER')")
    public ResponseEntity<Customer> createCustomer(
            @Valid @RequestBody Customer customer,
            @RequestHeader(value = "Accept-Language", defaultValue = "en", required = false) String language) {
        Locale locale = parseLocale(language);
        logger.debug("Creating customer with mobile: {}", customer.getMobile());
        Customer savedCustomer = customerService.createCustomer(customer, locale);
        return ResponseEntity.status(201).body(savedCustomer);
    }

    @GetMapping("/{id}")
    @PreAuthorize("hasAnyRole('OWNER', 'MANAGER', 'CASHIER')")
    public ResponseEntity<Customer> getCustomerById(
            @PathVariable String id,
            @RequestHeader(value = "Accept-Language", defaultValue = "en", required = false) String language) {
        Locale locale = parseLocale(language);
        logger.debug("Fetching customer with ID: {}", id);
        Customer customer = customerService.getCustomerById(id, locale);
        return ResponseEntity.ok(customer);
    }

    @GetMapping
    @PreAuthorize("hasAnyRole('OWNER', 'MANAGER', 'CASHIER')")
    public ResponseEntity<List<Customer>> getAllCustomers(
            @RequestHeader(value = "Accept-Language", defaultValue = "en", required = false) String language) {
        Locale locale = parseLocale(language);
        logger.debug("Fetching all customers");
        List<Customer> customers = customerService.getAllCustomers();
        return ResponseEntity.ok(customers);
    }

    @PutMapping("/{id}")
    @PreAuthorize("hasAnyRole('OWNER', 'MANAGER')")
    public ResponseEntity<Customer> updateCustomer(
            @PathVariable String id,
            @Valid @RequestBody Customer customer,
            @RequestHeader(value = "Accept-Language", defaultValue = "en", required = false) String language) {
        Locale locale = parseLocale(language);
        logger.debug("Updating customer with ID: {}", id);
        Customer updatedCustomer = customerService.updateCustomer(id, customer, locale);
        return ResponseEntity.ok(updatedCustomer);
    }

    @DeleteMapping("/{id}")
    @PreAuthorize("hasAnyRole('OWNER', 'MANAGER')")
    public ResponseEntity<Void> deleteCustomer(
            @PathVariable String id,
            @RequestHeader(value = "Accept-Language", defaultValue = "en", required = false) String language) {
        Locale locale = parseLocale(language);
        logger.debug("Deleting customer with ID: {}", id);
        customerService.deleteCustomer(id, locale);
        return ResponseEntity.noContent().build();
    }

    @GetMapping("/{id}/purchase-history")
    @PreAuthorize("hasAnyRole('OWNER', 'MANAGER', 'CASHIER')")
    public ResponseEntity<List<Bill>> getCustomerPurchaseHistory(
            @PathVariable String id,
            @RequestParam(required = false) @DateTimeFormat(iso = DateTimeFormat.ISO.DATE) Date startDate,
            @RequestParam(required = false) @DateTimeFormat(iso = DateTimeFormat.ISO.DATE) Date endDate,
            @RequestHeader(value = "Accept-Language", defaultValue = "en", required = false) String language) {
        Locale locale = parseLocale(language);
        logger.debug("Fetching purchase history for customer ID: {}, startDate: {}, endDate: {}", id, startDate, endDate);
        List<Bill> purchaseHistory = customerService.getCustomerPurchaseHistory(id, startDate, endDate, locale);
        return ResponseEntity.ok(purchaseHistory);
    }

    // --- NEW ENDPOINT: Send Custom Email ---
    @PostMapping("/send-email")
    @PreAuthorize("hasAnyRole('OWNER', 'MANAGER')")
    public ResponseEntity<Map<String, String>> sendCustomEmail(
            @Valid @RequestBody CustomEmailRequest request,
            @RequestHeader(value = "Accept-Language", defaultValue = "en", required = false) String language) {

        Locale locale = parseLocale(language);
        logger.info("[CUSTOMER CONTROLLER] Received request to send custom email to {} customers", request.getCustomerIds().size());

        // Fire-and-forget async execution (non-blocking)
        new Thread(() -> {
            try {
                customerService.sendCustomEmail(request, locale);
            } catch (Exception e) {
                logger.error("[CUSTOMER CONTROLLER] Error in async email sending", e);
            }
        }).start();

        return ResponseEntity.ok(
                Map.of("message", "Email sending process initiated for " + request.getCustomerIds().size() + " customers.")
        );
    }

    @PostMapping("/reminders")
    @PreAuthorize("hasAnyRole('OWNER', 'MANAGER')")
    public ResponseEntity<Map<String, String>> triggerMonthlyPurchaseReminders(
            @RequestHeader(value = "Accept-Language", defaultValue = "en", required = false) String language) {
        Locale locale = parseLocale(language);
        logger.debug("Triggering monthly purchase reminders manually");
        reminderService.sendMonthlyPurchaseReminders();
        return ResponseEntity.ok(Map.of("message", "Monthly purchase reminders triggered successfully"));
    }

    private Locale parseLocale(String acceptLanguage) {
        if (acceptLanguage == null || acceptLanguage.isEmpty()) {
            return Locale.ENGLISH;
        }
        String primaryLang = acceptLanguage.split(",")[0].split(";")[0].trim();
        String[] parts = primaryLang.split("-");
        if (parts.length == 2) {
            return new Locale(parts[0], parts[1]);
        }
        return new Locale(parts[0]);
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\controller\NotificationController.java
--------------------------------------------------------------------
package com.smartretail.backend.controller;

import com.smartretail.backend.models.Notification;
import com.smartretail.backend.service.NotificationService;
import jakarta.validation.Valid;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@RestController
@RequestMapping("/api/notifications")
public class NotificationController {
    private final NotificationService notificationService;

    public NotificationController(NotificationService notificationService) {
        this.notificationService = notificationService;
    }

    @PostMapping
    public ResponseEntity<Notification> createNotification(@Valid @RequestBody Notification notification) {
        Notification savedNotification = notificationService.createNotification(notification);
        return ResponseEntity.status(201).body(savedNotification);
    }

    @GetMapping
    public ResponseEntity<List<Notification>> getAllNotifications() {
        List<Notification> notifications = notificationService.getAllNotifications();
        return ResponseEntity.ok(notifications);
    }

    @PostMapping("/test")
    @PreAuthorize("hasRole('MANAGER')")
    public ResponseEntity<String> testNotification(
            @RequestParam String email,
            @RequestParam String message
    ) {
        try {
            notificationService.sendEmail(email, "SmartRetail Test Notification", message);
            return new ResponseEntity<>("Test email sent", HttpStatus.OK);
        } catch (Exception e) {
            return new ResponseEntity<>("Failed to send test email: " + e.getMessage(), HttpStatus.INTERNAL_SERVER_ERROR);
        }
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\controller\PaymentController.java
--------------------------------------------------------------------
package com.smartretail.backend.controller;

import com.smartretail.backend.models.Payment;
import com.smartretail.backend.service.PaymentService;
import jakarta.validation.Valid;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@RestController
@RequestMapping("/api/payments")
public class PaymentController {
    private final PaymentService paymentService;

    public PaymentController(PaymentService paymentService) {
        this.paymentService = paymentService;
    }

    @PostMapping
    public ResponseEntity<Payment> createPayment(@Valid @RequestBody Payment payment) {
        Payment savedPayment = paymentService.createPayment(payment);
        return ResponseEntity.status(201).body(savedPayment);
    }

    @GetMapping("/{paymentId}")
    public ResponseEntity<Payment> getPaymentById(@PathVariable String paymentId) {
        Payment payment = paymentService.getPaymentById(paymentId);
        if (payment == null) {
            return ResponseEntity.notFound().build();
        }
        return ResponseEntity.ok(payment);
    }

    @GetMapping
    public ResponseEntity<List<Payment>> getAllPayments() {
        List<Payment> payments = paymentService.getAllPayments();
        return ResponseEntity.ok(payments);
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\controller\ProductController.java
--------------------------------------------------------------------
package com.smartretail.backend.controller;

import com.fasterxml.jackson.databind.ObjectMapper;
import com.opencsv.bean.CsvBindByName;
import com.opencsv.bean.CsvToBeanBuilder;
import com.smartretail.backend.dto.ProductRequest;
import com.smartretail.backend.models.Product;
import com.smartretail.backend.service.FileService;
import com.smartretail.backend.service.ProductService;
import jakarta.validation.Valid;
import lombok.Getter;
import lombok.Setter;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.MessageSource;
import org.springframework.http.HttpStatus;
import org.springframework.http.MediaType;
import org.springframework.http.ResponseEntity;
import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.web.bind.annotation.*;
import org.springframework.web.multipart.MultipartFile;
import org.springframework.http.HttpHeaders;
import org.springframework.core.io.ByteArrayResource;
import org.springframework.core.io.Resource;
import java.util.*;
import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.*;
import java.util.stream.Collectors;

@RestController
@RequestMapping("/api/products")
public class ProductController {

    private static final Logger logger = LoggerFactory.getLogger(ProductController.class);
    private static final SimpleDateFormat DATE_FMT = new SimpleDateFormat("yyyy-MM-dd");
    static { DATE_FMT.setLenient(false); }

    private final ProductService productService;
    private final FileService fileService;
    private final MessageSource messageSource;
    private final ObjectMapper objectMapper = new ObjectMapper();

    @Autowired
    public ProductController(ProductService productService,
                             FileService fileService,
                             MessageSource messageSource) {
        this.productService = productService;
        this.fileService = fileService;
        this.messageSource = messageSource;
    }

    /* -------------------- CREATE -------------------- */
    @PostMapping(consumes = MediaType.APPLICATION_JSON_VALUE)
    @PreAuthorize("hasRole('MANAGER')")
    public ResponseEntity<Map<String, String>> createJson(
            @Valid @RequestBody ProductRequest request,
            @RequestHeader(value = "Accept-Language", defaultValue = "en") String lang) {

        Product product = toEntity(request);
        Product saved = productService.createProduct(product, parseLocale(lang));
        return buildCreatedResponse(saved);
    }

    @PostMapping(consumes = MediaType.MULTIPART_FORM_DATA_VALUE)
    @PreAuthorize("hasRole('MANAGER')")
    public ResponseEntity<Map<String, String>> createMultipart(
            @RequestParam("product") String productJson,
            @RequestPart(value = "imageFile", required = false) MultipartFile imageFile,
            @RequestHeader(value = "Accept-Language", defaultValue = "en") String lang) throws Exception {

        ProductRequest req = objectMapper.readValue(productJson, ProductRequest.class);
        Product product = toEntity(req);
        Product saved = productService.createProduct(product, imageFile, parseLocale(lang));
        return buildCreatedResponse(saved);
    }

    /* -------------------- IMAGE -------------------- */
    @GetMapping("/image/{imageId}")
    public ResponseEntity<Resource> getImage(@PathVariable String imageId) {
        try {
            Map<String, Object> imageData = fileService.getImage(imageId);
            byte[] bytes = (byte[]) imageData.get("bytes");
            String contentType = (String) imageData.get("contentType");

            ByteArrayResource resource = new ByteArrayResource(bytes);

            return ResponseEntity.ok()
                    .header(HttpHeaders.CONTENT_TYPE, contentType)
                    .contentLength(bytes.length)
                    .body(resource);
        } catch (Exception e) {
            logger.error("Failed to retrieve image: {}", imageId, e);
            return ResponseEntity.notFound().build();
        }
    }

    private ResponseEntity<Map<String, String>> buildCreatedResponse(Product p) {
        return ResponseEntity
                .status(HttpStatus.CREATED)
                .body(Map.of("message", "Product added successfully", "productId", p.getProductId()));
    }

    /* -------------------- READ -------------------- */
    @GetMapping("/{productId}")
    public ResponseEntity<Product> get(@PathVariable String productId,
                                       @RequestHeader(value = "Accept-Language", defaultValue = "en") String lang) {
        return ResponseEntity.ok(productService.getProductById(productId, parseLocale(lang)));
    }

    @GetMapping
    public ResponseEntity<List<Product>> list() {
        return ResponseEntity.ok(productService.getAllProducts());
    }

    /* -------------------- UPDATE -------------------- */
    @PutMapping(value = "/{productId}", consumes = MediaType.APPLICATION_JSON_VALUE)
    @PreAuthorize("hasRole('MANAGER')")
    public ResponseEntity<Map<String, String>> patch(
            @PathVariable String productId,
            @RequestBody Map<String, Object> updates,
            @RequestHeader(value = "Accept-Language", defaultValue = "en") String lang) {

        Locale locale = parseLocale(lang);
        Product patch = new Product();

        updates.forEach((k, v) -> {
            try {
                switch (k) {
                    case "name" -> patch.setName(safeString(v));
                    case "category" -> patch.setCategory(safeString(v));
                    case "price" -> patch.setPrice(safeDouble(v));
                    case "quantity" -> patch.setQuantity(safeInt(v));
                    case "minQuantity" -> patch.setMinQuantity(safeInt(v));
                    case "reorderLevel" -> patch.setReorderLevel(safeInt(v));
                    case "expiryDate" -> patch.setExpiryDate(parseDate(safeString(v)));
                    case "imageUrl" -> patch.setImageUrl(safeString(v));
                }
            } catch (Exception ex) {
                throw new IllegalArgumentException("Invalid value for field '" + k + "': " + v);
            }
        });

        Product updated = productService.updateProduct(productId, patch, locale);
        return ResponseEntity.ok(Map.of(
                "message", "Product updated successfully",
                "productId", updated.getProductId()));
    }

    @PutMapping(value = "/{productId}", consumes = MediaType.MULTIPART_FORM_DATA_VALUE)
    @PreAuthorize("hasRole('MANAGER')")
    public ResponseEntity<Map<String, String>> updateMultipart(
            @PathVariable String productId,
            @RequestParam("product") String productJson,
            @RequestPart(value = "imageFile", required = false) MultipartFile imageFile,
            @RequestHeader(value = "Accept-Language", defaultValue = "en") String lang) throws Exception {

        Locale locale = parseLocale(lang);

        // 1. Deserialize the JSON string into a Product object
        ProductRequest req = objectMapper.readValue(productJson, ProductRequest.class);
        Product productPatch = toEntity(req);

        // 2. Call the service method that handles file uploads
        Product updated = productService.updateProduct(productId, productPatch, imageFile, locale);

        // 3. Return the same response as your other methods
        return ResponseEntity.ok(Map.of(
                "message", "Product updated successfully",
                "productId", updated.getProductId()));
    }

    /* -------------------- DELETE -------------------- */
    @DeleteMapping("/{productId}")
    @PreAuthorize("hasRole('MANAGER') or hasRole('OWNER')")
    public ResponseEntity<Map<String, String>> delete(
            @PathVariable String productId,
            @RequestHeader(value = "Accept-Language", defaultValue = "en") String lang) {

        productService.deleteProduct(productId, parseLocale(lang));

        return ResponseEntity.ok(Map.of(
                "message", "Product deleted successfully",
                "productId", productId));
    }

    /* -------------------- BULK CSV -------------------- */
    @PostMapping("/bulk")
    @PreAuthorize("hasRole('MANAGER')")
    public ResponseEntity<Map<String, Object>> bulkUpload(
            @RequestPart("file") MultipartFile file,
            @RequestHeader(value = "Accept-Language", defaultValue = "en") String lang) throws Exception {

        Locale locale = parseLocale(lang);
        validateCsvFile(file, locale);

        List<Product> success = new ArrayList<>();
        List<String> skipped = new ArrayList<>();
        List<String> errors = new ArrayList<>();

        try (BufferedReader r = new BufferedReader(new InputStreamReader(file.getInputStream()))) {
            List<ProductCsvBean> beans = new CsvToBeanBuilder<ProductCsvBean>(r)
                    .withType(ProductCsvBean.class)
                    .withIgnoreLeadingWhiteSpace(true)
                    .build()
                    .parse();

            for (int i = 0; i < beans.size(); i++) {
                ProductCsvBean b = beans.get(i);
                int row = i + 2;
                try {
                    validateCsvRow(b, row, errors);
                    if (productService.existsByProductId(b.getProductId())) {
                        skipped.add("Row " + row + ": Product already exists");
                        continue;
                    }
                    Product p = fromCsvBean(b);
                    success.add(productService.createProduct(p, locale));
                } catch (Exception ex) {
                    errors.add("Row " + row + ": " + ex.getMessage());
                }
            }
        }

        Map<String, Object> result = new LinkedHashMap<>();
        result.put("successful", success.size());
        result.put("skipped", skipped.size());
        result.put("errors", errors.size());
        result.put("successfulProductIds", success.stream().map(Product::getProductId).collect(Collectors.toList()));
        result.put("skippedDetails", skipped);
        result.put("errorDetails", errors);
        return ResponseEntity.status(HttpStatus.CREATED).body(result);
    }

    /* -------------------- HELPERS -------------------- */
    private Locale parseLocale(String header) {
        if (header == null || header.isBlank()) return Locale.ENGLISH;
        String primary = header.split(",")[0].split(";")[0].trim();
        String[] parts = primary.split("-");
        return parts.length == 2 ? new Locale(parts[0], parts[1]) : new Locale(parts[0]);
    }

    private void validateCsvFile(MultipartFile file, Locale locale) {
        if (file == null || file.isEmpty()) {
            throw new IllegalArgumentException(messageSource.getMessage("file.missing", null, locale));
        }
        if (!file.getOriginalFilename().toLowerCase().endsWith(".csv")) {
            throw new IllegalArgumentException(messageSource.getMessage("file.invalid.format", null, locale));
        }
    }

    private void validateCsvRow(ProductCsvBean b, int row, List<String> errors) {
        if (b.getProductId() == null || b.getProductId().isBlank()) {
            errors.add("Row " + row + ": Product ID missing");
        }
        if (b.getName() == null || b.getName().isBlank()) {
            errors.add("Row " + row + ": Product name missing");
        }
    }

    private Product toEntity(ProductRequest r) {
        Product p = new Product();
        p.setProductId(r.getProductId());
        p.setName(r.getName());
        p.setCategory(r.getCategory());
        p.setPrice(r.getPrice());
        p.setQuantity(r.getQuantity());
        p.setMinQuantity(r.getMinQuantity() > 0 ? r.getMinQuantity() : 5);
        p.setReorderLevel(r.getReorderLevel() > 0 ? r.getReorderLevel() : 10);
        p.setSupplierEmail(Optional.ofNullable(r.getSupplierEmail()).orElse("default@supplier.com"));
        p.setAddedBy("system");
        p.setImageUrl(r.getImageUrl());

        if (r.getExpiryDate() != null && !r.getExpiryDate().isBlank()) {
            p.setExpiryDate(parseDate(r.getExpiryDate()));
        }
        return p;
    }

    private Product fromCsvBean(ProductCsvBean b) {
        Product p = new Product();
        p.setProductId(b.getProductId());
        p.setName(b.getName());
        p.setCategory(b.getCategory());
        p.setPrice(b.getPrice());
        p.setQuantity(b.getQuantity());
        p.setMinQuantity(b.getMinQuantity());
        p.setReorderLevel(b.getReorderLevel());
        p.setAddedBy(Optional.ofNullable(b.getAddedBy()).orElse("system"));
        p.setSupplierEmail("default@supplier.com");

        if (b.getExpiryDate() != null && !b.getExpiryDate().isBlank()) {
            p.setExpiryDate(parseDate(b.getExpiryDate()));
        }
        p.setCreatedAt(new Date());
        p.setLastUpdated(new Date());
        return p;
    }

    private Date parseDate(String s) {
        if (s == null || s.isBlank()) return null;
        try {
            return DATE_FMT.parse(s);
        } catch (ParseException e) {
            throw new IllegalArgumentException("Invalid date format, expected yyyy-MM-dd: " + s);
        }
    }

    private String safeString(Object o) { return o == null ? null : o.toString(); }
    private double safeDouble(Object o) { return o == null ? 0.0 : Double.parseDouble(o.toString()); }
    private int safeInt(Object o) { return o == null ? 0 : Integer.parseInt(o.toString()); }

    /* -------------------- CSV BEAN -------------------- */
    @Getter @Setter
    public static class ProductCsvBean {
        @CsvBindByName(required = true) private String productId;
        @CsvBindByName(required = true) private String name;
        @CsvBindByName private String category;
        @CsvBindByName private double price;
        @CsvBindByName private int quantity;
        @CsvBindByName private int minQuantity;
        @CsvBindByName private int reorderLevel;
        @CsvBindByName private String expiryDate;
        @CsvBindByName private String addedBy;
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\controller\PushNotificationController.java
--------------------------------------------------------------------
package com.smartretail.backend.controller;

import com.smartretail.backend.models.PushSubscription;
import com.smartretail.backend.service.PushNotificationService;
import org.springframework.http.ResponseEntity;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.web.bind.annotation.*;

@RestController
@RequestMapping("/api/notifications")
public class PushNotificationController {

    private final PushNotificationService pushNotificationService;

    public PushNotificationController(PushNotificationService pushNotificationService) {
        this.pushNotificationService = pushNotificationService;
    }

    @PostMapping("/subscribe")
    public ResponseEntity<String> subscribe(@RequestBody PushSubscription subscription) {
        Authentication auth = SecurityContextHolder.getContext().getAuthentication();
        String userId = auth.getName(); // Email or userId from JWT
        pushNotificationService.saveSubscription(userId, subscription);
        return ResponseEntity.ok("Subscription saved");
    }

    @GetMapping("/vapid-public-key")
    public ResponseEntity<String> getVapidPublicKey() {
        return ResponseEntity.ok(pushNotificationService.getVapidPublicKey());
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\controller\ReportController.java
--------------------------------------------------------------------
package com.smartretail.backend.controller;

import com.smartretail.backend.dto.FullReportResponse;
import com.smartretail.backend.service.AnalyticsService;
import com.smartretail.backend.service.ReportPdfService;
import com.smartretail.backend.service.ReportService;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.context.MessageSource;
import org.springframework.http.HttpHeaders;
import org.springframework.http.MediaType;
import org.springframework.http.ResponseEntity;
import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.web.bind.annotation.*;

import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.Locale;
import java.util.Map;
import java.util.TimeZone;

@RestController
@RequestMapping("/api/reports")
public class ReportController {
    private static final Logger logger = LoggerFactory.getLogger(ReportController.class);
    private final ReportService reportService;
    private final MessageSource messageSource;
    private final AnalyticsService analyticsService;
    private final ReportPdfService reportPdfService;

    public ReportController(ReportService reportService,
                            MessageSource messageSource,
                            AnalyticsService analyticsService,
                            ReportPdfService reportPdfService) {
        this.reportService = reportService;
        this.messageSource = messageSource;
        this.analyticsService = analyticsService;
        this.reportPdfService = reportPdfService;
    }

    @GetMapping("/sales")
    public ResponseEntity<Map<String, Object>> getSalesReport(
            @RequestParam String startDate,
            @RequestParam String endDate,
            Locale locale) {
        logger.debug("Fetching sales report: startDate={}, endDate={}", startDate, endDate);
        SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd");
        dateFormat.setTimeZone(TimeZone.getTimeZone("UTC")); // Parse dates in UTC
        dateFormat.setLenient(false);
        try {
            Date start = dateFormat.parse(startDate);
            Date end = dateFormat.parse(endDate);
            // Adjust endDate to include the full day
            end = new Date(end.getTime() + 24 * 60 * 60 * 1000 - 1); // End of day
            Map<String, Object> report = reportService.getSalesReport(start, end, locale);
            return ResponseEntity.ok(report);
        } catch (Exception e) {
            logger.error("Invalid date format: startDate={} or endDate={}", startDate, endDate, e);
            throw new IllegalArgumentException(
                    messageSource.getMessage("report.date.invalid", new Object[]{startDate + " or " + endDate}, locale));
        }
    }

    @GetMapping("/inventory")
    public ResponseEntity<Map<String, Object>> getInventoryReport(
            @RequestParam(defaultValue = "10") int lowStockThreshold,
            @RequestParam(defaultValue = "30") int expiryDays,
            Locale locale) {
        logger.debug("Fetching inventory report: lowStockThreshold={}, expiryDays={}", lowStockThreshold, expiryDays);
        Map<String, Object> report = reportService.getInventoryReport(lowStockThreshold, expiryDays, locale);
        return ResponseEntity.ok(report);
    }

    @GetMapping("/full")
    @PreAuthorize("hasAnyRole('OWNER','MANAGER')")
    public ResponseEntity<FullReportResponse> getFullReport(
            @RequestParam String startDate,
            @RequestParam String endDate,
            @RequestParam(defaultValue = "10") int lowStockThreshold,
            @RequestParam(defaultValue = "30") int expiryDays,
            Locale locale) {

        logger.debug("Generating full report: {} to {}", startDate, endDate);
        // Delegate all logic to the service
        FullReportResponse fullReport = reportService.getFullReportData(startDate, endDate, lowStockThreshold, expiryDays, locale);
        return ResponseEntity.ok(fullReport);
    }

    @GetMapping("/full/pdf")
    @PreAuthorize("hasAnyRole('OWNER','MANAGER')")
    public ResponseEntity<byte[]> downloadFullReportPdf(
            @RequestParam String startDate,
            @RequestParam String endDate,
            @RequestParam(defaultValue = "10") int lowStockThreshold,
            @RequestParam(defaultValue = "30") int expiryDays,
            Locale locale) {

        logger.debug("Generating PDF report: {} to {}", startDate, endDate);

        // 1. Get the same data DTO
        FullReportResponse fullReport = reportService.getFullReportData(startDate, endDate, lowStockThreshold, expiryDays, locale);

        // 2. Pass DTO to PDF service
        byte[] pdfBytes = reportPdfService.generateFullReportPdf(fullReport, startDate, endDate, locale);

        // 3. Prepare headers for file download
        HttpHeaders headers = new HttpHeaders();
        headers.setContentType(MediaType.APPLICATION_PDF);
        String filename = String.format("SmartRetail_Report_%s_to_%s.pdf", startDate, endDate);
        headers.setContentDispositionFormData("attachment", filename);
        headers.setCacheControl("must-revalidate, post-check=0, pre-check=0");

        return ResponseEntity.ok()
                .headers(headers)
                .body(pdfBytes);
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\controller\SyncController.java
--------------------------------------------------------------------
package com.smartretail.backend.controller;

import com.smartretail.backend.models.Bill;
import com.smartretail.backend.models.Product;
import com.smartretail.backend.service.BillService;
import com.smartretail.backend.service.ProductService;
import lombok.Setter;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.http.ResponseEntity;
import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.web.bind.annotation.*;

import java.util.ArrayList;
import java.util.List;
import java.util.Locale;
import java.util.Map;

@RestController
@RequestMapping("/api/sync")
public class SyncController {
    private static final Logger logger = LoggerFactory.getLogger(SyncController.class);
    private final BillService billService;
    private final ProductService productService;

    public SyncController(BillService billService, ProductService productService) {
        this.billService = billService;
        this.productService = productService;
    }

    @PostMapping("/pending")
    @PreAuthorize("hasAnyRole('OWNER', 'MANAGER', 'CASHIER')")
    public ResponseEntity<Map<String, Object>> syncPendingData(
            @RequestBody SyncRequest syncRequest,
            @RequestHeader(value = "Accept-Language", defaultValue = "en") Locale locale) {
        logger.debug("[SYNC CONTROLLER] Processing sync request with {} bills and {} inventory updates",
                syncRequest.getBills().size(), syncRequest.getInventoryUpdates().size());

        List<String> processedBillIds = new ArrayList<>();
        List<String> processedProductIds = new ArrayList<>();
        List<String> errors = new ArrayList<>();

        // Process bills
        for (Bill bill : syncRequest.getBills()) {
            try {
                Bill savedBill = billService.createBill(bill, locale, true); // true = sync mode
                processedBillIds.add(savedBill.getBillId());
                logger.info("[SYNC CONTROLLER] Successfully synced bill: {}", savedBill.getBillId());
            } catch (Exception e) {
                logger.error("[SYNC CONTROLLER] Failed to sync bill {}: {}", bill.getBillId(), e.getMessage());
                errors.add("Bill " + bill.getBillId() + ": " + e.getMessage());
            }
        }

        // Process inventory updates
        for (Product product : syncRequest.getInventoryUpdates()) {
            try {
                // Use productId instead of id
                productService.updateProduct(product.getProductId(), product, locale, true); // true = sync mode
                processedProductIds.add(product.getProductId());
                logger.info("[SYNC CONTROLLER] Successfully synced product: {}", product.getProductId());
            } catch (Exception e) {
                logger.error("[SYNC CONTROLLER] Failed to sync product {}: {}", product.getProductId(), e.getMessage());
                errors.add("Product " + product.getProductId() + ": " + e.getMessage());
            }
        }

        Map<String, Object> response = Map.of(
                "processedBills", processedBillIds,
                "processedProducts", processedProductIds,
                "errors", errors,
                "message", errors.isEmpty() ? "Sync completed successfully" : "Sync completed with errors"
        );

        return ResponseEntity.ok(response);
    }

    // DTO for sync request
    @Setter
    public static class SyncRequest {
        private List<Bill> bills;
        private List<Product> inventoryUpdates;

        public List<Bill> getBills() {
            return bills != null ? bills : new ArrayList<>();
        }

        public List<Product> getInventoryUpdates() {
            return inventoryUpdates != null ? inventoryUpdates : new ArrayList<>();
        }
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\controller\UserController.java
--------------------------------------------------------------------
package com.smartretail.backend.controller;

import com.smartretail.backend.dto.SignupRequest;
import com.smartretail.backend.models.User;
import com.smartretail.backend.service.FileService;
import com.smartretail.backend.service.UserService;
import org.springframework.http.ResponseEntity;
import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@RestController
@RequestMapping("/api/users")
public class UserController {

    private final UserService userService;
    private final FileService fileService;

    public UserController(UserService userService, FileService fileService) {
        this.userService = userService;
        this.fileService = fileService;
    }

    @PostMapping
    @PreAuthorize("hasRole('OWNER')")
    public ResponseEntity<User> createUser(@RequestBody SignupRequest request) {
        User createdUser = userService.createUser(request);
        return ResponseEntity.ok(createdUser);
    }

    @GetMapping
    @PreAuthorize("hasRole('OWNER')")
    public ResponseEntity<List<User>> getAllUsers() {
        List<User> users = userService.getAllUsers();
        return ResponseEntity.ok(users);
    }

    @GetMapping("/{id}")
    @PreAuthorize("hasRole('OWNER')")
    public ResponseEntity<User> getUserById(@PathVariable String id) {
        User user = userService.getUserById(id);
        return ResponseEntity.ok(user);
    }

    @DeleteMapping("/{id}")
    @PreAuthorize("hasRole('OWNER')")
    public ResponseEntity<?> deleteUser(@PathVariable String id) {
        userService.deleteUser(id);
        return ResponseEntity.ok().build();
    }
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\dto
--------------------------------------------------------------------
Contents:
CustomEmailRequest.java
FullReportRequest.java
FullReportResponse.java
LoginRequest.java
LoginResponse.java
ProductRequest.java
SignupRequest.java

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\dto\CustomEmailRequest.java
--------------------------------------------------------------------
package com.smartretail.backend.dto;

import jakarta.validation.constraints.NotBlank;
import jakarta.validation.constraints.NotEmpty;
import lombok.Data;

import java.util.List;

@Data
public class CustomEmailRequest {

    @NotEmpty(message = "Customer ID list cannot be empty")
    private List<String> customerIds;

    @NotBlank(message = "Subject cannot be empty")
    private String subject;

    @NotBlank(message = "Body cannot be empty")
    private String body;
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\dto\FullReportRequest.java
--------------------------------------------------------------------
package com.smartretail.backend.dto;

import lombok.Getter;
import lombok.Setter;

@Getter
@Setter
public class FullReportRequest {
    private String startDate;
    private String endDate;
    private int lowStockThreshold = 10;
    private int expiryDays = 30;

    // Default constructor
    public FullReportRequest() {}

    // Getters and setters
    public String getStartDate() {
        return startDate;
    }

    public void setStartDate(String startDate) {
        this.startDate = startDate;
    }

    public String getEndDate() {
        return endDate;
    }

    public void setEndDate(String endDate) {
        this.endDate = endDate;
    }

    public int getLowStockThreshold() {
        return lowStockThreshold;
    }

    public void setLowStockThreshold(int lowStockThreshold) {
        this.lowStockThreshold = lowStockThreshold;
    }

    public int getExpiryDays() {
        return expiryDays;
    }

    public void setExpiryDays(int expiryDays) {
        this.expiryDays = expiryDays;
    }

    @Override
    public String toString() {
        return "FullReportRequest{" +
                "startDate='" + startDate + '\'' +
                ", endDate='" + endDate + '\'' +
                ", lowStockThreshold=" + lowStockThreshold +
                ", expiryDays=" + expiryDays +
                '}';
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\dto\FullReportResponse.java
--------------------------------------------------------------------
package com.smartretail.backend.dto;

import java.util.Map;

public class FullReportResponse {
    private Object salesReport;  // Changed from Map<String, Object> to Object
    private Object textSummary;  // This is what you're using in builder
    private Map<String, Object> inventoryReport;

    // Default constructor
    public FullReportResponse() {}

    // Constructor with all fields
    public FullReportResponse(Object salesReport, Object textSummary, Map<String, Object> inventoryReport) {
        this.salesReport = salesReport;
        this.textSummary = textSummary;
        this.inventoryReport = inventoryReport;
    }

    // Getters and setters
    public Object getSalesReport() {
        return salesReport;
    }

    public void setSalesReport(Object salesReport) {
        this.salesReport = salesReport;
    }

    public Object getTextSummary() {
        return textSummary;
    }

    public void setTextSummary(Object textSummary) {
        this.textSummary = textSummary;
    }

    public Map<String, Object> getInventoryReport() {
        return inventoryReport;
    }

    public void setInventoryReport(Map<String, Object> inventoryReport) {
        this.inventoryReport = inventoryReport;
    }

    // Builder pattern methods
    public static FullReportResponseBuilder builder() {
        return new FullReportResponseBuilder();
    }

    public static class FullReportResponseBuilder {
        private Object salesReport;
        private Object textSummary;
        private Map<String, Object> inventoryReport;

        public FullReportResponseBuilder salesReport(Object salesReport) {
            this.salesReport = salesReport;
            return this;
        }

        public FullReportResponseBuilder textSummary(Object textSummary) {
            this.textSummary = textSummary;
            return this;
        }

        public FullReportResponseBuilder inventoryReport(Map<String, Object> inventoryReport) {
            this.inventoryReport = inventoryReport;
            return this;
        }

        public FullReportResponse build() {
            return new FullReportResponse(salesReport, textSummary, inventoryReport);
        }
    }

    @Override
    public String toString() {
        return "FullReportResponse{" +
                "salesReport=" + salesReport +
                ", textSummary=" + textSummary +
                ", inventoryReport=" + inventoryReport +
                '}';
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\dto\LoginRequest.java
--------------------------------------------------------------------
package com.smartretail.backend.dto;

import jakarta.validation.constraints.Email;
import jakarta.validation.constraints.NotBlank;
import lombok.Getter;
import lombok.Setter;

@Setter
@Getter
public class LoginRequest {
    // Getters and Setters
    @NotBlank
    @Email
    private String email;

    @NotBlank
    private String password;

}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\dto\LoginResponse.java
--------------------------------------------------------------------
package com.smartretail.backend.dto;

import lombok.Getter;
import lombok.Setter;

@Setter
@Getter
public class LoginResponse {
    // Getters and Setters
    private String accessToken;
    private String refreshToken;

    public LoginResponse(String accessToken, String refreshToken) {
        this.accessToken = accessToken;
        this.refreshToken = refreshToken;
    }

}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\dto\ProductRequest.java
--------------------------------------------------------------------
package com.smartretail.backend.dto;

import jakarta.validation.constraints.NotBlank;
import jakarta.validation.constraints.Positive;
import jakarta.validation.constraints.Size;
import lombok.Data;
import lombok.NoArgsConstructor;
import lombok.AllArgsConstructor;

@Data
@NoArgsConstructor
@AllArgsConstructor
public class ProductRequest {
    private String productId;

    @NotBlank(message = "Name is required")
    private String name;

    private String category;

    @Positive(message = "Price must be positive")
    private double price;

    @Positive(message = "Quantity must be positive")
    private int quantity;

    private String expiryDate;
    private String imageUrl;
    private String supplierEmail;

    // Optional fields with defaults
    private int minQuantity = 5;
    private int reorderLevel = 10;
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\dto\SignupRequest.java
--------------------------------------------------------------------
package com.smartretail.backend.dto;

import jakarta.validation.constraints.Email;
import jakarta.validation.constraints.NotBlank;
import lombok.Getter;
import lombok.Setter;

@Setter
@Getter
public class SignupRequest {
    // Getters and Setters
    @NotBlank
    private String name;

    @NotBlank
    @Email
    private String email;

    @NotBlank
    private String password;

    @NotBlank
    private String role;

}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\exception
--------------------------------------------------------------------
Contents:
DuplicateMobileException.java
DuplicateResourceException.java
ProductNotFoundException.java
ResourceNotFoundException.java

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\exception\DuplicateMobileException.java
--------------------------------------------------------------------
package com.smartretail.backend.exception;

import lombok.Getter;

@Getter
public class DuplicateMobileException extends RuntimeException {
    private final String mobile;

    public DuplicateMobileException(String mobile) {
        super("Mobile already exists: " + mobile); // parent message bhi set ho gaya
        this.mobile = mobile;
    }

}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\exception\DuplicateResourceException.java
--------------------------------------------------------------------
package com.smartretail.backend.exception;

public class DuplicateResourceException extends RuntimeException {
    private final String messageKey;
    private final String resourceId;

    public DuplicateResourceException(String messageKey, String resourceId) {
        super("Duplicate resource: " + resourceId);
        this.messageKey = messageKey;
        this.resourceId = resourceId;
    }

    public String getMessageKey() { return messageKey; }
    public String getResourceId() { return resourceId; }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\exception\ProductNotFoundException.java
--------------------------------------------------------------------
package com.smartretail.backend.exception;

public class ProductNotFoundException extends RuntimeException {
    private final String productId;

    public ProductNotFoundException(String productId) {
        super(productId);
        this.productId = productId;
    }

    public String getProductId() {
        return productId;
    }
}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\exception\ResourceNotFoundException.java
--------------------------------------------------------------------
package com.smartretail.backend.exception;

public class ResourceNotFoundException extends RuntimeException {
    private final String messageKey;
    private final String resourceId;

    public ResourceNotFoundException(String messageKey, String resourceId) {
        super("Resource not found: " + resourceId);
        this.messageKey = messageKey;
        this.resourceId = resourceId;
    }

    public String getMessageKey() { return messageKey; }
    public String getResourceId() { return resourceId; }
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\models
--------------------------------------------------------------------
Contents:
AuditLog.java
Bill.java
Customer.java
Notification.java
Payment.java
Product.java
PushSubscription.java
RefreshToken.java
User.java

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\models\AuditLog.java
--------------------------------------------------------------------
package com.smartretail.backend.models;

import lombok.Getter;
import lombok.Setter;
import org.springframework.data.annotation.Id;
import org.springframework.data.mongodb.core.mapping.Document;

import java.util.Date;
import java.util.Map;

@Setter
@Getter
@Document(collection = "auditLogs")
public class AuditLog {
    // Getters and Setters
    @Id
    private String id;
    private String actionType;
    private String entityId;
    private String userEmail;
    private Date timestamp;
    private Map<String, Object> details;

    // Constructors
    public AuditLog() {}

    public AuditLog(String actionType, String entityId, String userEmail, Date timestamp, Map<String, Object> details) {
        this.actionType = actionType;
        this.entityId = entityId;
        this.userEmail = userEmail;
        this.timestamp = timestamp;
        this.details = details;
    }

}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\models\Bill.java
--------------------------------------------------------------------
package com.smartretail.backend.models;

import lombok.Getter;
import lombok.Setter;
import org.springframework.data.annotation.Id;
import org.springframework.data.mongodb.core.mapping.Document;

import java.util.Date;
import java.util.List;
import java.util.UUID;

@Setter
@Getter
@Document(collection = "bills")
public class Bill {

    @Id
    private String billId;
    private CustomerInfo customer;
    private List<BillItem> items;
    private double totalAmount;
    private Date createdAt;
    private String pdfAccessToken;
    private String addedBy;

    public Bill() {
        ensureDefaults();
    }

    public Bill(String billId, List<BillItem> items, String addedBy) {
        ensureDefaults();
        this.billId = billId;
        this.items = items;
        this.addedBy = addedBy;
        this.totalAmount = calculateTotal();
    }

    public Bill(String billId, CustomerInfo customer, List<BillItem> items,
                double totalAmount, String addedBy) {
        this(billId, items, addedBy);
        this.customer = customer;
        this.totalAmount = totalAmount;
    }

    // ✅ Ensure defaults are set every time (constructor OR deserialization)
    private void ensureDefaults() {
        if (this.createdAt == null)
            this.createdAt = new Date();
        if (this.pdfAccessToken == null || this.pdfAccessToken.isEmpty())
            this.pdfAccessToken = UUID.randomUUID().toString();
    }

    @Setter
    @Getter
    public static class BillItem {
        private String productId;
        private String productName;
        private int qty;
        private double price;

        public BillItem() {}

        public BillItem(String productId, String productName, int qty, double price) {
            this.productId = productId;
            this.productName = productName;
            this.qty = qty;
            this.price = price;
        }

        public double getItemTotal() {
            return this.qty * this.price;
        }
    }

    @Setter
    @Getter
    public static class CustomerInfo {
        private String name;
        private String email;
        private String mobile;

        public CustomerInfo() {}

        public CustomerInfo(String name, String email, String mobile) {
            this.name = name;
            this.email = email;
            this.mobile = mobile;
        }

        public boolean isValid() {
            return this.mobile != null && !this.mobile.trim().isEmpty();
        }
    }

    public boolean isValid() {
        return this.billId != null &&
                !this.billId.trim().isEmpty() &&
                this.items != null &&
                !this.items.isEmpty() &&
                this.addedBy != null &&
                !this.addedBy.trim().isEmpty();
    }

    public double calculateTotal() {
        if (this.items == null || this.items.isEmpty()) {
            return 0.0;
        }
        return this.items.stream()
                .mapToDouble(BillItem::getItemTotal)
                .sum();
    }

    // ✅ Automatically recalculate when items are updated
    public void setItems(List<BillItem> items) {
        this.items = items;
        this.totalAmount = calculateTotal();
    }
}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\models\Customer.java
--------------------------------------------------------------------
package com.smartretail.backend.models;

import lombok.Getter;
import lombok.Setter;
import org.springframework.data.annotation.Id;
import org.springframework.data.mongodb.core.mapping.Document;

import java.util.ArrayList;
import java.util.Date;
import java.util.List;

@Setter
@Getter
@Document(collection = "customers")
public class Customer {
    // Getters and Setters
    @Id
    private String id;
    private String name;
    private String email;
    private String mobile;
    private Date createdAt;
    private List<String> purchaseHistory;
    private int totalPurchaseCount;
    private Date lastPurchaseDate;

    public Customer() {
        this.purchaseHistory = new ArrayList<>();
        this.createdAt = new Date();
        this.totalPurchaseCount = 0;
        this.lastPurchaseDate = null;
    }

    public Customer(String name, String email, String mobile) {
        this.name = name;
        this.email = email;
        this.mobile = mobile;
        this.createdAt = new Date();
        this.purchaseHistory = new ArrayList<>();
        this.totalPurchaseCount = 0;
        this.lastPurchaseDate = null;
    }

    public void addBillId(String billId) {
        if (this.purchaseHistory == null) {
            this.purchaseHistory = new ArrayList<>();
        }
        this.purchaseHistory.add(billId);
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\models\Notification.java
--------------------------------------------------------------------
package com.smartretail.backend.models;

import lombok.Getter;
import lombok.Setter;
import org.springframework.data.annotation.Id;
import org.springframework.data.mongodb.core.mapping.Document;

import java.util.Date;

@Setter
@Getter
@Document(collection = "notifications")
public class Notification {
    @Id
    private String id;
    private String to;
    private String subject;
    private String message;
    private Date sentAt;

    public Notification() {
    }

    public Notification(String to, String subject, String message, Date sentAt) {
        this.to = to;
        this.subject = subject;
        this.message = message;
        this.sentAt = sentAt;
    }

}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\models\Payment.java
--------------------------------------------------------------------
package com.smartretail.backend.models;

import lombok.Data;
import org.springframework.data.annotation.Id;
import org.springframework.data.mongodb.core.index.Indexed;
import org.springframework.data.mongodb.core.mapping.Document;
import org.springframework.data.mongodb.core.mapping.Field;

import java.util.Date;

@Data
@Document(collection = "payments")
public class Payment {
    @Id
    private String id; // Maps to _id
    @Indexed(unique = true)
    private String paymentId; // e.g., "pay_2508171011"
    @Field("billId")
    private String billId; // References bills._id
    private double amount;
    private String paymentMode; // "CASH", "UPI"
    private String status; // "INITIATED", "SUCCESS", "FAILED"
    private String upiTransactionId; // Nullable
    private Date createdAt;
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\models\Product.java
--------------------------------------------------------------------
package com.smartretail.backend.models;

import jakarta.validation.constraints.NotBlank;
import lombok.Getter;
import lombok.Setter;
import org.springframework.data.annotation.Id;
import org.springframework.data.mongodb.core.index.Indexed;
import org.springframework.data.mongodb.core.mapping.Document;

import java.util.Date;

@Getter
@Setter
@Document(collection = "products")
public class Product {

    @Id
    private String id;                         // MongoDB _id

    @NotBlank(message = "Product ID is required")
    @Indexed(unique = true)
    private String productId;                  // custom business ID

    @NotBlank(message = "Product name is required")
    private String name;

    private String category;
    private double price;
    private int quantity;
    private int minQuantity;                   // minimum stock before alert
    private int reorderLevel;
    private Date expiryDate;
    private String imageId;                    // GridFS file id
    private String imageUrl;                   // public URL
    private String supplierEmail;
    private String addedBy;
    private Date lastUpdated;
    private Date createdAt;

    public Product() {
        this.createdAt = new Date();
        this.lastUpdated = new Date();
    }

    public Product(String productId, String name, String category, double price, int quantity,
                   int minQuantity, int reorderLevel, Date expiryDate, String imageId,
                   String imageUrl, String supplierEmail, String addedBy) {
        this.productId = productId;
        this.name = name;
        this.category = category;
        this.price = price;
        this.quantity = quantity;
        this.minQuantity = minQuantity;
        this.reorderLevel = reorderLevel;
        this.expiryDate = expiryDate;
        this.imageId = imageId;
        this.imageUrl = imageUrl;
        this.supplierEmail = supplierEmail;
        this.addedBy = addedBy;
        this.createdAt = new Date();
        this.lastUpdated = new Date();
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\models\PushSubscription.java
--------------------------------------------------------------------
package com.smartretail.backend.models;

import lombok.Getter;
import lombok.Setter;
import org.springframework.data.annotation.Id;
import org.springframework.data.mongodb.core.mapping.Document;

@Setter
@Getter
@Document(collection = "push_subscriptions")
public class PushSubscription {
    // Getters and Setters
    @Id
    private String id;
    private String userId; // Linked to User
    private String endpoint;
    private String p256dh;
    private String auth;

    // Constructors
    public PushSubscription() {}

    public PushSubscription(String userId, String endpoint, String p256dh, String auth) {
        this.userId = userId;
        this.endpoint = endpoint;
        this.p256dh = p256dh;
        this.auth = auth;
    }

}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\models\RefreshToken.java
--------------------------------------------------------------------
package com.smartretail.backend.models;

import lombok.Getter;
import lombok.Setter;
import org.springframework.data.annotation.Id;
import org.springframework.data.mongodb.core.mapping.Document;

import java.util.Date;

@Setter
@Getter
@Document(collection = "refresh_tokens")
public class RefreshToken {
    // Getters and Setters
    @Id
    private String id;
    private String userId;
    private String token;
    private Date expiryDate;

    // Constructors
    public RefreshToken() {}

    public RefreshToken(String userId, String token, Date expiryDate) {
        this.userId = userId;
        this.token = token;
        this.expiryDate = expiryDate;
    }

}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\models\User.java
--------------------------------------------------------------------
package com.smartretail.backend.models;

import lombok.Data;
import org.springframework.data.annotation.Id;
import org.springframework.data.mongodb.core.index.Indexed;
import org.springframework.data.mongodb.core.mapping.Document;

import java.util.Date;

@Data
@Document(collection = "users")
public class User {
    @Id
    private String id; // Maps to _id (MongoDB-generated ObjectId stored as String)
    private String userId; // Custom unique ID (e.g., "u101")
    @Indexed(unique = true)
    private String email; // Unique email
    private String name;
    private String password; // Hashed password
    private String role; // "OWNER", "MANAGER", "CASHIER"
    private Date createdAt;
    private Date lastLogin;

    public User(String userId, String email, String password, String name, String role) {
        this.userId = userId;
        this.email = email;
        this.password = password;
        this.name = name;
        this.role = role;
        this.createdAt = new Date();
        this.lastLogin = null;
    }

    public User() {

    }
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\repository
--------------------------------------------------------------------
Contents:
AuditLogRepository.java
BillRepository.java
CustomerRepository.java
NotificationRepository.java
PaymentRepository.java
ProductRepository.java
PushSubscriptionRepository.java
RefreshTokenRepository.java
UserRepository.java

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\repository\AuditLogRepository.java
--------------------------------------------------------------------
package com.smartretail.backend.repository;

import com.smartretail.backend.models.AuditLog;
import org.springframework.data.mongodb.repository.MongoRepository;

public interface AuditLogRepository extends MongoRepository<AuditLog, String> {
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\repository\BillRepository.java
--------------------------------------------------------------------
package com.smartretail.backend.repository;

import com.smartretail.backend.models.Bill;
import org.springframework.data.mongodb.repository.MongoRepository;

import java.util.Date;
import java.util.List;
import java.util.Optional;

public interface BillRepository extends MongoRepository<Bill, String> {
    Optional<Bill> findByBillId(String billId);
    boolean existsByBillId(String billId);
    List<Bill> findByCreatedAtBetween(Date startDate, Date endDate); // Added missing method
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\repository\CustomerRepository.java
--------------------------------------------------------------------
package com.smartretail.backend.repository;

import com.smartretail.backend.models.Customer;
import org.springframework.data.mongodb.repository.MongoRepository;
import java.util.Date; // **<-- ADD IMPORT**
import java.util.List; // **<-- ADD IMPORT**
import java.util.Optional;

public interface CustomerRepository extends MongoRepository<Customer, String> {
    Optional<Customer> findByMobile(String mobile);
    boolean existsByMobile(String mobile);

    // **--- ADD THIS NEW METHOD ---**
    List<Customer> findByLastPurchaseDateBeforeOrLastPurchaseDateIsNull(Date thresholdDate);
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\repository\NotificationRepository.java
--------------------------------------------------------------------
package com.smartretail.backend.repository;

import com.smartretail.backend.models.Notification;
import org.springframework.data.mongodb.repository.MongoRepository;

public interface NotificationRepository extends MongoRepository<Notification, String> {
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\repository\PaymentRepository.java
--------------------------------------------------------------------
package com.smartretail.backend.repository;

import com.smartretail.backend.models.Payment;
import org.springframework.data.mongodb.repository.MongoRepository;
import java.util.Optional;

public interface PaymentRepository extends MongoRepository<Payment, String> {
    Optional<Payment> findByPaymentId(String paymentId);
    boolean existsByPaymentId(String paymentId);
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\repository\ProductRepository.java
--------------------------------------------------------------------
package com.smartretail.backend.repository;

import com.smartretail.backend.models.Product;
import org.springframework.data.mongodb.repository.MongoRepository;
import org.springframework.data.mongodb.repository.Query;

import java.util.Date;
import java.util.List;
import java.util.Optional;

public interface ProductRepository extends MongoRepository<Product, String> {
    Optional<Product> findByProductId(String productId);
    boolean existsByProductId(String productId);
    List<Product> findByExpiryDateBefore(Date threshold);
    @Query("{ $expr: { $lt: ['$quantity', '$reorderLevel'] } }")
    List<Product> findLowStockProducts();
    @Query(value = "{ 'productId' : ?0 }", delete = true)
    void deleteByProductId(String productId);
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\repository\PushSubscriptionRepository.java
--------------------------------------------------------------------
package com.smartretail.backend.repository;

import com.smartretail.backend.models.PushSubscription;
import org.springframework.data.mongodb.repository.MongoRepository;

import java.util.Optional;

public interface PushSubscriptionRepository extends MongoRepository<PushSubscription, String> {
    Optional<PushSubscription> findByUserId(String userId);
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\repository\RefreshTokenRepository.java
--------------------------------------------------------------------
package com.smartretail.backend.repository;

import com.smartretail.backend.models.RefreshToken;
import org.springframework.data.mongodb.repository.MongoRepository;

import java.util.Optional;

public interface RefreshTokenRepository extends MongoRepository<RefreshToken, String> {
    Optional<RefreshToken> findByToken(String token);
    void deleteByUserId(String userId);
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\repository\UserRepository.java
--------------------------------------------------------------------
package com.smartretail.backend.repository;

import com.smartretail.backend.models.User;
import org.springframework.data.mongodb.repository.MongoRepository;
import java.util.Optional;

public interface UserRepository extends MongoRepository<User, String> {
    Optional<User> findByEmail(String email);
    boolean existsByEmail(String email);
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\security
--------------------------------------------------------------------
Contents:
CustomAccessDeniedHandler.java
CustomOAuth2AuthenticationSuccessHandler.java
JwtAuthenticationFilter.java
JwtUtil.java

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\security\CustomAccessDeniedHandler.java
--------------------------------------------------------------------
package com.smartretail.backend.security;

import com.fasterxml.jackson.databind.ObjectMapper;
import org.springframework.security.access.AccessDeniedException;
import org.springframework.security.web.access.AccessDeniedHandler;
import org.springframework.stereotype.Component;

import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import java.io.IOException;
import java.util.HashMap;
import java.util.Map;

@Component
public class CustomAccessDeniedHandler implements AccessDeniedHandler {

    @Override
    public void handle(HttpServletRequest request,
                       HttpServletResponse response,
                       AccessDeniedException accessDeniedException) throws IOException {

        response.setContentType("application/json");
        response.setStatus(HttpServletResponse.SC_FORBIDDEN);

        Map<String, Object> body = new HashMap<>();
        body.put("error", "Access Denied");
        body.put("message", accessDeniedException.getMessage());
        body.put("path", request.getRequestURI());

        new ObjectMapper().writeValue(response.getOutputStream(), body);
    }
}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\security\CustomOAuth2AuthenticationSuccessHandler.java
--------------------------------------------------------------------
package com.smartretail.backend.security;

import com.smartretail.backend.dto.LoginResponse;
import com.smartretail.backend.service.AuthService;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.security.core.Authentication;
import org.springframework.security.oauth2.core.user.DefaultOAuth2User;
import org.springframework.security.web.authentication.AuthenticationSuccessHandler;
import org.springframework.stereotype.Component;
import org.springframework.web.util.UriComponentsBuilder;

import java.io.IOException;

@Component
public class CustomOAuth2AuthenticationSuccessHandler implements AuthenticationSuccessHandler {

    @Autowired
    private AuthService authService;

    @Value("${frontend.base.url:http://localhost:5173}")
    private String frontendBaseUrl;

    @Override
    public void onAuthenticationSuccess(HttpServletRequest request,
                                          HttpServletResponse response,
                                          Authentication authentication) throws IOException {

        DefaultOAuth2User oauthUser = (DefaultOAuth2User) authentication.getPrincipal();
        String email = oauthUser.getAttribute("email");
        String name = oauthUser.getAttribute("name");

        // Use AuthService to find/create user and generate our custom JWTs
        LoginResponse loginResponse = authService.processOAuth2Login(email, name);

        // Redirect to frontend with tokens in URL parameters
        String redirectUrl = UriComponentsBuilder.fromUriString(frontendBaseUrl + "/login/success")
                .queryParam("token", loginResponse.getAccessToken())
                .queryParam("refreshToken", loginResponse.getRefreshToken())
                .build().toUriString();
        
        response.sendRedirect(redirectUrl);
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\security\JwtAuthenticationFilter.java
--------------------------------------------------------------------
package com.smartretail.backend.security;

import com.smartretail.backend.models.User;
import com.smartretail.backend.service.AuthService;
import io.jsonwebtoken.Claims;
import jakarta.servlet.FilterChain;
import jakarta.servlet.ServletException;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;
import org.springframework.security.core.authority.SimpleGrantedAuthority;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.security.web.authentication.WebAuthenticationDetailsSource;
import org.springframework.stereotype.Component;
import org.springframework.web.filter.OncePerRequestFilter;

import java.io.IOException;
import java.util.Collections;
import java.util.Optional;

@Component
public class JwtAuthenticationFilter extends OncePerRequestFilter {

    private static final Logger logger = LoggerFactory.getLogger(JwtAuthenticationFilter.class);
    private final JwtUtil jwtUtil;
    private final AuthService authService;

    public JwtAuthenticationFilter(JwtUtil jwtUtil, AuthService authService) {
        this.jwtUtil = jwtUtil;
        this.authService = authService;
    }

    @Override
    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain)
            throws ServletException, IOException {
        String authHeader = request.getHeader("Authorization");
        String jwt = null;
        String email = null;

        if (authHeader != null && authHeader.startsWith("Bearer ")) {
            jwt = authHeader.substring(7);
            try {
                Claims claims = jwtUtil.validateToken(jwt);
                email = claims.getSubject();
                logger.debug("[JWT] Extracted email from token: {}", email);
            } catch (Exception e) {
                logger.error("[JWT] Token validation failed: {}", e.getMessage());
            }
        } else {
            logger.debug("[JWT] No Bearer token found in Authorization header");
        }

        if (email != null && SecurityContextHolder.getContext().getAuthentication() == null) {
            Optional<User> optionalUser = Optional.ofNullable(authService.getUserByEmail(email));
            if (optionalUser.isPresent()) {
                User user = optionalUser.get();

                // FIX: Use getRole() instead of getRoles()
                String role = user.getRole();
                String springRole = "ROLE_" + role;

                var authorities = Collections.singletonList(
                        new SimpleGrantedAuthority(springRole)
                );

                UsernamePasswordAuthenticationToken authToken = new UsernamePasswordAuthenticationToken(
                        user, // Pass the full User object as principal
                        null,
                        authorities
                );
                authToken.setDetails(new WebAuthenticationDetailsSource().buildDetails(request));
                SecurityContextHolder.getContext().setAuthentication(authToken);
                logger.info("[JWT] Authentication set for user: {} with role: {}", email, springRole);
            } else {
                logger.warn("[JWT] User not found for email: {}", email);
            }
        }

        filterChain.doFilter(request, response);
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\security\JwtUtil.java
--------------------------------------------------------------------
package com.smartretail.backend.security;

import io.jsonwebtoken.Claims;
import io.jsonwebtoken.Jwts;
import io.jsonwebtoken.SignatureAlgorithm;
import io.jsonwebtoken.security.Keys;
import lombok.Getter;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Component;

import java.nio.charset.StandardCharsets;
import java.security.Key;
import java.util.Base64;
import java.util.Date;

@Component
public class JwtUtil {

    @Value("${jwt.secret}")
    private String secret;

    // 👉 Add this getter
    @Getter
    @Value("${jwt.expiration}")
    private long expiration;

    private Key getSigningKey() {
        // secret ko direct UTF-8 bytes lo (Base64 mat use karo)
        byte[] keyBytes = secret.getBytes(StandardCharsets.UTF_8);
        return Keys.hmacShaKeyFor(keyBytes);
    }

    public String generateToken(String email, String role) {
        return Jwts.builder()
                .setSubject(email)
                .claim("role", role)
                .setIssuedAt(new Date())
                .setExpiration(new Date(System.currentTimeMillis() + expiration))
                .signWith(getSigningKey(), SignatureAlgorithm.HS512)
                .compact();
    }

    public String generateRefreshToken(String email) {
        return Jwts.builder()
                .setSubject(email)
                .setIssuedAt(new Date())
                .setExpiration(new Date(System.currentTimeMillis() + expiration * 2)) // 2x expiry
                .signWith(getSigningKey(), SignatureAlgorithm.HS512)
                .compact();
    }

    public Claims validateToken(String token) {
        return Jwts.parserBuilder()
                .setSigningKey(getSigningKey())
                .build()
                .parseClaimsJws(token)
                .getBody();
    }

    public boolean isTokenExpired(Claims claims) {
        return claims.getExpiration().before(new Date());
    }

}

--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service
--------------------------------------------------------------------
Contents:
AnalyticsProxyService.java
AnalyticsService.java
AuditLogService.java
AuditLogServiceImpl.java
AuthService.java
AuthServiceImpl.java
BillService.java
BillServiceImpl.java
CustomerService.java
CustomerServiceImpl.java
FileService.java
FileServiceImpl.java
NotificationService.java
NotificationServiceImpl.java
PaymentService.java
PaymentServiceImpl.java
PdfService.java
PdfServiceImpl.java
ProductService.java
ProductServiceImpl.java
PushNotificationService.java
ReminderService.java
ReportPdfService.java
ReportPdfServiceImpl.java
ReportService.java
ReportServiceImpl.java
SyncService.java
UserService.java
UserServiceImpl.java

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\AnalyticsProxyService.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.http.ResponseEntity;
import org.springframework.stereotype.Service;
import org.springframework.web.client.RestTemplate;

@Service
public class AnalyticsProxyService {

    private final RestTemplate restTemplate;
    @Value("${flask.base.url}")
    private String flaskBaseUrl;

    public AnalyticsProxyService(RestTemplate restTemplate) {
        this.restTemplate = restTemplate;
    }

    public Object getFromFlask(String path) {
        String url = flaskBaseUrl + path;
        return restTemplate.getForObject(url, Object.class);
    }

    public byte[] getPdfFromFlask(String path) {
        String url = flaskBaseUrl + path;
        ResponseEntity<byte[]> response = restTemplate.getForEntity(url, byte[].class);
        return response.getBody();
    }
}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\AnalyticsService.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Service;
import org.springframework.web.client.RestTemplate;
import org.springframework.web.util.UriComponentsBuilder;

// --- NEW IMPORTS ---
import org.springframework.context.i18n.LocaleContextHolder;
import java.util.Locale;
import org.springframework.http.HttpHeaders;
import org.springframework.http.HttpEntity;
import org.springframework.http.HttpMethod;
import org.springframework.http.ResponseEntity;
// --- END NEW IMPORTS ---

@Service
public class AnalyticsService {
    private final RestTemplate restTemplate;

    @Value("${flask.base.url:http://localhost:5001}")
    private String flaskBaseUrl;

    public AnalyticsService(RestTemplate restTemplate) {
        this.restTemplate = restTemplate;
    }

    // --- MODIFIED METHOD ---
    public Object getReport(String startDate, String endDate) {
        String url = flaskBaseUrl + "/analytics/report";
        return getFromFlask(url, startDate, endDate);
    }

    // --- MODIFIED METHOD ---
    public Object getTextReport(String startDate, String endDate) {
        String url = flaskBaseUrl + "/analytics/report/text";
        return getFromFlask(url, startDate, endDate);
    }

    // --- NEW HELPER METHOD ---
    private Object getFromFlask(String url, String startDate, String endDate) {
        // 1. Get the locale from the current request
        Locale locale = LocaleContextHolder.getLocale();

        // 2. Build the URL with query params
        UriComponentsBuilder builder = UriComponentsBuilder.fromHttpUrl(url);
        if (startDate != null) builder.queryParam("startDate", startDate);
        if (endDate != null) builder.queryParam("endDate", endDate);

        // 3. Create headers and set the language
        HttpHeaders headers = new HttpHeaders();
        headers.set("Accept-Language", locale.toLanguageTag());

        // 4. Create an HttpEntity with the headers
        HttpEntity<String> entity = new HttpEntity<>(headers);

        // 5. Use restTemplate.exchange to send the request with headers
        ResponseEntity<Object> response = restTemplate.exchange(
                builder.toUriString(),
                HttpMethod.GET,
                entity,
                Object.class
        );

        return response.getBody();
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\AuditLogService.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.models.AuditLog;
import org.springframework.data.domain.Page;
import org.springframework.data.domain.Pageable;

import java.util.Date;
import java.util.Map;

public interface AuditLogService {
    void logAction(String actionType, String entityId, String userEmail, Map<String, Object> details);
    Page<AuditLog> getAuditLogs(String actionType, Date startDate, Date endDate, Pageable pageable);
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\AuditLogServiceImpl.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.models.AuditLog;
import com.smartretail.backend.repository.AuditLogRepository;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.data.domain.Page;
import org.springframework.data.domain.Pageable;
import org.springframework.data.mongodb.core.MongoTemplate;
import org.springframework.data.mongodb.core.query.Criteria;
import org.springframework.data.mongodb.core.query.Query;
import org.springframework.data.support.PageableExecutionUtils;
import org.springframework.stereotype.Service;

import java.util.Date;
import java.util.Map;

@Service
public class AuditLogServiceImpl implements AuditLogService {
    private static final Logger logger = LoggerFactory.getLogger(AuditLogServiceImpl.class);
    private final AuditLogRepository auditLogRepository;
    private final MongoTemplate mongoTemplate;

    public AuditLogServiceImpl(AuditLogRepository auditLogRepository, MongoTemplate mongoTemplate) {
        this.auditLogRepository = auditLogRepository;
        this.mongoTemplate = mongoTemplate;
    }

    @Override
    public void logAction(String actionType, String entityId, String userEmail, Map<String, Object> details) {
        logger.debug("[SERVICE] Logging action: type={}, entityId={}, userEmail={}", actionType, entityId, userEmail);
        AuditLog auditLog = new AuditLog(actionType, entityId, userEmail, new Date(), details);
        auditLogRepository.save(auditLog);
        logger.info("[SERVICE] Audit log saved: type={}, entityId={}", actionType, entityId);
    }

    @Override
    public Page<AuditLog> getAuditLogs(String actionType, Date startDate, Date endDate, Pageable pageable) {
        logger.debug("[SERVICE] Fetching audit logs: actionType={}, startDate={}, endDate={}, page={}, size={}",
                actionType, startDate, endDate, pageable.getPageNumber(), pageable.getPageSize());

        Query query = new Query();
        if (actionType != null && !actionType.isEmpty()) {
            query.addCriteria(Criteria.where("actionType").is(actionType));
        }
        if (startDate != null && endDate != null) {
            query.addCriteria(Criteria.where("timestamp").gte(startDate).lte(endDate));
        }
        query.with(pageable);

        long total = mongoTemplate.count(Query.of(query).limit(-1).skip(-1), AuditLog.class);
        return PageableExecutionUtils.getPage(mongoTemplate.find(query, AuditLog.class), pageable, () -> total);
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\AuthService.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.dto.LoginRequest;
import com.smartretail.backend.dto.LoginResponse;
import com.smartretail.backend.dto.SignupRequest;
import com.smartretail.backend.models.User;

public interface AuthService {
    User signup(SignupRequest request);
    LoginResponse login(LoginRequest request);
    User getUserByEmail(String email);
    String refreshToken(String refreshToken);

    // --- ADD THIS NEW METHOD ---
    LoginResponse processOAuth2Login(String email, String name);
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\AuthServiceImpl.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.dto.LoginRequest;
import com.smartretail.backend.dto.LoginResponse;
import com.smartretail.backend.dto.SignupRequest;
import com.smartretail.backend.models.RefreshToken;
import com.smartretail.backend.models.User;
import com.smartretail.backend.repository.RefreshTokenRepository;
import com.smartretail.backend.repository.UserRepository;
import com.smartretail.backend.security.JwtUtil;
// --- IMPORT THE INTERFACE ---
import org.springframework.security.crypto.password.PasswordEncoder; 
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import java.util.Optional;

import java.util.Date;

@Service
public class AuthServiceImpl implements AuthService {

    private final UserRepository userRepository;
    private final RefreshTokenRepository refreshTokenRepository;
    private final JwtUtil jwtUtil;
    // --- USE THE INTERFACE ---
    private final PasswordEncoder passwordEncoder; 
    private static final Logger logger = LoggerFactory.getLogger(AuthServiceImpl.class);

    // --- UPDATE THE CONSTRUCTOR ---
    public AuthServiceImpl(UserRepository userRepository,
                           RefreshTokenRepository refreshTokenRepository,
                           JwtUtil jwtUtil,
                           PasswordEncoder passwordEncoder) { // <-- INJECT IT HERE
        this.userRepository = userRepository;
        this.refreshTokenRepository = refreshTokenRepository;
        this.jwtUtil = jwtUtil;
        this.passwordEncoder = passwordEncoder; // <-- ASSIGN THE INJECTED BEAN
    }

    @Override
    public User signup(SignupRequest request) {
        if (userRepository.findByEmail(request.getEmail()).isPresent()) {
            throw new RuntimeException("User already exists: " + request.getEmail());
        }
        User user = new User();
        user.setEmail(request.getEmail());
        user.setName(request.getName());
        user.setRole(request.getRole());
        user.setPassword(passwordEncoder.encode(request.getPassword())); // Now uses the correct bean
        return userRepository.save(user);
    }

    @Override
    public LoginResponse login(LoginRequest request) {
        User user = userRepository.findByEmail(request.getEmail())
                .orElseThrow(() -> new RuntimeException("User not found: " + request.getEmail()));

        // This check will now work
        if (!passwordEncoder.matches(request.getPassword(), user.getPassword())) {
            throw new RuntimeException("Invalid password");
        }

        String accessToken = jwtUtil.generateToken(user.getEmail(), user.getRole());
        String refreshToken = jwtUtil.generateRefreshToken(user.getEmail());

        refreshTokenRepository.save(
                new RefreshToken(user.getId(), refreshToken,
                        new Date(System.currentTimeMillis() + jwtUtil.getExpiration() * 2))
        );

        return new LoginResponse(accessToken, refreshToken);
    }
    
    @Transactional
    @Override
    public LoginResponse processOAuth2Login(String email, String name) {
        Optional<User> userOptional = userRepository.findByEmail(email);

        User user;
        if (userOptional.isPresent()) {
            // User exists
            user = userOptional.get();
            if (name != null && !name.equals(user.getName())) {
                user.setName(name);
            }
            user.setLastLogin(new Date());
            user = userRepository.save(user);
            logger.info("[OAuth] Existing user logged in: {}", email);
        } else {
            // New user, create them
            logger.info("[OAuth] Creating new user: {}", email);
            user = new User();
            user.setEmail(email);
            user.setName(name);
            user.setRole("CASHIER"); // Default role
            user.setPassword(null); // No password for OAuth-only users
            user.setCreatedAt(new Date());
            user.setLastLogin(new Date());
            user.setUserId("u" + (System.currentTimeMillis() % 10000));
            user = userRepository.save(user);
        }

        // Generate tokens
        String accessToken = jwtUtil.generateToken(user.getEmail(), user.getRole());
        String refreshToken = jwtUtil.generateRefreshToken(user.getEmail());

        // Save refresh token
        refreshTokenRepository.deleteByUserId(user.getId());
        refreshTokenRepository.save(
            new RefreshToken(user.getId(), refreshToken,
                    new Date(System.currentTimeMillis() + jwtUtil.getExpiration() * 2))
        );

        return new LoginResponse(accessToken, refreshToken);
    }

    @Override
    public User getUserByEmail(String email) {
        return userRepository.findByEmail(email)
                .orElseThrow(() -> new RuntimeException("User not found: " + email));
    }

    @Override
    public String refreshToken(String refreshToken) {
        RefreshToken storedToken = refreshTokenRepository.findByToken(refreshToken)
                .orElseThrow(() -> new RuntimeException("Invalid refresh token"));

        if (storedToken.getExpiryDate().before(new Date())) {
            refreshTokenRepository.deleteById(storedToken.getId());
            throw new RuntimeException("Refresh token expired");
        }

        User user = userRepository.findById(storedToken.getUserId())
                .orElseThrow(() -> new RuntimeException("User not found: " + storedToken.getUserId()));

        return jwtUtil.generateToken(user.getEmail(), user.getRole());
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\BillService.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.models.Bill;
import java.util.Date;
import java.util.List;
import java.util.Locale;

public interface BillService {
    Bill createBill(Bill bill, Locale locale);
    Bill createBill(Bill bill, Locale locale, boolean isSyncMode);
    Bill getBillById(String billId, Locale locale);
    List<Bill> getAllBills();
    List<Bill> getBillsByDateRange(Date startDate, Date endDate, Locale locale);
    boolean validatePdfAccessToken(String billId, String token);
    String generatePdfAccessToken(String billId); // Added method
    boolean existsByBillId(String billId);
    void resendBillEmail(Bill bill, Locale locale);
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\BillServiceImpl.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.models.Bill;
import com.smartretail.backend.models.Customer;
import com.smartretail.backend.models.Product;
import com.smartretail.backend.repository.BillRepository;
import com.smartretail.backend.repository.CustomerRepository;
import com.smartretail.backend.repository.ProductRepository;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.context.MessageSource;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import java.util.*;

@Service
public class BillServiceImpl implements BillService {

    private static final Logger logger = LoggerFactory.getLogger(BillServiceImpl.class);
    private final BillRepository billRepository;
    private final CustomerRepository customerRepository;
    private final ProductRepository productRepository;
    private final ProductService productService;
    private final NotificationService notificationService;
    private final PdfService pdfService;
    private final MessageSource messageSource;
    private final AuditLogService auditLogService;

    public BillServiceImpl(BillRepository billRepository,
                           CustomerRepository customerRepository,
                           ProductRepository productRepository,
                           ProductService productService,
                           NotificationService notificationService,
                           PdfService pdfService,
                           MessageSource messageSource,
                           AuditLogService auditLogService) {
        this.billRepository = billRepository;
        this.customerRepository = customerRepository;
        this.productRepository = productRepository;
        this.productService = productService;
        this.notificationService = notificationService;
        this.pdfService = pdfService;
        this.messageSource = messageSource;
        this.auditLogService = auditLogService;
    }

    @Override
    @Transactional
    public Bill createBill(Bill bill, Locale locale) {
        return createBill(bill, locale, false);
    }

    @Override
    @Transactional
    public Bill createBill(Bill bill, Locale locale, boolean isSyncMode) {
        logger.debug("[BILL SERVICE] Creating bill with ID: {}", bill.getBillId());

        String userEmail = SecurityContextHolder.getContext().getAuthentication().getName();

        // ✅ Auto-generate Bill ID if missing
        if (bill.getBillId() == null || bill.getBillId().trim().isEmpty()) {
            bill.setBillId("B" + System.currentTimeMillis());
            logger.debug("[BILL SERVICE] Auto-generated bill ID: {}", bill.getBillId());
        }

        // ✅ AddedBy fallback
        if (bill.getAddedBy() == null || bill.getAddedBy().trim().isEmpty()) {
            bill.setAddedBy(userEmail != null ? userEmail : "system");
        }

        // ✅ Prevent duplicates
        if (!isSyncMode && billRepository.existsByBillId(bill.getBillId())) {
            throw new RuntimeException("Bill already exists: " + bill.getBillId());
        }

        // ✅ Validate customer
        if (bill.getCustomer() == null || bill.getCustomer().getMobile() == null) {
            throw new IllegalArgumentException("Customer details are required");
        }

        // ✅ Recalculate totalAmount based on product prices from DB
        double total = 0.0;
        if (bill.getItems() == null || bill.getItems().isEmpty()) {
            logger.warn("[BILL SERVICE] Bill {} has no items!", bill.getBillId());
        } else {
            for (Bill.BillItem item : bill.getItems()) {
                if (item.getProductId() == null || item.getProductId().trim().isEmpty()) {
                    logger.warn("[BILL SERVICE] Skipping invalid item without productId");
                    continue;
                }

                Product product = productService.getProductById(item.getProductId(), locale);
                if (product == null) {
                    logger.error("[BILL SERVICE] Product not found for ID: {}", item.getProductId());
                    continue;
                }

                item.setProductName(product.getName());
                item.setPrice(product.getPrice());

                double itemTotal = item.getItemTotal();
                total += itemTotal;

                logger.debug("[BILL SERVICE] {} × {} = {}", product.getName(), item.getQty(), itemTotal);

                // ✅ Update stock after sale
                productService.updateProductQuantity(item.getProductId(), item.getQty(), locale);
            }
        }

        // ✅ Calculate total again using built-in method (redundancy check)
        double computedTotal = bill.calculateTotal();
        if (computedTotal > 0) total = computedTotal;

        bill.setTotalAmount(total);
        bill.setCreatedAt(new Date());

        // ✅ Generate PDF access token using the new method
        if (bill.getPdfAccessToken() == null || bill.getPdfAccessToken().trim().isEmpty()) {
            bill.setPdfAccessToken(generatePdfAccessToken(bill.getBillId()));
            logger.debug("[BILL SERVICE] Generated new PDF access token for {}", bill.getBillId());
        }

        logger.debug("[BILL SERVICE] Final total for bill {} = ₹{}", bill.getBillId(), total);

        // ✅ Customer management
        Customer customer = customerRepository.findByMobile(bill.getCustomer().getMobile())
                .orElseGet(() -> {
                    return new Customer(
                            bill.getCustomer().getName(),
                            bill.getCustomer().getEmail(),
                            bill.getCustomer().getMobile());
                });

        // ✅ Update customer stats
        customer.setTotalPurchaseCount(customer.getTotalPurchaseCount() + 1);
        customer.setLastPurchaseDate(new Date());
        if (customer.getPurchaseHistory() == null) {
            customer.setPurchaseHistory(new ArrayList<>());
        }
        if (!customer.getPurchaseHistory().contains(bill.getBillId())) {
            customer.getPurchaseHistory().add(bill.getBillId());
        }

        customerRepository.save(customer);

        // ✅ Save Bill
        Bill savedBill = billRepository.save(bill);

        // ✅ Recalculate and persist totalAmount again
        savedBill.setTotalAmount(savedBill.calculateTotal());
        savedBill = billRepository.save(savedBill);

        logger.info("[BILL SERVICE] Bill {} saved successfully with total ₹{}", savedBill.getBillId(), savedBill.getTotalAmount());

        // ✅ Log action
        auditLogService.logAction("BILL_CREATED", savedBill.getBillId(), userEmail, Map.of(
                "totalAmount", savedBill.getTotalAmount(),
                "customerEmail", customer.getEmail()
        ));

        // ✅ Optional: Send PDF + Email
        try {
            if (bill.getCustomer().getEmail() != null && !bill.getCustomer().getEmail().isBlank()) {
                byte[] pdfContent = pdfService.generateBillPdf(savedBill, locale);
                notificationService.sendBillNotification(
                        bill.getCustomer().getEmail(),
                        savedBill.getBillId(),
                        savedBill.getTotalAmount(),
                        pdfContent,
                        locale
                );
                logger.info("[BILL SERVICE] Email sent for bill {}", savedBill.getBillId());
            }
        } catch (Exception e) {
            logger.error("[BILL SERVICE] Failed to send email for bill {}: {}", savedBill.getBillId(), e.getMessage());
        }

        return savedBill;
    }

    @Override
    public Bill getBillById(String billId, Locale locale) {
        return billRepository.findByBillId(billId)
                .orElseThrow(() -> new RuntimeException("Bill not found: " + billId));
    }

    @Override
    public List<Bill> getAllBills() {
        return billRepository.findAll();
    }

    @Override
    public List<Bill> getBillsByDateRange(Date startDate, Date endDate, Locale locale) {
        return billRepository.findByCreatedAtBetween(startDate, endDate);
    }

    @Override
    public boolean validatePdfAccessToken(String billId, String token) {
        try {
            // Token format: billId|randomUuid|exp (e.g. "B123|uuid|1734000000")
            String[] parts = token.split("\\|");
            if (parts.length != 3) return false;
            if (!parts[0].equals(billId)) return false;

            long exp = Long.parseLong(parts[2]);
            if (System.currentTimeMillis() > exp * 1000) {
                logger.warn("[BILL SERVICE] PDF token expired for bill: {}", billId);
                return false;
            }

            // Optional: You could add signature verification here if needed
            return true;
        } catch (Exception e) {
            logger.error("[BILL SERVICE] Invalid PDF token format for bill {}: {}", billId, e.getMessage());
            return false;
        }
    }

    /**
     * Generate a short-lived PDF access token
     * Format: billId|randomUuid|expirationTimestamp
     */
    public String generatePdfAccessToken(String billId) {
        String uuid = UUID.randomUUID().toString();
        long exp = System.currentTimeMillis() / 1000 + 3600; // 1 hour expiration
        return billId + "|" + uuid + "|" + exp;
    }

    @Override
    public boolean existsByBillId(String billId) {
        return billRepository.existsByBillId(billId);
    }

    @Override
    public void resendBillEmail(Bill bill, Locale locale) {
        try {
            byte[] pdfContent = pdfService.generateBillPdf(bill, locale);
            notificationService.sendBillNotification(
                    bill.getCustomer().getEmail(),
                    bill.getBillId(),
                    bill.getTotalAmount(),
                    pdfContent,
                    locale
            );
            logger.info("[BILL SERVICE] Bill email resent to {}", bill.getCustomer().getEmail());
        } catch (Exception e) {
            logger.error("[BILL SERVICE] Failed to resend email for bill {}: {}", bill.getBillId(), e.getMessage());
        }
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\CustomerService.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.models.Bill;
import com.smartretail.backend.models.Customer;
import com.smartretail.backend.dto.CustomEmailRequest;

import java.util.Date;
import java.util.List;
import java.util.Locale;

public interface CustomerService {

    Customer findOrCreateCustomer(Bill.CustomerInfo customerInfo, Locale locale);

    void addBillId(String mobile, String billId);

    Customer createCustomer(Customer customer, Locale locale);

    Customer getCustomerById(String id, Locale locale);

    List<Customer> getAllCustomers();

    Customer updateCustomer(String id, Customer customer, Locale locale);

    void deleteCustomer(String id, Locale locale);

    List<Bill> getCustomerPurchaseHistory(String customerId, Date startDate, Date endDate, Locale locale);

    void sendCustomEmail(CustomEmailRequest request, Locale locale);

    // --- NEW METHOD: Find customers with no purchases after threshold date ---
    /**
     * Finds customers who have not made any purchase after the given threshold date.
     * Useful for re-engagement campaigns (e.g., "We miss you!" emails).
     *
     * @param thresholdDate Customers with last purchase before this date are considered inactive
     * @return List of inactive customers
     */
    List<Customer> findInactiveCustomers(Date thresholdDate);
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\CustomerServiceImpl.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.dto.CustomEmailRequest;
import com.smartretail.backend.models.Bill;
import com.smartretail.backend.models.Customer;
import com.smartretail.backend.repository.BillRepository;
import com.smartretail.backend.repository.CustomerRepository;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.context.MessageSource;
import org.springframework.stereotype.Service;

import java.util.*;
import java.util.stream.Collectors;

@Service
public class CustomerServiceImpl implements CustomerService {

    private static final Logger logger = LoggerFactory.getLogger(CustomerServiceImpl.class);

    private final CustomerRepository customerRepository;
    private final BillRepository billRepository;
    private final MessageSource messageSource;
    private final NotificationService notificationService;

    public CustomerServiceImpl(CustomerRepository customerRepository,
                               BillRepository billRepository,
                               MessageSource messageSource,
                               NotificationService notificationService) {
        this.customerRepository = customerRepository;
        this.billRepository = billRepository;
        this.messageSource = messageSource;
        this.notificationService = notificationService;
    }

    @Override
    public Customer findOrCreateCustomer(Bill.CustomerInfo customerInfo, Locale locale) {
        logger.debug("[CUSTOMER SERVICE] Finding or creating customer with mobile: {}", customerInfo.getMobile());
        if (customerInfo.getMobile() == null || customerInfo.getMobile().trim().isEmpty()) {
            logger.error("[CUSTOMER SERVICE] Customer mobile is required");
            throw new IllegalArgumentException(messageSource.getMessage("customer.mobile.required", null, locale));
        }
        Optional<Customer> existingCustomer = customerRepository.findByMobile(customerInfo.getMobile());
        if (existingCustomer.isPresent()) {
            Customer customer = existingCustomer.get();
            logger.debug("[CUSTOMER SERVICE] Found existing customer: {}", customer.getMobile());
            logger.debug("[CUSTOMER SERVICE] Existing customer email: {}", customer.getEmail());
            if (customerInfo.getName() != null && !customerInfo.getName().isEmpty()) {
                customer.setName(customerInfo.getName());
                logger.debug("[CUSTOMER SERVICE] Updated customer name to: {}", customerInfo.getName());
            }
            if (customerInfo.getEmail() != null && !customerInfo.getEmail().isEmpty()) {
                customer.setEmail(customerInfo.getEmail());
                logger.debug("[CUSTOMER SERVICE] Updated customer email to: {}", customerInfo.getEmail());
            }
            Customer savedCustomer = customerRepository.save(customer);
            logger.debug("[CUSTOMER SERVICE] Customer saved with email: {}", savedCustomer.getEmail());
            return savedCustomer;
        } else {
            Customer newCustomer = new Customer();
            newCustomer.setMobile(customerInfo.getMobile());
            newCustomer.setName(customerInfo.getName() != null ? customerInfo.getName() : "Customer");
            newCustomer.setEmail(customerInfo.getEmail());
            newCustomer.setCreatedAt(new Date());
            newCustomer.setPurchaseHistory(new ArrayList<>());
            logger.debug("[CUSTOMER SERVICE] Creating new customer: {}", newCustomer.getMobile());
            logger.debug("[CUSTOMER SERVICE] New customer email: {}", newCustomer.getEmail());
            Customer savedCustomer = customerRepository.save(newCustomer);
            logger.debug("[CUSTOMER SERVICE] New customer created with email: {}", savedCustomer.getEmail());
            return savedCustomer;
        }
    }

    @Override
    public void addBillId(String mobile, String billId) {
        logger.debug("[CUSTOMER SERVICE] Adding bill ID {} to customer with mobile: {}", billId, mobile);
        Customer customer = customerRepository.findByMobile(mobile)
                .orElseThrow(() -> new IllegalArgumentException(
                        messageSource.getMessage("customer.not.found", new Object[]{mobile}, Locale.getDefault())));

        if (customer.getPurchaseHistory() == null) {
            customer.setPurchaseHistory(new ArrayList<>());
        }
        if (!customer.getPurchaseHistory().contains(billId)) {
            customer.getPurchaseHistory().add(billId);
            customerRepository.save(customer);
            logger.info("[CUSTOMER SERVICE] Bill ID {} added to customer: {}", billId, mobile);
        }
    }

    @Override
    public Customer createCustomer(Customer customer, Locale locale) {
        logger.debug("[CUSTOMER SERVICE] Creating customer with mobile: {}", customer.getMobile());
        if (customerRepository.findByMobile(customer.getMobile()).isPresent()) {
            logger.error("[CUSTOMER SERVICE] Customer already exists: {}", customer.getMobile());
            throw new IllegalArgumentException(
                    messageSource.getMessage("customer.exists", new Object[]{customer.getMobile()}, locale));
        }
        customer.setCreatedAt(new Date());
        Customer savedCustomer = customerRepository.save(customer);
        logger.info("[CUSTOMER SERVICE] Customer created: {}", savedCustomer.getMobile());
        return savedCustomer;
    }

    @Override
    public Customer getCustomerById(String id, Locale locale) {
        logger.debug("[CUSTOMER SERVICE] Fetching customer with ID: {}", id);
        Customer customer = customerRepository.findById(id)
                .orElseThrow(() -> new IllegalArgumentException(
                        messageSource.getMessage("customer.not.found", new Object[]{id}, locale)));
        logger.info("[CUSTOMER SERVICE] Found customer: {}", customer.getMobile());
        return customer;
    }

    @Override
    public List<Customer> getAllCustomers() {
        logger.debug("[CUSTOMER SERVICE] Fetching all customers");
        List<Customer> customers = customerRepository.findAll();
        logger.info("[CUSTOMER SERVICE] Found {} customers", customers.size());
        return customers;
    }

    @Override
    public Customer updateCustomer(String id, Customer customer, Locale locale) {
        logger.debug("[CUSTOMER SERVICE] Updating customer with ID: {}", id);
        Customer existing = customerRepository.findById(id)
                .orElseThrow(() -> new IllegalArgumentException(
                        messageSource.getMessage("customer.not.found", new Object[]{id}, locale)));
        existing.setName(customer.getName());
        existing.setEmail(customer.getEmail());
        existing.setMobile(customer.getMobile());
        Customer updatedCustomer = customerRepository.save(existing);
        logger.info("[CUSTOMER SERVICE] Customer updated: {}", updatedCustomer.getMobile());
        return updatedCustomer;
    }

    @Override
    public void deleteCustomer(String id, Locale locale) {
        logger.debug("[CUSTOMER SERVICE] Deleting customer with ID: {}", id);
        if (!customerRepository.existsById(id)) {
            logger.error("[CUSTOMER SERVICE] Customer not found: {}", id);
            throw new IllegalArgumentException(
                    messageSource.getMessage("customer.not.found", new Object[]{id}, locale));
        }
        customerRepository.deleteById(id);
        logger.info("[CUSTOMER SERVICE] Customer deleted: {}", id);
    }

    private Date getEndOfDay(Date date) {
        if (date == null) {
            return null;
        }
        Calendar c = Calendar.getInstance();
        c.setTime(date);
        c.set(Calendar.HOUR_OF_DAY, 23);
        c.set(Calendar.MINUTE, 59);
        c.set(Calendar.SECOND, 59);
        c.set(Calendar.MILLISECOND, 999);
        return c.getTime();
    }

    @Override
    public List<Bill> getCustomerPurchaseHistory(String customerId, Date startDate, Date endDate, Locale locale) {
        logger.debug("[CUSTOMER SERVICE] Fetching purchase history for customer ID: {}, startDate: {}, endDate: {}",
                customerId, startDate, endDate);
        if (customerId == null || customerId.isEmpty()) {
            logger.error("[CUSTOMER SERVICE] Customer ID is required");
            throw new IllegalArgumentException(messageSource.getMessage("customer.id.required", null, locale));
        }
        if (startDate != null && endDate != null && startDate.after(endDate)) {
            logger.error("[CUSTOMER SERVICE] Invalid date range: startDate={} is after endDate={}", startDate, endDate);
            throw new IllegalArgumentException(
                    messageSource.getMessage("report.date.range.invalid", new Object[]{startDate, endDate}, locale));
        }
        Customer customer = customerRepository.findById(customerId)
                .orElseThrow(() -> new IllegalArgumentException(
                        messageSource.getMessage("customer.not.found", new Object[]{customerId}, locale)));
        List<String> billIds = customer.getPurchaseHistory();
        if (billIds == null || billIds.isEmpty()) {
            logger.info("[CUSTOMER SERVICE] No purchase history found for customer: {}", customerId);
            return new ArrayList<>();
        }

        final Date finalEndDate = getEndOfDay(endDate);
        List<Bill> bills = billRepository.findAllById(billIds).stream()
                .filter(bill -> bill.getCreatedAt() != null)
                .filter(bill -> startDate == null || !bill.getCreatedAt().before(startDate))
                .filter(bill -> finalEndDate == null || !bill.getCreatedAt().after(finalEndDate))
                .collect(Collectors.toList());

        if (bills.size() < billIds.size()) {
            List<String> foundBillIds = bills.stream().map(Bill::getBillId).collect(Collectors.toList());
            List<String> missingBillIds = new ArrayList<>(billIds);
            missingBillIds.removeAll(foundBillIds);
            logger.warn("[CUSTOMER SERVICE] Some bill IDs not found: missing IDs {}, expected {}, found {}",
                    missingBillIds, billIds.size(), bills.size());
        }
        logger.info("[CUSTOMER SERVICE] Found {} bills in purchase history for customer: {}", bills.size(), customerId);
        return bills;
    }

    @Override
    public void sendCustomEmail(CustomEmailRequest request, Locale locale) {
        logger.info("[CUSTOMER SERVICE] Received request to send custom email to {} customers", request.getCustomerIds().size());

        List<Customer> customers = customerRepository.findAllById(request.getCustomerIds());
        int successCount = 0;

        for (Customer customer : customers) {
            if (customer.getEmail() == null || customer.getEmail().isBlank()) {
                logger.warn("[CUSTOMER SERVICE] Skipping customer {}: no email address", customer.getId());
                continue;
            }

            try {
                String personalizedBody = request.getBody()
                        .replace("{{customerName}}", Optional.ofNullable(customer.getName()).orElse("Customer"))
                        .replace("{{customerNameCase}}", Optional.ofNullable(customer.getName()).orElse("Customer"));

                notificationService.sendEmail(
                        customer.getEmail(),
                        request.getSubject(),
                        personalizedBody
                );
                successCount++;
            } catch (Exception e) {
                logger.error("[CUSTOMER SERVICE] Failed to send email to {}: {}", customer.getEmail(), e.getMessage());
            }
        }

        logger.info("[CUSTOMER SERVICE] Successfully sent {} out of {} emails", successCount, customers.size());
    }

    // --- NEW METHOD: Find Inactive Customers ---
    @Override
    public List<Customer> findInactiveCustomers(Date thresholdDate) {
        logger.debug("[CUSTOMER SERVICE] Finding customers inactive since: {}", thresholdDate);

        if (thresholdDate == null) {
            logger.warn("[CUSTOMER SERVICE] Threshold date is null, returning empty list");
            return Collections.emptyList();
        }

        return customerRepository.findByLastPurchaseDateBeforeOrLastPurchaseDateIsNull(thresholdDate);
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\FileService.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import org.springframework.web.multipart.MultipartFile;
import java.io.IOException;
import java.util.Map;

public interface FileService {
    String uploadImage(MultipartFile file, String fileName) throws IOException;
    Map<String, Object> getImage(String imageId);
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\FileServiceImpl.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.mongodb.client.gridfs.GridFSBucket;
import com.mongodb.client.gridfs.model.GridFSFile;
import com.mongodb.client.gridfs.model.GridFSUploadOptions;
import org.bson.Document;
import org.bson.types.ObjectId;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.data.mongodb.core.query.Criteria;
import org.springframework.data.mongodb.core.query.Query;
import org.springframework.data.mongodb.gridfs.GridFsTemplate;
import org.springframework.stereotype.Service;
import org.springframework.web.multipart.MultipartFile;

import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.util.HashMap;
import java.util.Map;

@Service
public class FileServiceImpl implements FileService {

    private final GridFsTemplate gridFsTemplate;
    private final GridFSBucket gridFSBucket;

    @Autowired
    public FileServiceImpl(GridFsTemplate gridFsTemplate, GridFSBucket gridFSBucket) {
        this.gridFsTemplate = gridFsTemplate;
        this.gridFSBucket = gridFSBucket;
    }

    @Override
    public String uploadImage(MultipartFile file, String filename) throws IOException {
        GridFSUploadOptions opts = new GridFSUploadOptions()
                .metadata(new Document("filename", filename)
                        .append("contentType", file.getContentType()));

        ObjectId id = gridFsTemplate.store(file.getInputStream(), filename,
                file.getContentType(), opts.getMetadata());
        return id.toHexString();
    }

    @Override
    public Map<String, Object> getImage(String imageId) {
        GridFSFile file = gridFsTemplate.findOne(
                Query.query(Criteria.where("_id").is(new ObjectId(imageId))));

        if (file == null || file.getMetadata() == null) {
            throw new RuntimeException("Image not found: " + imageId);
        }

        try (ByteArrayOutputStream out = new ByteArrayOutputStream()) {
            gridFSBucket.downloadToStream(file.getObjectId(), out);
            Map<String, Object> result = new HashMap<>();
            result.put("bytes", out.toByteArray());
            result.put("contentType", file.getMetadata().getString("contentType"));
            return result;
        } catch (IOException e) {
            throw new RuntimeException("Failed to download image", e);
        }
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\NotificationService.java
--------------------------------------------------------------------

package com.smartretail.backend.service;

import com.smartretail.backend.models.Notification;

import java.util.List;
import java.util.Locale;

public interface NotificationService {
    Notification createNotification(Notification notification);
    List<Notification> getAllNotifications();
    void sendEmail(String to, String subject, String text);
    void sendBillNotification(String customerEmail, String billId, double total, byte[] pdfContent, Locale locale);
    void sendLowStockNotification(String managerEmail, String productName, int quantity, int reorderLevel);
}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\NotificationServiceImpl.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.models.Notification;
import com.smartretail.backend.repository.NotificationRepository;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.context.MessageSource;
import org.springframework.core.io.ByteArrayResource;
import org.springframework.mail.javamail.JavaMailSender;
import org.springframework.mail.javamail.MimeMessageHelper;
import org.springframework.stereotype.Service;

import jakarta.mail.MessagingException;
import jakarta.mail.internet.MimeMessage;
import java.util.Date;
import java.util.List;
import java.util.Locale;

@Service
public class NotificationServiceImpl implements NotificationService {
    private final NotificationRepository notificationRepository;
    private final JavaMailSender mailSender;
    private final MessageSource messageSource;

    @Value("${spring.mail.username}")
    private String fromEmail;

    public NotificationServiceImpl(NotificationRepository notificationRepository,
                                   JavaMailSender mailSender,
                                   MessageSource messageSource) {
        this.notificationRepository = notificationRepository;
        this.mailSender = mailSender;
        this.messageSource = messageSource;
    }

    @Override
    public Notification createNotification(Notification notification) {
        System.out.println("[SERVICE] Creating notification for: " + notification.getTo());
        notification.setSentAt(new Date());

        // Save notification first
        Notification savedNotification = notificationRepository.save(notification);

        // Send email without saving again
        sendEmailDirect(notification.getTo(), notification.getSubject(), notification.getMessage());

        return savedNotification;
    }

    @Override
    public List<Notification> getAllNotifications() {
        System.out.println("[SERVICE] Fetching all notifications.");
        return notificationRepository.findAll();
    }

    @Override
    public void sendEmail(String to, String subject, String text) {
        Notification notification = new Notification(to, subject, text, new Date());
        notificationRepository.save(notification);
        sendEmailDirect(to, subject, text);
    }

    private void sendEmailDirect(String to, String subject, String text) {
        try {
            MimeMessage message = mailSender.createMimeMessage();
            MimeMessageHelper helper = new MimeMessageHelper(message, true, "UTF-8");
            helper.setFrom(fromEmail);
            helper.setTo(to);
            helper.setSubject(subject);
            helper.setText(text, false);
            mailSender.send(message);
            System.out.println("[NOTIFICATION] Email sent to: " + to);
        } catch (MessagingException e) {
            System.err.println("[NOTIFICATION] Failed to send email to " + to + ": " + e.getMessage());
            throw new RuntimeException("Email send failed. Check SMTP authentication or app password.", e);
        }
    }

    @Override
    public void sendBillNotification(String customerEmail, String billId, double total, byte[] pdfContent, Locale locale) {
        if (customerEmail == null || customerEmail.trim().isEmpty()) {
            System.err.println("[NOTIFICATION] Customer email is null or empty for bill: " + billId);
            return;
        }

        try {
            String subject;
            String text;

            try {
                subject = messageSource.getMessage("bill.notification.subject", new Object[]{billId}, locale);
                text = messageSource.getMessage("bill.email.body", new Object[]{billId, String.format("%.2f", total)}, locale);
            } catch (Exception e) {
                subject = "Your Bill Receipt - " + billId;
                text = String.format(
                        "Dear Customer,\n\nThank you for your purchase!\n\nBill ID: %s\nTotal Amount: ₹%.2f\n\nPlease find your bill attached.\n\nThank you for shopping with us!\n\nSmartRetail Team",
                        billId, total
                );
                System.out.println("[NOTIFICATION] Using fallback email message for bill: " + billId);
            }

            System.out.println("[NOTIFICATION] Attempting to send email to: " + customerEmail);
            System.out.println("[NOTIFICATION] Subject: " + subject);

            Notification notification = new Notification(customerEmail, subject, text, new Date());
            notificationRepository.save(notification);

            MimeMessage message = mailSender.createMimeMessage();
            MimeMessageHelper helper = new MimeMessageHelper(message, true, "UTF-8");
            helper.setFrom(fromEmail);
            helper.setTo(customerEmail);
            helper.setSubject(subject);
            helper.setText(text, false);

            if (pdfContent != null && pdfContent.length > 0) {
                helper.addAttachment("Bill_" + billId + ".pdf", new ByteArrayResource(pdfContent));
                System.out.println("[NOTIFICATION] PDF attachment added, size: " + pdfContent.length + " bytes");
            }

            mailSender.send(message);
            System.out.println("[NOTIFICATION] Bill notification sent successfully to: " + customerEmail + " for bill: " + billId);

        } catch (MessagingException e) {
            System.err.println("[NOTIFICATION] Failed to send bill notification to " + customerEmail + ": " + e.getMessage());
            e.printStackTrace();
            throw new RuntimeException("Failed to send bill notification", e);
        }
    }

    @Override
    public void sendLowStockNotification(String managerEmail, String productName, int quantity, int reorderLevel) {
        String emailSubject = "SmartRetail: Low Stock Alert for " + productName;
        String emailText = String.format(
                "Alert: Product '%s' is low on stock.\nCurrent Quantity: %d\nReorder Level: %d\nPlease restock soon.",
                productName, quantity, reorderLevel
        );
        sendEmail(managerEmail, emailSubject, emailText);
    }
}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\PaymentService.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.models.Payment;
import java.util.List;

public interface PaymentService {
    Payment createPayment(Payment payment);
    Payment getPaymentById(String paymentId);
    List<Payment> getAllPayments();
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\PaymentServiceImpl.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.models.Payment;
import com.smartretail.backend.repository.PaymentRepository;
import org.springframework.stereotype.Service;

import java.util.Date;
import java.util.List;
import java.util.UUID;

@Service
public class PaymentServiceImpl implements PaymentService {
    private final PaymentRepository paymentRepository;

    public PaymentServiceImpl(PaymentRepository paymentRepository) {
        this.paymentRepository = paymentRepository;
    }

    @Override
    public Payment createPayment(Payment payment) {
        System.out.println("[SERVICE] Creating payment: " + payment.getPaymentId());
        String paymentId = "pay_" + UUID.randomUUID().toString().substring(0, 8);
        payment.setPaymentId(paymentId);
        if (paymentRepository.existsByPaymentId(paymentId)) {
            System.out.println("[SERVICE] Create failed: Payment ID already exists: " + paymentId);
            throw new RuntimeException("Payment ID already exists");
        }
        payment.setCreatedAt(new Date());
        Payment savedPayment = paymentRepository.save(payment);
        System.out.println("[SERVICE] Payment created successfully: " + savedPayment.getPaymentId());
        return savedPayment;
    }

    @Override
    public Payment getPaymentById(String paymentId) {
        System.out.println("[SERVICE] Fetching payment with ID: " + paymentId);
        return paymentRepository.findByPaymentId(paymentId).orElse(null);
    }

    @Override
    public List<Payment> getAllPayments() {
        System.out.println("[SERVICE] Fetching all payments.");
        return paymentRepository.findAll();
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\PdfService.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.models.Bill;
import java.util.Locale;

public interface PdfService {
    byte[] generateBillPdf(Bill bill, Locale locale);
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\PdfServiceImpl.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.itextpdf.kernel.colors.ColorConstants;
import com.itextpdf.kernel.font.PdfFont;
import com.itextpdf.kernel.font.PdfFontFactory;
import com.itextpdf.kernel.pdf.PdfDocument;
import com.itextpdf.kernel.pdf.PdfWriter;
import com.itextpdf.layout.Document;
import com.itextpdf.layout.borders.Border;
import com.itextpdf.layout.element.Cell;
import com.itextpdf.layout.element.Paragraph;
import com.itextpdf.layout.element.Table;
import com.itextpdf.layout.properties.TextAlignment;
import com.itextpdf.layout.properties.UnitValue;
import com.smartretail.backend.models.Bill;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.stereotype.Service;
import org.springframework.http.HttpHeaders;
import org.springframework.http.MediaType;

import java.io.ByteArrayOutputStream;
import java.util.Locale;

// --- NEW IMPORT ---
import org.springframework.context.MessageSource;
// --- END NEW IMPORT ---

@Service
public class PdfServiceImpl implements PdfService {
    private static final Logger logger = LoggerFactory.getLogger(PdfServiceImpl.class);

    // --- NEW FIELD ---
    private final MessageSource messageSource;

    // --- MODIFIED CONSTRUCTOR ---
    public PdfServiceImpl(MessageSource messageSource) {
        this.messageSource = messageSource;
    }

    // --- Helper method for translation ---
    private String t(String key, Locale locale) {
        // Fallback to the key itself if not found, to avoid errors
        return messageSource.getMessage(key, null, key, locale);
    }

    @Override
    public byte[] generateBillPdf(Bill bill, Locale locale) {
        if (bill == null) {
            throw new IllegalArgumentException("Bill cannot be null");
        }

       // ... (logging remains the same) [cite: 174]

        try (ByteArrayOutputStream outputStream = new ByteArrayOutputStream()) {
            PdfWriter writer = new PdfWriter(outputStream);
            PdfDocument pdf = new PdfDocument(writer);
            Document document = new Document(pdf);

            PdfFont font = PdfFontFactory.createFont("Helvetica");
            PdfFont boldFont = PdfFontFactory.createFont("Helvetica-Bold");

            // Header - MODIFIED
            addHeader(document, boldFont, font, locale);

            // Bill details - MODIFIED
            addBillDetails(document, bill, boldFont, font, locale);

            // Items table - MODIFIED
            addItemsTable(document, bill, boldFont, font, locale);

            // Total - MODIFIED
            addTotal(document, bill, boldFont, locale);

            document.close();
           // ... (logging remains the same) [cite: 175]
            return outputStream.toByteArray();

        } catch (Exception e) {
            // ... (error logging remains the same) [cite: 175]
            throw new RuntimeException("Failed to generate PDF", e);
        }
    }

    // --- MODIFIED METHOD ---
    private void addHeader(Document document, PdfFont boldFont, PdfFont font, Locale locale) {
        document.add(new Paragraph("SmartRetail")
                .setFont(boldFont).setFontSize(24).setTextAlignment(TextAlignment.CENTER));
        document.add(new Paragraph(t("pdf.bill.receiptTitle", locale)) // "Official Receipt"
                .setFont(font).setFontSize(14).setTextAlignment(TextAlignment.CENTER).setMarginBottom(20));
    }

    // --- MODIFIED METHOD ---
    private void addBillDetails(Document document, Bill bill, PdfFont boldFont, PdfFont font, Locale locale) {
        Table detailsTable = new Table(new float[]{1, 2});
        detailsTable.setWidth(UnitValue.createPercentValue(50));

        detailsTable.addCell(createCell(boldFont, t("pdf.bill.billId", locale) + ":", false)); // "Bill ID:"
        detailsTable.addCell(createCell(font, bill.getBillId(), false));

        if (bill.getCustomer() != null) {
            detailsTable.addCell(createCell(boldFont, t("pdf.bill.customer", locale) + ":", false)); // "Customer:"
            detailsTable.addCell(createCell(font,
                    bill.getCustomer().getName() != null ? bill.getCustomer().getName() : "N/A", false));

            detailsTable.addCell(createCell(boldFont, t("pdf.bill.mobile", locale) + ":", false)); // "Mobile:"
            detailsTable.addCell(createCell(font,
                    bill.getCustomer().getMobile() != null ? bill.getCustomer().getMobile() : "N/A", false));
        }

        document.add(detailsTable.setMarginBottom(20));
    }

    // --- MODIFIED METHOD ---
    private void addItemsTable(Document document, Bill bill, PdfFont boldFont, PdfFont font, Locale locale) {
        Table itemsTable = new Table(new float[]{3, 1, 1, 1});
        itemsTable.setWidth(UnitValue.createPercentValue(100));

        // Headers
        itemsTable.addHeaderCell(createCell(boldFont, t("pdf.bill.product", locale), true)); // "Product"
        itemsTable.addHeaderCell(createCell(boldFont, t("pdf.bill.qty", locale), true)); // "Qty"
        itemsTable.addHeaderCell(createCell(boldFont, t("pdf.bill.price", locale), true)); // "Price"
        itemsTable.addHeaderCell(createCell(boldFont, t("pdf.bill.subtotal", locale), true)); // "Subtotal"

        // ... (items loop remains the same) [cite: 177, 178]
        if (bill.getItems() != null) {
            for (Bill.BillItem item : bill.getItems()) {
                String productName = item.getProductName() != null ?
                        item.getProductName() : "Product " + item.getProductId();
                double itemPrice = item.getPrice();
                double subtotal = item.getQty() * itemPrice;
                itemsTable.addCell(createCell(font, productName, false));
                itemsTable.addCell(createCell(font, String.valueOf(item.getQty()), false));
                itemsTable.addCell(createCell(font, String.format("₹%.2f", itemPrice), false));
                itemsTable.addCell(createCell(font, String.format("₹%.2f", subtotal), false));
            }
        }
        document.add(itemsTable);
    }

    // --- MODIFIED METHOD ---
    private void addTotal(Document document, Bill bill, PdfFont boldFont, Locale locale) {
        String totalText = String.format("%s: ₹%.2f", t("pdf.bill.total", locale), bill.getTotalAmount()); // "Total:"
        document.add(new Paragraph(totalText)
                .setFont(boldFont).setFontSize(12)
                .setTextAlignment(TextAlignment.RIGHT).setMarginTop(10));
    }

   // ... (createCell method remains the same) [cite: 179]
    private Cell createCell(PdfFont font, String text, boolean isHeader) {
        Cell cell = new Cell().setFont(font).add(new Paragraph(text));
        if (isHeader) {
            cell.setBackgroundColor(ColorConstants.LIGHT_GRAY);
        } else {
            cell.setBorder(Border.NO_BORDER);
        }
        return cell;
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\ProductService.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.models.Product;
import org.springframework.web.multipart.MultipartFile;

import java.io.IOException;
import java.util.Date;
import java.util.List;
import java.util.Locale;

public interface ProductService {

    boolean existsByProductId(String productId);

    Product createProduct(Product product, MultipartFile imageFile, Locale locale) throws IOException;
    Product createProduct(Product product, Locale locale);                     // no image

    Product getProductById(String productId, Locale locale);
    List<Product> getAllProducts();

    Product updateProduct(String productId, Product product, MultipartFile imageFile, Locale locale) throws IOException;
    Product updateProduct(String productId, Product product, Locale locale);   // no image
    Product updateProduct(String productId, Product product, Locale locale, boolean isSyncMode);

    void deleteProduct(String productId, Locale locale);

    List<Product> getLowStockProducts();
    List<Product> getExpiringProducts(Date threshold);

    Product restockProduct(String productId, int restockQty, Locale locale);
    Product updateProductQuantity(String productId, int quantity, Locale locale);
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\ProductServiceImpl.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.exception.DuplicateResourceException;
import com.smartretail.backend.exception.ProductNotFoundException;
import com.smartretail.backend.models.Product;
import com.smartretail.backend.repository.ProductRepository;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.MessageSource;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;
import org.springframework.web.multipart.MultipartFile;

import java.io.IOException;
import java.util.*;
import java.util.function.Consumer;
import java.util.function.Supplier;
import java.util.stream.Collectors;

@Service
public class ProductServiceImpl implements ProductService {

    private static final Logger logger = LoggerFactory.getLogger(ProductServiceImpl.class);

    private final ProductRepository productRepository;
    private final NotificationService notificationService;
    private final FileService fileService;
    private final MessageSource messageSource;
    private final AuditLogService auditLogService;

    @Autowired
    public ProductServiceImpl(ProductRepository productRepository,
                              NotificationService notificationService,
                              FileService fileService,
                              MessageSource messageSource,
                              AuditLogService auditLogService) {
        this.productRepository = productRepository;
        this.notificationService = notificationService;
        this.fileService = fileService;
        this.messageSource = messageSource;
        this.auditLogService = auditLogService;
    }

    private String currentUser() {
        return Optional.ofNullable(SecurityContextHolder.getContext().getAuthentication())
                .map(auth -> auth.getName())
                .orElse("system");
    }

    private void audit(String action, String entityId, Map<String, Object> details) {
        auditLogService.logAction(action, entityId, currentUser(), details);
    }

    /* ------------------- EXISTS ------------------- */
    @Override
    public boolean existsByProductId(String productId) {
        audit("PRODUCT_EXISTENCE_CHECKED", productId, Map.of("productId", productId));
        return productRepository.existsByProductId(productId);
    }

    /* ------------------- CREATE ------------------- */
    @Override
    @Transactional
    public Product createProduct(Product product, MultipartFile imageFile, Locale locale) throws IOException {
        logger.debug("[SERVICE] Creating product (image={}) – {}", imageFile != null, product.getName());

        if (productRepository.existsByProductId(product.getProductId())) {
            audit("PRODUCT_CREATION_FAILED", product.getProductId(),
                    Map.of("productId", product.getProductId(), "reason", "DUPLICATE_PRODUCT_ID"));
            throw new DuplicateResourceException("product.exists", product.getProductId());
        }

        String imageId = null;
        if (imageFile != null && !imageFile.isEmpty()) {
            imageId = fileService.uploadImage(imageFile, "product_" + product.getProductId());
            product.setImageId(imageId);
            product.setImageUrl("/api/products/image/" + imageId);
        }

        product.setCreatedAt(new Date());
        product.setLastUpdated(new Date());
        Product saved = productRepository.save(product);

        audit("PRODUCT_CREATED", saved.getProductId(), Map.of(
                "name", saved.getName(),
                "category", saved.getCategory(),
                "price", saved.getPrice(),
                "quantity", saved.getQuantity(),
                "minQuantity", saved.getMinQuantity(),
                "reorderLevel", saved.getReorderLevel(),
                "hasImage", imageId != null));

        logger.info("[SERVICE] Product created – {}", saved.getProductId());
        return saved;
    }

    @Override
    @Transactional
    public Product createProduct(Product product, Locale locale) {
        try {
            return createProduct(product, null, locale);
        } catch (IOException e) {
            throw new RuntimeException("Unexpected IO error", e);
        }
    }

    /* ------------------- READ ------------------- */
    @Override
    public Product getProductById(String productId, Locale locale) {
        return productRepository.findByProductId(productId)
                .map(p -> {
                    audit("PRODUCT_ACCESSED", productId, Map.of("name", p.getName()));
                    return p;
                })
                .orElseThrow(() -> {
                    audit("PRODUCT_ACCESS_FAILED", productId, Map.of("reason", "PRODUCT_NOT_FOUND"));
                    return new ProductNotFoundException(
                            messageSource.getMessage("product.not.found", new Object[]{productId}, locale));
                });
    }

    @Override
    public List<Product> getAllProducts() {
        audit("PRODUCTS_BULK_ACCESSED", "ALL", Map.of("action", "FETCH_ALL"));
        return productRepository.findAll();
    }

    /* ------------------- UPDATE (multipart) ------------------- */
    @Override
    @Transactional
    public Product updateProduct(String productId, Product patch, MultipartFile imageFile, Locale locale) throws IOException {
        Product existing = productRepository.findByProductId(productId)
                .orElseThrow(() -> {
                    audit("PRODUCT_UPDATE_FAILED", productId, Map.of("reason", "PRODUCT_NOT_FOUND"));
                    return new ProductNotFoundException(
                            messageSource.getMessage("product.not.found", new Object[]{productId}, locale));
                });

        Map<String, Object> oldVals = new HashMap<>();
        Map<String, Object> newVals = new HashMap<>();

        // ----- fields -----
        // Use all fields from the 'patch' object, not just a few
        updateIfChanged(existing::getName, existing::setName, patch.getName(), "name", oldVals, newVals);
        updateIfChanged(existing::getCategory, existing::setCategory, patch.getCategory(), "category", oldVals, newVals);

        // --- FIX: Use patch.getPrice() and patch.getQuantity() ---
        if (patch.getPrice() > 0) { // Check for valid price
            updateIfChanged(() -> existing.getPrice(), v -> existing.setPrice(v), patch.getPrice(), "price", oldVals, newVals);
        }
        if (patch.getQuantity() >= 0) { // Check for valid quantity
            updateIfChanged(existing::getQuantity, existing::setQuantity, patch.getQuantity(), "quantity", oldVals, newVals);
        }
        if (patch.getMinQuantity() > 0) {
            updateIfChanged(existing::getMinQuantity, existing::setMinQuantity, patch.getMinQuantity(), "minQuantity", oldVals, newVals);
        }
        if (patch.getReorderLevel() > 0) {
            updateIfChanged(existing::getReorderLevel, existing::setReorderLevel, patch.getReorderLevel(), "reorderLevel", oldVals, newVals);
        }
        // --- END FIX ---

        updateIfChanged(existing::getExpiryDate, existing::setExpiryDate, patch.getExpiryDate(), "expiryDate", oldVals, newVals);
        updateIfChanged(existing::getSupplierEmail, existing::setSupplierEmail, patch.getSupplierEmail(), "supplierEmail", oldVals, newVals);
        updateIfChanged(existing::getAddedBy, existing::setAddedBy, patch.getAddedBy(), "addedBy", oldVals, newVals);

        // Don't update imageUrl from JSON patch, only from imageFile
        // updateIfChanged(existing::getImageUrl, existing::setImageUrl, patch.getImageUrl(), "imageUrl", oldVals, newVals);

        // ----- image -----
        if (imageFile != null && !imageFile.isEmpty()) {
            String newId = fileService.uploadImage(imageFile, "product_" + productId);
            String newUrl = "/api/products/image/" + newId; // Use the correct URL structure
            oldVals.put("imageId", existing.getImageId());
            newVals.put("imageId", newId);
            newVals.put("imageUrl", newUrl);
            existing.setImageId(newId);
            existing.setImageUrl(newUrl); // Set the URL
        }

        existing.setLastUpdated(new Date());
        Product updated = productRepository.save(existing);

        boolean lowStock = sendLowStockIfNeeded(updated);
        audit("PRODUCT_UPDATED", productId, Map.of(
                "oldValues", oldVals,
                "newValues", newVals,
                "lowStockNotificationSent", lowStock));

        return updated;
    }

    @Override
    @Transactional
    public Product updateProduct(String productId, Product patch, Locale locale) {
        try {
            return updateProduct(productId, patch, null, locale);
        } catch (IOException e) {
            throw new RuntimeException("Unexpected IO error", e);
        }
    }

    /* ------------------- SYNC-MODE UPDATE ------------------- */
    @Override
    @Transactional
    public Product updateProduct(String productId, Product patch, Locale locale, boolean isSyncMode) {
        Product existing = productRepository.findByProductId(productId)
                .orElseThrow(() -> new ProductNotFoundException(
                        messageSource.getMessage("product.not.found", new Object[]{productId}, locale)));

        if (isSyncMode && noChanges(existing, patch)) {
            logger.info("[SERVICE] Sync-mode: no changes for {}", productId);
            return existing;
        }

        Map<String, Object> oldVals = new HashMap<>();
        Map<String, Object> newVals = new HashMap<>();

        updateIfChanged(existing::getName, existing::setName, patch.getName(), "name", oldVals, newVals);
        updateIfChanged(existing::getCategory, existing::setCategory, patch.getCategory(), "category", oldVals, newVals);
        updateIfChanged(() -> existing.getPrice(), v -> existing.setPrice(v), patch.getPrice(), "price", oldVals, newVals);
        updateIfChanged(existing::getQuantity, existing::setQuantity, patch.getQuantity(), "quantity", oldVals, newVals);
        updateIfChanged(existing::getMinQuantity, existing::setMinQuantity, patch.getMinQuantity(), "minQuantity", oldVals, newVals);
        updateIfChanged(existing::getReorderLevel, existing::setReorderLevel, patch.getReorderLevel(), "reorderLevel", oldVals, newVals);
        updateIfChanged(existing::getExpiryDate, existing::setExpiryDate, patch.getExpiryDate(), "expiryDate", oldVals, newVals);
        updateIfChanged(existing::getSupplierEmail, existing::setSupplierEmail, patch.getSupplierEmail(), "supplierEmail", oldVals, newVals);
        updateIfChanged(existing::getAddedBy, existing::setAddedBy, patch.getAddedBy(), "addedBy", oldVals, newVals);
        updateIfChanged(existing::getImageUrl, existing::setImageUrl, patch.getImageUrl(), "imageUrl", oldVals, newVals);

        existing.setLastUpdated(new Date());
        Product updated = productRepository.save(existing);

        boolean lowStock = !isSyncMode && sendLowStockIfNeeded(updated);
        audit("PRODUCT_UPDATED", productId, Map.of(
                "oldValues", oldVals,
                "newValues", newVals,
                "syncMode", isSyncMode,
                "lowStockNotificationSent", lowStock));

        return updated;
    }

    private boolean noChanges(Product existing, Product incoming) {
        return Objects.equals(existing.getQuantity(), incoming.getQuantity())
                && Objects.equals(existing.getName(), incoming.getName())
                && existing.getPrice() == incoming.getPrice()
                && Objects.equals(existing.getCategory(), incoming.getCategory())
                && existing.getMinQuantity() == incoming.getMinQuantity()
                && existing.getReorderLevel() == incoming.getReorderLevel();
    }

    private boolean sendLowStockIfNeeded(Product p) {
        if (p.getQuantity() < p.getReorderLevel()) {
            notificationService.sendLowStockNotification(
                    "manager@shop.com", p.getName(), p.getQuantity(), p.getReorderLevel());
            return true;
        }
        return false;
    }

    /* ------------------- DELETE ------------------- */
    @Override
    @Transactional
    public void deleteProduct(String productId, Locale locale) {
        Product p = productRepository.findByProductId(productId)
                .orElseThrow(() -> {
                    audit("PRODUCT_DELETION_FAILED", productId, Map.of("reason", "PRODUCT_NOT_FOUND"));
                    return new ProductNotFoundException(
                            messageSource.getMessage("product.not.found", new Object[]{productId}, locale));
                });

        audit("PRODUCT_DELETED", productId, Map.of(
                "name", p.getName(),
                "category", p.getCategory(),
                "quantity", p.getQuantity(),
                "price", p.getPrice(),
                "minQuantity", p.getMinQuantity()));

        productRepository.deleteByProductId(productId);
    }

    /* ------------------- LOW STOCK / EXPIRY ------------------- */
    @Override
    public List<Product> getLowStockProducts() {
        audit("LOW_STOCK_PRODUCTS_ACCESSED", "LOW_STOCK", Map.of());
        return productRepository.findLowStockProducts();
    }

    @Override
    public List<Product> getExpiringProducts(Date threshold) {
        audit("EXPIRING_PRODUCTS_ACCESSED", "EXPIRING", Map.of("threshold", threshold));
        return productRepository.findByExpiryDateBefore(threshold).stream()
                .filter(p -> p.getExpiryDate() != null)
                .collect(Collectors.toList());
    }

    /* ------------------- RESTOCK ------------------- */
    @Override
    @Transactional
    public Product restockProduct(String productId, int restockQty, Locale locale) {
        if (restockQty <= 0) {
            audit("PRODUCT_RESTOCK_FAILED", productId, Map.of("reason", "INVALID_QUANTITY"));
            throw new IllegalArgumentException(
                    messageSource.getMessage("product.restock.invalid.quantity", new Object[]{restockQty}, locale));
        }

        Product p = productRepository.findByProductId(productId)
                .orElseThrow(() -> {
                    audit("PRODUCT_RESTOCK_FAILED", productId, Map.of("reason", "PRODUCT_NOT_FOUND"));
                    return new ProductNotFoundException(
                            messageSource.getMessage("product.not.found", new Object[]{productId}, locale));
                });

        int oldQty = p.getQuantity();
        p.setQuantity(oldQty + restockQty);
        p.setLastUpdated(new Date());
        Product saved = productRepository.save(p);

        boolean low = sendLowStockIfNeeded(saved);
        audit("PRODUCT_RESTOCKED", productId, Map.of(
                "oldQuantity", oldQty,
                "restockQty", restockQty,
                "newQuantity", saved.getQuantity(),
                "lowStockNotificationSent", low));

        return saved;
    }

    /* ------------------- QUANTITY UPDATE ------------------- */
    @Override
    @Transactional
    public Product updateProductQuantity(String productId, int quantity, Locale locale) {
        Product p = productRepository.findByProductId(productId)
                .orElseThrow(() -> {
                    audit("PRODUCT_QUANTITY_UPDATE_FAILED", productId, Map.of("reason", "PRODUCT_NOT_FOUND"));
                    return new ProductNotFoundException(
                            messageSource.getMessage("product.not.found", new Object[]{productId}, locale));
                });

        int oldQty = p.getQuantity();
        int newQty = oldQty - quantity;
        if (newQty < 0) {
            audit("PRODUCT_QUANTITY_UPDATE_FAILED", productId, Map.of(
                    "oldQuantity", oldQty,
                    "quantityChange", quantity,
                    "reason", "INSUFFICIENT_STOCK"));
            throw new IllegalArgumentException(
                    messageSource.getMessage("product.insufficient.stock", new Object[]{productId}, locale));
        }

        p.setQuantity(newQty);
        p.setLastUpdated(new Date());
        Product saved = productRepository.save(p);

        boolean low = sendLowStockIfNeeded(saved);
        audit("PRODUCT_QUANTITY_UPDATED", productId, Map.of(
                "oldQuantity", oldQty,
                "quantityChange", quantity,
                "newQuantity", newQty,
                "lowStockNotificationSent", low));

        return saved;
    }

    /* ------------------- FIELD PATCH HELPER ------------------- */
    private <T> void updateIfChanged(Supplier<T> getter, Consumer<T> setter,
                                     T incoming, String field,
                                     Map<String, Object> oldMap,
                                     Map<String, Object> newMap) {
        T current = getter.get();
        if (incoming != null && !Objects.equals(incoming, current)) {
            oldMap.put(field, current);
            newMap.put(field, incoming);
            setter.accept(incoming);
        }
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\PushNotificationService.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.models.PushSubscription;
import com.smartretail.backend.repository.PushSubscriptionRepository;
import lombok.Getter;
import nl.martijndwars.webpush.Notification;
import nl.martijndwars.webpush.PushService;
import nl.martijndwars.webpush.Subscription;
import org.bouncycastle.jce.provider.BouncyCastleProvider;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Service;

import java.security.GeneralSecurityException;
import java.security.Security;
import java.util.Optional;

@Service
public class PushNotificationService {

    private final PushSubscriptionRepository subscriptionRepository;
    private final PushService pushService;

    @Getter
    private final String vapidPublicKey;
    private final String vapidPrivateKey;
    public PushNotificationService(
            PushSubscriptionRepository subscriptionRepository,
            @Value("${vapid.public.key}") String vapidPublicKey,
            @Value("${vapid.private.key}") String vapidPrivateKey
    ) throws GeneralSecurityException {
        this.subscriptionRepository = subscriptionRepository;
        this.vapidPublicKey = vapidPublicKey;
        this.vapidPrivateKey = vapidPrivateKey;

        Security.addProvider(new BouncyCastleProvider());

        this.pushService = new PushService(vapidPublicKey, vapidPrivateKey);
    }

    public void saveSubscription(String userId, PushSubscription subscription) {
        subscription.setUserId(userId);
        subscriptionRepository.save(subscription);
        System.out.println("[PUSH] Subscription saved for user: " + userId);
    }

    public void sendPushNotification(String userId, String title, String message) {
        Optional<PushSubscription> subscriptionOpt = subscriptionRepository.findByUserId(userId);
        if (subscriptionOpt.isPresent()) {
            PushSubscription subscriptionEntity = subscriptionOpt.get();

            try {
                // Convert your entity to web-push library's Subscription object
                Subscription subscription = new Subscription(
                        subscriptionEntity.getEndpoint(),
                        new Subscription.Keys(
                                subscriptionEntity.getP256dh(),
                                subscriptionEntity.getAuth()
                        )
                );

                // Create notification payload (you can use JSON for more complex messages)
                String payload = "{\"title\":\"" + title + "\",\"body\":\"" + message + "\"}";

                // Create and send notification
                Notification notification = new Notification(subscription, payload);
                pushService.send(notification);

                System.out.println("[PUSH] Notification sent to user: " + userId);
            } catch (Exception e) {
                System.err.println("[PUSH] Failed to send notification to user: " + userId + ", error: " + e.getMessage());
                e.printStackTrace();
            }
        }
    }

}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\ReminderService.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.models.Bill;
import com.smartretail.backend.models.Customer;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.context.MessageSource;
import org.springframework.scheduling.annotation.Scheduled;
import org.springframework.stereotype.Service;

import java.util.*;
import java.util.stream.Collectors;

@Service
public class ReminderService {

    private static final Logger logger = LoggerFactory.getLogger(ReminderService.class);

    private final CustomerService customerService;
    private final NotificationService notificationService;
    private final MessageSource messageSource;

    public ReminderService(CustomerService customerService,
                           NotificationService notificationService,
                           MessageSource messageSource) {
        this.customerService = customerService;
        this.notificationService = notificationService;
        this.messageSource = messageSource;
    }

    /**
     * Sends monthly purchase reminders to customers with frequently bought items.
     * Runs on the 1st of every month at 9:00 AM.
     */
    @Scheduled(cron = "0 0 9 1 * ?")
    public void sendMonthlyPurchaseReminders() {
        logger.info("[REMINDER SERVICE] Starting monthly purchase reminders");

        List<Customer> customers = customerService.getAllCustomers();
        int processedCount = 0;

        for (Customer customer : customers) {
            if (customer.getEmail() == null || customer.getEmail().isBlank()) {
                logger.debug("[REMINDER SERVICE] Skipping {}: no email", customer.getMobile());
                continue;
            }

            List<Bill> purchaseHistory = customerService.getCustomerPurchaseHistory(
                    customer.getId(), null, null, Locale.ENGLISH);

            if (purchaseHistory.isEmpty()) {
                logger.debug("[REMINDER SERVICE] Skipping {}: no purchase history", customer.getMobile());
                continue;
            }

            // Count product frequency
            Map<String, Long> productFrequency = purchaseHistory.stream()
                    .flatMap(bill -> bill.getItems().stream())
                    .collect(Collectors.groupingBy(
                            Bill.BillItem::getProductName,
                            Collectors.counting()
                    ));

            List<String> frequentItems = productFrequency.entrySet().stream()
                    .filter(entry -> entry.getValue() >= 2)
                    .map(Map.Entry::getKey)
                    .collect(Collectors.toList());

            if (frequentItems.isEmpty()) {
                logger.debug("[REMINDER SERVICE] Skipping {}: no frequent items", customer.getMobile());
                continue;
            }

            try {
                String subject = messageSource.getMessage("reminder.subject", null, Locale.ENGLISH);
                String body = messageSource.getMessage(
                        "reminder.body",
                        new Object[]{customer.getName(), String.join("\n", frequentItems)},
                        Locale.ENGLISH
                );

                notificationService.sendEmail(customer.getEmail(), subject, body);
                logger.info("[REMINDER SERVICE] Sent reminder to {} for items: {}", customer.getMobile(), frequentItems);
                processedCount++;
            } catch (Exception e) {
                logger.error("[REMINDER SERVICE] Failed to send reminder to {}: {}", customer.getEmail(), e.getMessage());
            }
        }

        logger.info("[REMINDER SERVICE] Monthly reminders complete. Processed {} customers.", processedCount);
    }

    /**
     * Sends re-engagement emails to customers inactive for 30+ days.
     * Runs daily at 10:00 AM.
     */
    @Scheduled(cron = "0 0 10 * * ?")
    public void sendReEngagementReminders() {
        logger.info("[REMINDER SERVICE] Starting daily re-engagement email task...");

        // Calculate threshold: 30 days ago
        Calendar cal = Calendar.getInstance();
        cal.add(Calendar.DAY_OF_MONTH, -30);
        Date thirtyDaysAgo = cal.getTime();

        // Find inactive customers
        List<Customer> inactiveCustomers = customerService.findInactiveCustomers(thirtyDaysAgo);

        if (inactiveCustomers.isEmpty()) {
            logger.info("[REMINDER SERVICE] No inactive customers found. Task complete.");
            return;
        }

        logger.info("[REMINDER SERVICE] Found {} inactive customers to re-engage.", inactiveCustomers.size());

        String subject = messageSource.getMessage("re_engagement.subject", null, Locale.ENGLISH);
        int successCount = 0;

        for (Customer customer : inactiveCustomers) {
            if (customer.getEmail() == null || customer.getEmail().isBlank()) {
                logger.debug("[REMINDER SERVICE] Skipping inactive customer {}: no email", customer.getId());
                continue;
            }

            try {
                String body = messageSource.getMessage(
                        "re_engagement.body",
                        new Object[]{Optional.ofNullable(customer.getName()).orElse("Valued Customer")},
                        Locale.ENGLISH
                );

                notificationService.sendEmail(customer.getEmail(), subject, body);
                successCount++;
                logger.debug("[REMINDER SERVICE] Re-engagement email sent to: {}", customer.getEmail());
            } catch (Exception e) {
                logger.error("[REMINDER SERVICE] Failed to send re-engagement email to {}: {}", customer.getEmail(), e.getMessage());
            }
        }

        logger.info("[REMINDER SERVICE] Re-engagement task complete. Successfully sent {} emails.", successCount);
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\ReportPdfService.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.dto.FullReportResponse;
import java.util.Locale;

public interface ReportPdfService {
    /**
     * Generates a full executive report as a PDF byte array.
     * @param reportData The combined report data DTO
     * @param locale The locale for any I18n strings (if needed)
     * @return A byte[] containing the PDF data
     */
    byte[] generateFullReportPdf(FullReportResponse reportData, String startDate, String endDate, Locale locale);
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\ReportPdfServiceImpl.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.itextpdf.kernel.colors.DeviceRgb;
import com.itextpdf.kernel.colors.ColorConstants;
import com.itextpdf.kernel.font.PdfFont;
import com.itextpdf.kernel.font.PdfFontFactory;
import com.itextpdf.kernel.geom.PageSize;
import com.itextpdf.kernel.pdf.PdfDocument;
import com.itextpdf.kernel.pdf.PdfWriter;
import com.itextpdf.layout.Document;
import com.itextpdf.layout.borders.SolidBorder;
import com.itextpdf.layout.element.Cell;
import com.itextpdf.layout.element.Paragraph;
import com.itextpdf.layout.element.Table;
import com.itextpdf.layout.properties.TextAlignment;
import com.itextpdf.layout.properties.UnitValue;
import com.smartretail.backend.dto.FullReportResponse;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.stereotype.Service;

import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.text.NumberFormat;
import java.util.List;
import java.util.Locale;
import java.util.*;

// --- NEW IMPORT ---
import org.springframework.context.MessageSource;
// --- END NEW IMPORT ---

@Service
public class ReportPdfServiceImpl implements ReportPdfService {

    private static final Logger logger = LoggerFactory.getLogger(ReportPdfServiceImpl.class);

    // --- NEW FIELD ---
    private final MessageSource messageSource;

    // --- NEW CONSTRUCTOR ---
    public ReportPdfServiceImpl(MessageSource messageSource) {
        this.messageSource = messageSource;
    }

    // --- NEW HELPER METHOD ---
    private String t(String key, Locale locale) {
        return messageSource.getMessage(key, null, key, locale);
    }

    @Override
    public byte[] generateFullReportPdf(FullReportResponse reportData, String startDate, String endDate, Locale locale) {
        try (ByteArrayOutputStream outputStream = new ByteArrayOutputStream()) {
            PdfWriter writer = new PdfWriter(outputStream);
            PdfDocument pdf = new PdfDocument(writer);
            Document document = new Document(pdf, PageSize.A4);
            document.setMargins(40, 40, 40, 40);

            PdfFont font;
            PdfFont boldFont;
            PdfFont titleFont;
            try {
                font = PdfFontFactory.createFont("Helvetica");
                boldFont = PdfFontFactory.createFont("Helvetica-Bold");
                titleFont = PdfFontFactory.createFont("Helvetica-Bold");
            } catch (IOException e) {
                font = PdfFontFactory.createFont();
                boldFont = PdfFontFactory.createFont();
                titleFont = PdfFontFactory.createFont();
            }

            // Build PDF sections WITHOUT Low Stock Details
            addHeader(document, startDate, endDate, titleFont, font, locale); // <-- Pass locale
            addAISummary(document, reportData, boldFont, font, locale); // <-- Pass locale
            addKeyMetrics(document, reportData, boldFont, font, locale); // <-- Pass locale
            addInventoryAlerts(document, reportData, boldFont, font, locale); // <-- Pass locale
            addTopProducts(document, reportData, boldFont, font, locale); // <-- Pass locale
            // REMOVED: addLowStockDetails(document, reportData, boldFont, font, locale);

            document.close();
            logger.info("Successfully generated PDF report");
            return outputStream.toByteArray();

        } catch (Exception e) {
            logger.error("Failed to generate PDF report: {}", e.getMessage(), e);
            throw new RuntimeException("PDF generation failed", e);
        }
    }

    // --- MODIFIED METHOD ---
    private void addHeader(Document document, String startDate, String endDate, PdfFont titleFont, PdfFont font, Locale locale) {
        // Main title matching website
        Paragraph title = new Paragraph(t("pdf.report.title", locale)) // "Executive Report"
                .setFont(titleFont)
                .setFontSize(24)
                .setTextAlignment(TextAlignment.CENTER)
                .setFontColor(ColorConstants.BLACK)
                .setMarginBottom(5);
        document.add(title);

        // Date range matching website format
        Paragraph dateRange = new Paragraph(startDate + " " + t("pdf.report.to", locale) + " " + endDate) // "to"
                .setFont(font)
                .setFontSize(14)
                .setTextAlignment(TextAlignment.CENTER)
                .setFontColor(ColorConstants.DARK_GRAY)
                .setMarginBottom(30);
        document.add(dateRange);

        // Add a subtle separator line
        Paragraph separator = new Paragraph("")
                .setBorder(new SolidBorder(ColorConstants.LIGHT_GRAY, 0.5f))
                .setMarginBottom(30);
        document.add(separator);
    }

    // --- MODIFIED METHOD ---
    private void addAISummary(Document document, FullReportResponse reportData, PdfFont boldFont, PdfFont font, Locale locale) {
        try {
            // Extract AI summary from the correct location in response
            String summary = extractAISummary(reportData);
            if (summary != null && !summary.trim().isEmpty()) {
                Paragraph sectionTitle = new Paragraph(t("pdf.report.aiSummary", locale)) // "AI Generated Summary"
                        .setFont(boldFont)
                        .setFontSize(18)
                        .setFontColor(ColorConstants.BLACK)
                        .setMarginBottom(10);
                document.add(sectionTitle);

                Paragraph summaryParagraph = new Paragraph(summary)
                        .setFont(font)
                        .setFontSize(11)
                        .setFontColor(ColorConstants.DARK_GRAY)
                        .setItalic()
                        .setPadding(15)
                        .setBorder(new SolidBorder(getColorFromHex("#0ea5e9"), 2f)) // Cyan border
                        .setBorderLeft(new SolidBorder(getColorFromHex("#0ea5e9"), 4f))
                        .setBackgroundColor(getColorFromHex("#f8fafc")) // Light gray background
                        .setMarginBottom(25);
                document.add(summaryParagraph);
            }
        } catch (Exception e) {
            logger.warn("Could not parse AI summary for PDF: {}", e.getMessage());
        }
    }

    private String extractAISummary(FullReportResponse reportData) {
        // Try multiple possible locations for AI summary
        if (reportData.getTextSummary() != null) {
            if (reportData.getTextSummary() instanceof Map) {
                Map<?, ?> textSummaryMap = (Map<?, ?>) reportData.getTextSummary();
                Object summary = textSummaryMap.get("report");
                if (summary instanceof String) {
                    return (String) summary;
                }
            } else if (reportData.getTextSummary() instanceof String) {
                return (String) reportData.getTextSummary();
            }
        }

        // Check if summary is in sales report
        if (reportData.getSalesReport() != null && reportData.getSalesReport() instanceof Map) {
            Map<?, ?> salesReport = (Map<?, ?>) reportData.getSalesReport();
            Object summary = salesReport.get("aiSummary");
            if (summary instanceof String) {
                return (String) summary;
            }
        }

        return "AI summary not available for this report period.";
    }

    // --- MODIFIED METHOD ---
    private void addKeyMetrics(Document document, FullReportResponse reportData, PdfFont boldFont, PdfFont font, Locale locale) {
        try {
            Map<String, Object> salesSummary = extractSalesSummary(reportData);
            if (salesSummary != null && !salesSummary.isEmpty()) {
                NumberFormat currencyFormat = NumberFormat.getCurrencyInstance(new Locale("en", "IN"));

                Paragraph sectionTitle = new Paragraph(t("pdf.report.keyMetrics", locale)) // "Key Metrics"
                        .setFont(boldFont)
                        .setFontSize(18)
                        .setFontColor(ColorConstants.BLACK)
                        .setMarginBottom(15);
                document.add(sectionTitle);

                // Extract metrics with fallbacks
                double totalRevenue = getDoubleValue(salesSummary.get("total_revenue"));
                int totalOrders = getIntValue(salesSummary.get("total_orders"));
                int productsSold = getIntValue(salesSummary.get("total_products_sold"));

                // If direct values not found, try alternative keys
                if (totalRevenue == 0) {
                    totalRevenue = getDoubleValue(salesSummary.get("totalRevenue"));
                }
                if (totalOrders == 0) {
                    totalOrders = getIntValue(salesSummary.get("totalOrders"));
                }
                if (productsSold == 0) {
                    productsSold = getIntValue(salesSummary.get("totalProductsSold"));
                }

                Table table = new Table(UnitValue.createPercentArray(3)).useAllAvailableWidth();

                // Revenue metric (green color from website)
                table.addCell(createMetricCell(t("pdf.report.totalRevenue", locale), currencyFormat.format(totalRevenue), // "Total Revenue"
                        boldFont, font, ColorConstants.DARK_GRAY, getColorFromHex("#10b981")));

                // Orders metric (blue color from website)
                table.addCell(createMetricCell(t("pdf.report.totalOrders", locale), String.valueOf(totalOrders), // "Total Orders"
                        boldFont, font, ColorConstants.DARK_GRAY, getColorFromHex("#3b82f6")));

                // Products sold metric (cyan color from website)
                table.addCell(createMetricCell(t("pdf.report.productsSold", locale), String.valueOf(productsSold), // "Products Sold"
                        boldFont, font, ColorConstants.DARK_GRAY, getColorFromHex("#06b6d4")));

                document.add(table.setMarginBottom(30));
            }
        } catch (Exception e) {
            logger.warn("Could not parse key metrics for PDF: {}", e.getMessage());
        }
    }

    private Map<String, Object> extractSalesSummary(FullReportResponse reportData) {
        if (reportData.getSalesReport() instanceof Map) {
            Map<?, ?> salesReport = (Map<?, ?>) reportData.getSalesReport();
            Object summaryObj = salesReport.get("summary");
            if (summaryObj instanceof Map) {
                return (Map<String, Object>) summaryObj;
            }
            // If no summary object, use the sales report itself
            return (Map<String, Object>) salesReport;
        }
        return null;
    }

    // --- MODIFIED METHOD ---
    private void addInventoryAlerts(Document document, FullReportResponse reportData, PdfFont boldFont, PdfFont font, Locale locale) {
        try {
            Map<String, Object> inventoryReport = reportData.getInventoryReport();
            if (inventoryReport != null) {
                Paragraph sectionTitle = new Paragraph(t("pdf.report.inventoryAlerts", locale)) // "Inventory Alerts"
                        .setFont(boldFont)
                        .setFontSize(18)
                        .setFontColor(ColorConstants.BLACK)
                        .setMarginBottom(15);
                document.add(sectionTitle);

                // Extract counts with multiple fallback keys
                int lowStockCount = getIntValue(inventoryReport.get("lowStockCount"));
                if (lowStockCount == 0) {
                    lowStockCount = getIntValue(inventoryReport.get("low_stock_count"));
                }

                int expiringCount = getIntValue(inventoryReport.get("expiringCount"));
                if (expiringCount == 0) {
                    expiringCount = getIntValue(inventoryReport.get("expiring_count"));
                }

                Table table = new Table(UnitValue.createPercentArray(2)).useAllAvailableWidth();

                // Low stock (orange color from website)
                table.addCell(createMetricCell(t("pdf.report.lowStock", locale), String.valueOf(lowStockCount), // "Low Stock Items"
                        boldFont, font, ColorConstants.DARK_GRAY, getColorFromHex("#f59e0b")));

                // Expiring soon (red color from website)
                table.addCell(createMetricCell(t("pdf.report.expiring", locale), String.valueOf(expiringCount), // "Expiring Soon Items"
                        boldFont, font, ColorConstants.DARK_GRAY, getColorFromHex("#ef4444")));

                document.add(table.setMarginBottom(30));
            }
        } catch (Exception e) {
            logger.warn("Could not parse inventory alerts for PDF: {}", e.getMessage());
        }
    }

    // --- MODIFIED METHOD ---
    private void addTopProducts(Document document, FullReportResponse reportData, PdfFont boldFont, PdfFont font, Locale locale) {
        try {
            List<Map<String, Object>> topProducts = extractTopProducts(reportData);
            if (topProducts != null && !topProducts.isEmpty()) {
                Paragraph sectionTitle = new Paragraph(t("pdf.report.topProducts", locale)) // "Top Selling Products"
                        .setFont(boldFont)
                        .setFontSize(18)
                        .setFontColor(ColorConstants.BLACK)
                        .setMarginBottom(10);
                document.add(sectionTitle);

                Table table = new Table(UnitValue.createPercentArray(new float[]{3, 2, 2, 2})).useAllAvailableWidth();

                // Header row
                table.addHeaderCell(createHeaderCell(t("pdf.report.productName", locale), boldFont)); // "Product Name"
                table.addHeaderCell(createHeaderCell(t("pdf.report.category", locale), boldFont)); // "Category"
                table.addHeaderCell(createHeaderCell(t("pdf.report.unitsSold", locale), boldFont)); // "Units Sold"
                table.addHeaderCell(createHeaderCell(t("pdf.report.totalRevenue", locale), boldFont)); // "Total Revenue"

                NumberFormat currencyFormat = NumberFormat.getCurrencyInstance(new Locale("en", "IN"));

                for (Map<String, Object> product : topProducts) {
                    String name = getStringValue(product.get("name"));
                    String category = getStringValue(product.get("category"));
                    int qty = getIntValue(product.get("qty"));
                    double revenue = getDoubleValue(product.get("revenue"));

                    table.addCell(createBodyCell(name, font));
                    table.addCell(createBodyCell(category, font));
                    table.addCell(createBodyCell(String.valueOf(qty), font));
                    table.addCell(createBodyCell(currencyFormat.format(revenue), font));
                }
                document.add(table.setMarginBottom(25));
            } else {
                // Add message when no top products
                Paragraph noData = new Paragraph(t("pdf.report.noTopProducts", locale)) // "No top selling products data available for this period."
                        .setFont(font)
                        .setFontSize(11)
                        .setFontColor(ColorConstants.DARK_GRAY)
                        .setItalic()
                        .setMarginBottom(25);
                document.add(noData);
            }
        } catch (Exception e) {
            logger.warn("Could not parse top products for PDF: {}", e.getMessage());
        }
    }

    private List<Map<String, Object>> extractTopProducts(FullReportResponse reportData) {
        if (reportData.getSalesReport() instanceof Map) {
            Map<?, ?> salesReport = (Map<?, ?>) reportData.getSalesReport();
            Object topProductsObj = salesReport.get("top_products");
            if (topProductsObj instanceof List) {
                return (List<Map<String, Object>>) topProductsObj;
            }
        }
        return null;
    }

    // --- MODIFIED METHOD (if you decide to re-enable low stock details) ---
    private void addLowStockDetails(Document document, FullReportResponse reportData, PdfFont boldFont, PdfFont font, Locale locale) {
        try {
            document.add(new Paragraph(t("pdf.report.lowStockDetails", locale)) // "Low Stock Details"
                    .setFont(boldFont)
                    .setFontSize(18)
                    .setFontColor(ColorConstants.BLACK)
                    .setMarginBottom(10));

            List<Map<String, Object>> lowStockProducts = extractLowStockProducts(reportData);

            if (lowStockProducts != null && !lowStockProducts.isEmpty()) {
                logger.debug("Displaying {} low stock products in PDF", lowStockProducts.size());

                Table table = new Table(UnitValue.createPercentArray(new float[]{3, 2, 2, 2}))
                        .useAllAvailableWidth()
                        .setMarginBottom(20);

                // Header row
                table.addHeaderCell(createHeaderCell(t("pdf.report.productName", locale), boldFont)); // "Product Name"
                table.addHeaderCell(createHeaderCell(t("pdf.report.category", locale), boldFont)); // "Category"
                table.addHeaderCell(createHeaderCell(t("pdf.report.remainingQty", locale), boldFont)); // "Remaining Qty"
                table.addHeaderCell(createHeaderCell(t("pdf.report.reorderLevel", locale), boldFont)); // "Re-order Level"

                for (Map<String, Object> product : lowStockProducts) {
                    // Extract data with multiple fallback keys
                    String name = getStringValue(product.get("name"));
                    if (name.equals("N/A")) name = getStringValue(product.get("productName"));

                    String category = getStringValue(product.get("category"));
                    if (category.equals("N/A")) category = getStringValue(product.get("productCategory"));

                    int quantity = getIntValue(product.get("quantity"));
                    if (quantity == 0) quantity = getIntValue(product.get("stock"));
                    if (quantity == 0) quantity = getIntValue(product.get("remainingQuantity"));

                    int reorderLevel = getIntValue(product.get("reorderLevel"));
                    if (reorderLevel == 0) reorderLevel = getIntValue(product.get("reorderLevel"));
                    if (reorderLevel == 0) reorderLevel = getIntValue(product.get("reorder_level"));

                    table.addCell(createBodyCell(name, font));
                    table.addCell(createBodyCell(category, font));
                    table.addCell(createBodyCell(String.valueOf(quantity), font));
                    table.addCell(createBodyCell(String.valueOf(reorderLevel), font));
                }
                document.add(table);
            } else {
                logger.debug("No low stock products to display");
                Paragraph noData = new Paragraph(t("pdf.report.noLowStock", locale)) // "No low stock items to display"
                        .setFont(font)
                        .setFontSize(11)
                        .setFontColor(ColorConstants.DARK_GRAY)
                        .setItalic()
                        .setMarginBottom(20);
                document.add(noData);
            }
        } catch (Exception e) {
            logger.error("Error in addLowStockDetails: {}", e.getMessage(), e);

            Paragraph errorMsg = new Paragraph(t("pdf.report.lowStockError", locale) + e.getMessage()) // "Error loading low stock details: "
                    .setFont(font)
                    .setFontSize(10)
                    .setFontColor(ColorConstants.RED)
                    .setItalic()
                    .setMarginBottom(20);
            document.add(errorMsg);
        }
    }

    private List<Map<String, Object>> extractLowStockProducts(FullReportResponse reportData) {
        try {
            if (reportData == null) {
                logger.debug("Report data is null");
                return null;
            }

            logger.debug("=== DEEP INVENTORY REPORT ANALYSIS ===");

            // Method 1: Direct extraction from inventory report
            if (reportData.getInventoryReport() != null) {
                Map<String, Object> inventoryReport = reportData.getInventoryReport();
                logger.debug("Inventory Report Type: {}", inventoryReport.getClass().getSimpleName());
                logger.debug("All Inventory Report Keys: {}", inventoryReport.keySet());

                // Print ALL keys and their types
                for (Map.Entry<String, Object> entry : inventoryReport.entrySet()) {
                    logger.debug("Key: '{}', Type: {}, Value: {}",
                            entry.getKey(),
                            entry.getValue() != null ? entry.getValue().getClass().getSimpleName() : "null",
                            entry.getValue() instanceof List ? "List with " + ((List<?>) entry.getValue()).size() + " items" : entry.getValue());
                }

                // Try EVERY possible key pattern
                String[] allPossibleKeys = {
                        "lowStockProducts", "lowStockItems", "low_stock_products",
                        "lowStockList", "lowStockDetails", "low_stock_items",
                        "lowStock", "low_stock", "lowStockProductsList",
                        "products", "items", "inventoryItems", "stockItems",
                        "lowStockData", "low_stock_data", "lowInventory"
                };

                for (String key : allPossibleKeys) {
                    if (inventoryReport.containsKey(key)) {
                        Object obj = inventoryReport.get(key);
                        logger.debug("Found potential data with key '{}': {}", key, obj);

                        if (obj instanceof List) {
                            List<?> list = (List<?>) obj;
                            logger.debug("List with key '{}' has {} items", key, list.size());
                            if (!list.isEmpty()) {
                                logger.debug("First item in list: {}", list.get(0));
                                if (list.get(0) instanceof Map) {
                                    Map<?, ?> firstItem = (Map<?, ?>) list.get(0);
                                    logger.debug("First item keys: {}", firstItem.keySet());
                                }
                            }

                            List<Map<String, Object>> result = convertToListOfMaps(list);
                            if (!result.isEmpty()) {
                                logger.debug("SUCCESS: Found low stock data with key '{}', {} items", key, result.size());
                                return result;
                            }
                        }
                    }
                }

                // Method 2: Look for ANY list that contains product-like objects
                logger.debug("=== SEARCHING FOR ANY PRODUCT-LIKE LISTS ===");
                for (Map.Entry<String, Object> entry : inventoryReport.entrySet()) {
                    if (entry.getValue() instanceof List) {
                        List<?> list = (List<?>) entry.getValue();
                        if (!list.isEmpty() && list.get(0) instanceof Map) {
                            Map<?, ?> firstItem = (Map<?, ?>) list.get(0);
                            logger.debug("Found list with key '{}', first item keys: {}", entry.getKey(), firstItem.keySet());

                            // Check if this looks like product data
                            if (hasProductFields(firstItem)) {
                                List<Map<String, Object>> result = convertToListOfMaps(list);
                                logger.debug("SUCCESS: Found product data with key '{}', {} items", entry.getKey(), result.size());
                                return result;
                            }
                        }
                    }
                }
            }

            // Method 3: Check if low stock data is at the root level
            logger.debug("=== CHECKING ROOT LEVEL ===");
            if (reportData instanceof Map) {
                Map<?, ?> rootMap = (Map<?, ?>) reportData;
                logger.debug("Root level keys: {}", rootMap.keySet());

                for (String key : new String[]{"lowStockProducts", "lowStockItems"}) {
                    if (rootMap.containsKey(key)) {
                        Object obj = rootMap.get(key);
                        if (obj instanceof List) {
                            List<Map<String, Object>> result = convertToListOfMaps((List<?>) obj);
                            logger.debug("SUCCESS: Found low stock data at root level with key '{}', {} items", key, result.size());
                            return result;
                        }
                    }
                }
            }

            logger.debug("FAILED: No low stock products found after exhaustive search");
            return null;

        } catch (Exception e) {
            logger.error("Error extracting low stock products: {}", e.getMessage(), e);
            return null;
        }
    }

    // Helper method to convert any list to List<Map<String, Object>>
    private List<Map<String, Object>> convertToListOfMaps(List<?> rawList) {
        List<Map<String, Object>> result = new ArrayList<>();
        if (rawList != null) {
            for (Object item : rawList) {
                if (item instanceof Map) {
                    result.add((Map<String, Object>) item);
                }
            }
        }
        return result;
    }

    // Helper method to check if a map has product-like fields
    private boolean hasProductFields(Map<?, ?> item) {
        Set<?> keys = item.keySet();
        return keys.contains("name") || keys.contains("productName") ||
                keys.contains("quantity") || keys.contains("stock") ||
                keys.contains("reorderLevel") || keys.contains("category");
    }

    private String determineStockStatus(int quantity, int reorderLevel) {
        if (quantity <= 0) return "Out of Stock";
        if (quantity <= 2) return "Critical";
        if (reorderLevel > 0 && quantity <= reorderLevel) return "Below Reorder Level";
        return "Low Stock";
    }

    private Cell createMetricCell(String title, String value, PdfFont boldFont, PdfFont font,
                                  com.itextpdf.kernel.colors.Color titleColor, com.itextpdf.kernel.colors.Color valueColor) {
        Cell cell = new Cell();
        cell.setBorder(new SolidBorder(ColorConstants.LIGHT_GRAY, 1f))
                .setPadding(15)
                .setBackgroundColor(ColorConstants.WHITE)
                .add(new Paragraph(title)
                        .setFont(font).setFontSize(11)
                        .setFontColor(titleColor)
                        .setTextAlignment(TextAlignment.CENTER))
                .add(new Paragraph(value)
                        .setFont(boldFont).setFontSize(20)
                        .setFontColor(valueColor)
                        .setTextAlignment(TextAlignment.CENTER)
                        .setMarginTop(5));
        return cell;
    }

    private Cell createHeaderCell(String text, PdfFont font) {
        Cell cell = new Cell();
        cell.add(new Paragraph(text))
                .setFont(font).setFontSize(11)
                .setFontColor(ColorConstants.WHITE)
                .setBackgroundColor(ColorConstants.DARK_GRAY)
                .setPadding(8)
                .setTextAlignment(TextAlignment.LEFT);
        return cell;
    }

    private Cell createBodyCell(String text, PdfFont font) {
        Cell cell = new Cell();
        cell.add(new Paragraph(text))
                .setFont(font).setFontSize(10)
                .setFontColor(ColorConstants.BLACK)
                .setPadding(8)
                .setTextAlignment(TextAlignment.LEFT);
        return cell;
    }

    // Helper method to convert hex color to iText Color
    private com.itextpdf.kernel.colors.Color getColorFromHex(String hexColor) {
        try {
            if (hexColor.startsWith("#")) {
                hexColor = hexColor.substring(1);
            }
            int r = Integer.parseInt(hexColor.substring(0, 2), 16);
            int g = Integer.parseInt(hexColor.substring(2, 4), 16);
            int b = Integer.parseInt(hexColor.substring(4, 6), 16);
            return new com.itextpdf.kernel.colors.DeviceRgb(r, g, b);
        } catch (Exception e) {
            return ColorConstants.BLACK;
        }
    }

    // Helper methods for safe type conversion
    private double getDoubleValue(Object value) {
        if (value instanceof Number) {
            return ((Number) value).doubleValue();
        }
        return 0.0;
    }

    private int getIntValue(Object value) {
        if (value instanceof Number) {
            return ((Number) value).intValue();
        }
        return 0;
    }

    private String getStringValue(Object value) {
        if (value instanceof String) {
            return (String) value;
        }
        return value != null ? value.toString() : "N/A";
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\ReportService.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.dto.FullReportResponse;
import java.util.Date;
import java.util.Locale;
import java.util.Map;

public interface ReportService {
    Map<String, Object> getSalesReport(Date startDate, Date endDate, Locale locale);
    Map<String, Object> getInventoryReport(int lowStockThreshold, int expiryDays, Locale locale);

    // --- ADDED NEW METHOD ---
    FullReportResponse getFullReportData(String startDate, String endDate, int lowStockThreshold, int expiryDays, Locale locale);
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\ReportServiceImpl.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.dto.FullReportResponse;
import com.smartretail.backend.models.Bill;
import com.smartretail.backend.models.Product;
import com.smartretail.backend.repository.BillRepository;
import com.smartretail.backend.repository.ProductRepository;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.context.MessageSource;
import org.springframework.data.mongodb.core.MongoTemplate;
import org.springframework.data.mongodb.core.aggregation.Aggregation;
import org.springframework.data.mongodb.core.aggregation.AggregationResults;
import org.springframework.data.mongodb.core.query.Criteria;
import org.springframework.stereotype.Service;

import java.util.*;
import java.util.stream.Collectors;

@Service
public class ReportServiceImpl implements ReportService {
    private static final Logger logger = LoggerFactory.getLogger(ReportServiceImpl.class);
    private final BillRepository billRepository;
    private final ProductRepository productRepository;
    private final MongoTemplate mongoTemplate;
    private final MessageSource messageSource;
    private final AnalyticsService analyticsService;

    public ReportServiceImpl(BillRepository billRepository, ProductRepository productRepository,
                             MongoTemplate mongoTemplate, MessageSource messageSource,
                             AnalyticsService analyticsService) {
        this.billRepository = billRepository;
        this.productRepository = productRepository;
        this.mongoTemplate = mongoTemplate;
        this.messageSource = messageSource;
        this.analyticsService = analyticsService;
    }

    @Override
    public Map<String, Object> getSalesReport(Date startDate, Date endDate, Locale locale) {
        logger.debug("[SERVICE] Generating sales report for range: {} to {}", startDate, endDate);
        if (startDate.after(endDate)) {
            logger.error("[SERVICE] Invalid date range: startDate={} is after endDate={}", startDate, endDate);
            throw new IllegalArgumentException(
                    messageSource.getMessage("report.date.range.invalid", new Object[]{startDate, endDate}, locale));
        }

        // Simplified aggregation without complex SpEL expressions
        Aggregation aggregation = Aggregation.newAggregation(
                Aggregation.match(Criteria.where("createdAt").gte(startDate).lte(endDate)),
                Aggregation.group()
                        .count().as("billCount")
                        .sum("totalAmount").as("totalSales")
        );

        AggregationResults<Map> results = mongoTemplate.aggregate(aggregation, "bills", Map.class);
        Map<String, Object> report = results.getUniqueMappedResult();

        Map<String, Object> result = new HashMap<>();
        if (report == null || report.isEmpty()) {
            logger.info("[SERVICE] No bills found for range: {} to {}", startDate, endDate);
            result.put("totalSales", 0.0);
            result.put("billCount", 0);
            result.put("averageBillAmount", 0.0);
            result.put("bills", Collections.emptyList());
        } else {
            // Get bills with null safety for createdAt field
            List<Bill> bills = billRepository.findAll().stream()
                    .filter(bill -> bill.getCreatedAt() != null) // Filter out bills with null createdAt
                    .filter(bill -> !bill.getCreatedAt().before(startDate) && !bill.getCreatedAt().after(endDate))
                    .limit(100)
                    .collect(Collectors.toList());

            // Extract values from aggregation result with proper type casting
            int billCount = 0;
            double totalSales = 0.0;
            double averageBillAmount = 0.0;

            // Handle different possible number types from MongoDB
            Object billCountObj = report.get("billCount");
            Object totalSalesObj = report.get("totalSales");

            if (billCountObj instanceof Integer) {
                billCount = (Integer) billCountObj;
            } else if (billCountObj instanceof Long) {
                billCount = ((Long) billCountObj).intValue();
            } else if (billCountObj instanceof Double) {
                billCount = ((Double) billCountObj).intValue();
            }

            if (totalSalesObj instanceof Double) {
                totalSales = (Double) totalSalesObj;
            } else if (totalSalesObj instanceof Integer) {
                totalSales = ((Integer) totalSalesObj).doubleValue();
            } else if (totalSalesObj instanceof Long) {
                totalSales = ((Long) totalSalesObj).doubleValue();
            }

            // Calculate average in Java
            averageBillAmount = billCount > 0 ? totalSales / billCount : 0.0;

            result.put("totalSales", totalSales);
            result.put("billCount", billCount);
            result.put("averageBillAmount", Math.round(averageBillAmount * 100.0) / 100.0); // Round to 2 decimal places
            result.put("bills", bills);
        }

        logger.info("[SERVICE] Sales report generated: totalSales={}, billCount={}, averageBillAmount={}",
                result.get("totalSales"), result.get("billCount"), result.get("averageBillAmount"));
        return result;
    }

    @Override
    public Map<String, Object> getInventoryReport(int lowStockThreshold, int expiryDays, Locale locale) {
        logger.debug("[SERVICE] Generating inventory report: lowStockThreshold={}, expiryDays={}", lowStockThreshold, expiryDays);
        if (lowStockThreshold < 0) {
            logger.error("[SERVICE] Invalid low stock threshold: {}", lowStockThreshold);
            throw new IllegalArgumentException(
                    messageSource.getMessage("report.lowStockThreshold.invalid", null, locale));
        }
        if (expiryDays < 0) {
            logger.error("[SERVICE] Invalid expiry days: {}", expiryDays);
            throw new IllegalArgumentException(
                    messageSource.getMessage("report.expiryDays.invalid", null, locale));
        }

        // Calculate expiry date
        Calendar calendar = Calendar.getInstance(TimeZone.getTimeZone("UTC"));
        calendar.add(Calendar.DAY_OF_MONTH, expiryDays);
        Date expiryDate = calendar.getTime();

        // Fetch all products
        List<Product> allProducts = productRepository.findAll();
        if (allProducts.isEmpty()) {
            logger.warn("[SERVICE] No products found");
            throw new IllegalArgumentException(
                    messageSource.getMessage("report.no.products.found", null, locale));
        }

        // Filter low-stock and expiring products
        List<Product> lowStockProducts = allProducts.stream()
                .filter(p -> p.getQuantity() <= lowStockThreshold)
                .collect(Collectors.toList());
        List<Product> expiringProducts = allProducts.stream()
                .filter(p -> p.getExpiryDate() != null && !p.getExpiryDate().after(expiryDate))
                .collect(Collectors.toList());

        Map<String, Object> result = new HashMap<>();
        result.put("totalProducts", allProducts.size());
        result.put("lowStockProducts", lowStockProducts);
        result.put("expiringProducts", expiringProducts);
        result.put("lowStockCount", lowStockProducts.size());
        result.put("expiringCount", expiringProducts.size());

        logger.info("[SERVICE] Inventory report generated: totalProducts={}, lowStockCount={}, expiringCount={}",
                allProducts.size(), lowStockProducts.size(), expiringProducts.size());
        return result;
    }

    @Override
    public FullReportResponse getFullReportData(String startDate, String endDate, int lowStockThreshold, int expiryDays, Locale locale) {
        logger.debug("Gathering full report data for: {} to {}", startDate, endDate);

        // 1. Get Sales Report from Flask
        Object salesReport = analyticsService.getReport(startDate, endDate);

        // 2. Get Text Summary from Flask
        Object textSummary = analyticsService.getTextReport(startDate, endDate);

        // 3. Get Inventory Report from Spring (this same service)
        Map<String, Object> inventoryReport = this.getInventoryReport(lowStockThreshold, expiryDays, locale);

        // 4. Combine into one response
        return FullReportResponse.builder()
                .salesReport(salesReport)
                .textSummary(textSummary)
                .inventoryReport(inventoryReport)
                .build();
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\SyncService.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.models.Bill;
import com.smartretail.backend.repository.BillRepository;
import org.springframework.stereotype.Service;

import java.util.Locale;
import java.util.Optional;

@Service
public class SyncService {

    private final BillRepository billRepository;
    private final BillService billService;

    public SyncService(BillRepository billRepository, BillService billService) {
        this.billRepository = billRepository;
        this.billService = billService;
    }

    public String syncBill(Bill bill, Locale locale) {
        // Check if bill exists (idempotency)
        Optional<Bill> existingBill = billRepository.findByBillId(bill.getBillId());
        if (existingBill.isPresent()) {
            System.out.println("[SYNC] Bill already exists: " + bill.getBillId());
            return bill.getBillId();
        }
        // Create new bill
        Bill savedBill = billService.createBill(bill, locale);
        System.out.println("[SYNC] Bill synced: " + savedBill.getBillId());
        return savedBill.getBillId();
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\UserService.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.dto.SignupRequest;
import com.smartretail.backend.models.User;
import org.springframework.security.core.userdetails.UserDetailsService;

import java.util.List;

public interface UserService extends UserDetailsService {
    User getUserById(String id);
    User createUser(SignupRequest request);
    List<User> getAllUsers();
    void deleteUser(String id);
    User getUserByEmail(String email);
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\UserServiceImpl.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.dto.SignupRequest;
import com.smartretail.backend.models.User;
import com.smartretail.backend.repository.UserRepository;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.security.core.userdetails.UsernameNotFoundException;
import org.springframework.security.crypto.password.PasswordEncoder;
import org.springframework.stereotype.Service;

import java.util.List;

@Service
public class UserServiceImpl implements UserService {

    private final UserRepository userRepository;
    private final PasswordEncoder passwordEncoder;

    public UserServiceImpl(UserRepository userRepository, PasswordEncoder passwordEncoder) {
        this.userRepository = userRepository;
        this.passwordEncoder = passwordEncoder;
    }

    @Override
    public User getUserById(String id) {
        return userRepository.findById(id)
                .orElseThrow(() -> new RuntimeException("User not found: " + id));
    }

    @Override
    public User createUser(SignupRequest request) {
        // Check if user already exists
        if (userRepository.findByEmail(request.getEmail()).isPresent()) {
            throw new RuntimeException("User with this email already exists");
        }

        // Validate that role is provided
        if (request.getRole() == null || request.getRole().trim().isEmpty()) {
            throw new RuntimeException("Role is required");
        }

        // Generate userId
        String userId = "u" + (System.currentTimeMillis() % 10000);

        User user = new User(
                userId,
                request.getEmail(),
                passwordEncoder.encode(request.getPassword()),
                request.getName(),
                request.getRole().toUpperCase() // Convert to uppercase
        );

        return userRepository.save(user);
    }

    @Override
    public List<User> getAllUsers() {
        return userRepository.findAll();
    }

    @Override
    public void deleteUser(String id) {
        if (!userRepository.existsById(id)) {
            throw new RuntimeException("User not found");
        }
        userRepository.deleteById(id);
    }

    @Override
    public User getUserByEmail(String email) {
        return userRepository.findByEmail(email)
                .orElseThrow(() -> new RuntimeException("User not found: " + email));
    }

    @Override
    public UserDetails loadUserByUsername(String email) throws UsernameNotFoundException {
        User user = userRepository.findByEmail(email)
                .orElseThrow(() -> new UsernameNotFoundException("User not found: " + email));
        return org.springframework.security.core.userdetails.User
                .withUsername(user.getEmail())
                .password(user.getPassword())
                .roles(user.getRole())
                .build();
    }
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\backend\src\main\resources
--------------------------------------------------------------------
Contents:
application.properties
messages.properties
messages_hi.properties
messages_mr.properties
messages_te.properties

====================================================================
📄 File: G:\FINALCODE\backend\src\main\resources\application.properties
--------------------------------------------------------------------
spring.application.name=backend
spring.data.mongodb.uri=mongodb+srv://admin:SuperS3cr3tPassword@cluster0.xo5fnfx.mongodb.net/smartretail?retryWrites=true&w=majority&appName=Cluster0

# JWT Config
jwt.secret=7a3f8b2c5d9e1f4a6b8c0d2e5f7a3b9c1d4e6f8a2b5c7d9e0f1a3b5c7d9e1f2a4b6c8d0e2f4a7b9c1d3e5f7a9b1c3d5e7f9a2b4c6d8e0f2a4b6c8d0e2f4a6b8c0d2e4
jwt.expiration=3600000
jwt.refresh.expiration=604800000

# Mongo + Logs
logging.level.org.springframework.data.mongodb=DEBUG
logging.level.com.smartretail.backend=TRACE

# Email Config (Gmail SMTP)
spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.username=<gmail-id>
spring.mail.password=<gmail-app-password>
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true

# Flask
flask.base.url=http://localhost:5001

# Logging
logging.level.org.springframework.web=DEBUG
logging.level.org.springframework.security=DEBUG

# Internationalization
spring.messages.basename=messages
spring.messages.encoding=UTF-8

# VAPID Keys
vapid.public.key=BKpuFUFV1MHiCQvfAp4BkS0MNpH4vKkGVfbx2W6oltrICM2VJlsWyNQnnBlt2pHNM4lP215Wjbee4QBEZ-VBMuk
vapid.private.key=lKNZtclJ29wiW9qObJBNZSVvh0XULEiQGA0nMLR_OnU

spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB
spring.servlet.multipart.enabled=true

# Add these new properties at the end of the file


frontend.base.url=http://localhost:5173

# ... (all your other properties)

# --- REPLACE THESE LINES ---
spring.security.oauth2.client.registration.google.client-id=650352159939-qq7ed3sh35lg74gvb7j8gmv3jvjqqukj.apps.googleusercontent.com
spring.security.oauth2.client.registration.google.client-secret=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
spring.security.oauth2.client.registration.google.scope=openid,email,profile

# This tells Spring where to send the user after the backend is done

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\resources\messages.properties
--------------------------------------------------------------------
# Default English messages
customer.not.found=Customer not found: {0}
customer.exists=Customer already exists: {0}
bill.exists=Bill already exists: {0}
bill.not.found=Bill not found: {0}
product.not.found=Product not found: {0}
product.exists=Product already exists: {0}
product.insufficient.stock=Insufficient stock for product: {0}
product.update.failed=Failed to update product: {0}
product.restock.invalid.quantity=Restock quantity must be positive
product.image.upload.failed=Failed to upload image for product: {0}
success.product.deleted=Product deleted successfully: {0}
error.generic=An unexpected error occurred
bill.created.notification=Thank you for shopping at SmartRetail!\nBill ID: {0}\nTotal: ₹{1}\nView your bill at: {2}
bill.notification.subject=SmartRetail: Bill {0} Confirmation

# Error messages
error.product.not_found=Product not found: {0}
error.bill.not_found=Bill not found: {0}
error.customer.not_found=Customer not found: {0}
error.user.not_found=User not found: {0}
error.invalid_request=Invalid request: {0}
error.email.failed=Failed to send email: {0}
error.product.exists=Product ID already exists: {0}
error.bill.exists=Bill ID already exists: {0}
error.insufficient_stock=Insufficient stock for product: {0}
error.unauthorized=Unauthorized access
error.forbidden=Access forbidden
error.validation=Validation failed: {0}
error.database=Database error: {0}
error.file.upload=File upload failed: {0}
error.payment.failed=Payment failed: {0}
error.customer.exists=Mobile number already exists: {0}

# Add these missing message keys
file.missing=File is missing
file.invalid.format=Invalid file format. Only CSV files are allowed.
product.id.missing=Product ID is missing at row {0}
product.name.missing=Product name is missing at row {0}
product.category.missing=Product category is missing at row {0}
product.price.invalid=Invalid price at row {0}
product.addedBy.missing=Added by field is missing at row {0}
product.date.invalid=Invalid date format for product {0} at row {1}
product.add.failed=Failed to add product {0} at row {1}

bill.items.empty=Items list is empty at row {0} for bill {1}
bill.item.product.missing=Product ID missing in item at row {0} for bill {1}

# Bulk upload messages
file.parse.error=Error parsing CSV file. Please check the file format.
file.empty=CSV file is empty
file.processing.error=Error processing CSV file

bill.id.missing=Bill ID is missing at row {0}
bill.customer.missing=Customer mobile is missing at row {0}
bill.items.missing=Items are missing at row {0}
bill.total.invalid=Invalid total amount at row {0} for bill {1}
bill.addedBy.missing=Added by field is missing at row {0}
bill.items.invalid=Invalid items format at row {0} for bill {1}
bill.date.invalid=Invalid date format at row {0} for bill {1}
bill.skipped=Row {0}: Bill {1} already exists and was skipped
bill.add.failed=Failed to add bill {0} at row {1}
# Service validation messages
bill.addedBy.missing.service=Added by field is required for bill {0}
bill.items.invalid.quantity=Invalid quantity for items in bill {0}
bill.items.invalid.price=Invalid price for items in bill {0}
bill.total.invalid.service=Total amount mismatch for bill {0}

report.date.invalid=Invalid date format: {0}
report.date.range.invalid=Start date {0} must be before end date {1}
report.lowStockThreshold.invalid=Low stock threshold must be positive
report.expiryDays.invalid=Expiry days must be positive
report.no.bills.found=No bills found for the given date range
report.no.products.found=No products found

bill.email.body=Dear Customer,\n\nThank you for your purchase!\n\nBill ID: {0}\nTotal Amount: ₹{1}\n\nPlease find your bill attached.\n\nThank you for shopping with us!\n\nSmartRetail Team

audit.page.invalid=Page must be non-negative
audit.size.invalid=Page size must be positive
audit.no.logs.found=No audit logs found for the given criteria

# Existing messages
customer.mobile.required=Mobile number is required
customer.id.required=Customer ID is required
# New messages for reminders
reminder.no.email=Customer {0} has no email address
reminder.no.purchase.history=Customer {0} has no purchase history
reminder.no.frequent.items=Customer {0} has no frequently purchased items
reminder.subject=Monthly Purchase Reminder from Smart Retail
reminder.body=Dear {0},\n\nWe noticed you frequently purchase the following items:\n{1}\nVisit us to restock your favorites!\n\nBest regards,\nSmart Retail Team

# Existing messages
bill.customer.required=Customer information is required
product.out.of.stock=Product {0} is out of stock

# New messages for sync
sync.bill.duplicate=Bill {0} already exists
sync.product.unchanged=Product {0} has no changes
sync.error.bill=Failed to sync bill {0}: {1}
sync.error.product=Failed to sync product {0}: {1}

# **--- ADD THESE NEW KEYS ---**
# Re-engagement Email Template
re_engagement.subject=We've Missed You at Smart Retail!
re_engagement.body=Dear {0},\n\nIt's been a while since your last purchase, and we miss you!\n\nCome back and check out our latest products and offers.\n\nBest regards,\nThe Smart Retail Team

# PDF Bill Translations
pdf.bill.receiptTitle=Official Receipt
pdf.bill.billId=Bill ID
pdf.bill.customer=Customer
pdf.bill.mobile=Mobile
pdf.bill.product=Product
pdf.bill.qty=Qty
pdf.bill.price=Price
pdf.bill.subtotal=Subtotal
pdf.bill.total=Total

# PDF Report Translations
pdf.report.title=Executive Report
pdf.report.to=to
pdf.report.aiSummary=AI Generated Summary
pdf.report.keyMetrics=Key Metrics
pdf.report.totalRevenue=Total Revenue
pdf.report.totalOrders=Total Orders
pdf.report.productsSold=Products Sold
pdf.report.inventoryAlerts=Inventory Alerts
pdf.report.lowStock=Low Stock Items
pdf.report.expiring=Expiring Soon Items
pdf.report.topProducts=Top Selling Products
pdf.report.productName=Product Name
pdf.report.category=Category
pdf.report.unitsSold=Units Sold
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\resources\messages_hi.properties
--------------------------------------------------------------------
# Default Hindi messages
customer.not.found=ग्राहक नहीं मिला: {0}
customer.exists=ग्राहक पहले से मौजूद है: {0}
bill.exists=बिल पहले से मौजूद है: {0}
bill.not.found=बिल नहीं मिला: {0}
product.not.found=उत्पाद नहीं मिला: {0}
product.exists=उत्पाद पहले से मौजूद है: {0}
product.insufficient.stock=उत्पाद के लिए पर्याप्त स्टॉक नहीं है: {0}
product.update.failed=उत्पाद अपडेट करने में विफल: {0}
product.restock.invalid.quantity=रिस्टॉक मात्रा सकारात्मक होनी चाहिए
product.image.upload.failed=उत्पाद की छवि अपलोड करने में विफल: {0}
success.product.deleted=उत्पाद सफलतापूर्वक हटाया गया: {0}
error.generic=एक अप्रत्याशित त्रुटि हुई
bill.created.notification=SmartRetail पर खरीदारी करने के लिए धन्यवाद!\nबिल आईडी: {0}\nकुल: ₹{1}\nअपना बिल देखें: {2}
bill.notification.subject=SmartRetail: बिल {0} पुष्टिकरण

# Error messages
error.product.not_found=उत्पाद नहीं मिला: {0}
error.bill.not_found=बिल नहीं मिला: {0}
error.customer.not_found=ग्राहक नहीं मिला: {0}
error.user.not_found=उपयोगकर्ता नहीं मिला: {0}
error.invalid_request=अमान्य अनुरोध: {0}
error.email.failed=ईमेल भेजने में विफल: {0}
error.product.exists=उत्पाद आईडी पहले से मौजूद है: {0}
error.bill.exists=बिल आईडी पहले से मौजूद है: {0}
error.insufficient_stock=उत्पाद के लिए पर्याप्त स्टॉक नहीं है: {0}
error.unauthorized=अनधिकृत पहुंच
error.forbidden=पहुंच वर्जित
error.validation=सत्यापन विफल: {0}
error.database=डेटाबेस त्रुटि: {0}
error.file.upload=फ़ाइल अपलोड विफल: {0}
error.payment.failed=भुगतान विफल: {0}
error.customer.exists=मोबाइल नंबर पहले से मौजूद है: {0}

# Add these missing message keys
file.missing=फ़ाइल गुम है
file.invalid.format=अमान्य फ़ाइल प्रारूप। केवल CSV फ़ाइलों की अनुमति है।
product.id.missing=पंक्ति {0} पर उत्पाद आईडी गुम है
product.name.missing=पंक्ति {0} पर उत्पाद नाम गुम है
product.category.missing=पंक्ति {0} पर उत्पाद श्रेणी गुम है
product.price.invalid=पंक्ति {0} पर अमान्य मूल्य
product.addedBy.missing=पंक्ति {0} पर जोड़ने वाला फ़ील्ड गुम है
product.date.invalid=पंक्ति {1} पर उत्पाद {0} के लिए अमान्य तिथि प्रारूप
product.add.failed=पंक्ति {1} पर उत्पाद {0} जोड़ने में विफल

bill.items.empty=बिल {1} के लिए पंक्ति {0} पर आइटम सूची खाली है
bill.item.product.missing=बिल {1} के लिए पंक्ति {0} पर आइटम में उत्पाद आईडी गुम है

# Bulk upload messages
file.parse.error=CSV फ़ाइल पार्स करने में त्रुटि। कृपया फ़ाइल प्रारूप जांचें।
file.empty=CSV फ़ाइल खाली है
file.processing.error=CSV फ़ाइल प्रोसेस करने में त्रुटि

bill.id.missing=पंक्ति {0} पर बिल आईडी गुम है
bill.customer.missing=पंक्ति {0} पर ग्राहक मोबाइल गुम है
bill.items.missing=पंक्ति {0} पर आइटम गुम हैं
bill.total.invalid=बिल {1} के लिए पंक्ति {0} पर अमान्य कुल राशि
bill.addedBy.missing=पंक्ति {0} पर जोड़ने वाला फ़ील्ड गुम है
bill.items.invalid=बिल {1} के लिए पंक्ति {0} पर अमान्य आइटम प्रारूप
bill.date.invalid=बिल {1} के लिए पंक्ति {0} पर अमान्य तिथि प्रारूप
bill.skipped=पंक्ति {0}: बिल {1} पहले से मौजूद है और छोड़ दिया गया
bill.add.failed=पंक्ति {1} पर बिल {0} जोड़ने में विफल
# Service validation messages
bill.addedBy.missing.service=बिल {0} के लिए जोड़ने वाला फ़ील्ड आवश्यक है
bill.items.invalid.quantity=बिल {0} के लिए आइटम की अमान्य मात्रा
bill.items.invalid.price=बिल {0} के लिए आइटम की अमान्य कीमत
bill.total.invalid.service=बिल {0} के लिए कुल राशि असंगत

report.date.invalid=अमान्य तिथि प्रारूप: {0}
report.date.range.invalid=प्रारंभ तिथि {0} अंत तिथि {1} से पहले होनी चाहिए
report.lowStockThreshold.invalid=कम स्टॉक सीमा सकारात्मक होनी चाहिए
report.expiryDays.invalid=समाप्ति दिन सकारात्मक होने चाहिए
report.no.bills.found=दिए गए तिथि सीमा के लिए कोई बिल नहीं मिला
report.no.products.found=कोई उत्पाद नहीं मिला

bill.email.body=प्रिय ग्राहक,\n\nआपकी खरीदारी के लिए धन्यवाद!\n\nबिल आईडी: {0}\nकुल राशि: ₹{1}\n\nकृपया अपना बिल संलग्न पाएं।\n\nहमारे साथ खरीदारी करने के लिए धन्यवाद!\n\nSmartRetail टीम

audit.page.invalid=पृष्ठ गैर-नकारात्मक होना चाहिए
audit.size.invalid=पृष्ठ आकार सकारात्मक होना चाहिए
audit.no.logs.found=दिए गए मानदंडों के लिए कोई ऑडिट लॉग नहीं मिला

# Existing messages
customer.mobile.required=मोबाइल नंबर आवश्यक है
customer.id.required=ग्राहक आईडी आवश्यक है
# New messages for reminders
reminder.no.email=ग्राहक {0} का कोई ईमेल पता नहीं है
reminder.no.purchase.history=ग्राहक {0} का कोई खरीद इतिहास नहीं है
reminder.no.frequent.items=ग्राहक {0} के पास कोई अक्सर खरीदे जाने वाले आइटम नहीं हैं
reminder.subject=Smart Retail से मासिक खरीद अनुस्मारक
reminder.body=प्रिय {0},\n\nहमने देखा कि आप निम्नलिखित आइटम अक्सर खरीदते हैं:\n{1}\nअपने पसंदीदा आइटम फिर से खरीदने के लिए हमें देखें!\n\nसादर,\nSmart Retail टीम

# Existing messages
bill.customer.required=ग्राहक जानकारी आवश्यक है
product.out.of.stock=उत्पाद {0} स्टॉक में नहीं है

# New messages for sync
sync.bill.duplicate=बिल {0} पहले से मौजूद है
sync.product.unchanged=उत्पाद {0} में कोई बदलाव नहीं है
sync.error.bill=बिल {0} सिंक करने में विफल: {1}
sync.error.product=उत्पाद {0} सिंक करने में विफल: {1}

# ... (existing keys)
# Re-engagement Email Template
# ... (existing keys)
# Re-engagement Email Template
re_engagement.subject=Smart Retail ?? ???? ??? ? ??? ??!
re_engagement.body=????? {0},\n\n???? ????? ??????? ?? ??? ??? ??? ?? ??? ??, ?? ???? ???? ??? ? ??? ??!\n\n???? ??? ?? ????? ?? ???????? ?? ?????????? ?? ??????\n\n?????,\n??????? ????? ???
# PDF Bill Translations
pdf.bill.receiptTitle=???????? ????
pdf.bill.billId=??? ????
pdf.bill.customer=??????
pdf.bill.mobile=??????
pdf.bill.product=??????
pdf.bill.qty=??????
pdf.bill.price=?????
pdf.bill.subtotal=??-???
pdf.bill.total=???

# PDF Report Translations
pdf.report.title=????????? ???????
pdf.report.to=??
pdf.report.aiSummary=??? ??????
pdf.report.keyMetrics=?????? ?????????
pdf.report.totalRevenue=??? ??????
pdf.report.totalOrders=??? ?????
pdf.report.productsSold=???? ??????
pdf.report.inventoryAlerts=????????? ?????
pdf.report.lowStock=?? ????? ???? ????
pdf.report.expiring=???? ?? ?????? ???? ???? ????
pdf.report.topProducts=????? ????? ???? ??????
pdf.report.productName=?????? ?? ???
pdf.report.category=??????
pdf.report.unitsSold=???? ?? ???????
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\resources\messages_mr.properties
--------------------------------------------------------------------
# Default Marathi messages
customer.not.found=ग्राहक सापडला नाही: {0}
customer.exists=ग्राहक आधीच अस्तित्वात आहे: {0}
bill.exists=बिल आधीच अस्तित्वात आहे: {0}
bill.not.found=बिल सापडले नाही: {0}
product.not.found=उत्पादन सापडले नाही: {0}
product.exists=उत्पादन आधीच अस्तित्वात आहे: {0}
product.insufficient.stock=उत्पादनासाठी पुरेसा स्टॉक नाही: {0}
product.update.failed=उत्पादन अद्ययावत करण्यात अयशस्वी: {0}
product.restock.invalid.quantity=पुनर्स्टॉक प्रमाण सकारात्मक असणे आवश्यक आहे
product.image.upload.failed=उत्पादनाची प्रतिमा अपलोड करण्यात अयशस्वी: {0}
success.product.deleted=उत्पादन यशस्वीरित्या हटवले: {0}
error.generic=एक अनपेक्षित त्रुटी आली
bill.created.notification=SmartRetail वर खरेदी केल्याबद्दल धन्यवाद!\nबिल आयडी: {0}\nएकूण: ₹{1}\nआपले बिल पहा: {2}
bill.notification.subject=SmartRetail: बिल {0} पुष्टीकरण

# Error messages
error.product.not_found=उत्पादन सापडले नाही: {0}
error.bill.not_found=बिल सापडले नाही: {0}
error.customer.not_found=ग्राहक सापडला नाही: {0}
error.user.not_found=वापरकर्ता सापडला नाही: {0}
error.invalid_request=अवैध विनंती: {0}
error.email.failed=ईमेल पाठविण्यात अयशस्वी: {0}
error.product.exists=उत्पादन आयडी आधीच अस्तित्वात आहे: {0}
error.bill.exists=बिल आयडी आधीच अस्तित्वात आहे: {0}
error.insufficient_stock=उत्पादनासाठी पुरेसा स्टॉक नाही: {0}
error.unauthorized=अनधिकृत प्रवेश
error.forbidden=प्रवेश निषिद्ध
error.validation=सत्यापन अयशस्वी: {0}
error.database=डेटाबेस त्रुटी: {0}
error.file.upload=फाइल अपलोड अयशस्वी: {0}
error.payment.failed=पेमेंट अयशस्वी: {0}
error.customer.exists=मोबाइल नंबर आधीच अस्तित्वात आहे: {0}

# Add these missing message keys
file.missing=फाइल गहाळ आहे
file.invalid.format=अवैध फाइल स्वरूप. केवळ CSV फाइल्स परवानगी आहेत.
product.id.missing=ओळ {0} वर उत्पादन आयडी गहाळ आहे
product.name.missing=ओळ {0} वर उत्पादन नाव गहाळ आहे
product.category.missing=ओळ {0} वर उत्पादन श्रेणी गहाळ आहे
product.price.invalid=ओळ {0} वर अवैध किंमत
product.addedBy.missing=ओळ {0} वर जोडणारा फील्ड गहाळ आहे
product.date.invalid=ओळ {1} वर उत्पादन {0} साठी अवैध तारीख स्वरूप
product.add.failed=ओळ {1} वर उत्पादन {0} जोडण्यात अयशस्वी

bill.items.empty=बिल {1} साठी ओळ {0} वर आयटम यादी रिकामी आहे
bill.item.product.missing=बिल {1} साठी ओळ {0} वर आयटममध्ये उत्पादन आयडी गहाळ आहे

# Bulk upload messages
file.parse.error=CSV फाइल पार्स करताना त्रुटी. कृपया फाइल स्वरूप तपासा.
file.empty=CSV फाइल रिकामी आहे
file.processing.error=CSV फाइल प्रक्रिया करताना त्रुटी

bill.id.missing=ओळ {0} वर बिल आयडी गहाळ आहे
bill.customer.missing=ओळ {0} वर ग्राहक मोबाइल गहाळ आहे
bill.items.missing=ओळ {0} वर आयटम गहाळ आहेत
bill.total.invalid=बिल {1} साठी ओळ {0} वर अवैध एकूण रक्कम
bill.addedBy.missing=ओळ {0} वर जोडणारा फील्ड गहाळ आहे
bill.items.invalid=बिल {1} साठी ओळ {0} वर अवैध आयटम स्वरूप
bill.date.invalid=बिल {1} साठी ओळ {0} वर अवैध तारीख स्वरूप
bill.skipped=ओळ {0}: बिल {1} आधीच अस्तित्वात आहे आणि वगळण्यात आला
bill.add.failed=ओळ {1} वर बिल {0} जोडण्यात अयशस्वी
# Service validation messages
bill.addedBy.missing.service=बिल {0} साठी जोडणारा फील्ड आवश्यक आहे
bill.items.invalid.quantity=बिल {0} साठी आयटमचे अवैध प्रमाण
bill.items.invalid.price=बिल {0} साठी आयटमची अवैध किंमत
bill.total.invalid.service=बिल {0} साठी एकूण रक्कम जुळत नाही

report.date.invalid=अवैध तारीख स्वरूप: {0}
report.date.range.invalid=प्रारंभ तारीख {0} समाप्ती तारीख {1} पूर्वी असणे आवश्यक आहे
report.lowStockThreshold.invalid=कमी स्टॉक उंबरठा सकारात्मक असणे आवश्यक आहे
report.expiryDays.invalid=कालबाह्यता दिवस सकारात्मक असणे आवश्यक आहे
report.no.bills.found=दिलेल्या तारीख श्रेणीसाठी कोणतीही बिले सापडली नाहीत
report.no.products.found=कोणतीही उत्पादने सापडली नाहीत

bill.email.body=प्रिय ग्राहक,\n\nआपल्या खरेदीबद्दल धन्यवाद!\n\nबिल आयडी: {0}\nएकूण रक्कम: ₹{1}\n\nकृपया आपले बिल संलग्न शोधा.\n\nआमच्यासोबत खरेदी केल्याबद्दल धन्यवाद!\n\nSmartRetail संघ

audit.page.invalid=पृष्ठ नकारात्मक नसावे
audit.size.invalid=पृष्ठ आकार सकारात्मक असावा
audit.no.logs.found=दिलेल्या निकषांसाठी कोणेही ऑडिट लॉग सापडले नाहीत

# Existing messages
customer.mobile.required=मोबाइल नंबर आवश्यक आहे
customer.id.required=ग्राहक आयडी आवश्यक आहे
# New messages for reminders
reminder.no.email=ग्राहक {0} कडे ईमेल पत्ता नाही
reminder.no.purchase.history=ग्राहक {0} कडे कोणताही खरेदी इतिहास नाही
reminder.no.frequent.items=ग्राहक {0} कडे वारंवार खरेदी केलेले आयटम नाहीत
reminder.subject=Smart Retail कडून मासिक खरेदी रिमाइंडर
reminder.body=प्रिय {0},\n\nआम्ही पाहिले की आपण खालील आयटम वारंवार खरेदी करता:\n{1}\nआपले आवडते आयटम पुन्हा स्टॉक करण्यासाठी आम्हाला भेट द्या!\n\nशुभेच्छा,\nSmart Retail संघ

# Existing messages
bill.customer.required=ग्राहक माहिती आवश्यक आहे
product.out.of.stock=उत्पादन {0} स्टॉकमध्ये नाही

# New messages for sync
sync.bill.duplicate=बिल {0} आधीच अस्तित्वात आहे
sync.product.unchanged=उत्पादन {0} मध्ये कोणतेही बदल नाहीत
sync.error.bill=बिल {0} सिंक करण्यात अयशस्वी: {1}
sync.error.product=उत्पादन {0} सिंक करण्यात अयशस्वी: {1}

# ... (existing keys)
# Re-engagement Email Template
# ... (existing keys)
# Re-engagement Email Template
re_engagement.subject=Smart Retail ?? ????? ???? ??? ???!
re_engagement.body=????? {0},\n\n??????? ???????? ??????? ???? ??? ???? ???, ??? ??????? ????? ???? ??? ???!\n\n??? ?? ??? ???? ???? ???????? ??? ????? ???.\n\n???????,\n??????? ????? ???
# PDF Bill Translations
pdf.bill.receiptTitle=?????? ?????
pdf.bill.billId=??? ????
pdf.bill.customer=??????
pdf.bill.mobile=??????
pdf.bill.product=???????
pdf.bill.qty=??????
pdf.bill.price=?????
pdf.bill.subtotal=??-????
pdf.bill.total=????

# PDF Report Translations
pdf.report.title=????????? ?????
pdf.report.to=??
pdf.report.aiSummary=AI ?????????? ??????
pdf.report.keyMetrics=?????? ?????????
pdf.report.totalRevenue=???? ?????
pdf.report.totalOrders=???? ???????
pdf.report.productsSold=??????? ????????
pdf.report.inventoryAlerts=??????????? ?????
pdf.report.lowStock=??? ????? ???????? ?????
pdf.report.expiring=????? ???????? ???????? ?????
pdf.report.topProducts=???????? ????? ?????? ????????
pdf.report.productName=?????????? ???
pdf.report.category=??????
pdf.report.unitsSold=??????? ???????
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\resources\messages_te.properties
--------------------------------------------------------------------
# Default Telugu messages
customer.not.found=కస్టమర్ కనుగొనబడలేదు: {0}
customer.exists=కస్టమర్ ఇప్పటికే ఉన్నారు: {0}
bill.exists=బిల్ ఇప్పటికే ఉంది: {0}
bill.not.found=బిల్ కనుగొనబడలేదు: {0}
product.not.found=ఉత్పత్తి కనుగొనబడలేదు: {0}
product.exists=ఉత్పత్తి ఇప్పటికే ఉంది: {0}
product.insufficient.stock=ఉత్పత్తికి తగినంత స్టాక్ లేదు: {0}
product.update.failed=ఉత్పత్తి నవీకరించడం విఫలమైంది: {0}
product.restock.invalid.quantity=రీస్టాక్ పరిమాణం సానుకూలంగా ఉండాలి
product.image.upload.failed=ఉత్పత్తి యొక్క చిత్రం అప్లోడ్ చేయడం విఫలమైంది: {0}
success.product.deleted=ఉత్పత్తి విజయవంతంగా తొలగించబడింది: {0}
error.generic=ఊహించని లోపం సంభవించింది
bill.created.notification=SmartRetail వద్ద షాపింగ్ చేసినందుకు ధన్యవాదాలు!\nబిల్ ID: {0}\nమొత్తం: ₹{1}\nమీ బిల్ ఇక్కడ వీక్షించండి: {2}
bill.notification.subject=SmartRetail: బిల్ {0} ధృవీకరణ

# Error messages
error.product.not_found=ఉత్పత్తి కనుగొనబడలేదు: {0}
error.bill.not_found=బిల్ కనుగొనబడలేదు: {0}
error.customer.not_found=కస్టమర్ కనుగొనబడలేదు: {0}
error.user.not_found=వినియోగదారు కనుగొనబడలేదు: {0}
error.invalid_request=చెల్లని అభ్యర్థన: {0}
error.email.failed=ఇమెయిల్ పంపడం విఫలమైంది: {0}
error.product.exists=ఉత్పత్తి ID ఇప్పటికే ఉంది: {0}
error.bill.exists=బిల్ ID ఇప్పటికే ఉంది: {0}
error.insufficient_stock=ఉత్పత్తికి తగినంత స్టాక్ లేదు: {0}
error.unauthorized=అనధికార ప్రవేశం
error.forbidden=ప్రవేశం నిషేధించబడింది
error.validation=ధృవీకరణ విఫలమైంది: {0}
error.database=డేటాబేస్ లోపం: {0}
error.file.upload=ఫైల్ అప్లోడ్ విఫలమైంది: {0}
error.payment.failed=చెల్లింపు విఫలమైంది: {0}
error.customer.exists=మొబైల్ నంబర్ ఇప్పటికే ఉంది: {0}

# Add these missing message keys
file.missing=ఫైల్ లేదు
file.invalid.format=చెల్లని ఫైల్ ఫార్మాట్. CSV ఫైళ్ళు మాత్రమే అనుమతించబడతాయి.
product.id.missing=వరుస {0} వద్ద ఉత్పత్తి ID లేదు
product.name.missing=వరుస {0} వద్ద ఉత్పత్తి పేరు లేదు
product.category.missing=వరుస {0} వద్ద ఉత్పత్తి వర్గం లేదు
product.price.invalid=వరుస {0} వద్ద చెల్లని ధర
product.addedBy.missing=వరుస {0} వద్ద జోడించినవారి ఫీల్డ్ లేదు
product.date.invalid=వరుస {1} వద్ద ఉత్పత్తి {0} కోసం చెల్లని తేదీ ఫార్మాట్
product.add.failed=వరుస {1} వద్ద ఉత్పత్తి {0} జోడించడం విఫలమైంది

bill.items.empty=బిల్ {1} కోసం వరుస {0} వద్ద ఐటమ్ల జాబితా ఖాళీగా ఉంది
bill.item.product.missing=బిల్ {1} కోసం వరుస {0} వద్ద ఐటమ్లో ఉత్పత్తి ID లేదు

# Bulk upload messages
file.parse.error=CSV ఫైల్ పార్స్ చేయడంలో లోపం. దయచేసి ఫైల్ ఫార్మాట్ తనిఖీ చేయండి.
file.empty=CSV ఫైల్ ఖాళీగా ఉంది
file.processing.error=CSV ఫైల్ ప్రాసెస్ చేయడంలో లోపం

bill.id.missing=వరుస {0} వద్ద బిల్ ID లేదు
bill.customer.missing=వరుస {0} వద్ద కస్టమర్ మొబైల్ లేదు
bill.items.missing=వరుస {0} వద్ద ఐటమ్లు లేవు
bill.total.invalid=బిల్ {1} కోసం వరుస {0} వద్ద చెల్లని మొత్తం అమౌంట్
bill.addedBy.missing=వరుస {0} వద్ద జోడించినవారి ఫీల్డ్ లేదు
bill.items.invalid=బిల్ {1} కోసం వరుస {0} వద్ద చెల్లని ఐటమ్ల ఫార్మాట్
bill.date.invalid=బిల్ {1} కోసం వరుస {0} వద్ద చెల్లని తేదీ ఫార్మాట్
bill.skipped=వరుస {0}: బిల్ {1} ఇప్పటికే ఉంది మరియు దాటవేయబడింది
bill.add.failed=వరుస {1} వద్ద బిల్ {0} జోడించడం విఫలమైంది
# Service validation messages
bill.addedBy.missing.service=బిల్ {0} కోసం జోడించినవారి ఫీల్డ్ అవసరం
bill.items.invalid.quantity=బిల్ {0} కోసం ఐటమ్లలో చెల్లని పరిమాణం
bill.items.invalid.price=బిల్ {0} కోసం ఐటమ్లలో చెల్లని ధర
bill.total.invalid.service=బిల్ {0} కోసం మొత్తం అమౌంట్ సరిపోలడం లేదు

report.date.invalid=చెల్లని తేదీ ఫార్మాట్: {0}
report.date.range.invalid=ప్రారంభ తేదీ {0} ముగింపు తేదీ {1} కంటే ముందు ఉండాలి
report.lowStockThreshold.invalid=తక్కువ స్టాక్ థ్రెషోల్డ్ సానుకూలంగా ఉండాలి
report.expiryDays.invalid=కాలబడ్డ రోజులు సానుకూలంగా ఉండాలి
report.no.bills.found=ఇచ్చిన తేదీ పరిధికి బిల్లులు లేవు
report.no.products.found=ఉత్పత్తులు ఏవీ లేవు

bill.email.body=ప్రియ కస్టమర్,\n\nమీ కొనుగోలుకు ధన్యవాదాలు!\n\nబిల్ ID: {0}\nమొత్తం అమౌంట్: ₹{1}\n\nదయచేసి మీ బిల్ అటాచ్ చేయబడినది.\n\nమాతో షాపింగ్ చేసినందుకు ధన్యవాదాలు!\n\nSmartRetail టీం

audit.page.invalid=పేజీ నాన్-నెగటివ్గా ఉండాలి
audit.size.invalid=పేజీ సైజు పాజిటివ్గా ఉండాలి
audit.no.logs.found=ఇచ్చిన ప్రమాణాలకు ఆడిట్ లాగ్లు ఏవీ లేవు

# Existing messages
customer.mobile.required=మొబైల్ నంబర్ అవసరం
customer.id.required=కస్టమర్ ID అవసరం
# New messages for reminders
reminder.no.email=కస్టమర్ {0}కి ఇమెయిల్ చిరునామా లేదు
reminder.no.purchase.history=కస్టమర్ {0}కి కొనుగోలు చరిత్ర లేదు
reminder.no.frequent.items=కస్టమర్ {0}కి తరచుగా కొనుగోలు చేసిన వస్తువులు లేవు
reminder.subject=Smart Retail నుండి నెలవారీ కొనుగోలు రిమైండర్
reminder.body=ప్రియ {0},\n\nమీరు తరచుగా క్రింది వస్తువులను కొనుగోలు చేస్తున్నట్లు మేము గమనించాము:\n{1}\nమీ ఇష్టమైన వస్తువులను రీస్టాక్ చేయడానికి మాకు సందర్శించండి!\n\nఅభినందనలు,\nSmart Retail టీం

# Existing messages
bill.customer.required=కస్టమర్ సమాచారం అవసరం
product.out.of.stock=ఉత్పత్తి {0} స్టాక్లో లేదు

# New messages for sync
sync.bill.duplicate=బిల్ {0} ఇప్పటికే ఉంది
sync.product.unchanged=ఉత్పత్తి {0}లో మార్పులు లేవు
sync.error.bill=బిల్ {0} సింక్ చేయడం విఫలమైంది: {1}
sync.error.product=ఉత్పత్తి {0} సింక్ చేయడం విఫలమైంది: {1}

# ... (existing keys)
# Re-engagement Email Template
# ... (existing keys)
# Re-engagement Email Template
re_engagement.subject=Smart Retail ????????? ???? ????????!
re_engagement.body=???????? {0},\n\n???? ????????? ???????? ???? ???? ???? ????????, ????? ???? ????????? ???? ???????????!\n\n?????? ????? ?? ???? ?????????? ????? ???????? ??????.\n\n??????????,\n???????? ?????? ?????
# PDF Bill Translations
pdf.bill.receiptTitle=???????? ?????
pdf.bill.billId=???? ID
pdf.bill.customer=???????
pdf.bill.mobile=??????
pdf.bill.product=????????
pdf.bill.qty=???????
pdf.bill.price=??
pdf.bill.subtotal=??-??????
pdf.bill.total=??????

# PDF Report Translations
pdf.report.title=????????????? ???????
pdf.report.to=?????
pdf.report.aiSummary=AI ??????????? ???????
pdf.report.keyMetrics=???? ?????????
pdf.report.totalRevenue=?????? ?????
pdf.report.totalOrders=?????? ????????
pdf.report.productsSold=?????? ??????????
pdf.report.inventoryAlerts=????????? ??????????
pdf.report.lowStock=?????? ?????? ???? ?????????
pdf.report.expiring=?????? ????? ?????? ?????????
pdf.report.topProducts=?????????? ???????? ??????????
pdf.report.productName=???????? ????
pdf.report.category=?????
pdf.report.unitsSold=?????? ????????
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\backend\src\test
--------------------------------------------------------------------
Contents:
java

====================================================================
📁 Directory: G:\FINALCODE\backend\src\test\java
--------------------------------------------------------------------
Contents:
com

====================================================================
📁 Directory: G:\FINALCODE\backend\src\test\java\com
--------------------------------------------------------------------
Contents:
smartretail

====================================================================
📁 Directory: G:\FINALCODE\backend\src\test\java\com\smartretail
--------------------------------------------------------------------
Contents:
backend

====================================================================
📁 Directory: G:\FINALCODE\backend\src\test\java\com\smartretail\backend
--------------------------------------------------------------------
Contents:
BackendApplicationTests.java
controller
service

====================================================================
📄 File: G:\FINALCODE\backend\src\test\java\com\smartretail\backend\BackendApplicationTests.java
--------------------------------------------------------------------
package com.smartretail.backend;

import org.junit.jupiter.api.Test;
import org.springframework.boot.test.context.SpringBootTest;

@SpringBootTest
class BackendApplicationTests {

	@Test
	void contextLoads() {
	}

}

--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\backend\src\test\java\com\smartretail\backend\controller
--------------------------------------------------------------------
Contents:
CustomerControllerTest.java
ProductControllerTest.java
ReportControllerTest.java
SyncControllerTest.java

====================================================================
📄 File: G:\FINALCODE\backend\src\test\java\com\smartretail\backend\controller\CustomerControllerTest.java
--------------------------------------------------------------------
package com.smartretail.backend.controller;

import com.smartretail.backend.models.Bill;
import com.smartretail.backend.models.Customer;
import com.smartretail.backend.service.CustomerService;
import com.smartretail.backend.service.ReminderService;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.junit.jupiter.MockitoExtension;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;

import java.util.Arrays;
import java.util.Date;
import java.util.List;
import java.util.Locale; // --- FIX: Import Locale ---
import java.util.Map;

import static org.junit.jupiter.api.Assertions.*;
import static org.mockito.ArgumentMatchers.*;
import static org.mockito.Mockito.*;

@ExtendWith(MockitoExtension.class)
class CustomerControllerTest {

    @Mock
    private CustomerService customerService;

    @Mock
    private ReminderService reminderService;

    @InjectMocks
    private CustomerController customerController;

    @Test
    void testCreateCustomer_Success() {
        Customer customer = new Customer();
        customer.setId("68d7eb12a2d18777fbd48685");
        customer.setMobile("5554447788");
        customer.setName("Sita");

        // --- FIX: Mock expects a Locale object, not a String "en" ---
        when(customerService.createCustomer(any(Customer.class), eq(new Locale("en")))).thenReturn(customer);
        // --- End Fix ---

        ResponseEntity<Customer> response = customerController.createCustomer(customer, "en");

        assertEquals(HttpStatus.CREATED, response.getStatusCode());
        assertEquals("68d7eb12a2d18777fbd48685", response.getBody().getId());
        
        // --- FIX: Verify with Locale object ---
        verify(customerService).createCustomer(customer, eq(new Locale("en")));
        // --- End Fix ---
    }

    @Test
    void testGetCustomerById_Success() {
        Customer customer = new Customer();
        customer.setId("68d7eb12a2d18777fbd48685");
        customer.setMobile("5554447788");

        // --- FIX: Mock expects a Locale object ---
        when(customerService.getCustomerById("68d7eb12a2d18777fbd48685", eq(new Locale("en")))).thenReturn(customer);
        // --- End Fix ---

        ResponseEntity<Customer> response = customerController.getCustomerById("68d7eb12a2d18777fbd48685", "en");

        assertEquals(HttpStatus.OK, response.getStatusCode());
        assertEquals("68d7eb12a2d18777fbd48685", response.getBody().getId());
        
        // --- FIX: Verify with Locale object ---
        verify(customerService).getCustomerById("68d7eb12a2d18777fbd48685", eq(new Locale("en")));
        // --- End Fix ---
    }

    @Test
    void testGetAllCustomers_Success() {
        Customer customer = new Customer();
        customer.setId("68d7eb12a2d18777fbd48685");
        when(customerService.getAllCustomers()).thenReturn(Arrays.asList(customer));

        ResponseEntity<List<Customer>> response = customerController.getAllCustomers("en");

        assertEquals(HttpStatus.OK, response.getStatusCode());
        assertEquals(1, response.getBody().size());
        verify(customerService).getAllCustomers();
    }

    @Test
    void testUpdateCustomer_Success() {
        Customer customer = new Customer();
        customer.setId("68d7eb12a2d18777fbd48685");
        customer.setMobile("5554447788");

        // --- FIX: Mock expects a Locale object ---
        when(customerService.updateCustomer(eq("68d7eb12a2d18777fbd48685"), any(Customer.class), eq(new Locale("en"))))
                .thenReturn(customer);
        // --- End Fix ---

        ResponseEntity<Customer> response = customerController.updateCustomer("68d7eb12a2d18777fbd48685", customer, "en");

        assertEquals(HttpStatus.OK, response.getStatusCode());
        assertEquals("68d7eb12a2d18777fbd48685", response.getBody().getId());
        
        // --- FIX: Verify with Locale object ---
        verify(customerService).updateCustomer("68d7eb12a2d18777fbd48685", customer, eq(new Locale("en")));
        // --- End Fix ---
    }

    @Test
    void testDeleteCustomer_Success() {
        // --- FIX: Mock expects a Locale object ---
        doNothing().when(customerService).deleteCustomer("68d7eb12a2d18777fbd48685", eq(new Locale("en")));
        // --- End Fix ---

        ResponseEntity<Void> response = customerController.deleteCustomer("68d7eb12a2d18777fbd48685", "en");

        assertEquals(HttpStatus.NO_CONTENT, response.getStatusCode());
        
        // --- FIX: Verify with Locale object ---
        verify(customerService).deleteCustomer("68d7eb12a2d18777fbd48685", eq(new Locale("en")));
        // --- End Fix ---
    }

    @Test
    void testGetCustomerPurchaseHistory_Success() {
        Bill bill1 = new Bill();
        bill1.setBillId("bill001");
        bill1.setTotalAmount(500.0);
        bill1.setCreatedAt(new Date(2025 - 1900, 8, 27, 10, 0, 0));
        Bill.CustomerInfo ci1 = new Bill.CustomerInfo();
        ci1.setMobile("5554447788");
        bill1.setCustomer(ci1);

        Bill bill2 = new Bill();
        bill2.setBillId("bill002");
        bill2.setTotalAmount(300.0);
        bill2.setCreatedAt(new Date(2025 - 1900, 8, 27, 12, 0, 0));
        Bill.CustomerInfo ci2 = new Bill.CustomerInfo();
        ci2.setMobile("5554447788");
        bill2.setCustomer(ci2);

        Bill bill3 = new Bill();
        bill3.setBillId("bill003");
        bill3.setTotalAmount(200.0);
        bill3.setCreatedAt(new Date(2025 - 1900, 8, 27, 15, 0, 0));
        Bill.CustomerInfo ci3 = new Bill.CustomerInfo();
        ci3.setMobile("5554447788");
        bill3.setCustomer(ci3);

        // --- FIX: Mock expects a Locale object ---
        when(customerService.getCustomerPurchaseHistory("68d7eb12a2d18777fbd48685", null, null, eq(new Locale("en"))))
                .thenReturn(Arrays.asList(bill1, bill2, bill3));
        // --- End Fix ---

        ResponseEntity<List<Bill>> response = customerController
                .getCustomerPurchaseHistory("68d7eb12a2d18777fbd48685", null, null, "en");

        assertEquals(HttpStatus.OK, response.getStatusCode());
        assertEquals(3, response.getBody().size());
        assertEquals("bill001", response.getBody().get(0).getBillId());
        
        // --- FIX: Verify with Locale object ---
        verify(customerService).getCustomerPurchaseHistory("68d7eb12a2d18777fbd48685", null, null, eq(new Locale("en")));
        // --- End Fix ---
    }

    @Test
    void testTriggerMonthlyPurchaseReminders_Success() {
        doNothing().when(reminderService).sendMonthlyPurchaseReminders();

        ResponseEntity<Map<String, String>> response = customerController.triggerMonthlyPurchaseReminders("en");

        assertEquals(HttpStatus.OK, response.getStatusCode());
        assertEquals("Monthly purchase reminders triggered successfully", response.getBody().get("message"));
        verify(reminderService).sendMonthlyPurchaseReminders();
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\test\java\com\smartretail\backend\controller\ProductControllerTest.java
--------------------------------------------------------------------
package com.smartretail.backend.controller;

import com.smartretail.backend.models.Product;
import com.smartretail.backend.service.ProductService;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.junit.jupiter.MockitoExtension;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.mock.web.MockMultipartFile;
import org.springframework.web.multipart.MultipartFile;

import java.io.IOException;
import java.util.Locale; // --- FIX: Import Locale ---
import java.util.Map;

import static org.junit.jupiter.api.Assertions.*;
import static org.mockito.ArgumentMatchers.*;
import static org.mockito.Mockito.*;

@ExtendWith(MockitoExtension.class)
class ProductControllerTest {

    @Mock
    private ProductService productService;

    @InjectMocks
    private ProductController productController;

    // --- FIX: Renamed test method to match controller ---
    @Test
    void testCreateProductMultipart_Success() throws Exception {
        String productJson = """
                {
                    "productId": "p123",
                    "name": "Product A",
                    "category": "Electronics",
                    "price": 299.99,
                    "quantity": 10
                }
                """;

        MultipartFile imageFile = new MockMultipartFile("imageFile", "test.jpg", "image/jpeg", "test".getBytes());

        Product mockProduct = new Product();
        mockProduct.setProductId("p123");
        mockProduct.setName("Product A");
        mockProduct.setPrice(299.99);
        mockProduct.setQuantity(10);

        // --- FIX: Mock expects a Locale object, not a String "en" ---
        when(productService.createProduct(any(Product.class), any(MultipartFile.class), eq(new Locale("en"))))
                .thenReturn(mockProduct);
        // --- End Fix ---

        // --- FIX: Call the correct controller method ---
        ResponseEntity<Map<String, String>> response = productController.createMultipart(productJson, imageFile, "en");
        // --- End Fix ---

        assertEquals(HttpStatus.CREATED, response.getStatusCode());
        assertEquals("Product added successfully", response.getBody().get("message"));
        assertEquals("p123", response.getBody().get("productId"));
        
        // --- FIX: Verify with Locale object ---
        verify(productService, times(1))
                .createProduct(any(Product.class), any(MultipartFile.class), eq(new Locale("en")));
        // --- End Fix ---
    }

    // --- FIX: Renamed test method to match controller ---
    @Test
    void testCreateProductMultipart_NoImage_Success() throws Exception {
        String productJson = """
                {
                    "productId": "p123",
                    "name": "Product A",
                    "category": "Electronics",
                    "price": 299.99,
                    "quantity": 10
                }
                """;

        Product mockProduct = new Product();
        mockProduct.setProductId("p123");
        mockProduct.setName("Product A");
        mockProduct.setPrice(299.99);
        mockProduct.setQuantity(10);

        // --- FIX: Mock expects a Locale object ---
        when(productService.createProduct(any(Product.class), isNull(), eq(new Locale("en"))))
                .thenReturn(mockProduct);
        // --- End Fix ---

        // --- FIX: Call the correct controller method ---
        ResponseEntity<Map<String, String>> response = productController.createMultipart(productJson, null, "en");
        // --- End Fix ---

        assertEquals(HttpStatus.CREATED, response.getStatusCode());
        assertEquals("Product added successfully", response.getBody().get("message"));
        assertEquals("p123", response.getBody().get("productId"));
        
        // --- FIX: Verify with Locale object ---
        verify(productService, times(1))
                .createProduct(any(Product.class), isNull(), eq(new Locale("en")));
        // --- End Fix ---
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\test\java\com\smartretail\backend\controller\ReportControllerTest.java
--------------------------------------------------------------------

package com.smartretail.backend.controller;

import com.smartretail.backend.models.Bill;
import com.smartretail.backend.models.Product;
import com.smartretail.backend.service.ReportService;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.junit.jupiter.MockitoExtension;
import org.springframework.context.MessageSource;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;

import java.text.SimpleDateFormat;
import java.util.*;

import static org.junit.jupiter.api.Assertions.*;
import static org.mockito.ArgumentMatchers.*;
import static org.mockito.Mockito.*;

@ExtendWith(MockitoExtension.class)
class ReportControllerTest {

    @Mock
    private ReportService reportService;

    @Mock
    private MessageSource messageSource;

    @InjectMocks
    private ReportController reportController;

    private final SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd");

    @Test
    void testGetSalesReport_Success() throws Exception {
        // Arrange
        String startDateStr = "2025-09-01";
        String endDateStr = "2025-09-30";
        Date startDate = dateFormat.parse(startDateStr);
        Date endDate = new Date(dateFormat.parse(endDateStr).getTime() + 24 * 60 * 60 * 1000 - 1);

        Map<String, Object> report = new HashMap<>();
        report.put("totalSales", 10000.0);
        report.put("billCount", 50);
        report.put("averageBillAmount", 200.0);
        Bill bill = new Bill();
        bill.setBillId("b123");
        bill.setTotalAmount(200.0);
        bill.setCreatedAt(new Date());
        report.put("bills", List.of(bill));

        when(reportService.getSalesReport(startDate, endDate, Locale.ENGLISH)).thenReturn(report);

        // Act
        ResponseEntity<Map<String, Object>> response = reportController.getSalesReport(startDateStr, endDateStr, Locale.ENGLISH);

        // Assert
        assertEquals(HttpStatus.OK, response.getStatusCode());
        assertEquals(report, response.getBody());
        assertEquals(10000.0, response.getBody().get("totalSales"));
        assertEquals(50, response.getBody().get("billCount"));
        assertEquals(200.0, response.getBody().get("averageBillAmount"));
        assertEquals(1, ((List<?>) response.getBody().get("bills")).size());
        verify(reportService, times(1)).getSalesReport(startDate, endDate, Locale.ENGLISH);
    }

    @Test
    void testGetSalesReport_InvalidDateFormat() {
        // Arrange
        String startDateStr = "2025-13-01"; // Invalid month
        String endDateStr = "2025-09-30";
        when(messageSource.getMessage(eq("report.date.invalid"), any(), eq(Locale.ENGLISH)))
                .thenReturn("Invalid date format: 2025-13-01 or 2025-09-30");

        // Act & Assert
        Exception exception = assertThrows(IllegalArgumentException.class,
                () -> reportController.getSalesReport(startDateStr, endDateStr, Locale.ENGLISH));
        assertEquals("Invalid date format: 2025-13-01 or 2025-09-30", exception.getMessage());
        verify(reportService, never()).getSalesReport(any(), any(), any());
    }

    @Test
    void testGetSalesReport_StartDateAfterEndDate() throws Exception {
        // Arrange
        String startDateStr = "2025-09-30";
        String endDateStr = "2025-09-01";
        Date startDate = dateFormat.parse(startDateStr);
        Date endDate = new Date(dateFormat.parse(endDateStr).getTime() + 24 * 60 * 60 * 1000 - 1);
        when(reportService.getSalesReport(startDate, endDate, Locale.ENGLISH))
                .thenThrow(new IllegalArgumentException("Start date 2025-09-30 must be before end date 2025-09-01"));
        when(messageSource.getMessage(eq("report.date.range.invalid"), any(), eq(Locale.ENGLISH)))
                .thenReturn("Start date 2025-09-30 must be before end date 2025-09-01");

        // Act & Assert
        Exception exception = assertThrows(IllegalArgumentException.class,
                () -> reportController.getSalesReport(startDateStr, endDateStr, Locale.ENGLISH));
        assertEquals("Start date 2025-09-30 must be before end date 2025-09-01", exception.getMessage());
        verify(reportService, times(1)).getSalesReport(startDate, endDate, Locale.ENGLISH);
    }

    @Test
    void testGetSalesReport_NoBillsFound() throws Exception {
        // Arrange
        String startDateStr = "2025-09-01";
        String endDateStr = "2025-09-30";
        Date startDate = dateFormat.parse(startDateStr);
        Date endDate = new Date(dateFormat.parse(endDateStr).getTime() + 24 * 60 * 60 * 1000 - 1);
        Map<String, Object> report = new HashMap<>();
        report.put("totalSales", 0.0);
        report.put("billCount", 0);
        report.put("averageBillAmount", 0.0);
        report.put("bills", Collections.emptyList());
        when(reportService.getSalesReport(startDate, endDate, Locale.ENGLISH)).thenReturn(report);

        // Act
        ResponseEntity<Map<String, Object>> response = reportController.getSalesReport(startDateStr, endDateStr, Locale.ENGLISH);

        // Assert
        assertEquals(HttpStatus.OK, response.getStatusCode());
        assertEquals(0.0, response.getBody().get("totalSales"));
        assertEquals(0, response.getBody().get("billCount"));
        assertEquals(0.0, response.getBody().get("averageBillAmount"));
        assertEquals(0, ((List<?>) response.getBody().get("bills")).size());
        verify(reportService, times(1)).getSalesReport(startDate, endDate, Locale.ENGLISH);
    }

    @Test
    void testGetInventoryReport_Success() {
        // Arrange
        int lowStockThreshold = 10;
        int expiryDays = 30;
        Product product = new Product();
        product.setProductId("p123");
        product.setName("Product A");
        product.setQuantity(5);
        product.setExpiryDate(new Date());
        Map<String, Object> report = new HashMap<>();
        report.put("totalProducts", 100);
        report.put("lowStockProducts", List.of(product));
        report.put("expiringProducts", List.of(product));
        report.put("lowStockCount", 1);
        report.put("expiringCount", 1);
        when(reportService.getInventoryReport(lowStockThreshold, expiryDays, Locale.ENGLISH)).thenReturn(report);

        // Act
        ResponseEntity<Map<String, Object>> response = reportController.getInventoryReport(lowStockThreshold, expiryDays, Locale.ENGLISH);

        // Assert
        assertEquals(HttpStatus.OK, response.getStatusCode());
        assertEquals(100, response.getBody().get("totalProducts"));
        assertEquals(1, response.getBody().get("lowStockCount"));
        assertEquals(1, response.getBody().get("expiringCount"));
        assertEquals(1, ((List<?>) response.getBody().get("lowStockProducts")).size());
        assertEquals(1, ((List<?>) response.getBody().get("expiringProducts")).size());
        verify(reportService, times(1)).getInventoryReport(lowStockThreshold, expiryDays, Locale.ENGLISH);
    }

    @Test
    void testGetInventoryReport_NegativeLowStockThreshold() {
        // Arrange
        int lowStockThreshold = -1;
        int expiryDays = 30;
        when(reportService.getInventoryReport(lowStockThreshold, expiryDays, Locale.ENGLISH))
                .thenThrow(new IllegalArgumentException("Low stock threshold must be positive"));
        when(messageSource.getMessage(eq("report.lowStockThreshold.invalid"), any(), eq(Locale.ENGLISH)))
                .thenReturn("Low stock threshold must be positive");

        // Act & Assert
        Exception exception = assertThrows(IllegalArgumentException.class,
                () -> reportController.getInventoryReport(lowStockThreshold, expiryDays, Locale.ENGLISH));
        assertEquals("Low stock threshold must be positive", exception.getMessage());
        verify(reportService, times(1)).getInventoryReport(lowStockThreshold, expiryDays, Locale.ENGLISH);
    }

    @Test
    void testGetInventoryReport_NegativeExpiryDays() {
        // Arrange
        int lowStockThreshold = 10;
        int expiryDays = -1;
        when(reportService.getInventoryReport(lowStockThreshold, expiryDays, Locale.ENGLISH))
                .thenThrow(new IllegalArgumentException("Expiry days must be positive"));
        when(messageSource.getMessage(eq("report.expiryDays.invalid"), any(), eq(Locale.ENGLISH)))
                .thenReturn("Expiry days must be positive");

        // Act & Assert
        Exception exception = assertThrows(IllegalArgumentException.class,
                () -> reportController.getInventoryReport(lowStockThreshold, expiryDays, Locale.ENGLISH));
        assertEquals("Expiry days must be positive", exception.getMessage());
        verify(reportService, times(1)).getInventoryReport(lowStockThreshold, expiryDays, Locale.ENGLISH);
    }

    @Test
    void testGetInventoryReport_NoProductsFound() {
        // Arrange
        int lowStockThreshold = 10;
        int expiryDays = 30;
        when(reportService.getInventoryReport(lowStockThreshold, expiryDays, Locale.ENGLISH))
                .thenThrow(new IllegalArgumentException("No products found"));
        when(messageSource.getMessage(eq("report.no.products.found"), any(), eq(Locale.ENGLISH)))
                .thenReturn("No products found");

        // Act & Assert
        Exception exception = assertThrows(IllegalArgumentException.class,
                () -> reportController.getInventoryReport(lowStockThreshold, expiryDays, Locale.ENGLISH));
        assertEquals("No products found", exception.getMessage());
        verify(reportService, times(1)).getInventoryReport(lowStockThreshold, expiryDays, Locale.ENGLISH);
    }
}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\test\java\com\smartretail\backend\controller\SyncControllerTest.java
--------------------------------------------------------------------
package com.smartretail.backend.controller;

import com.smartretail.backend.models.Bill;
import com.smartretail.backend.models.Product;
import com.smartretail.backend.service.BillService;
import com.smartretail.backend.service.ProductService;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.junit.jupiter.MockitoExtension;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;

import java.util.Arrays;
import java.util.Date;
import java.util.List;
import java.util.Locale;
import java.util.Map;

import static org.junit.jupiter.api.Assertions.*;
import static org.mockito.ArgumentMatchers.*;
import static org.mockito.Mockito.*;

@ExtendWith(MockitoExtension.class)
class SyncControllerTest {

    @Mock
    private BillService billService;

    @Mock
    private ProductService productService;

    @InjectMocks
    private SyncController syncController;

    private Bill bill;
    private Product product;
    private SyncController.SyncRequest syncRequest;

    @BeforeEach
    void setUp() {
        bill = new Bill();
        bill.setBillId("bill005");
        bill.setTotalAmount(600.0);
        bill.setCreatedAt(new Date());
        Bill.CustomerInfo customerInfo = new Bill.CustomerInfo();
        customerInfo.setMobile("5554447788");
        customerInfo.setEmail("sambhavkumath9753@gmail.com");
        customerInfo.setName("Sambhav");
        bill.setCustomer(customerInfo);
        Bill.BillItem item = new Bill.BillItem();
        item.setProductId("p123");
        item.setProductName("Laptop");
        item.setQty(1);
        item.setPrice(600.0);
        bill.setItems(Arrays.asList(item));

        product = new Product();
        product.setProductId("p123"); // FIXED: Use setProductId instead of setId
        product.setName("Laptop");
        product.setPrice(600.0);
        product.setQuantity(9);

        syncRequest = new SyncController.SyncRequest();
        syncRequest.setBills(Arrays.asList(bill));
        syncRequest.setInventoryUpdates(Arrays.asList(product));
    }

    @Test
    void testSyncPendingData_Success() {
        when(billService.createBill(any(Bill.class), eq(Locale.ENGLISH), eq(true))).thenReturn(bill);
        when(productService.updateProduct(eq("p123"), any(Product.class), eq(Locale.ENGLISH), eq(true))).thenReturn(product);

        ResponseEntity<Map<String, Object>> response = syncController.syncPendingData(syncRequest, Locale.ENGLISH);

        assertEquals(HttpStatus.OK, response.getStatusCode());
        Map<String, Object> body = response.getBody();
        assertEquals(Arrays.asList("bill005"), body.get("processedBills"));
        assertEquals(Arrays.asList("p123"), body.get("processedProducts"));
        assertTrue(((List<?>) body.get("errors")).isEmpty());
        assertEquals("Sync completed successfully", body.get("message"));
        verify(billService).createBill(bill, Locale.ENGLISH, true);
        verify(productService).updateProduct("p123", product, Locale.ENGLISH, true);
    }

    @Test
    void testSyncPendingData_BillDuplicate() {
        when(billService.createBill(any(Bill.class), eq(Locale.ENGLISH), eq(true)))
                .thenThrow(new IllegalArgumentException("Bill bill005 already exists"));
        when(productService.updateProduct(eq("p123"), any(Product.class), eq(Locale.ENGLISH), eq(true))).thenReturn(product);

        ResponseEntity<Map<String, Object>> response = syncController.syncPendingData(syncRequest, Locale.ENGLISH);

        assertEquals(HttpStatus.OK, response.getStatusCode());
        Map<String, Object> body = response.getBody();
        assertTrue(((List<?>) body.get("processedBills")).isEmpty());
        assertEquals(Arrays.asList("p123"), body.get("processedProducts"));
        assertEquals(Arrays.asList("Bill bill005: Bill bill005 already exists"), body.get("errors"));
        assertEquals("Sync completed with errors", body.get("message"));
        verify(billService).createBill(bill, Locale.ENGLISH, true);
        verify(productService).updateProduct("p123", product, Locale.ENGLISH, true);
    }

    @Test
    void testSyncPendingData_ProductError() {
        when(billService.createBill(any(Bill.class), eq(Locale.ENGLISH), eq(true))).thenReturn(bill);
        when(productService.updateProduct(eq("p123"), any(Product.class), eq(Locale.ENGLISH), eq(true)))
                .thenThrow(new IllegalArgumentException("Product p123 not found"));

        ResponseEntity<Map<String, Object>> response = syncController.syncPendingData(syncRequest, Locale.ENGLISH);

        assertEquals(HttpStatus.OK, response.getStatusCode());
        Map<String, Object> body = response.getBody();
        assertEquals(Arrays.asList("bill005"), body.get("processedBills"));
        assertTrue(((List<?>) body.get("processedProducts")).isEmpty());
        assertEquals(Arrays.asList("Product p123: Product p123 not found"), body.get("errors"));
        assertEquals("Sync completed with errors", body.get("message"));
        verify(billService).createBill(bill, Locale.ENGLISH, true);
        verify(productService).updateProduct("p123", product, Locale.ENGLISH, true);
    }

    @Test
    void testSyncPendingData_EmptyRequest() {
        syncRequest.setBills(List.of());
        syncRequest.setInventoryUpdates(List.of());

        ResponseEntity<Map<String, Object>> response = syncController.syncPendingData(syncRequest, Locale.ENGLISH);

        assertEquals(HttpStatus.OK, response.getStatusCode());
        Map<String, Object> body = response.getBody();
        assertTrue(((List<?>) body.get("processedBills")).isEmpty());
        assertTrue(((List<?>) body.get("processedProducts")).isEmpty());
        assertTrue(((List<?>) body.get("errors")).isEmpty());
        assertEquals("Sync completed successfully", body.get("message"));
        verify(billService, never()).createBill(any(), any(), anyBoolean());
        verify(productService, never()).updateProduct(any(), any(), any(), anyBoolean());
    }

    @Test
    void testSyncPendingData_NullLists() {
        syncRequest.setBills(null);
        syncRequest.setInventoryUpdates(null);

        ResponseEntity<Map<String, Object>> response = syncController.syncPendingData(syncRequest, Locale.ENGLISH);

        assertEquals(HttpStatus.OK, response.getStatusCode());
        Map<String, Object> body = response.getBody();
        assertTrue(((List<?>) body.get("processedBills")).isEmpty());
        assertTrue(((List<?>) body.get("processedProducts")).isEmpty());
        assertTrue(((List<?>) body.get("errors")).isEmpty());
        assertEquals("Sync completed successfully", body.get("message"));
        verify(billService, never()).createBill(any(), any(), anyBoolean());
        verify(productService, never()).updateProduct(any(), any(), any(), anyBoolean());
    }
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\backend\src\test\java\com\smartretail\backend\service
--------------------------------------------------------------------
Contents:
BillServiceTest.java
CustomerServiceTest.java
ProductServiceTest.java
ReminderServiceTest.java
ReportServiceTest.java

====================================================================
📄 File: G:\FINALCODE\backend\src\test\java\com\smartretail\backend\service\BillServiceTest.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.models.Bill;
import com.smartretail.backend.models.Customer;
import com.smartretail.backend.models.Product;
import com.smartretail.backend.repository.BillRepository;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.junit.jupiter.MockitoExtension;
import org.springframework.context.MessageSource;

import java.util.Arrays;
import java.util.Locale;

import static org.junit.jupiter.api.Assertions.*;
import static org.mockito.ArgumentMatchers.any;
import static org.mockito.ArgumentMatchers.anyString;
import static org.mockito.Mockito.*;

@ExtendWith(MockitoExtension.class)
class BillServiceTest {

    @Mock
    private BillRepository billRepository;
    @Mock
    private CustomerService customerService;
    @Mock
    private ProductService productService;
    @Mock
    private NotificationService notificationService;
    @Mock
    private MessageSource messageSource;

    @InjectMocks
    private BillServiceImpl billService;

    private Bill bill;
    private Bill.BillItem item1;
    private Bill.BillItem item2;
    private Product product1;
    private Product product2;
    private Customer customer;

    @BeforeEach
    void setUp() {
        // Setup test data
        bill = new Bill();
        bill.setBillId("b12345678");
        bill.setAddedBy("manager@shop.com");

        // Create customer info
        Bill.CustomerInfo customerInfo = new Bill.CustomerInfo();
        customerInfo.setMobile("1234567890");
        bill.setCustomer(customerInfo);

        // Create bill items
        item1 = new Bill.BillItem();
        item1.setProductId("p12345678");
        item1.setQty(2);

        item2 = new Bill.BillItem();
        item2.setProductId("p98765432");
        item2.setQty(1);

        bill.setItems(Arrays.asList(item1, item2));

        // Create products
        product1 = new Product();
        product1.setProductId("p12345678");
        product1.setPrice(999.99);
        product1.setQuantity(10);

        product2 = new Product();
        product2.setProductId("p98765432");
        product2.setPrice(49.99);
        product2.setQuantity(5);

        // Create customer
        customer = new Customer();
        customer.setMobile("1234567890");
        customer.setName("Test Customer");
        customer.setEmail("test@customer.com");
    }

    @Test
    void testCreateBill_DuplicateBillId_ThrowsException() {
        // Given
        when(billRepository.existsByBillId("b12345678")).thenReturn(true);
        when(messageSource.getMessage("bill.exists", new Object[]{"b12345678"}, Locale.ENGLISH))
                .thenReturn("Bill already exists: b12345678");

        // When & Then
        RuntimeException exception = assertThrows(RuntimeException.class, () -> {
            billService.createBill(bill, Locale.ENGLISH);
        });

        assertEquals("Bill already exists: b12345678", exception.getMessage());
        verify(billRepository, times(1)).existsByBillId("b12345678");
        verify(billRepository, never()).save(any(Bill.class));
    }

    @Test
    void testCreateBill_MissingAddedBy_ThrowsException() {
        // Given
        bill.setAddedBy(null);
        when(billRepository.existsByBillId("b12345678")).thenReturn(false);
        when(messageSource.getMessage("bill.addedBy.missing.service", new Object[]{"b12345678"}, Locale.ENGLISH))
                .thenReturn("Added by field is required for bill: b12345678");

        // When & Then
        RuntimeException exception = assertThrows(RuntimeException.class, () -> {
            billService.createBill(bill, Locale.ENGLISH);
        });

        assertEquals("Added by field is required for bill: b12345678", exception.getMessage());
        verify(billRepository, times(1)).existsByBillId("b12345678");
        verify(billRepository, never()).save(any(Bill.class));
    }

    @Test
    void testCreateBill_InvalidQuantity_ThrowsException() {
        // Given
        item1.setQty(0); // Invalid quantity
        when(billRepository.existsByBillId("b12345678")).thenReturn(false);
        when(productService.getProductById("p12345678", Locale.ENGLISH)).thenReturn(product1);
        when(messageSource.getMessage("bill.items.invalid.quantity", new Object[]{"b12345678"}, Locale.ENGLISH))
                .thenReturn("Invalid quantity for items in bill: b12345678");

        // When & Then
        RuntimeException exception = assertThrows(RuntimeException.class, () -> {
            billService.createBill(bill, Locale.ENGLISH);
        });

        assertEquals("Invalid quantity for items in bill: b12345678", exception.getMessage());
        verify(productService, times(1)).getProductById("p12345678", Locale.ENGLISH);
        verify(billRepository, never()).save(any(Bill.class));
    }

    @Test
    void testCreateBill_InvalidProductPrice_ThrowsException() {
        // Given
        product1.setPrice(0); // Invalid price
        when(billRepository.existsByBillId("b12345678")).thenReturn(false);
        when(productService.getProductById("p12345678", Locale.ENGLISH)).thenReturn(product1);
        when(messageSource.getMessage("bill.items.invalid.price", new Object[]{"b12345678"}, Locale.ENGLISH))
                .thenReturn("Invalid price for items in bill: b12345678");

        // When & Then
        RuntimeException exception = assertThrows(RuntimeException.class, () -> {
            billService.createBill(bill, Locale.ENGLISH);
        });

        assertEquals("Invalid price for items in bill: b12345678", exception.getMessage());
        verify(productService, times(1)).getProductById("p12345678", Locale.ENGLISH);
        verify(billRepository, never()).save(any(Bill.class));
    }

    @Test
    void testCreateBill_Success() {
        // Given
        when(billRepository.existsByBillId("b12345678")).thenReturn(false);
        when(productService.getProductById("p12345678", Locale.ENGLISH)).thenReturn(product1);
        when(productService.getProductById("p98765432", Locale.ENGLISH)).thenReturn(product2);
        when(customerService.findOrCreateCustomer(any(Bill.CustomerInfo.class), eq(Locale.ENGLISH))).thenReturn(customer);
        when(billRepository.save(any(Bill.class))).thenReturn(bill);

        // When
        Bill result = billService.createBill(bill, Locale.ENGLISH);

        // Then
        assertNotNull(result);
        assertEquals("b12345678", result.getBillId());

        // Verify total amount calculation: (999.99 * 2) + (49.99 * 1) = 1999.98 + 49.99 = 2049.97
        assertEquals(2049.97, result.getTotalAmount(), 0.01);

        verify(billRepository, times(1)).existsByBillId("b12345678");
        verify(productService, times(1)).getProductById("p12345678", Locale.ENGLISH);
        verify(productService, times(1)).getProductById("p98765432", Locale.ENGLISH);
        verify(productService, times(1)).updateProductQuantity("p12345678", 2, Locale.ENGLISH);
        verify(productService, times(1)).updateProductQuantity("p98765432", 1, Locale.ENGLISH);
        verify(customerService, times(1)).findOrCreateCustomer(any(Bill.CustomerInfo.class), eq(Locale.ENGLISH));
        verify(customerService, times(1)).addBillId("1234567890", "b12345678");
        verify(billRepository, times(1)).save(any(Bill.class));
    }

    @Test
    void testCreateBill_WithoutCustomer_Success() {
        // Given
        bill.setCustomer(null); // No customer
        when(billRepository.existsByBillId("b12345678")).thenReturn(false);
        when(productService.getProductById("p12345678", Locale.ENGLISH)).thenReturn(product1);
        when(productService.getProductById("p98765432", Locale.ENGLISH)).thenReturn(product2);
        when(billRepository.save(any(Bill.class))).thenReturn(bill);

        // When
        Bill result = billService.createBill(bill, Locale.ENGLISH);

        // Then
        assertNotNull(result);
        assertEquals("b12345678", result.getBillId());

        // Customer service should not be called when there's no customer
        verify(customerService, never()).findOrCreateCustomer(any(), any());
        verify(customerService, never()).addBillId(anyString(), anyString());

        verify(billRepository, times(1)).save(any(Bill.class));
    }

    @Test
    void testCreateBill_ProductNotFound_ThrowsException() {
        // Given
        when(billRepository.existsByBillId("b12345678")).thenReturn(false);
        when(productService.getProductById("p12345678", Locale.ENGLISH))
                .thenThrow(new RuntimeException("Product not found"));

        // When & Then
        RuntimeException exception = assertThrows(RuntimeException.class, () -> {
            billService.createBill(bill, Locale.ENGLISH);
        });

        assertEquals("Product not found", exception.getMessage());
        verify(productService, times(1)).getProductById("p12345678", Locale.ENGLISH);
        verify(billRepository, never()).save(any(Bill.class));
    }
    @Test
    void testGetBillById_NotFound_ThrowsException() {
        when(billRepository.findByBillId("nonexistent")).thenReturn(java.util.Optional.empty());
        when(messageSource.getMessage("bill.not.found", new Object[]{"nonexistent"}, Locale.ENGLISH))
                .thenReturn("Bill not found: nonexistent");

        RuntimeException exception = assertThrows(RuntimeException.class, () -> {
            billService.getBillById("nonexistent", Locale.ENGLISH);
        });

        assertEquals("Bill not found: nonexistent", exception.getMessage());
    }

    @Test
    void testExistsByBillId() {
        when(billRepository.existsByBillId("b12345678")).thenReturn(true);

        boolean exists = billService.existsByBillId("b12345678");

        assertTrue(exists);
        verify(billRepository, times(1)).existsByBillId("b12345678");
    }

    @Test
    void testValidatePdfAccessToken_ValidToken() {
        Bill bill = new Bill();
        bill.setPdfAccessToken("valid-token");

        when(billRepository.findByBillId("b12345678")).thenReturn(java.util.Optional.of(bill));

        boolean isValid = billService.validatePdfAccessToken("b12345678", "valid-token");

        assertTrue(isValid);
    }

    @Test
    void testValidatePdfAccessToken_InvalidToken() {
        Bill bill = new Bill();
        bill.setPdfAccessToken("valid-token");

        when(billRepository.findByBillId("b12345678")).thenReturn(java.util.Optional.of(bill));

        boolean isValid = billService.validatePdfAccessToken("b12345678", "invalid-token");

        assertFalse(isValid);
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\test\java\com\smartretail\backend\service\CustomerServiceTest.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.models.Bill;
import com.smartretail.backend.models.Customer;
import com.smartretail.backend.repository.BillRepository;
import com.smartretail.backend.repository.CustomerRepository;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.junit.jupiter.MockitoExtension;
import org.springframework.context.MessageSource;

import java.util.Arrays;
import java.util.Date;
import java.util.List;
import java.util.Locale;
import java.util.Optional;
import java.util.*;

import static org.junit.jupiter.api.Assertions.*;
import static org.mockito.ArgumentMatchers.*;
import static org.mockito.Mockito.*;

@ExtendWith(MockitoExtension.class)
class CustomerServiceTest {

    @Mock
    private CustomerRepository customerRepository;

    @Mock
    private BillRepository billRepository;

    @Mock
    private MessageSource messageSource;

    @InjectMocks
    private CustomerServiceImpl customerService;

    private Customer customer;
    private Bill.CustomerInfo customerInfo;
    private Locale locale;
    private Bill bill1;
    private Bill bill2;
    private Bill bill3;

    @BeforeEach
    void setUp() {
        locale = Locale.forLanguageTag("en");

        customer = new Customer();
        customer.setId("68d7eb12a2d18777fbd48685");
        customer.setName("Sita");
        customer.setEmail("sita@gmail.com");
        customer.setMobile("5554447788");
        customer.setCreatedAt(new Date());
        customer.setPurchaseHistory(Arrays.asList("bill001", "bill002", "bill003"));

        customerInfo = new Bill.CustomerInfo();
        customerInfo.setName("Sita");
        customerInfo.setEmail("sita@gmail.com");
        customerInfo.setMobile("5554447788");

        bill1 = new Bill();
        bill1.setBillId("bill001");
        bill1.setTotalAmount(500.0);
        bill1.setCreatedAt(new Date(2025 - 1900, 8, 27, 10, 0, 0));
        Bill.CustomerInfo billCustomerInfo1 = new Bill.CustomerInfo();
        billCustomerInfo1.setMobile("5554447788");
        bill1.setCustomer(billCustomerInfo1);

        bill2 = new Bill();
        bill2.setBillId("bill002");
        bill2.setTotalAmount(300.0);
        bill2.setCreatedAt(new Date(2025 - 1900, 8, 27, 12, 0, 0));
        Bill.CustomerInfo billCustomerInfo2 = new Bill.CustomerInfo();
        billCustomerInfo2.setMobile("5554447788");
        bill2.setCustomer(billCustomerInfo2);

        bill3 = new Bill();
        bill3.setBillId("bill003");
        bill3.setTotalAmount(200.0);
        bill3.setCreatedAt(new Date(2025 - 1900, 8, 27, 15, 0, 0));
        Bill.CustomerInfo billCustomerInfo3 = new Bill.CustomerInfo();
        billCustomerInfo3.setMobile("5554447788");
        bill3.setCustomer(billCustomerInfo3);

        when(messageSource.getMessage(eq("customer.exists"), any(), eq(locale)))
                .thenReturn("Customer already exists: 5554447788");
        when(messageSource.getMessage(eq("customer.not.found"), any(), eq(locale)))
                .thenReturn("Customer not found: {0}");
        when(messageSource.getMessage(eq("customer.id.required"), any(), eq(locale)))
                .thenReturn("Customer ID is required");
        when(messageSource.getMessage(eq("report.date.range.invalid"), any(), eq(locale)))
                .thenReturn("Start date {0} must be before end date {1}");
    }

    @Test
    void testCreateCustomerSuccess() {
        when(customerRepository.findByMobile("5554447788")).thenReturn(Optional.empty());
        when(customerRepository.save(any(Customer.class))).thenReturn(customer);

        Customer result = customerService.createCustomer(customer, locale);

        assertNotNull(result);
        assertEquals("Sita", result.getName());
        verify(customerRepository).save(any(Customer.class));
    }

    @Test
    void testCreateCustomerDuplicateMobile() {
        when(customerRepository.findByMobile("5554447788")).thenReturn(Optional.of(customer));

        IllegalArgumentException exception = assertThrows(IllegalArgumentException.class,
                () -> customerService.createCustomer(customer, locale));
        assertEquals("Customer already exists: 5554447788", exception.getMessage());
    }

    @Test
    void testFindOrCreateCustomerExisting() {
        when(customerRepository.findByMobile("5554447788")).thenReturn(Optional.of(customer));
        when(customerRepository.save(any(Customer.class))).thenReturn(customer);

        Customer result = customerService.findOrCreateCustomer(customerInfo, locale);

        assertNotNull(result);
        assertEquals("Sita", result.getName());
        verify(customerRepository).save(customer);
    }

    @Test
    void testFindOrCreateCustomerNew() {
        when(customerRepository.findByMobile("5554447788")).thenReturn(Optional.empty());
        when(customerRepository.save(any(Customer.class))).thenReturn(customer);

        Customer result = customerService.findOrCreateCustomer(customerInfo, locale);

        assertNotNull(result);
        assertEquals("Sita", result.getName());
        verify(customerRepository).save(any(Customer.class));
    }

    @Test
    void testAddBillId() {
        when(customerRepository.findByMobile("5554447788")).thenReturn(Optional.of(customer));
        when(customerRepository.save(any(Customer.class))).thenReturn(customer);

        customerService.addBillId("5554447788", "bill004");

        assertTrue(customer.getPurchaseHistory().contains("bill004"));
        verify(customerRepository).save(customer);
    }

    @Test
    void testAddBillIdCustomerNotFound() {
        when(customerRepository.findByMobile("5554447788")).thenReturn(Optional.empty());
        when(messageSource.getMessage(eq("customer.not.found"), any(), eq(Locale.ENGLISH)))
                .thenReturn("Customer not found: 5554447788");

        IllegalArgumentException exception = assertThrows(IllegalArgumentException.class,
                () -> customerService.addBillId("5554447788", "bill004"));
        assertEquals("Customer not found: 5554447788", exception.getMessage());
    }

    @Test
    void testGetCustomerByIdSuccess() {
        when(customerRepository.findById("68d7eb12a2d18777fbd48685")).thenReturn(Optional.of(customer));

        Customer result = customerService.getCustomerById("68d7eb12a2d18777fbd48685", locale);

        assertNotNull(result);
        assertEquals("Sita", result.getName());
    }

    @Test
    void testGetCustomerByIdNotFound() {
        when(customerRepository.findById("68d7eb12a2d18777fbd48685")).thenReturn(Optional.empty());

        IllegalArgumentException exception = assertThrows(IllegalArgumentException.class,
                () -> customerService.getCustomerById("68d7eb12a2d18777fbd48685", locale));
        assertEquals("Customer not found: 68d7eb12a2d18777fbd48685", exception.getMessage());
    }

    @Test
    void testGetAllCustomers() {
        when(customerRepository.findAll()).thenReturn(Arrays.asList(customer));

        List<Customer> customers = customerService.getAllCustomers();

        assertEquals(1, customers.size());
        assertEquals("Sita", customers.get(0).getName());
    }

    @Test
    void testUpdateCustomerSuccess() {
        Customer updatedData = new Customer();
        updatedData.setName("Sita Updated");
        updatedData.setEmail("sita.updated@gmail.com");
        updatedData.setMobile("5554447789");

        when(customerRepository.findById("68d7eb12a2d18777fbd48685")).thenReturn(Optional.of(customer));
        when(customerRepository.save(any(Customer.class))).thenReturn(customer);

        Customer result = customerService.updateCustomer("68d7eb12a2d18777fbd48685", updatedData, locale);

        assertEquals("Sita Updated", customer.getName());
        assertEquals("sita.updated@gmail.com", customer.getEmail());
        assertEquals("5554447789", customer.getMobile());
        verify(customerRepository).save(customer);
    }

    @Test
    void testUpdateCustomerNotFound() {
        when(customerRepository.findById("68d7eb12a2d18777fbd48685")).thenReturn(Optional.empty());

        IllegalArgumentException exception = assertThrows(IllegalArgumentException.class,
                () -> customerService.updateCustomer("68d7eb12a2d18777fbd48685", customer, locale));
        assertEquals("Customer not found: 68d7eb12a2d18777fbd48685", exception.getMessage());
    }

    @Test
    void testDeleteCustomerSuccess() {
        when(customerRepository.existsById("68d7eb12a2d18777fbd48685")).thenReturn(true);

        customerService.deleteCustomer("68d7eb12a2d18777fbd48685", locale);

        verify(customerRepository).deleteById("68d7eb12a2d18777fbd48685");
    }

    @Test
    void testDeleteCustomerNotFound() {
        when(customerRepository.existsById("68d7eb12a2d18777fbd48685")).thenReturn(false);

        IllegalArgumentException exception = assertThrows(IllegalArgumentException.class,
                () -> customerService.deleteCustomer("68d7eb12a2d18777fbd48685", locale));
        assertEquals("Customer not found: 68d7eb12a2d18777fbd48685", exception.getMessage());
    }

    @Test
    void testGetCustomerPurchaseHistory_Success() {
        when(customerRepository.findById("68d7eb12a2d18777fbd48685")).thenReturn(Optional.of(customer));
        when(billRepository.findAllById(Arrays.asList("bill001", "bill002", "bill003")))
                .thenReturn(Arrays.asList(bill1, bill2, bill3));

        List<Bill> purchaseHistory = customerService.getCustomerPurchaseHistory("68d7eb12a2d18777fbd48685", null, null, locale);

        assertEquals(3, purchaseHistory.size());
        assertEquals("bill001", purchaseHistory.get(0).getBillId());
        assertEquals("bill002", purchaseHistory.get(1).getBillId());
        assertEquals("bill003", purchaseHistory.get(2).getBillId());
        verify(billRepository).findAllById(Arrays.asList("bill001", "bill002", "bill003"));
    }

    @Test
    void testGetCustomerPurchaseHistory_BillNotFound() {
        customer.setPurchaseHistory(Arrays.asList("bill001", "bill002", "bill004"));
        when(customerRepository.findById("68d7eb12a2d18777fbd48685")).thenReturn(Optional.of(customer));
        when(billRepository.findAllById(Arrays.asList("bill001", "bill002", "bill004")))
                .thenReturn(Arrays.asList(bill1, bill2));

        List<Bill> purchaseHistory = customerService.getCustomerPurchaseHistory("68d7eb12a2d18777fbd48685", null, null, locale);

        assertEquals(2, purchaseHistory.size());
        assertEquals("bill001", purchaseHistory.get(0).getBillId());
        assertEquals("bill002", purchaseHistory.get(1).getBillId());
        verify(billRepository).findAllById(Arrays.asList("bill001", "bill002", "bill004"));
    }

    @Test
    void testGetCustomerPurchaseHistory_WithDateRange() {
        Date startDate = new Date(2025 - 1900, 8, 27, 0, 0, 0); // 2025-09-27 00:00:00
        Date endDate = new Date(2025 - 1900, 8, 27, 23, 59, 59); // 2025-09-27 23:59:59
        when(customerRepository.findById("68d7eb12a2d18777fbd48685")).thenReturn(Optional.of(customer));
        when(billRepository.findAllById(Arrays.asList("bill001", "bill002", "bill003")))
                .thenReturn(Arrays.asList(bill1, bill2, bill3));

        List<Bill> purchaseHistory = customerService.getCustomerPurchaseHistory("68d7eb12a2d18777fbd48685", startDate, endDate, locale);

        assertEquals(3, purchaseHistory.size());
        assertEquals("bill001", purchaseHistory.get(0).getBillId());
        assertEquals("bill002", purchaseHistory.get(1).getBillId());
        assertEquals("bill003", purchaseHistory.get(2).getBillId());
        verify(billRepository).findAllById(Arrays.asList("bill001", "bill002", "bill003"));
    }

    @Test
    void testGetCustomerPurchaseHistory_CustomerNotFound() {
        when(customerRepository.findById("68d7eb12a2d18777fbd48685")).thenReturn(Optional.empty());

        IllegalArgumentException exception = assertThrows(IllegalArgumentException.class,
                () -> customerService.getCustomerPurchaseHistory("68d7eb12a2d18777fbd48685", null, null, locale));
        assertEquals("Customer not found: 68d7eb12a2d18777fbd48685", exception.getMessage());
        verify(billRepository, never()).findAllById(any());
    }

    @Test
    void testGetCustomerPurchaseHistory_EmptyPurchaseHistory() {
        customer.setPurchaseHistory(new ArrayList<>());
        when(customerRepository.findById("68d7eb12a2d18777fbd48685")).thenReturn(Optional.of(customer));

        List<Bill> purchaseHistory = customerService.getCustomerPurchaseHistory("68d7eb12a2d18777fbd48685", null, null, locale);

        assertTrue(purchaseHistory.isEmpty());
        verify(billRepository, never()).findAllById(any());
    }

    @Test
    void testGetCustomerPurchaseHistory_InvalidCustomerId() {
        IllegalArgumentException exception = assertThrows(IllegalArgumentException.class,
                () -> customerService.getCustomerPurchaseHistory("", null, null, locale));
        assertEquals("Customer ID is required", exception.getMessage());
        verify(customerRepository, never()).findById(any());
        verify(billRepository, never()).findAllById(any());
    }

    @Test
    void testGetCustomerPurchaseHistory_InvalidDateRange() {
        Date startDate = new Date();
        Date endDate = new Date(startDate.getTime() - 86400000); // Yesterday
        when(customerRepository.findById("68d7eb12a2d18777fbd48685")).thenReturn(Optional.of(customer));

        IllegalArgumentException exception = assertThrows(IllegalArgumentException.class,
                () -> customerService.getCustomerPurchaseHistory("68d7eb12a2d18777fbd48685", startDate, endDate, locale));
        assertEquals("Start date " + startDate + " must be before end date " + endDate, exception.getMessage());
        verify(billRepository, never()).findAllById(any());
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\test\java\com\smartretail\backend\service\ProductServiceTest.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.exception.ProductNotFoundException;
import com.smartretail.backend.models.Product;
import com.smartretail.backend.repository.ProductRepository;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.junit.jupiter.MockitoExtension;
import org.springframework.context.MessageSource;

import java.util.Arrays;
import java.util.Date;
import java.util.List;
import java.util.Locale;
import java.util.Optional;

import static org.junit.jupiter.api.Assertions.*;
import static org.mockito.ArgumentMatchers.*;
import static org.mockito.Mockito.*;

@ExtendWith(MockitoExtension.class)
class ProductServiceTest {

    @Mock
    private ProductRepository productRepository;

    @Mock
    private NotificationService notificationService;

    @Mock
    private FileService fileService;

    @Mock
    private MessageSource messageSource;

    @Mock
    private AuditLogService auditLogService;

    @InjectMocks
    private ProductServiceImpl productService;

    private Product product;
    private Locale locale;

    @BeforeEach
    void setUp() {
        locale = Locale.forLanguageTag("en");

        product = new Product();
        product.setProductId("p12345678");
        product.setName("Laptop");
        product.setCategory("Electronics");
        product.setPrice(999.99);
        product.setQuantity(8);
        product.setReorderLevel(10);
        product.setExpiryDate(null);
        product.setAddedBy("ravi@shop.com");
        product.setLastUpdated(new Date());

        // Mock MessageSource for error messages
        when(messageSource.getMessage(eq("product.exists"), any(), eq(locale)))
                .thenReturn("Product already exists: p12345678");
        when(messageSource.getMessage(eq("product.not.found"), any(), eq(locale)))
                .thenReturn("Product not found: p12345678");
        when(messageSource.getMessage(eq("product.restock.invalid.quantity"), any(), eq(locale)))
                .thenReturn("Restock quantity must be positive");
        when(messageSource.getMessage(eq("product.update.failed"), any(), eq(locale)))
                .thenReturn("Product update failed: p12345678");
    }

    @Test
    void testAddProductSuccess() {
        when(productRepository.existsByProductId("p12345678")).thenReturn(false);
        when(productRepository.save(any(Product.class))).thenReturn(product);

        Product result = productService.createProduct(product, locale);

        assertNotNull(result);
        assertEquals("p12345678", result.getProductId());
        verify(productRepository).save(product);
    }

    @Test
    void testAddProductDuplicateId() {
        when(productRepository.existsByProductId("p12345678")).thenReturn(true);

        RuntimeException exception = assertThrows(RuntimeException.class,
                () -> productService.createProduct(product, locale));
        assertEquals("Product already exists: p12345678", exception.getMessage());
    }

    @Test
    void testGetLowStockProducts() {
        when(productRepository.findLowStockProducts()).thenReturn(Arrays.asList(product));

        List<Product> products = productService.getLowStockProducts();

        assertEquals(1, products.size());
        assertEquals("p12345678", products.get(0).getProductId());
    }

    @Test
    void testGetExpiringProducts() {
        product.setExpiryDate(new Date(System.currentTimeMillis() + 5 * 24 * 60 * 60 * 1000L));
        when(productRepository.findByExpiryDateBefore(any(Date.class))).thenReturn(Arrays.asList(product));

        List<Product> products = productService.getExpiringProducts(
                new Date(System.currentTimeMillis() + 7 * 24 * 60 * 60 * 1000L));

        assertEquals(1, products.size());
        assertEquals("p12345678", products.get(0).getProductId());
    }

    @Test
    void testRestockProductSuccess() {
        when(productRepository.findByProductId("p12345678")).thenReturn(Optional.of(product));
        when(productRepository.save(any(Product.class))).thenReturn(product);

        Product result = productService.restockProduct("p12345678", 5, locale);

        assertEquals(13, result.getQuantity());
        verify(productRepository).save(product);
    }

    @Test
    void testRestockProductInvalidQty() {
        when(productRepository.findByProductId("p12345678")).thenReturn(Optional.of(product));

        RuntimeException exception = assertThrows(RuntimeException.class,
                () -> productService.restockProduct("p12345678", 0, locale));
        assertEquals("Restock quantity must be positive", exception.getMessage());
    }

    @Test
    void testRestockProductNotFound() {
        when(productRepository.findByProductId("p12345678")).thenReturn(Optional.empty());

        ProductNotFoundException exception = assertThrows(ProductNotFoundException.class,
                () -> productService.restockProduct("p12345678", 5, locale));
        assertEquals("Product not found: p12345678", exception.getMessage());
    }

    @Test
    void testGetProductByIdSuccess() {
        when(productRepository.findByProductId("p12345678")).thenReturn(Optional.of(product));

        Product result = productService.getProductById("p12345678", locale);

        assertNotNull(result);
        assertEquals("p12345678", result.getProductId());
    }

    @Test
    void testGetProductByIdNotFound() {
        when(productRepository.findByProductId("p12345678")).thenReturn(Optional.empty());

        ProductNotFoundException exception = assertThrows(ProductNotFoundException.class,
                () -> productService.getProductById("p12345678", locale));
        assertEquals("Product not found: p12345678", exception.getMessage());
    }

    // NEW TESTS FOR SYNC MODE FUNCTIONALITY

    @Test
    void testUpdateProductSyncMode_Success() {
        Product updatedProduct = new Product();
        updatedProduct.setProductId("p12345678");
        updatedProduct.setName("Laptop Pro");
        updatedProduct.setCategory("Electronics");
        updatedProduct.setPrice(1099.99);
        updatedProduct.setQuantity(15);

        when(productRepository.findByProductId("p12345678")).thenReturn(Optional.of(product));
        when(productRepository.save(any(Product.class))).thenReturn(updatedProduct);

        Product result = productService.updateProduct("p12345678", updatedProduct, locale, true);

        assertNotNull(result);
        assertEquals("Laptop Pro", result.getName());
        assertEquals(1099.99, result.getPrice());
        assertEquals(15, result.getQuantity());
        verify(productRepository).save(any(Product.class));
    }

    @Test
    void testUpdateProductSyncMode_Unchanged_SkipsUpdate() {
        Product unchangedProduct = new Product();
        unchangedProduct.setProductId("p12345678");
        unchangedProduct.setName("Laptop");
        unchangedProduct.setCategory("Electronics");
        unchangedProduct.setPrice(999.99);
        unchangedProduct.setQuantity(8);

        when(productRepository.findByProductId("p12345678")).thenReturn(Optional.of(product));

        Product result = productService.updateProduct("p12345678", unchangedProduct, locale, true);

        assertNotNull(result);
        assertEquals("Laptop", result.getName());
        assertEquals(999.99, result.getPrice());
        assertEquals(8, result.getQuantity());
        // Should not save since no changes
        verify(productRepository, never()).save(any(Product.class));
    }

    @Test
    void testUpdateProductSyncMode_NullCategory_Success() {
        Product updatedProduct = new Product();
        updatedProduct.setProductId("p12345678");
        updatedProduct.setName("Laptop");
        updatedProduct.setCategory(null); // Null category
        updatedProduct.setPrice(999.99);
        updatedProduct.setQuantity(10); // Changed quantity

        when(productRepository.findByProductId("p12345678")).thenReturn(Optional.of(product));
        when(productRepository.save(any(Product.class))).thenReturn(updatedProduct);

        Product result = productService.updateProduct("p12345678", updatedProduct, locale, true);

        assertNotNull(result);
        assertEquals(10, result.getQuantity());
        verify(productRepository).save(any(Product.class));
    }

    @Test
    void testUpdateProductSyncMode_ProductNotFound() {
        Product updatedProduct = new Product();
        updatedProduct.setProductId("p12345678");
        updatedProduct.setName("Laptop Pro");

        when(productRepository.findByProductId("p12345678")).thenReturn(Optional.empty());

        assertThrows(RuntimeException.class,
                () -> productService.updateProduct("p12345678", updatedProduct, locale, true));
    }

    @Test
    void testUpdateProductQuantity_Success() {
        when(productRepository.findByProductId("p12345678")).thenReturn(Optional.of(product));
        when(productRepository.save(any(Product.class))).thenReturn(product);

        Product result = productService.updateProductQuantity("p12345678", 3, locale);

        assertEquals(5, result.getQuantity()); // 8 - 3 = 5
        verify(productRepository).save(product);
    }

    @Test
    void testUpdateProductQuantity_InsufficientStock() {
        when(productRepository.findByProductId("p12345678")).thenReturn(Optional.of(product));

        RuntimeException exception = assertThrows(RuntimeException.class,
                () -> productService.updateProductQuantity("p12345678", 10, locale));
        assertTrue(exception.getMessage().contains("p12345678"));
    }

    @Test
    void testUpdateProductQuantity_ProductNotFound() {
        when(productRepository.findByProductId("p12345678")).thenReturn(Optional.empty());

        ProductNotFoundException exception = assertThrows(ProductNotFoundException.class,
                () -> productService.updateProductQuantity("p12345678", 3, locale));
        assertEquals("Product not found: p12345678", exception.getMessage());
    }

    @Test
    void testExistsByProductId_True() {
        when(productRepository.existsByProductId("p12345678")).thenReturn(true);

        boolean exists = productService.existsByProductId("p12345678");

        assertTrue(exists);
        verify(productRepository).existsByProductId("p12345678");
    }

    @Test
    void testExistsByProductId_False() {
        when(productRepository.existsByProductId("p12345678")).thenReturn(false);

        boolean exists = productService.existsByProductId("p12345678");

        assertFalse(exists);
        verify(productRepository).existsByProductId("p12345678");
    }

    @Test
    void testGetAllProducts() {
        when(productRepository.findAll()).thenReturn(Arrays.asList(product));

        List<Product> products = productService.getAllProducts();

        assertEquals(1, products.size());
        assertEquals("p12345678", products.get(0).getProductId());
        verify(productRepository).findAll();
    }

    @Test
    void testDeleteProduct_Success() {
        when(productRepository.findByProductId("p12345678")).thenReturn(Optional.of(product));
        doNothing().when(productRepository).deleteByProductId("p12345678");

        productService.deleteProduct("p12345678", locale);

        verify(productRepository).deleteByProductId("p12345678");
    }

    @Test
    void testDeleteProduct_NotFound() {
        when(productRepository.findByProductId("p12345678")).thenReturn(Optional.empty());

        ProductNotFoundException exception = assertThrows(ProductNotFoundException.class,
                () -> productService.deleteProduct("p12345678", locale));
        assertEquals("Product not found: p12345678", exception.getMessage());
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\test\java\com\smartretail\backend\service\ReminderServiceTest.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.models.Bill;
import com.smartretail.backend.models.Customer;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.junit.jupiter.MockitoExtension;
import org.springframework.context.MessageSource;

import java.util.Arrays;
import java.util.Date;
import java.util.List;
import java.util.Locale;

import static org.mockito.ArgumentMatchers.*;
import static org.mockito.Mockito.*;

@ExtendWith(MockitoExtension.class)
class ReminderServiceTest {

    @Mock
    private CustomerService customerService;

    @Mock
    private NotificationService notificationService;

    @Mock
    private MessageSource messageSource;

    @InjectMocks
    private ReminderService reminderService;

    private Customer customer;
    private Bill bill1;
    private Bill bill2;

    @BeforeEach
    void setUp() {
        customer = new Customer();
        customer.setId("68d7eb12a2d18777fbd48685");
        customer.setName("Sita");
        customer.setEmail("sita@gmail.com");
        customer.setMobile("5554447788");
        customer.setPurchaseHistory(Arrays.asList("bill001", "bill002"));

        bill1 = new Bill();
        bill1.setBillId("bill001");
        bill1.setCreatedAt(new Date());
        Bill.CustomerInfo billCustomerInfo1 = new Bill.CustomerInfo();
        billCustomerInfo1.setMobile("5554447788");
        bill1.setCustomer(billCustomerInfo1);
        Bill.BillItem item1 = new Bill.BillItem();
        item1.setProductName("Laptop");
        item1.setProductId("p123");
        item1.setQty(1);
        item1.setPrice(500.0);
        bill1.setItems(Arrays.asList(item1));

        bill2 = new Bill();
        bill2.setBillId("bill002");
        bill2.setCreatedAt(new Date());
        Bill.CustomerInfo billCustomerInfo2 = new Bill.CustomerInfo();
        billCustomerInfo2.setMobile("5554447788");
        bill2.setCustomer(billCustomerInfo2);
        Bill.BillItem item2 = new Bill.BillItem();
        item2.setProductName("Laptop");
        item2.setProductId("p123");
        item2.setQty(1);
        item2.setPrice(500.0);
        bill2.setItems(Arrays.asList(item2));

        when(customerService.getAllCustomers()).thenReturn(Arrays.asList(customer));
        when(customerService.getCustomerPurchaseHistory(eq("68d7eb12a2d18777fbd48685"), any(), any(), eq(Locale.ENGLISH)))
                .thenReturn(Arrays.asList(bill1, bill2));
        when(messageSource.getMessage(eq("reminder.no.email"), any(), eq(Locale.ENGLISH)))
                .thenReturn("Customer 5554447788 has no email address");
        when(messageSource.getMessage(eq("reminder.no.purchase.history"), any(), eq(Locale.ENGLISH)))
                .thenReturn("Customer 5554447788 has no purchase history");
        when(messageSource.getMessage(eq("reminder.no.frequent.items"), any(), eq(Locale.ENGLISH)))
                .thenReturn("Customer 5554447788 has no frequently purchased items");
        when(messageSource.getMessage(eq("reminder.subject"), any(), eq(Locale.ENGLISH)))
                .thenReturn("Monthly Purchase Reminder from Smart Retail");
        when(messageSource.getMessage(eq("reminder.body"), any(), eq(Locale.ENGLISH)))
                .thenReturn("Dear Sita,\n\nWe noticed you frequently purchase the following items:\nLaptop\nVisit us to restock your favorites!\n\nBest regards,\nSmart Retail Team");
    }

    @Test
    void testSendMonthlyPurchaseReminders_Success() {
        reminderService.sendMonthlyPurchaseReminders();

        verify(customerService).getAllCustomers();
        verify(customerService).getCustomerPurchaseHistory("68d7eb12a2d18777fbd48685", null, null, Locale.ENGLISH);
        verify(notificationService).sendEmail(
                eq("sita@gmail.com"),
                eq("Monthly Purchase Reminder from Smart Retail"),
                contains("Dear Sita,\n\nWe noticed you frequently purchase the following items:\nLaptop\n")
        );
    }

    @Test
    void testSendMonthlyPurchaseReminders_NoEmail() {
        customer.setEmail(null);
        when(customerService.getAllCustomers()).thenReturn(Arrays.asList(customer));

        reminderService.sendMonthlyPurchaseReminders();

        verify(customerService).getAllCustomers();
        verify(customerService, never()).getCustomerPurchaseHistory(anyString(), any(), any(), any());
        verify(notificationService, never()).sendEmail(anyString(), anyString(), anyString());
    }

    @Test
    void testSendMonthlyPurchaseReminders_NoPurchaseHistory() {
        when(customerService.getCustomerPurchaseHistory(eq("68d7eb12a2d18777fbd48685"), any(), any(), eq(Locale.ENGLISH)))
                .thenReturn(List.of());

        reminderService.sendMonthlyPurchaseReminders();

        verify(customerService).getAllCustomers();
        verify(customerService).getCustomerPurchaseHistory("68d7eb12a2d18777fbd48685", null, null, Locale.ENGLISH);
        verify(notificationService, never()).sendEmail(anyString(), anyString(), anyString());
    }

    @Test
    void testSendMonthlyPurchaseReminders_NoFrequentItems() {
        bill2.getItems().get(0).setProductName("Mouse"); // Different product
        when(customerService.getCustomerPurchaseHistory(eq("68d7eb12a2d18777fbd48685"), any(), any(), eq(Locale.ENGLISH)))
                .thenReturn(Arrays.asList(bill1, bill2));

        reminderService.sendMonthlyPurchaseReminders();

        verify(customerService).getAllCustomers();
        verify(customerService).getCustomerPurchaseHistory("68d7eb12a2d18777fbd48685", null, null, Locale.ENGLISH);
        verify(notificationService, never()).sendEmail(anyString(), anyString(), anyString());
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\test\java\com\smartretail\backend\service\ReportServiceTest.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.models.Bill;
import com.smartretail.backend.models.Product;
import com.smartretail.backend.repository.BillRepository;
import com.smartretail.backend.repository.ProductRepository;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.junit.jupiter.MockitoExtension;
import org.springframework.context.MessageSource;
import org.springframework.data.mongodb.core.MongoTemplate;
import org.springframework.data.mongodb.core.aggregation.AggregationResults;

import java.util.*;

import static org.junit.jupiter.api.Assertions.*;
import static org.mockito.ArgumentMatchers.any;
import static org.mockito.Mockito.*;

@ExtendWith(MockitoExtension.class)
class ReportServiceTest {

    @Mock
    private BillRepository billRepository;
    @Mock
    private ProductRepository productRepository;
    @Mock
    private MongoTemplate mongoTemplate;
    @Mock
    private MessageSource messageSource;

    @InjectMocks
    private ReportServiceImpl reportService;

    @Test
    void testGetSalesReport_ValidRange_ReturnsReport() {
        Date startDate = new Date(2025 - 1900, 8, 1);
        Date endDate = new Date(2025 - 1900, 8, 30);
        Map<String, Object> aggregationResult = new HashMap<>();
        aggregationResult.put("totalSales", 5000.0);
        aggregationResult.put("billCount", 10);
        aggregationResult.put("averageBillAmount", 500.0);

        when(mongoTemplate.aggregate(any(), eq("bills"), eq(Map.class)))
                .thenReturn(new AggregationResults<>(List.of(aggregationResult), null));
        when(billRepository.findAll()).thenReturn(List.of(new Bill()));

        Map<String, Object> result = reportService.getSalesReport(startDate, endDate, Locale.ENGLISH);

        assertEquals(5000.0, result.get("totalSales"));
        assertEquals(10, result.get("billCount"));
        assertEquals(500.0, result.get("averageBillAmount"));
        assertFalse(((List<?>) result.get("bills")).isEmpty());
    }

    @Test
    void testGetSalesReport_NoBills_ThrowsException() {
        Date startDate = new Date(2025 - 1900, 8, 1);
        Date endDate = new Date(2025 - 1900, 8, 30);
        when(mongoTemplate.aggregate(any(), eq("bills"), eq(Map.class)))
                .thenReturn(new AggregationResults<>(List.of(), null));
        when(messageSource.getMessage("report.no.bills.found", null, Locale.ENGLISH))
                .thenReturn("No bills found for the given date range");

        IllegalArgumentException exception = assertThrows(IllegalArgumentException.class, () -> {
            reportService.getSalesReport(startDate, endDate, Locale.ENGLISH);
        });

        assertEquals("No bills found for the given date range", exception.getMessage());
    }

    @Test
    void testGetInventoryReport_ValidParams_ReturnsReport() {
        Product product = new Product();
        product.setProductId("p123");
        product.setQuantity(5);
        product.setExpiryDate(new Date(System.currentTimeMillis() + 15 * 24 * 60 * 60 * 1000L)); // 15 days

        when(productRepository.findAll()).thenReturn(List.of(product));

        Map<String, Object> result = reportService.getInventoryReport(10, 30, Locale.ENGLISH);

        assertEquals(1, result.get("totalProducts"));
        assertEquals(1, ((List<?>) result.get("lowStockProducts")).size());
        assertEquals(1, ((List<?>) result.get("expiringProducts")).size());
    }
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend
--------------------------------------------------------------------
Contents:
.gitignore
index.html
node_modules
package.json
package-lock.json
postcss.config.cjs
README.md
src
tailwind.config.js
vite.config.mjs

====================================================================
📄 File: G:\FINALCODE\frontend\.gitignore
--------------------------------------------------------------------

node_modules/

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\index.html
--------------------------------------------------------------------
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Smart Retail - Frontend</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@600;700;800&display=swap" rel="stylesheet">
</head>
<body>
<div id="root"></div>

<script type="module" src="/src/main.jsx"></script>
</body>
</html>
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\package.json
--------------------------------------------------------------------
{
  "name": "smart-retail-frontend",
  "version": "1.0.0",
  "private": true,
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview"
  },
  "dependencies": {
    "axios": "^1.5.0",
    "framer-motion": "^12.23.24",
    "fuse.js": "^7.0.0",
    "i18next": "^25.6.0",
    "jwt-decode": "^3.1.2",
    "react": "^18.2.0",
    "react-countup": "^6.5.3",
    "react-datepicker": "^8.8.0",
    "react-dom": "^18.2.0",
    "react-i18next": "^16.2.4",
    "react-router-dom": "^6.21.3",
    "recharts": "^3.3.0"
  },
  "devDependencies": {
    "@tailwindcss/aspect-ratio": "^0.4.2",
    "@vitejs/plugin-react": "^4.0.0",
    "autoprefixer": "^10.4.14",
    "postcss": "^8.4.24",
    "tailwindcss": "^3.4.12",
    "vite": "^4.5.0"
  },
  "main": "tailwind.config.js",
  "keywords": [],
  "author": "",
  "license": "ISC",
  "description": ""
}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\package-lock.json
--------------------------------------------------------------------
{
  "name": "smart-retail-frontend",
  "version": "1.0.0",
  "lockfileVersion": 3,
  "requires": true,
  "packages": {
    "": {
      "name": "smart-retail-frontend",
      "version": "1.0.0",
      "license": "ISC",
      "dependencies": {
        "axios": "^1.5.0",
        "framer-motion": "^12.23.24",
        "fuse.js": "^7.0.0",
        "i18next": "^25.6.0",
        "jwt-decode": "^3.1.2",
        "react": "^18.2.0",
        "react-countup": "^6.5.3",
        "react-datepicker": "^8.8.0",
        "react-dom": "^18.2.0",
        "react-i18next": "^16.2.4",
        "react-router-dom": "^6.21.3",
        "recharts": "^3.3.0"
      },
      "devDependencies": {
        "@tailwindcss/aspect-ratio": "^0.4.2",
        "@vitejs/plugin-react": "^4.0.0",
        "autoprefixer": "^10.4.14",
        "postcss": "^8.4.24",
        "tailwindcss": "^3.4.12",
        "vite": "^4.5.0"
      }
    },
    "node_modules/@alloc/quick-lru": {
      "version": "5.2.0",
      "resolved": "https://registry.npmjs.org/@alloc/quick-lru/-/quick-lru-5.2.0.tgz",
      "integrity": "sha512-UrcABB+4bUrFABwbluTIBErXwvbsU/V7TZWfmbgJfbkwiBuziS9gxdODUyuiecfdGQ85jglMW6juS3+z5TsKLw==",
      "dev": true,
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/@babel/code-frame": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/code-frame/-/code-frame-7.27.1.tgz",
      "integrity": "sha512-cjQ7ZlQ0Mv3b47hABuTevyTuYN4i+loJKGeV9flcCgIK37cCXRh+L1bd3iBHlynerhQ7BhCkn2BPbQUL+rGqFg==",
      "dev": true,
      "dependencies": {
        "@babel/helper-validator-identifier": "^7.27.1",
        "js-tokens": "^4.0.0",
        "picocolors": "^1.1.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/compat-data": {
      "version": "7.28.5",
      "resolved": "https://registry.npmjs.org/@babel/compat-data/-/compat-data-7.28.5.tgz",
      "integrity": "sha512-6uFXyCayocRbqhZOB+6XcuZbkMNimwfVGFji8CTZnCzOHVGvDqzvitu1re2AU5LROliz7eQPhB8CpAMvnx9EjA==",
      "dev": true,
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/core": {
      "version": "7.28.5",
      "resolved": "https://registry.npmjs.org/@babel/core/-/core-7.28.5.tgz",
      "integrity": "sha512-e7jT4DxYvIDLk1ZHmU/m/mB19rex9sv0c2ftBtjSBv+kVM/902eh0fINUzD7UwLLNR+jU585GxUJ8/EBfAM5fw==",
      "dev": true,
      "dependencies": {
        "@babel/code-frame": "^7.27.1",
        "@babel/generator": "^7.28.5",
        "@babel/helper-compilation-targets": "^7.27.2",
        "@babel/helper-module-transforms": "^7.28.3",
        "@babel/helpers": "^7.28.4",
        "@babel/parser": "^7.28.5",
        "@babel/template": "^7.27.2",
        "@babel/traverse": "^7.28.5",
        "@babel/types": "^7.28.5",
        "@jridgewell/remapping": "^2.3.5",
        "convert-source-map": "^2.0.0",
        "debug": "^4.1.0",
        "gensync": "^1.0.0-beta.2",
        "json5": "^2.2.3",
        "semver": "^6.3.1"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/babel"
      }
    },
    "node_modules/@babel/generator": {
      "version": "7.28.5",
      "resolved": "https://registry.npmjs.org/@babel/generator/-/generator-7.28.5.tgz",
      "integrity": "sha512-3EwLFhZ38J4VyIP6WNtt2kUdW9dokXA9Cr4IVIFHuCpZ3H8/YFOl5JjZHisrn1fATPBmKKqXzDFvh9fUwHz6CQ==",
      "dev": true,
      "dependencies": {
        "@babel/parser": "^7.28.5",
        "@babel/types": "^7.28.5",
        "@jridgewell/gen-mapping": "^0.3.12",
        "@jridgewell/trace-mapping": "^0.3.28",
        "jsesc": "^3.0.2"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-compilation-targets": {
      "version": "7.27.2",
      "resolved": "https://registry.npmjs.org/@babel/helper-compilation-targets/-/helper-compilation-targets-7.27.2.tgz",
      "integrity": "sha512-2+1thGUUWWjLTYTHZWK1n8Yga0ijBz1XAhUXcKy81rd5g6yh7hGqMp45v7cadSbEHc9G3OTv45SyneRN3ps4DQ==",
      "dev": true,
      "dependencies": {
        "@babel/compat-data": "^7.27.2",
        "@babel/helper-validator-option": "^7.27.1",
        "browserslist": "^4.24.0",
        "lru-cache": "^5.1.1",
        "semver": "^6.3.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-compilation-targets/node_modules/lru-cache": {
      "version": "5.1.1",
      "resolved": "https://registry.npmjs.org/lru-cache/-/lru-cache-5.1.1.tgz",
      "integrity": "sha512-KpNARQA3Iwv+jTA0utUVVbrh+Jlrr1Fv0e56GGzAFOXN7dk/FviaDW8LHmK52DlcH4WP2n6gI8vN1aesBFgo9w==",
      "dev": true,
      "dependencies": {
        "yallist": "^3.0.2"
      }
    },
    "node_modules/@babel/helper-globals": {
      "version": "7.28.0",
      "resolved": "https://registry.npmjs.org/@babel/helper-globals/-/helper-globals-7.28.0.tgz",
      "integrity": "sha512-+W6cISkXFa1jXsDEdYA8HeevQT/FULhxzR99pxphltZcVaugps53THCeiWA8SguxxpSp3gKPiuYfSWopkLQ4hw==",
      "dev": true,
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-module-imports": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/helper-module-imports/-/helper-module-imports-7.27.1.tgz",
      "integrity": "sha512-0gSFWUPNXNopqtIPQvlD5WgXYI5GY2kP2cCvoT8kczjbfcfuIljTbcWrulD1CIPIX2gt1wghbDy08yE1p+/r3w==",
      "dev": true,
      "dependencies": {
        "@babel/traverse": "^7.27.1",
        "@babel/types": "^7.27.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-module-transforms": {
      "version": "7.28.3",
      "resolved": "https://registry.npmjs.org/@babel/helper-module-transforms/-/helper-module-transforms-7.28.3.tgz",
      "integrity": "sha512-gytXUbs8k2sXS9PnQptz5o0QnpLL51SwASIORY6XaBKF88nsOT0Zw9szLqlSGQDP/4TljBAD5y98p2U1fqkdsw==",
      "dev": true,
      "dependencies": {
        "@babel/helper-module-imports": "^7.27.1",
        "@babel/helper-validator-identifier": "^7.27.1",
        "@babel/traverse": "^7.28.3"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0"
      }
    },
    "node_modules/@babel/helper-plugin-utils": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/helper-plugin-utils/-/helper-plugin-utils-7.27.1.tgz",
      "integrity": "sha512-1gn1Up5YXka3YYAHGKpbideQ5Yjf1tDa9qYcgysz+cNCXukyLl6DjPXhD3VRwSb8c0J9tA4b2+rHEZtc6R0tlw==",
      "dev": true,
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-string-parser": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/helper-string-parser/-/helper-string-parser-7.27.1.tgz",
      "integrity": "sha512-qMlSxKbpRlAridDExk92nSobyDdpPijUq2DW6oDnUqd0iOGxmQjyqhMIihI9+zv4LPyZdRje2cavWPbCbWm3eA==",
      "dev": true,
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-validator-identifier": {
      "version": "7.28.5",
      "resolved": "https://registry.npmjs.org/@babel/helper-validator-identifier/-/helper-validator-identifier-7.28.5.tgz",
      "integrity": "sha512-qSs4ifwzKJSV39ucNjsvc6WVHs6b7S03sOh2OcHF9UHfVPqWWALUsNUVzhSBiItjRZoLHx7nIarVjqKVusUZ1Q==",
      "dev": true,
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-validator-option": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/helper-validator-option/-/helper-validator-option-7.27.1.tgz",
      "integrity": "sha512-YvjJow9FxbhFFKDSuFnVCe2WxXk1zWc22fFePVNEaWJEu8IrZVlda6N0uHwzZrUM1il7NC9Mlp4MaJYbYd9JSg==",
      "dev": true,
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helpers": {
      "version": "7.28.4",
      "resolved": "https://registry.npmjs.org/@babel/helpers/-/helpers-7.28.4.tgz",
      "integrity": "sha512-HFN59MmQXGHVyYadKLVumYsA9dBFun/ldYxipEjzA4196jpLZd8UjEEBLkbEkvfYreDqJhZxYAWFPtrfhNpj4w==",
      "dev": true,
      "dependencies": {
        "@babel/template": "^7.27.2",
        "@babel/types": "^7.28.4"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/parser": {
      "version": "7.28.5",
      "resolved": "https://registry.npmjs.org/@babel/parser/-/parser-7.28.5.tgz",
      "integrity": "sha512-KKBU1VGYR7ORr3At5HAtUQ+TV3SzRCXmA/8OdDZiLDBIZxVyzXuztPjfLd3BV1PRAQGCMWWSHYhL0F8d5uHBDQ==",
      "dev": true,
      "dependencies": {
        "@babel/types": "^7.28.5"
      },
      "bin": {
        "parser": "bin/babel-parser.js"
      },
      "engines": {
        "node": ">=6.0.0"
      }
    },
    "node_modules/@babel/plugin-transform-react-jsx-self": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/plugin-transform-react-jsx-self/-/plugin-transform-react-jsx-self-7.27.1.tgz",
      "integrity": "sha512-6UzkCs+ejGdZ5mFFC/OCUrv028ab2fp1znZmCZjAOBKiBK2jXD1O+BPSfX8X2qjJ75fZBMSnQn3Rq2mrBJK2mw==",
      "dev": true,
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.27.1"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-transform-react-jsx-source": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/plugin-transform-react-jsx-source/-/plugin-transform-react-jsx-source-7.27.1.tgz",
      "integrity": "sha512-zbwoTsBruTeKB9hSq73ha66iFeJHuaFkUbwvqElnygoNbj/jHRsSeokowZFN3CZ64IvEqcmmkVe89OPXc7ldAw==",
      "dev": true,
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.27.1"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/runtime": {
      "version": "7.28.4",
      "resolved": "https://registry.npmjs.org/@babel/runtime/-/runtime-7.28.4.tgz",
      "integrity": "sha512-Q/N6JNWvIvPnLDvjlE1OUBLPQHH6l3CltCEsHIujp45zQUSSh8K+gHnaEX45yAT1nyngnINhvWtzN+Nb9D8RAQ==",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/template": {
      "version": "7.27.2",
      "resolved": "https://registry.npmjs.org/@babel/template/-/template-7.27.2.tgz",
      "integrity": "sha512-LPDZ85aEJyYSd18/DkjNh4/y1ntkE5KwUHWTiqgRxruuZL2F1yuHligVHLvcHY2vMHXttKFpJn6LwfI7cw7ODw==",
      "dev": true,
      "dependencies": {
        "@babel/code-frame": "^7.27.1",
        "@babel/parser": "^7.27.2",
        "@babel/types": "^7.27.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/traverse": {
      "version": "7.28.5",
      "resolved": "https://registry.npmjs.org/@babel/traverse/-/traverse-7.28.5.tgz",
      "integrity": "sha512-TCCj4t55U90khlYkVV/0TfkJkAkUg3jZFA3Neb7unZT8CPok7iiRfaX0F+WnqWqt7OxhOn0uBKXCw4lbL8W0aQ==",
      "dev": true,
      "dependencies": {
        "@babel/code-frame": "^7.27.1",
        "@babel/generator": "^7.28.5",
        "@babel/helper-globals": "^7.28.0",
        "@babel/parser": "^7.28.5",
        "@babel/template": "^7.27.2",
        "@babel/types": "^7.28.5",
        "debug": "^4.3.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/types": {
      "version": "7.28.5",
      "resolved": "https://registry.npmjs.org/@babel/types/-/types-7.28.5.tgz",
      "integrity": "sha512-qQ5m48eI/MFLQ5PxQj4PFaprjyCTLI37ElWMmNs0K8Lk3dVeOdNpB3ks8jc7yM5CDmVC73eMVk/trk3fgmrUpA==",
      "dev": true,
      "dependencies": {
        "@babel/helper-string-parser": "^7.27.1",
        "@babel/helper-validator-identifier": "^7.28.5"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@esbuild/android-arm": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/android-arm/-/android-arm-0.18.20.tgz",
      "integrity": "sha512-fyi7TDI/ijKKNZTUJAQqiG5T7YjJXgnzkURqmGj13C6dCqckZBLdl4h7bkhHt/t0WP+zO9/zwroDvANaOqO5Sw==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/android-arm64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/android-arm64/-/android-arm64-0.18.20.tgz",
      "integrity": "sha512-Nz4rJcchGDtENV0eMKUNa6L12zz2zBDXuhj/Vjh18zGqB44Bi7MBMSXjgunJgjRhCmKOjnPuZp4Mb6OKqtMHLQ==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/android-x64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/android-x64/-/android-x64-0.18.20.tgz",
      "integrity": "sha512-8GDdlePJA8D6zlZYJV/jnrRAi6rOiNaCC/JclcXpB+KIuvfBN4owLtgzY2bsxnx666XjJx2kDPUmnTtR8qKQUg==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/darwin-arm64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/darwin-arm64/-/darwin-arm64-0.18.20.tgz",
      "integrity": "sha512-bxRHW5kHU38zS2lPTPOyuyTm+S+eobPUnTNkdJEfAddYgEcll4xkT8DB9d2008DtTbl7uJag2HuE5NZAZgnNEA==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/darwin-x64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/darwin-x64/-/darwin-x64-0.18.20.tgz",
      "integrity": "sha512-pc5gxlMDxzm513qPGbCbDukOdsGtKhfxD1zJKXjCCcU7ju50O7MeAZ8c4krSJcOIJGFR+qx21yMMVYwiQvyTyQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/freebsd-arm64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/freebsd-arm64/-/freebsd-arm64-0.18.20.tgz",
      "integrity": "sha512-yqDQHy4QHevpMAaxhhIwYPMv1NECwOvIpGCZkECn8w2WFHXjEwrBn3CeNIYsibZ/iZEUemj++M26W3cNR5h+Tw==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "freebsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/freebsd-x64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/freebsd-x64/-/freebsd-x64-0.18.20.tgz",
      "integrity": "sha512-tgWRPPuQsd3RmBZwarGVHZQvtzfEBOreNuxEMKFcd5DaDn2PbBxfwLcj4+aenoh7ctXcbXmOQIn8HI6mCSw5MQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "freebsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-arm": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-arm/-/linux-arm-0.18.20.tgz",
      "integrity": "sha512-/5bHkMWnq1EgKr1V+Ybz3s1hWXok7mDFUMQ4cG10AfW3wL02PSZi5kFpYKrptDsgb2WAJIvRcDm+qIvXf/apvg==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-arm64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-arm64/-/linux-arm64-0.18.20.tgz",
      "integrity": "sha512-2YbscF+UL7SQAVIpnWvYwM+3LskyDmPhe31pE7/aoTMFKKzIc9lLbyGUpmmb8a8AixOL61sQ/mFh3jEjHYFvdA==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-ia32": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-ia32/-/linux-ia32-0.18.20.tgz",
      "integrity": "sha512-P4etWwq6IsReT0E1KHU40bOnzMHoH73aXp96Fs8TIT6z9Hu8G6+0SHSw9i2isWrD2nbx2qo5yUqACgdfVGx7TA==",
      "cpu": [
        "ia32"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-loong64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-loong64/-/linux-loong64-0.18.20.tgz",
      "integrity": "sha512-nXW8nqBTrOpDLPgPY9uV+/1DjxoQ7DoB2N8eocyq8I9XuqJ7BiAMDMf9n1xZM9TgW0J8zrquIb/A7s3BJv7rjg==",
      "cpu": [
        "loong64"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-mips64el": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-mips64el/-/linux-mips64el-0.18.20.tgz",
      "integrity": "sha512-d5NeaXZcHp8PzYy5VnXV3VSd2D328Zb+9dEq5HE6bw6+N86JVPExrA6O68OPwobntbNJ0pzCpUFZTo3w0GyetQ==",
      "cpu": [
        "mips64el"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-ppc64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-ppc64/-/linux-ppc64-0.18.20.tgz",
      "integrity": "sha512-WHPyeScRNcmANnLQkq6AfyXRFr5D6N2sKgkFo2FqguP44Nw2eyDlbTdZwd9GYk98DZG9QItIiTlFLHJHjxP3FA==",
      "cpu": [
        "ppc64"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-riscv64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-riscv64/-/linux-riscv64-0.18.20.tgz",
      "integrity": "sha512-WSxo6h5ecI5XH34KC7w5veNnKkju3zBRLEQNY7mv5mtBmrP/MjNBCAlsM2u5hDBlS3NGcTQpoBvRzqBcRtpq1A==",
      "cpu": [
        "riscv64"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-s390x": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-s390x/-/linux-s390x-0.18.20.tgz",
      "integrity": "sha512-+8231GMs3mAEth6Ja1iK0a1sQ3ohfcpzpRLH8uuc5/KVDFneH6jtAJLFGafpzpMRO6DzJ6AvXKze9LfFMrIHVQ==",
      "cpu": [
        "s390x"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-x64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-x64/-/linux-x64-0.18.20.tgz",
      "integrity": "sha512-UYqiqemphJcNsFEskc73jQ7B9jgwjWrSayxawS6UVFZGWrAAtkzjxSqnoclCXxWtfwLdzU+vTpcNYhpn43uP1w==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/netbsd-x64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/netbsd-x64/-/netbsd-x64-0.18.20.tgz",
      "integrity": "sha512-iO1c++VP6xUBUmltHZoMtCUdPlnPGdBom6IrO4gyKPFFVBKioIImVooR5I83nTew5UOYrk3gIJhbZh8X44y06A==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "netbsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/openbsd-x64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/openbsd-x64/-/openbsd-x64-0.18.20.tgz",
      "integrity": "sha512-e5e4YSsuQfX4cxcygw/UCPIEP6wbIL+se3sxPdCiMbFLBWu0eiZOJ7WoD+ptCLrmjZBK1Wk7I6D/I3NglUGOxg==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "openbsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/sunos-x64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/sunos-x64/-/sunos-x64-0.18.20.tgz",
      "integrity": "sha512-kDbFRFp0YpTQVVrqUd5FTYmWo45zGaXe0X8E1G/LKFC0v8x0vWrhOWSLITcCn63lmZIxfOMXtCfti/RxN/0wnQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "sunos"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/win32-arm64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-arm64/-/win32-arm64-0.18.20.tgz",
      "integrity": "sha512-ddYFR6ItYgoaq4v4JmQQaAI5s7npztfV4Ag6NrhiaW0RrnOXqBkgwZLofVTlq1daVTQNhtI5oieTvkRPfZrePg==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/win32-ia32": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-ia32/-/win32-ia32-0.18.20.tgz",
      "integrity": "sha512-Wv7QBi3ID/rROT08SABTS7eV4hX26sVduqDOTe1MvGMjNd3EjOz4b7zeexIR62GTIEKrfJXKL9LFxTYgkyeu7g==",
      "cpu": [
        "ia32"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/win32-x64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-x64/-/win32-x64-0.18.20.tgz",
      "integrity": "sha512-kTdfRcSiDfQca/y9QIkng02avJ+NCaQvrMejlsB3RRv5sE9rRoeBPISaZpKxHELzRxZyLvNts1P27W3wV+8geQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@floating-ui/core": {
      "version": "1.7.3",
      "resolved": "https://registry.npmjs.org/@floating-ui/core/-/core-1.7.3.tgz",
      "integrity": "sha512-sGnvb5dmrJaKEZ+LDIpguvdX3bDlEllmv4/ClQ9awcmCZrlx5jQyyMWFM5kBI+EyNOCDDiKk8il0zeuX3Zlg/w==",
      "dependencies": {
        "@floating-ui/utils": "^0.2.10"
      }
    },
    "node_modules/@floating-ui/dom": {
      "version": "1.7.4",
      "resolved": "https://registry.npmjs.org/@floating-ui/dom/-/dom-1.7.4.tgz",
      "integrity": "sha512-OOchDgh4F2CchOX94cRVqhvy7b3AFb+/rQXyswmzmGakRfkMgoWVjfnLWkRirfLEfuD4ysVW16eXzwt3jHIzKA==",
      "dependencies": {
        "@floating-ui/core": "^1.7.3",
        "@floating-ui/utils": "^0.2.10"
      }
    },
    "node_modules/@floating-ui/react": {
      "version": "0.27.16",
      "resolved": "https://registry.npmjs.org/@floating-ui/react/-/react-0.27.16.tgz",
      "integrity": "sha512-9O8N4SeG2z++TSM8QA/KTeKFBVCNEz/AGS7gWPJf6KFRzmRWixFRnCnkPHRDwSVZW6QPDO6uT0P2SpWNKCc9/g==",
      "dependencies": {
        "@floating-ui/react-dom": "^2.1.6",
        "@floating-ui/utils": "^0.2.10",
        "tabbable": "^6.0.0"
      },
      "peerDependencies": {
        "react": ">=17.0.0",
        "react-dom": ">=17.0.0"
      }
    },
    "node_modules/@floating-ui/react-dom": {
      "version": "2.1.6",
      "resolved": "https://registry.npmjs.org/@floating-ui/react-dom/-/react-dom-2.1.6.tgz",
      "integrity": "sha512-4JX6rEatQEvlmgU80wZyq9RT96HZJa88q8hp0pBd+LrczeDI4o6uA2M+uvxngVHo4Ihr8uibXxH6+70zhAFrVw==",
      "dependencies": {
        "@floating-ui/dom": "^1.7.4"
      },
      "peerDependencies": {
        "react": ">=16.8.0",
        "react-dom": ">=16.8.0"
      }
    },
    "node_modules/@floating-ui/utils": {
      "version": "0.2.10",
      "resolved": "https://registry.npmjs.org/@floating-ui/utils/-/utils-0.2.10.tgz",
      "integrity": "sha512-aGTxbpbg8/b5JfU1HXSrbH3wXZuLPJcNEcZQFMxLs3oSzgtVu6nFPkbbGGUvBcUjKV2YyB9Wxxabo+HEH9tcRQ=="
    },
    "node_modules/@isaacs/cliui": {
      "version": "8.0.2",
      "resolved": "https://registry.npmjs.org/@isaacs/cliui/-/cliui-8.0.2.tgz",
      "integrity": "sha512-O8jcjabXaleOG9DQ0+ARXWZBTfnP4WNAqzuiJK7ll44AmxGKv/J2M4TPjxjY3znBCfvBXFzucm1twdyFybFqEA==",
      "dev": true,
      "dependencies": {
        "string-width": "^5.1.2",
        "string-width-cjs": "npm:string-width@^4.2.0",
        "strip-ansi": "^7.0.1",
        "strip-ansi-cjs": "npm:strip-ansi@^6.0.1",
        "wrap-ansi": "^8.1.0",
        "wrap-ansi-cjs": "npm:wrap-ansi@^7.0.0"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@jridgewell/gen-mapping": {
      "version": "0.3.13",
      "resolved": "https://registry.npmjs.org/@jridgewell/gen-mapping/-/gen-mapping-0.3.13.tgz",
      "integrity": "sha512-2kkt/7niJ6MgEPxF0bYdQ6etZaA+fQvDcLKckhy1yIQOzaoKjBBjSj63/aLVjYE3qhRt5dvM+uUyfCg6UKCBbA==",
      "dev": true,
      "dependencies": {
        "@jridgewell/sourcemap-codec": "^1.5.0",
        "@jridgewell/trace-mapping": "^0.3.24"
      }
    },
    "node_modules/@jridgewell/remapping": {
      "version": "2.3.5",
      "resolved": "https://registry.npmjs.org/@jridgewell/remapping/-/remapping-2.3.5.tgz",
      "integrity": "sha512-LI9u/+laYG4Ds1TDKSJW2YPrIlcVYOwi2fUC6xB43lueCjgxV4lffOCZCtYFiH6TNOX+tQKXx97T4IKHbhyHEQ==",
      "dev": true,
      "dependencies": {
        "@jridgewell/gen-mapping": "^0.3.5",
        "@jridgewell/trace-mapping": "^0.3.24"
      }
    },
    "node_modules/@jridgewell/resolve-uri": {
      "version": "3.1.2",
      "resolved": "https://registry.npmjs.org/@jridgewell/resolve-uri/-/resolve-uri-3.1.2.tgz",
      "integrity": "sha512-bRISgCIjP20/tbWSPWMEi54QVPRZExkuD9lJL+UIxUKtwVJA8wW1Trb1jMs1RFXo1CBTNZ/5hpC9QvmKWdopKw==",
      "dev": true,
      "engines": {
        "node": ">=6.0.0"
      }
    },
    "node_modules/@jridgewell/sourcemap-codec": {
      "version": "1.5.5",
      "resolved": "https://registry.npmjs.org/@jridgewell/sourcemap-codec/-/sourcemap-codec-1.5.5.tgz",
      "integrity": "sha512-cYQ9310grqxueWbl+WuIUIaiUaDcj7WOq5fVhEljNVgRfOUhY9fy2zTvfoqWsnebh8Sl70VScFbICvJnLKB0Og==",
      "dev": true
    },
    "node_modules/@jridgewell/trace-mapping": {
      "version": "0.3.31",
      "resolved": "https://registry.npmjs.org/@jridgewell/trace-mapping/-/trace-mapping-0.3.31.tgz",
      "integrity": "sha512-zzNR+SdQSDJzc8joaeP8QQoCQr8NuYx2dIIytl1QeBEZHJ9uW6hebsrYgbz8hJwUQao3TWCMtmfV8Nu1twOLAw==",
      "dev": true,
      "dependencies": {
        "@jridgewell/resolve-uri": "^3.1.0",
        "@jridgewell/sourcemap-codec": "^1.4.14"
      }
    },
    "node_modules/@nodelib/fs.scandir": {
      "version": "2.1.5",
      "resolved": "https://registry.npmjs.org/@nodelib/fs.scandir/-/fs.scandir-2.1.5.tgz",
      "integrity": "sha512-vq24Bq3ym5HEQm2NKCr3yXDwjc7vTsEThRDnkp2DK9p1uqLR+DHurm/NOTo0KG7HYHU7eppKZj3MyqYuMBf62g==",
      "dev": true,
      "dependencies": {
        "@nodelib/fs.stat": "2.0.5",
        "run-parallel": "^1.1.9"
      },
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/@nodelib/fs.stat": {
      "version": "2.0.5",
      "resolved": "https://registry.npmjs.org/@nodelib/fs.stat/-/fs.stat-2.0.5.tgz",
      "integrity": "sha512-RkhPPp2zrqDAQA/2jNhnztcPAlv64XdhIp7a7454A5ovI7Bukxgt7MX7udwAu3zg1DcpPU0rz3VV1SeaqvY4+A==",
      "dev": true,
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/@nodelib/fs.walk": {
      "version": "1.2.8",
      "resolved": "https://registry.npmjs.org/@nodelib/fs.walk/-/fs.walk-1.2.8.tgz",
      "integrity": "sha512-oGB+UxlgWcgQkgwo8GcEGwemoTFt3FIO9ababBmaGwXIoBKZ+GTy0pP185beGg7Llih/NSHSV2XAs1lnznocSg==",
      "dev": true,
      "dependencies": {
        "@nodelib/fs.scandir": "2.1.5",
        "fastq": "^1.6.0"
      },
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/@pkgjs/parseargs": {
      "version": "0.11.0",
      "resolved": "https://registry.npmjs.org/@pkgjs/parseargs/-/parseargs-0.11.0.tgz",
      "integrity": "sha512-+1VkjdD0QBLPodGrJUeqarH8VAIvQODIbwh9XpP5Syisf7YoQgsJKPNFoqqLQlu+VQ/tVSshMR6loPMn8U+dPg==",
      "dev": true,
      "optional": true,
      "engines": {
        "node": ">=14"
      }
    },
    "node_modules/@reduxjs/toolkit": {
      "version": "2.9.2",
      "resolved": "https://registry.npmjs.org/@reduxjs/toolkit/-/toolkit-2.9.2.tgz",
      "integrity": "sha512-ZAYu/NXkl/OhqTz7rfPaAhY0+e8Fr15jqNxte/2exKUxvHyQ/hcqmdekiN1f+Lcw3pE+34FCgX+26zcUE3duCg==",
      "dependencies": {
        "@standard-schema/spec": "^1.0.0",
        "@standard-schema/utils": "^0.3.0",
        "immer": "^10.0.3",
        "redux": "^5.0.1",
        "redux-thunk": "^3.1.0",
        "reselect": "^5.1.0"
      },
      "peerDependencies": {
        "react": "^16.9.0 || ^17.0.0 || ^18 || ^19",
        "react-redux": "^7.2.1 || ^8.1.3 || ^9.0.0"
      },
      "peerDependenciesMeta": {
        "react": {
          "optional": true
        },
        "react-redux": {
          "optional": true
        }
      }
    },
    "node_modules/@remix-run/router": {
      "version": "1.14.2",
      "resolved": "https://registry.npmjs.org/@remix-run/router/-/router-1.14.2.tgz",
      "integrity": "sha512-ACXpdMM9hmKZww21yEqWwiLws/UPLhNKvimN8RrYSqPSvB3ov7sLvAcfvaxePeLvccTQKGdkDIhLYApZVDFuKg==",
      "engines": {
        "node": ">=14.0.0"
      }
    },
    "node_modules/@standard-schema/spec": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/@standard-schema/spec/-/spec-1.0.0.tgz",
      "integrity": "sha512-m2bOd0f2RT9k8QJx1JN85cZYyH1RqFBdlwtkSlf4tBDYLCiiZnv1fIIwacK6cqwXavOydf0NPToMQgpKq+dVlA=="
    },
    "node_modules/@standard-schema/utils": {
      "version": "0.3.0",
      "resolved": "https://registry.npmjs.org/@standard-schema/utils/-/utils-0.3.0.tgz",
      "integrity": "sha512-e7Mew686owMaPJVNNLs55PUvgz371nKgwsc4vxE49zsODpJEnxgxRo2y/OKrqueavXgZNMDVj3DdHFlaSAeU8g=="
    },
    "node_modules/@tailwindcss/aspect-ratio": {
      "version": "0.4.2",
      "resolved": "https://registry.npmjs.org/@tailwindcss/aspect-ratio/-/aspect-ratio-0.4.2.tgz",
      "integrity": "sha512-8QPrypskfBa7QIMuKHg2TA7BqES6vhBrDLOv8Unb6FcFyd3TjKbc6lcmb9UPQHxfl24sXoJ41ux/H7qQQvfaSQ==",
      "dev": true,
      "peerDependencies": {
        "tailwindcss": ">=2.0.0 || >=3.0.0 || >=3.0.0-alpha.1"
      }
    },
    "node_modules/@types/d3-array": {
      "version": "3.2.2",
      "resolved": "https://registry.npmjs.org/@types/d3-array/-/d3-array-3.2.2.tgz",
      "integrity": "sha512-hOLWVbm7uRza0BYXpIIW5pxfrKe0W+D5lrFiAEYR+pb6w3N2SwSMaJbXdUfSEv+dT4MfHBLtn5js0LAWaO6otw=="
    },
    "node_modules/@types/d3-color": {
      "version": "3.1.3",
      "resolved": "https://registry.npmjs.org/@types/d3-color/-/d3-color-3.1.3.tgz",
      "integrity": "sha512-iO90scth9WAbmgv7ogoq57O9YpKmFBbmoEoCHDB2xMBY0+/KVrqAaCDyCE16dUspeOvIxFFRI+0sEtqDqy2b4A=="
    },
    "node_modules/@types/d3-ease": {
      "version": "3.0.2",
      "resolved": "https://registry.npmjs.org/@types/d3-ease/-/d3-ease-3.0.2.tgz",
      "integrity": "sha512-NcV1JjO5oDzoK26oMzbILE6HW7uVXOHLQvHshBUW4UMdZGfiY6v5BeQwh9a9tCzv+CeefZQHJt5SRgK154RtiA=="
    },
    "node_modules/@types/d3-interpolate": {
      "version": "3.0.4",
      "resolved": "https://registry.npmjs.org/@types/d3-interpolate/-/d3-interpolate-3.0.4.tgz",
      "integrity": "sha512-mgLPETlrpVV1YRJIglr4Ez47g7Yxjl1lj7YKsiMCb27VJH9W8NVM6Bb9d8kkpG/uAQS5AmbA48q2IAolKKo1MA==",
      "dependencies": {
        "@types/d3-color": "*"
      }
    },
    "node_modules/@types/d3-path": {
      "version": "3.1.1",
      "resolved": "https://registry.npmjs.org/@types/d3-path/-/d3-path-3.1.1.tgz",
      "integrity": "sha512-VMZBYyQvbGmWyWVea0EHs/BwLgxc+MKi1zLDCONksozI4YJMcTt8ZEuIR4Sb1MMTE8MMW49v0IwI5+b7RmfWlg=="
    },
    "node_modules/@types/d3-scale": {
      "version": "4.0.9",
      "resolved": "https://registry.npmjs.org/@types/d3-scale/-/d3-scale-4.0.9.tgz",
      "integrity": "sha512-dLmtwB8zkAeO/juAMfnV+sItKjlsw2lKdZVVy6LRr0cBmegxSABiLEpGVmSJJ8O08i4+sGR6qQtb6WtuwJdvVw==",
      "dependencies": {
        "@types/d3-time": "*"
      }
    },
    "node_modules/@types/d3-shape": {
      "version": "3.1.7",
      "resolved": "https://registry.npmjs.org/@types/d3-shape/-/d3-shape-3.1.7.tgz",
      "integrity": "sha512-VLvUQ33C+3J+8p+Daf+nYSOsjB4GXp19/S/aGo60m9h1v6XaxjiT82lKVWJCfzhtuZ3yD7i/TPeC/fuKLLOSmg==",
      "dependencies": {
        "@types/d3-path": "*"
      }
    },
    "node_modules/@types/d3-time": {
      "version": "3.0.4",
      "resolved": "https://registry.npmjs.org/@types/d3-time/-/d3-time-3.0.4.tgz",
      "integrity": "sha512-yuzZug1nkAAaBlBBikKZTgzCeA+k1uy4ZFwWANOfKw5z5LRhV0gNA7gNkKm7HoK+HRN0wX3EkxGk0fpbWhmB7g=="
    },
    "node_modules/@types/d3-timer": {
      "version": "3.0.2",
      "resolved": "https://registry.npmjs.org/@types/d3-timer/-/d3-timer-3.0.2.tgz",
      "integrity": "sha512-Ps3T8E8dZDam6fUyNiMkekK3XUsaUEik+idO9/YjPtfj2qruF8tFBXS7XhtE4iIXBLxhmLjP3SXpLhVf21I9Lw=="
    },
    "node_modules/@types/use-sync-external-store": {
      "version": "0.0.6",
      "resolved": "https://registry.npmjs.org/@types/use-sync-external-store/-/use-sync-external-store-0.0.6.tgz",
      "integrity": "sha512-zFDAD+tlpf2r4asuHEj0XH6pY6i0g5NeAHPn+15wk3BV6JA69eERFXC1gyGThDkVa1zCyKr5jox1+2LbV/AMLg=="
    },
    "node_modules/@vitejs/plugin-react": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/@vitejs/plugin-react/-/plugin-react-4.0.0.tgz",
      "integrity": "sha512-HX0XzMjL3hhOYm+0s95pb0Z7F8O81G7joUHgfDd/9J/ZZf5k4xX6QAMFkKsHFxaHlf6X7GD7+XuaZ66ULiJuhQ==",
      "dev": true,
      "dependencies": {
        "@babel/core": "^7.21.4",
        "@babel/plugin-transform-react-jsx-self": "^7.21.0",
        "@babel/plugin-transform-react-jsx-source": "^7.19.6",
        "react-refresh": "^0.14.0"
      },
      "engines": {
        "node": "^14.18.0 || >=16.0.0"
      },
      "peerDependencies": {
        "vite": "^4.2.0"
      }
    },
    "node_modules/ansi-regex": {
      "version": "6.2.2",
      "resolved": "https://registry.npmjs.org/ansi-regex/-/ansi-regex-6.2.2.tgz",
      "integrity": "sha512-Bq3SmSpyFHaWjPk8If9yc6svM8c56dB5BAtW4Qbw5jHTwwXXcTLoRMkpDJp6VL0XzlWaCHTXrkFURMYmD0sLqg==",
      "dev": true,
      "engines": {
        "node": ">=12"
      },
      "funding": {
        "url": "https://github.com/chalk/ansi-regex?sponsor=1"
      }
    },
    "node_modules/ansi-styles": {
      "version": "6.2.3",
      "resolved": "https://registry.npmjs.org/ansi-styles/-/ansi-styles-6.2.3.tgz",
      "integrity": "sha512-4Dj6M28JB+oAH8kFkTLUo+a2jwOFkuqb3yucU0CANcRRUbxS0cP0nZYCGjcc3BNXwRIsUVmDGgzawme7zvJHvg==",
      "dev": true,
      "engines": {
        "node": ">=12"
      },
      "funding": {
        "url": "https://github.com/chalk/ansi-styles?sponsor=1"
      }
    },
    "node_modules/any-promise": {
      "version": "1.3.0",
      "resolved": "https://registry.npmjs.org/any-promise/-/any-promise-1.3.0.tgz",
      "integrity": "sha512-7UvmKalWRt1wgjL1RrGxoSJW/0QZFIegpeGvZG9kjp8vrRu55XTHbwnqq2GpXm9uLbcuhxm3IqX9OB4MZR1b2A==",
      "dev": true
    },
    "node_modules/anymatch": {
      "version": "3.1.3",
      "resolved": "https://registry.npmjs.org/anymatch/-/anymatch-3.1.3.tgz",
      "integrity": "sha512-KMReFUr0B4t+D+OBkjR3KYqvocp2XaSzO55UcB6mgQMd3KbcE+mWTyvVV7D/zsdEbNnV6acZUutkiHQXvTr1Rw==",
      "dev": true,
      "dependencies": {
        "normalize-path": "^3.0.0",
        "picomatch": "^2.0.4"
      },
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/arg": {
      "version": "5.0.2",
      "resolved": "https://registry.npmjs.org/arg/-/arg-5.0.2.tgz",
      "integrity": "sha512-PYjyFOLKQ9y57JvQ6QLo8dAgNqswh8M1RMJYdQduT6xbWSgK36P/Z/v+p888pM69jMMfS8Xd8F6I1kQ/I9HUGg==",
      "dev": true
    },
    "node_modules/asynckit": {
      "version": "0.4.0",
      "resolved": "https://registry.npmjs.org/asynckit/-/asynckit-0.4.0.tgz",
      "integrity": "sha512-Oei9OH4tRh0YqU3GxhX79dM/mwVgvbZJaSNaRk+bshkj0S5cfHcgYakreBjrHwatXKbz+IoIdYLxrKim2MjW0Q=="
    },
    "node_modules/autoprefixer": {
      "version": "10.4.21",
      "resolved": "https://registry.npmjs.org/autoprefixer/-/autoprefixer-10.4.21.tgz",
      "integrity": "sha512-O+A6LWV5LDHSJD3LjHYoNi4VLsj/Whi7k6zG12xTYaU4cQ8oxQGckXNX8cRHK5yOZ/ppVHe0ZBXGzSV9jXdVbQ==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/postcss/"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/autoprefixer"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "dependencies": {
        "browserslist": "^4.24.4",
        "caniuse-lite": "^1.0.30001702",
        "fraction.js": "^4.3.7",
        "normalize-range": "^0.1.2",
        "picocolors": "^1.1.1",
        "postcss-value-parser": "^4.2.0"
      },
      "bin": {
        "autoprefixer": "bin/autoprefixer"
      },
      "engines": {
        "node": "^10 || ^12 || >=14"
      },
      "peerDependencies": {
        "postcss": "^8.1.0"
      }
    },
    "node_modules/axios": {
      "version": "1.13.0",
      "resolved": "https://registry.npmjs.org/axios/-/axios-1.13.0.tgz",
      "integrity": "sha512-zt40Pz4zcRXra9CVV31KeyofwiNvAbJ5B6YPz9pMJ+yOSLikvPT4Yi5LjfgjRa9CawVYBaD1JQzIVcIvBejKeA==",
      "dependencies": {
        "follow-redirects": "^1.15.6",
        "form-data": "^4.0.4",
        "proxy-from-env": "^1.1.0"
      }
    },
    "node_modules/balanced-match": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/balanced-match/-/balanced-match-1.0.2.tgz",
      "integrity": "sha512-3oSeUO0TMV67hN1AmbXsK4yaqU7tjiHlbxRDZOpH0KW9+CeX4bRAaX0Anxt0tx2MrpRpWwQaPwIlISEJhYU5Pw==",
      "dev": true
    },
    "node_modules/baseline-browser-mapping": {
      "version": "2.8.20",
      "resolved": "https://registry.npmjs.org/baseline-browser-mapping/-/baseline-browser-mapping-2.8.20.tgz",
      "integrity": "sha512-JMWsdF+O8Orq3EMukbUN1QfbLK9mX2CkUmQBcW2T0s8OmdAUL5LLM/6wFwSrqXzlXB13yhyK9gTKS1rIizOduQ==",
      "dev": true,
      "bin": {
        "baseline-browser-mapping": "dist/cli.js"
      }
    },
    "node_modules/binary-extensions": {
      "version": "2.3.0",
      "resolved": "https://registry.npmjs.org/binary-extensions/-/binary-extensions-2.3.0.tgz",
      "integrity": "sha512-Ceh+7ox5qe7LJuLHoY0feh3pHuUDHAcRUeyL2VYghZwfpkNIy/+8Ocg0a3UuSoYzavmylwuLWQOf3hl0jjMMIw==",
      "dev": true,
      "engines": {
        "node": ">=8"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/brace-expansion": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/brace-expansion/-/brace-expansion-2.0.2.tgz",
      "integrity": "sha512-Jt0vHyM+jmUBqojB7E1NIYadt0vI0Qxjxd2TErW94wDz+E2LAm5vKMXXwg6ZZBTHPuUlDgQHKXvjGBdfcF1ZDQ==",
      "dev": true,
      "dependencies": {
        "balanced-match": "^1.0.0"
      }
    },
    "node_modules/braces": {
      "version": "3.0.3",
      "resolved": "https://registry.npmjs.org/braces/-/braces-3.0.3.tgz",
      "integrity": "sha512-yQbXgO/OSZVD2IsiLlro+7Hf6Q18EJrKSEsdoMzKePKXct3gvD8oLcOQdIzGupr5Fj+EDe8gO/lxc1BzfMpxvA==",
      "dev": true,
      "dependencies": {
        "fill-range": "^7.1.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/browserslist": {
      "version": "4.27.0",
      "resolved": "https://registry.npmjs.org/browserslist/-/browserslist-4.27.0.tgz",
      "integrity": "sha512-AXVQwdhot1eqLihwasPElhX2tAZiBjWdJ9i/Zcj2S6QYIjkx62OKSfnobkriB81C3l4w0rVy3Nt4jaTBltYEpw==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/browserslist"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/browserslist"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "dependencies": {
        "baseline-browser-mapping": "^2.8.19",
        "caniuse-lite": "^1.0.30001751",
        "electron-to-chromium": "^1.5.238",
        "node-releases": "^2.0.26",
        "update-browserslist-db": "^1.1.4"
      },
      "bin": {
        "browserslist": "cli.js"
      },
      "engines": {
        "node": "^6 || ^7 || ^8 || ^9 || ^10 || ^11 || ^12 || >=13.7"
      }
    },
    "node_modules/call-bind-apply-helpers": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/call-bind-apply-helpers/-/call-bind-apply-helpers-1.0.2.tgz",
      "integrity": "sha512-Sp1ablJ0ivDkSzjcaJdxEunN5/XvksFJ2sMBFfq6x0ryhQV/2b/KwFe21cMpmHtPOSij8K99/wSfoEuTObmuMQ==",
      "dependencies": {
        "es-errors": "^1.3.0",
        "function-bind": "^1.1.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/camelcase-css": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/camelcase-css/-/camelcase-css-2.0.1.tgz",
      "integrity": "sha512-QOSvevhslijgYwRx6Rv7zKdMF8lbRmx+uQGx2+vDc+KI/eBnsy9kit5aj23AgGu3pa4t9AgwbnXWqS+iOY+2aA==",
      "dev": true,
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/caniuse-lite": {
      "version": "1.0.30001751",
      "resolved": "https://registry.npmjs.org/caniuse-lite/-/caniuse-lite-1.0.30001751.tgz",
      "integrity": "sha512-A0QJhug0Ly64Ii3eIqHu5X51ebln3k4yTUkY1j8drqpWHVreg/VLijN48cZ1bYPiqOQuqpkIKnzr/Ul8V+p6Cw==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/browserslist"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/caniuse-lite"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ]
    },
    "node_modules/chokidar": {
      "version": "3.6.0",
      "resolved": "https://registry.npmjs.org/chokidar/-/chokidar-3.6.0.tgz",
      "integrity": "sha512-7VT13fmjotKpGipCW9JEQAusEPE+Ei8nl6/g4FBAmIm0GOOLMua9NDDo/DWp0ZAxCr3cPq5ZpBqmPAQgDda2Pw==",
      "dev": true,
      "dependencies": {
        "anymatch": "~3.1.2",
        "braces": "~3.0.2",
        "glob-parent": "~5.1.2",
        "is-binary-path": "~2.1.0",
        "is-glob": "~4.0.1",
        "normalize-path": "~3.0.0",
        "readdirp": "~3.6.0"
      },
      "engines": {
        "node": ">= 8.10.0"
      },
      "funding": {
        "url": "https://paulmillr.com/funding/"
      },
      "optionalDependencies": {
        "fsevents": "~2.3.2"
      }
    },
    "node_modules/chokidar/node_modules/glob-parent": {
      "version": "5.1.2",
      "resolved": "https://registry.npmjs.org/glob-parent/-/glob-parent-5.1.2.tgz",
      "integrity": "sha512-AOIgSQCepiJYwP3ARnGx+5VnTu2HBYdzbGP45eLw1vr3zB3vZLeyed1sC9hnbcOc9/SrMyM5RPQrkGz4aS9Zow==",
      "dev": true,
      "dependencies": {
        "is-glob": "^4.0.1"
      },
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/clsx": {
      "version": "2.1.1",
      "resolved": "https://registry.npmjs.org/clsx/-/clsx-2.1.1.tgz",
      "integrity": "sha512-eYm0QWBtUrBWZWG0d386OGAw16Z995PiOVo2B7bjWSbHedGl5e0ZWaq65kOGgUSNesEIDkB9ISbTg/JK9dhCZA==",
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/color-convert": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/color-convert/-/color-convert-2.0.1.tgz",
      "integrity": "sha512-RRECPsj7iu/xb5oKYcsFHSppFNnsj/52OVTRKb4zP5onXwVF3zVmmToNcOfGC+CRDpfK/U584fMg38ZHCaElKQ==",
      "dev": true,
      "dependencies": {
        "color-name": "~1.1.4"
      },
      "engines": {
        "node": ">=7.0.0"
      }
    },
    "node_modules/color-name": {
      "version": "1.1.4",
      "resolved": "https://registry.npmjs.org/color-name/-/color-name-1.1.4.tgz",
      "integrity": "sha512-dOy+3AuW3a2wNbZHIuMZpTcgjGuLU/uBL/ubcZF9OXbDo8ff4O8yVp5Bf0efS8uEoYo5q4Fx7dY9OgQGXgAsQA==",
      "dev": true
    },
    "node_modules/combined-stream": {
      "version": "1.0.8",
      "resolved": "https://registry.npmjs.org/combined-stream/-/combined-stream-1.0.8.tgz",
      "integrity": "sha512-FQN4MRfuJeHf7cBbBMJFXhKSDq+2kAArBlmRBvcvFE5BB1HZKXtSFASDhdlz9zOYwxh8lDdnvmMOe/+5cdoEdg==",
      "dependencies": {
        "delayed-stream": "~1.0.0"
      },
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/commander": {
      "version": "4.1.1",
      "resolved": "https://registry.npmjs.org/commander/-/commander-4.1.1.tgz",
      "integrity": "sha512-NOKm8xhkzAjzFx8B2v5OAHT+u5pRQc2UCa2Vq9jYL/31o2wi9mxBA7LIFs3sV5VSC49z6pEhfbMULvShKj26WA==",
      "dev": true,
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/convert-source-map": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/convert-source-map/-/convert-source-map-2.0.0.tgz",
      "integrity": "sha512-Kvp459HrV2FEJ1CAsi1Ku+MY3kasH19TFykTz2xWmMeq6bk2NU3XXvfJ+Q61m0xktWwt+1HSYf3JZsTms3aRJg==",
      "dev": true
    },
    "node_modules/countup.js": {
      "version": "2.9.0",
      "resolved": "https://registry.npmjs.org/countup.js/-/countup.js-2.9.0.tgz",
      "integrity": "sha512-llqrvyXztRFPp6+i8jx25phHWcVWhrHO4Nlt0uAOSKHB8778zzQswa4MU3qKBvkXfJKftRYFJuVHez67lyKdHg=="
    },
    "node_modules/cross-spawn": {
      "version": "7.0.6",
      "resolved": "https://registry.npmjs.org/cross-spawn/-/cross-spawn-7.0.6.tgz",
      "integrity": "sha512-uV2QOWP2nWzsy2aMp8aRibhi9dlzF5Hgh5SHaB9OiTGEyDTiJJyx0uy51QXdyWbtAHNua4XJzUKca3OzKUd3vA==",
      "dev": true,
      "dependencies": {
        "path-key": "^3.1.0",
        "shebang-command": "^2.0.0",
        "which": "^2.0.1"
      },
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/cssesc": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/cssesc/-/cssesc-3.0.0.tgz",
      "integrity": "sha512-/Tb/JcjK111nNScGob5MNtsntNM1aCNUDipB/TkwZFhyDrrE47SOx/18wF2bbjgc3ZzCSKW1T5nt5EbFoAz/Vg==",
      "dev": true,
      "bin": {
        "cssesc": "bin/cssesc"
      },
      "engines": {
        "node": ">=4"
      }
    },
    "node_modules/d3-array": {
      "version": "3.2.4",
      "resolved": "https://registry.npmjs.org/d3-array/-/d3-array-3.2.4.tgz",
      "integrity": "sha512-tdQAmyA18i4J7wprpYq8ClcxZy3SC31QMeByyCFyRt7BVHdREQZ5lpzoe5mFEYZUWe+oq8HBvk9JjpibyEV4Jg==",
      "dependencies": {
        "internmap": "1 - 2"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-color": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/d3-color/-/d3-color-3.1.0.tgz",
      "integrity": "sha512-zg/chbXyeBtMQ1LbD/WSoW2DpC3I0mpmPdW+ynRTj/x2DAWYrIY7qeZIHidozwV24m4iavr15lNwIwLxRmOxhA==",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-ease": {
      "version": "3.0.1",
      "resolved": "https://registry.npmjs.org/d3-ease/-/d3-ease-3.0.1.tgz",
      "integrity": "sha512-wR/XK3D3XcLIZwpbvQwQ5fK+8Ykds1ip7A2Txe0yxncXSdq1L9skcG7blcedkOX+ZcgxGAmLX1FrRGbADwzi0w==",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-format": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/d3-format/-/d3-format-3.1.0.tgz",
      "integrity": "sha512-YyUI6AEuY/Wpt8KWLgZHsIU86atmikuoOmCfommt0LYHiQSPjvX2AcFc38PX0CBpr2RCyZhjex+NS/LPOv6YqA==",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-interpolate": {
      "version": "3.0.1",
      "resolved": "https://registry.npmjs.org/d3-interpolate/-/d3-interpolate-3.0.1.tgz",
      "integrity": "sha512-3bYs1rOD33uo8aqJfKP3JWPAibgw8Zm2+L9vBKEHJ2Rg+viTR7o5Mmv5mZcieN+FRYaAOWX5SJATX6k1PWz72g==",
      "dependencies": {
        "d3-color": "1 - 3"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-path": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/d3-path/-/d3-path-3.1.0.tgz",
      "integrity": "sha512-p3KP5HCf/bvjBSSKuXid6Zqijx7wIfNW+J/maPs+iwR35at5JCbLUT0LzF1cnjbCHWhqzQTIN2Jpe8pRebIEFQ==",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-scale": {
      "version": "4.0.2",
      "resolved": "https://registry.npmjs.org/d3-scale/-/d3-scale-4.0.2.tgz",
      "integrity": "sha512-GZW464g1SH7ag3Y7hXjf8RoUuAFIqklOAq3MRl4OaWabTFJY9PN/E1YklhXLh+OQ3fM9yS2nOkCoS+WLZ6kvxQ==",
      "dependencies": {
        "d3-array": "2.10.0 - 3",
        "d3-format": "1 - 3",
        "d3-interpolate": "1.2.0 - 3",
        "d3-time": "2.1.1 - 3",
        "d3-time-format": "2 - 4"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-shape": {
      "version": "3.2.0",
      "resolved": "https://registry.npmjs.org/d3-shape/-/d3-shape-3.2.0.tgz",
      "integrity": "sha512-SaLBuwGm3MOViRq2ABk3eLoxwZELpH6zhl3FbAoJ7Vm1gofKx6El1Ib5z23NUEhF9AsGl7y+dzLe5Cw2AArGTA==",
      "dependencies": {
        "d3-path": "^3.1.0"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-time": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/d3-time/-/d3-time-3.1.0.tgz",
      "integrity": "sha512-VqKjzBLejbSMT4IgbmVgDjpkYrNWUYJnbCGo874u7MMKIWsILRX+OpX/gTk8MqjpT1A/c6HY2dCA77ZN0lkQ2Q==",
      "dependencies": {
        "d3-array": "2 - 3"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-time-format": {
      "version": "4.1.0",
      "resolved": "https://registry.npmjs.org/d3-time-format/-/d3-time-format-4.1.0.tgz",
      "integrity": "sha512-dJxPBlzC7NugB2PDLwo9Q8JiTR3M3e4/XANkreKSUxF8vvXKqm1Yfq4Q5dl8budlunRVlUUaDUgFt7eA8D6NLg==",
      "dependencies": {
        "d3-time": "1 - 3"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-timer": {
      "version": "3.0.1",
      "resolved": "https://registry.npmjs.org/d3-timer/-/d3-timer-3.0.1.tgz",
      "integrity": "sha512-ndfJ/JxxMd3nw31uyKoY2naivF+r29V+Lc0svZxe1JvvIRmi8hUsrMvdOwgS1o6uBHmiz91geQ0ylPP0aj1VUA==",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/date-fns": {
      "version": "4.1.0",
      "resolved": "https://registry.npmjs.org/date-fns/-/date-fns-4.1.0.tgz",
      "integrity": "sha512-Ukq0owbQXxa/U3EGtsdVBkR1w7KOQ5gIBqdH2hkvknzZPYvBxb/aa6E8L7tmjFtkwZBu3UXBbjIgPo/Ez4xaNg==",
      "funding": {
        "type": "github",
        "url": "https://github.com/sponsors/kossnocorp"
      }
    },
    "node_modules/debug": {
      "version": "4.4.3",
      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
      "dev": true,
      "dependencies": {
        "ms": "^2.1.3"
      },
      "engines": {
        "node": ">=6.0"
      },
      "peerDependenciesMeta": {
        "supports-color": {
          "optional": true
        }
      }
    },
    "node_modules/decimal.js-light": {
      "version": "2.5.1",
      "resolved": "https://registry.npmjs.org/decimal.js-light/-/decimal.js-light-2.5.1.tgz",
      "integrity": "sha512-qIMFpTMZmny+MMIitAB6D7iVPEorVw6YQRWkvarTkT4tBeSLLiHzcwj6q0MmYSFCiVpiqPJTJEYIrpcPzVEIvg=="
    },
    "node_modules/delayed-stream": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/delayed-stream/-/delayed-stream-1.0.0.tgz",
      "integrity": "sha512-ZySD7Nf91aLB0RxL4KGrKHBXl7Eds1DAmEdcoVawXnLD7SDhpNgtuII2aAkg7a7QS41jxPSZ17p4VdGnMHk3MQ==",
      "engines": {
        "node": ">=0.4.0"
      }
    },
    "node_modules/didyoumean": {
      "version": "1.2.2",
      "resolved": "https://registry.npmjs.org/didyoumean/-/didyoumean-1.2.2.tgz",
      "integrity": "sha512-gxtyfqMg7GKyhQmb056K7M3xszy/myH8w+B4RT+QXBQsvAOdc3XymqDDPHx1BgPgsdAA5SIifona89YtRATDzw==",
      "dev": true
    },
    "node_modules/dlv": {
      "version": "1.1.3",
      "resolved": "https://registry.npmjs.org/dlv/-/dlv-1.1.3.tgz",
      "integrity": "sha512-+HlytyjlPKnIG8XuRG8WvmBP8xs8P71y+SKKS6ZXWoEgLuePxtDoUEiH7WkdePWrQ5JBpE6aoVqfZfJUQkjXwA==",
      "dev": true
    },
    "node_modules/dunder-proto": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/dunder-proto/-/dunder-proto-1.0.1.tgz",
      "integrity": "sha512-KIN/nDJBQRcXw0MLVhZE9iQHmG68qAVIBg9CqmUYjmQIhgij9U5MFvrqkUL5FbtyyzZuOeOt0zdeRe4UY7ct+A==",
      "dependencies": {
        "call-bind-apply-helpers": "^1.0.1",
        "es-errors": "^1.3.0",
        "gopd": "^1.2.0"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/eastasianwidth": {
      "version": "0.2.0",
      "resolved": "https://registry.npmjs.org/eastasianwidth/-/eastasianwidth-0.2.0.tgz",
      "integrity": "sha512-I88TYZWc9XiYHRQ4/3c5rjjfgkjhLyW2luGIheGERbNQ6OY7yTybanSpDXZa8y7VUP9YmDcYa+eyq4ca7iLqWA==",
      "dev": true
    },
    "node_modules/electron-to-chromium": {
      "version": "1.5.241",
      "resolved": "https://registry.npmjs.org/electron-to-chromium/-/electron-to-chromium-1.5.241.tgz",
      "integrity": "sha512-ILMvKX/ZV5WIJzzdtuHg8xquk2y0BOGlFOxBVwTpbiXqWIH0hamG45ddU4R3PQ0gYu+xgo0vdHXHli9sHIGb4w==",
      "dev": true
    },
    "node_modules/emoji-regex": {
      "version": "9.2.2",
      "resolved": "https://registry.npmjs.org/emoji-regex/-/emoji-regex-9.2.2.tgz",
      "integrity": "sha512-L18DaJsXSUk2+42pv8mLs5jJT2hqFkFE4j21wOmgbUqsZ2hL72NsUU785g9RXgo3s0ZNgVl42TiHp3ZtOv/Vyg==",
      "dev": true
    },
    "node_modules/es-define-property": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/es-define-property/-/es-define-property-1.0.1.tgz",
      "integrity": "sha512-e3nRfgfUZ4rNGL232gUgX06QNyyez04KdjFrF+LTRoOXmrOgFKDg4BCdsjW8EnT69eqdYGmRpJwiPVYNrCaW3g==",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-errors": {
      "version": "1.3.0",
      "resolved": "https://registry.npmjs.org/es-errors/-/es-errors-1.3.0.tgz",
      "integrity": "sha512-Zf5H2Kxt2xjTvbJvP2ZWLEICxA6j+hAmMzIlypy4xcBg1vKVnx89Wy0GbS+kf5cwCVFFzdCFh2XSCFNULS6csw==",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-object-atoms": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/es-object-atoms/-/es-object-atoms-1.1.1.tgz",
      "integrity": "sha512-FGgH2h8zKNim9ljj7dankFPcICIK9Cp5bm+c2gQSYePhpaG5+esrLODihIorn+Pe6FGJzWhXQotPv73jTaldXA==",
      "dependencies": {
        "es-errors": "^1.3.0"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-set-tostringtag": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/es-set-tostringtag/-/es-set-tostringtag-2.1.0.tgz",
      "integrity": "sha512-j6vWzfrGVfyXxge+O0x5sh6cvxAog0a/4Rdd2K36zCMV5eJ+/+tOAngRO8cODMNWbVRdVlmGZQL2YS3yR8bIUA==",
      "dependencies": {
        "es-errors": "^1.3.0",
        "get-intrinsic": "^1.2.6",
        "has-tostringtag": "^1.0.2",
        "hasown": "^2.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-toolkit": {
      "version": "1.41.0",
      "resolved": "https://registry.npmjs.org/es-toolkit/-/es-toolkit-1.41.0.tgz",
      "integrity": "sha512-bDd3oRmbVgqZCJS6WmeQieOrzpl3URcWBUVDXxOELlUW2FuW+0glPOz1n0KnRie+PdyvUZcXz2sOn00c6pPRIA==",
      "workspaces": [
        "docs",
        "benchmarks"
      ]
    },
    "node_modules/esbuild": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/esbuild/-/esbuild-0.18.20.tgz",
      "integrity": "sha512-ceqxoedUrcayh7Y7ZX6NdbbDzGROiyVBgC4PriJThBKSVPWnnFHZAkfI1lJT8QFkOwH4qOS2SJkS4wvpGl8BpA==",
      "dev": true,
      "hasInstallScript": true,
      "bin": {
        "esbuild": "bin/esbuild"
      },
      "engines": {
        "node": ">=12"
      },
      "optionalDependencies": {
        "@esbuild/android-arm": "0.18.20",
        "@esbuild/android-arm64": "0.18.20",
        "@esbuild/android-x64": "0.18.20",
        "@esbuild/darwin-arm64": "0.18.20",
        "@esbuild/darwin-x64": "0.18.20",
        "@esbuild/freebsd-arm64": "0.18.20",
        "@esbuild/freebsd-x64": "0.18.20",
        "@esbuild/linux-arm": "0.18.20",
        "@esbuild/linux-arm64": "0.18.20",
        "@esbuild/linux-ia32": "0.18.20",
        "@esbuild/linux-loong64": "0.18.20",
        "@esbuild/linux-mips64el": "0.18.20",
        "@esbuild/linux-ppc64": "0.18.20",
        "@esbuild/linux-riscv64": "0.18.20",
        "@esbuild/linux-s390x": "0.18.20",
        "@esbuild/linux-x64": "0.18.20",
        "@esbuild/netbsd-x64": "0.18.20",
        "@esbuild/openbsd-x64": "0.18.20",
        "@esbuild/sunos-x64": "0.18.20",
        "@esbuild/win32-arm64": "0.18.20",
        "@esbuild/win32-ia32": "0.18.20",
        "@esbuild/win32-x64": "0.18.20"
      }
    },
    "node_modules/escalade": {
      "version": "3.2.0",
      "resolved": "https://registry.npmjs.org/escalade/-/escalade-3.2.0.tgz",
      "integrity": "sha512-WUj2qlxaQtO4g6Pq5c29GTcWGDyd8itL8zTlipgECz3JesAiiOKotd8JU6otB3PACgG6xkJUyVhboMS+bje/jA==",
      "dev": true,
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/eventemitter3": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/eventemitter3/-/eventemitter3-5.0.1.tgz",
      "integrity": "sha512-GWkBvjiSZK87ELrYOSESUYeVIc9mvLLf/nXalMOS5dYrgZq9o5OVkbZAVM06CVxYsCwH9BDZFPlQTlPA1j4ahA=="
    },
    "node_modules/fast-glob": {
      "version": "3.3.3",
      "resolved": "https://registry.npmjs.org/fast-glob/-/fast-glob-3.3.3.tgz",
      "integrity": "sha512-7MptL8U0cqcFdzIzwOTHoilX9x5BrNqye7Z/LuC7kCMRio1EMSyqRK3BEAUD7sXRq4iT4AzTVuZdhgQ2TCvYLg==",
      "dev": true,
      "dependencies": {
        "@nodelib/fs.stat": "^2.0.2",
        "@nodelib/fs.walk": "^1.2.3",
        "glob-parent": "^5.1.2",
        "merge2": "^1.3.0",
        "micromatch": "^4.0.8"
      },
      "engines": {
        "node": ">=8.6.0"
      }
    },
    "node_modules/fast-glob/node_modules/glob-parent": {
      "version": "5.1.2",
      "resolved": "https://registry.npmjs.org/glob-parent/-/glob-parent-5.1.2.tgz",
      "integrity": "sha512-AOIgSQCepiJYwP3ARnGx+5VnTu2HBYdzbGP45eLw1vr3zB3vZLeyed1sC9hnbcOc9/SrMyM5RPQrkGz4aS9Zow==",
      "dev": true,
      "dependencies": {
        "is-glob": "^4.0.1"
      },
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/fastq": {
      "version": "1.19.1",
      "resolved": "https://registry.npmjs.org/fastq/-/fastq-1.19.1.tgz",
      "integrity": "sha512-GwLTyxkCXjXbxqIhTsMI2Nui8huMPtnxg7krajPJAjnEG/iiOS7i+zCtWGZR9G0NBKbXKh6X9m9UIsYX/N6vvQ==",
      "dev": true,
      "dependencies": {
        "reusify": "^1.0.4"
      }
    },
    "node_modules/fill-range": {
      "version": "7.1.1",
      "resolved": "https://registry.npmjs.org/fill-range/-/fill-range-7.1.1.tgz",
      "integrity": "sha512-YsGpe3WHLK8ZYi4tWDg2Jy3ebRz2rXowDxnld4bkQB00cc/1Zw9AWnC0i9ztDJitivtQvaI9KaLyKrc+hBW0yg==",
      "dev": true,
      "dependencies": {
        "to-regex-range": "^5.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/follow-redirects": {
      "version": "1.15.11",
      "resolved": "https://registry.npmjs.org/follow-redirects/-/follow-redirects-1.15.11.tgz",
      "integrity": "sha512-deG2P0JfjrTxl50XGCDyfI97ZGVCxIpfKYmfyrQ54n5FO/0gfIES8C/Psl6kWVDolizcaaxZJnTS0QSMxvnsBQ==",
      "funding": [
        {
          "type": "individual",
          "url": "https://github.com/sponsors/RubenVerborgh"
        }
      ],
      "engines": {
        "node": ">=4.0"
      },
      "peerDependenciesMeta": {
        "debug": {
          "optional": true
        }
      }
    },
    "node_modules/foreground-child": {
      "version": "3.3.1",
      "resolved": "https://registry.npmjs.org/foreground-child/-/foreground-child-3.3.1.tgz",
      "integrity": "sha512-gIXjKqtFuWEgzFRJA9WCQeSJLZDjgJUOMCMzxtvFq/37KojM1BFGufqsCy0r4qSQmYLsZYMeyRqzIWOMup03sw==",
      "dev": true,
      "dependencies": {
        "cross-spawn": "^7.0.6",
        "signal-exit": "^4.0.1"
      },
      "engines": {
        "node": ">=14"
      },
      "funding": {
        "url": "https://github.com/sponsors/isaacs"
      }
    },
    "node_modules/form-data": {
      "version": "4.0.4",
      "resolved": "https://registry.npmjs.org/form-data/-/form-data-4.0.4.tgz",
      "integrity": "sha512-KrGhL9Q4zjj0kiUt5OO4Mr/A/jlI2jDYs5eHBpYHPcBEVSiipAvn2Ko2HnPe20rmcuuvMHNdZFp+4IlGTMF0Ow==",
      "dependencies": {
        "asynckit": "^0.4.0",
        "combined-stream": "^1.0.8",
        "es-set-tostringtag": "^2.1.0",
        "hasown": "^2.0.2",
        "mime-types": "^2.1.12"
      },
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/fraction.js": {
      "version": "4.3.7",
      "resolved": "https://registry.npmjs.org/fraction.js/-/fraction.js-4.3.7.tgz",
      "integrity": "sha512-ZsDfxO51wGAXREY55a7la9LScWpwv9RxIrYABrlvOFBlH/ShPnrtsXeuUIfXKKOVicNxQ+o8JTbJvjS4M89yew==",
      "dev": true,
      "engines": {
        "node": "*"
      },
      "funding": {
        "type": "patreon",
        "url": "https://github.com/sponsors/rawify"
      }
    },
    "node_modules/framer-motion": {
      "version": "12.23.24",
      "resolved": "https://registry.npmjs.org/framer-motion/-/framer-motion-12.23.24.tgz",
      "integrity": "sha512-HMi5HRoRCTou+3fb3h9oTLyJGBxHfW+HnNE25tAXOvVx/IvwMHK0cx7IR4a2ZU6sh3IX1Z+4ts32PcYBOqka8w==",
      "dependencies": {
        "motion-dom": "^12.23.23",
        "motion-utils": "^12.23.6",
        "tslib": "^2.4.0"
      },
      "peerDependencies": {
        "@emotion/is-prop-valid": "*",
        "react": "^18.0.0 || ^19.0.0",
        "react-dom": "^18.0.0 || ^19.0.0"
      },
      "peerDependenciesMeta": {
        "@emotion/is-prop-valid": {
          "optional": true
        },
        "react": {
          "optional": true
        },
        "react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/fsevents": {
      "version": "2.3.3",
      "resolved": "https://registry.npmjs.org/fsevents/-/fsevents-2.3.3.tgz",
      "integrity": "sha512-5xoDfX+fL7faATnagmWPpbFtwh/R77WmMMqqHGS65C3vvB0YHrgF+B1YmZ3441tMj5n63k0212XNoJwzlhffQw==",
      "dev": true,
      "hasInstallScript": true,
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": "^8.16.0 || ^10.6.0 || >=11.0.0"
      }
    },
    "node_modules/function-bind": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/function-bind/-/function-bind-1.1.2.tgz",
      "integrity": "sha512-7XHNxH7qX9xG5mIwxkhumTox/MIRNcOgDrxWsMt2pAr23WHp6MrRlN7FBSFpCpr+oVO0F744iUgR82nJMfG2SA==",
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/fuse.js": {
      "version": "7.1.0",
      "resolved": "https://registry.npmjs.org/fuse.js/-/fuse.js-7.1.0.tgz",
      "integrity": "sha512-trLf4SzuuUxfusZADLINj+dE8clK1frKdmqiJNb1Es75fmI5oY6X2mxLVUciLLjxqw/xr72Dhy+lER6dGd02FQ==",
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/gensync": {
      "version": "1.0.0-beta.2",
      "resolved": "https://registry.npmjs.org/gensync/-/gensync-1.0.0-beta.2.tgz",
      "integrity": "sha512-3hN7NaskYvMDLQY55gnW3NQ+mesEAepTqlg+VEbj7zzqEMBVNhzcGYYeqFo/TlYz6eQiFcp1HcsCZO+nGgS8zg==",
      "dev": true,
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/get-intrinsic": {
      "version": "1.3.0",
      "resolved": "https://registry.npmjs.org/get-intrinsic/-/get-intrinsic-1.3.0.tgz",
      "integrity": "sha512-9fSjSaos/fRIVIp+xSJlE6lfwhES7LNtKaCBIamHsjr2na1BiABJPo0mOjjz8GJDURarmCPGqaiVg5mfjb98CQ==",
      "dependencies": {
        "call-bind-apply-helpers": "^1.0.2",
        "es-define-property": "^1.0.1",
        "es-errors": "^1.3.0",
        "es-object-atoms": "^1.1.1",
        "function-bind": "^1.1.2",
        "get-proto": "^1.0.1",
        "gopd": "^1.2.0",
        "has-symbols": "^1.1.0",
        "hasown": "^2.0.2",
        "math-intrinsics": "^1.1.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/get-proto": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/get-proto/-/get-proto-1.0.1.tgz",
      "integrity": "sha512-sTSfBjoXBp89JvIKIefqw7U2CCebsc74kiY6awiGogKtoSGbgjYE/G/+l9sF3MWFPNc9IcoOC4ODfKHfxFmp0g==",
      "dependencies": {
        "dunder-proto": "^1.0.1",
        "es-object-atoms": "^1.0.0"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/glob": {
      "version": "10.4.5",
      "resolved": "https://registry.npmjs.org/glob/-/glob-10.4.5.tgz",
      "integrity": "sha512-7Bv8RF0k6xjo7d4A/PxYLbUCfb6c+Vpd2/mB2yRDlew7Jb5hEXiCD9ibfO7wpk8i4sevK6DFny9h7EYbM3/sHg==",
      "dev": true,
      "dependencies": {
        "foreground-child": "^3.1.0",
        "jackspeak": "^3.1.2",
        "minimatch": "^9.0.4",
        "minipass": "^7.1.2",
        "package-json-from-dist": "^1.0.0",
        "path-scurry": "^1.11.1"
      },
      "bin": {
        "glob": "dist/esm/bin.mjs"
      },
      "funding": {
        "url": "https://github.com/sponsors/isaacs"
      }
    },
    "node_modules/glob-parent": {
      "version": "6.0.2",
      "resolved": "https://registry.npmjs.org/glob-parent/-/glob-parent-6.0.2.tgz",
      "integrity": "sha512-XxwI8EOhVQgWp6iDL+3b0r86f4d6AX6zSU55HfB4ydCEuXLXc5FcYeOu+nnGftS4TEju/11rt4KJPTMgbfmv4A==",
      "dev": true,
      "dependencies": {
        "is-glob": "^4.0.3"
      },
      "engines": {
        "node": ">=10.13.0"
      }
    },
    "node_modules/gopd": {
      "version": "1.2.0",
      "resolved": "https://registry.npmjs.org/gopd/-/gopd-1.2.0.tgz",
      "integrity": "sha512-ZUKRh6/kUFoAiTAtTYPZJ3hw9wNxx+BIBOijnlG9PnrJsCcSjs1wyyD6vJpaYtgnzDrKYRSqf3OO6Rfa93xsRg==",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/has-symbols": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/has-symbols/-/has-symbols-1.1.0.tgz",
      "integrity": "sha512-1cDNdwJ2Jaohmb3sg4OmKaMBwuC48sYni5HUw2DvsC8LjGTLK9h+eb1X6RyuOHe4hT0ULCW68iomhjUoKUqlPQ==",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/has-tostringtag": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/has-tostringtag/-/has-tostringtag-1.0.2.tgz",
      "integrity": "sha512-NqADB8VjPFLM2V0VvHUewwwsw0ZWBaIdgo+ieHtK3hasLz4qeCRjYcqfB6AQrBggRKppKF8L52/VqdVsO47Dlw==",
      "dependencies": {
        "has-symbols": "^1.0.3"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/hasown": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/hasown/-/hasown-2.0.2.tgz",
      "integrity": "sha512-0hJU9SCPvmMzIBdZFqNPXWa6dqh7WdH0cII9y+CyS8rG3nL48Bclra9HmKhVVUHyPWNH5Y7xDwAB7bfgSjkUMQ==",
      "dependencies": {
        "function-bind": "^1.1.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/html-parse-stringify": {
      "version": "3.0.1",
      "resolved": "https://registry.npmjs.org/html-parse-stringify/-/html-parse-stringify-3.0.1.tgz",
      "integrity": "sha512-KknJ50kTInJ7qIScF3jeaFRpMpE8/lfiTdzf/twXyPBLAGrLRTmkz3AdTnKeh40X8k9L2fdYwEp/42WGXIRGcg==",
      "dependencies": {
        "void-elements": "3.1.0"
      }
    },
    "node_modules/i18next": {
      "version": "25.6.0",
      "resolved": "https://registry.npmjs.org/i18next/-/i18next-25.6.0.tgz",
      "integrity": "sha512-tTn8fLrwBYtnclpL5aPXK/tAYBLWVvoHM1zdfXoRNLcI+RvtMsoZRV98ePlaW3khHYKuNh/Q65W/+NVFUeIwVw==",
      "funding": [
        {
          "type": "individual",
          "url": "https://locize.com"
        },
        {
          "type": "individual",
          "url": "https://locize.com/i18next.html"
        },
        {
          "type": "individual",
          "url": "https://www.i18next.com/how-to/faq#i18next-is-awesome.-how-can-i-support-the-project"
        }
      ],
      "dependencies": {
        "@babel/runtime": "^7.27.6"
      },
      "peerDependencies": {
        "typescript": "^5"
      },
      "peerDependenciesMeta": {
        "typescript": {
          "optional": true
        }
      }
    },
    "node_modules/immer": {
      "version": "10.2.0",
      "resolved": "https://registry.npmjs.org/immer/-/immer-10.2.0.tgz",
      "integrity": "sha512-d/+XTN3zfODyjr89gM3mPq1WNX2B8pYsu7eORitdwyA2sBubnTl3laYlBk4sXY5FUa5qTZGBDPJICVbvqzjlbw==",
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/immer"
      }
    },
    "node_modules/internmap": {
      "version": "2.0.3",
      "resolved": "https://registry.npmjs.org/internmap/-/internmap-2.0.3.tgz",
      "integrity": "sha512-5Hh7Y1wQbvY5ooGgPbDaL5iYLAPzMTUrjMulskHLH6wnv/A+1q5rgEaiuqEjB+oxGXIVZs1FF+R/KPN3ZSQYYg==",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/is-binary-path": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/is-binary-path/-/is-binary-path-2.1.0.tgz",
      "integrity": "sha512-ZMERYes6pDydyuGidse7OsHxtbI7WVeUEozgR/g7rd0xUimYNlvZRE/K2MgZTjWy725IfelLeVcEM97mmtRGXw==",
      "dev": true,
      "dependencies": {
        "binary-extensions": "^2.0.0"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/is-core-module": {
      "version": "2.16.1",
      "resolved": "https://registry.npmjs.org/is-core-module/-/is-core-module-2.16.1.tgz",
      "integrity": "sha512-UfoeMA6fIJ8wTYFEUjelnaGI67v6+N7qXJEvQuIGa99l4xsCruSYOVSQ0uPANn4dAzm8lkYPaKLrrijLq7x23w==",
      "dev": true,
      "dependencies": {
        "hasown": "^2.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-extglob": {
      "version": "2.1.1",
      "resolved": "https://registry.npmjs.org/is-extglob/-/is-extglob-2.1.1.tgz",
      "integrity": "sha512-SbKbANkN603Vi4jEZv49LeVJMn4yGwsbzZworEoyEiutsN3nJYdbO36zfhGJ6QEDpOZIFkDtnq5JRxmvl3jsoQ==",
      "dev": true,
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/is-fullwidth-code-point": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/is-fullwidth-code-point/-/is-fullwidth-code-point-3.0.0.tgz",
      "integrity": "sha512-zymm5+u+sCsSWyD9qNaejV3DFvhCKclKdizYaJUuHA83RLjb7nSuGnddCHGv0hk+KY7BMAlsWeK4Ueg6EV6XQg==",
      "dev": true,
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/is-glob": {
      "version": "4.0.3",
      "resolved": "https://registry.npmjs.org/is-glob/-/is-glob-4.0.3.tgz",
      "integrity": "sha512-xelSayHH36ZgE7ZWhli7pW34hNbNl8Ojv5KVmkJD4hBdD3th8Tfk9vYasLM+mXWOZhFkgZfxhLSnrwRr4elSSg==",
      "dev": true,
      "dependencies": {
        "is-extglob": "^2.1.1"
      },
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/is-number": {
      "version": "7.0.0",
      "resolved": "https://registry.npmjs.org/is-number/-/is-number-7.0.0.tgz",
      "integrity": "sha512-41Cifkg6e8TylSpdtTpeLVMqvSBEVzTttHvERD741+pnZ8ANv0004MRL43QKPDlK9cGvNp6NZWZUBlbGXYxxng==",
      "dev": true,
      "engines": {
        "node": ">=0.12.0"
      }
    },
    "node_modules/isexe": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/isexe/-/isexe-2.0.0.tgz",
      "integrity": "sha512-RHxMLp9lnKHGHRng9QFhRCMbYAcVpn69smSGcq3f36xjgVVWThj4qqLbTLlq7Ssj8B+fIQ1EuCEGI2lKsyQeIw==",
      "dev": true
    },
    "node_modules/jackspeak": {
      "version": "3.4.3",
      "resolved": "https://registry.npmjs.org/jackspeak/-/jackspeak-3.4.3.tgz",
      "integrity": "sha512-OGlZQpz2yfahA/Rd1Y8Cd9SIEsqvXkLVoSw/cgwhnhFMDbsQFeZYoJJ7bIZBS9BcamUW96asq/npPWugM+RQBw==",
      "dev": true,
      "dependencies": {
        "@isaacs/cliui": "^8.0.2"
      },
      "funding": {
        "url": "https://github.com/sponsors/isaacs"
      },
      "optionalDependencies": {
        "@pkgjs/parseargs": "^0.11.0"
      }
    },
    "node_modules/jiti": {
      "version": "1.21.7",
      "resolved": "https://registry.npmjs.org/jiti/-/jiti-1.21.7.tgz",
      "integrity": "sha512-/imKNG4EbWNrVjoNC/1H5/9GFy+tqjGBHCaSsN+P2RnPqjsLmv6UD3Ej+Kj8nBWaRAwyk7kK5ZUc+OEatnTR3A==",
      "dev": true,
      "bin": {
        "jiti": "bin/jiti.js"
      }
    },
    "node_modules/js-tokens": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/js-tokens/-/js-tokens-4.0.0.tgz",
      "integrity": "sha512-RdJUflcE3cUzKiMqQgsCu06FPu9UdIJO0beYbPhHN4k6apgJtifcoCtT9bcxOpYBtpD2kCM6Sbzg4CausW/PKQ=="
    },
    "node_modules/jsesc": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/jsesc/-/jsesc-3.1.0.tgz",
      "integrity": "sha512-/sM3dO2FOzXjKQhJuo0Q173wf2KOo8t4I8vHy6lF9poUp7bKT0/NHE8fPX23PwfhnykfqnC2xRxOnVw5XuGIaA==",
      "dev": true,
      "bin": {
        "jsesc": "bin/jsesc"
      },
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/json5": {
      "version": "2.2.3",
      "resolved": "https://registry.npmjs.org/json5/-/json5-2.2.3.tgz",
      "integrity": "sha512-XmOWe7eyHYH14cLdVPoyg+GOH3rYX++KpzrylJwSW98t3Nk+U8XOl8FWKOgwtzdb8lXGf6zYwDUzeHMWfxasyg==",
      "dev": true,
      "bin": {
        "json5": "lib/cli.js"
      },
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/jwt-decode": {
      "version": "3.1.2",
      "resolved": "https://registry.npmjs.org/jwt-decode/-/jwt-decode-3.1.2.tgz",
      "integrity": "sha512-UfpWE/VZn0iP50d8cz9NrZLM9lSWhcJ+0Gt/nm4by88UL+J1SiKN8/5dkjMmbEzwL2CAe+67GsegCbIKtbp75A=="
    },
    "node_modules/lilconfig": {
      "version": "3.1.3",
      "resolved": "https://registry.npmjs.org/lilconfig/-/lilconfig-3.1.3.tgz",
      "integrity": "sha512-/vlFKAoH5Cgt3Ie+JLhRbwOsCQePABiU3tJ1egGvyQ+33R/vcwM2Zl2QR/LzjsBeItPt3oSVXapn+m4nQDvpzw==",
      "dev": true,
      "engines": {
        "node": ">=14"
      },
      "funding": {
        "url": "https://github.com/sponsors/antonk52"
      }
    },
    "node_modules/lines-and-columns": {
      "version": "1.2.4",
      "resolved": "https://registry.npmjs.org/lines-and-columns/-/lines-and-columns-1.2.4.tgz",
      "integrity": "sha512-7ylylesZQ/PV29jhEDl3Ufjo6ZX7gCqJr5F7PKrqc93v7fzSymt1BpwEU8nAUXs8qzzvqhbjhK5QZg6Mt/HkBg==",
      "dev": true
    },
    "node_modules/loose-envify": {
      "version": "1.4.0",
      "resolved": "https://registry.npmjs.org/loose-envify/-/loose-envify-1.4.0.tgz",
      "integrity": "sha512-lyuxPGr/Wfhrlem2CL/UcnUc1zcqKAImBDzukY7Y5F/yQiNdko6+fRLevlw1HgMySw7f611UIY408EtxRSoK3Q==",
      "dependencies": {
        "js-tokens": "^3.0.0 || ^4.0.0"
      },
      "bin": {
        "loose-envify": "cli.js"
      }
    },
    "node_modules/lru-cache": {
      "version": "10.4.3",
      "resolved": "https://registry.npmjs.org/lru-cache/-/lru-cache-10.4.3.tgz",
      "integrity": "sha512-JNAzZcXrCt42VGLuYz0zfAzDfAvJWW6AfYlDBQyDV5DClI2m5sAmK+OIO7s59XfsRsWHp02jAJrRadPRGTt6SQ==",
      "dev": true
    },
    "node_modules/math-intrinsics": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/math-intrinsics/-/math-intrinsics-1.1.0.tgz",
      "integrity": "sha512-/IXtbwEk5HTPyEwyKX6hGkYXxM9nbj64B+ilVJnC/R6B0pH5G4V3b0pVbL7DBj4tkhBAppbQUlf6F6Xl9LHu1g==",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/merge2": {
      "version": "1.4.1",
      "resolved": "https://registry.npmjs.org/merge2/-/merge2-1.4.1.tgz",
      "integrity": "sha512-8q7VEgMJW4J8tcfVPy8g09NcQwZdbwFEqhe/WZkoIzjn/3TGDwtOCYtXGxA3O8tPzpczCCDgv+P2P5y00ZJOOg==",
      "dev": true,
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/micromatch": {
      "version": "4.0.8",
      "resolved": "https://registry.npmjs.org/micromatch/-/micromatch-4.0.8.tgz",
      "integrity": "sha512-PXwfBhYu0hBCPw8Dn0E+WDYb7af3dSLVWKi3HGv84IdF4TyFoC0ysxFd0Goxw7nSv4T/PzEJQxsYsEiFCKo2BA==",
      "dev": true,
      "dependencies": {
        "braces": "^3.0.3",
        "picomatch": "^2.3.1"
      },
      "engines": {
        "node": ">=8.6"
      }
    },
    "node_modules/mime-db": {
      "version": "1.52.0",
      "resolved": "https://registry.npmjs.org/mime-db/-/mime-db-1.52.0.tgz",
      "integrity": "sha512-sPU4uV7dYlvtWJxwwxHD0PuihVNiE7TyAbQ5SWxDCB9mUYvOgroQOwYQQOKPJ8CIbE+1ETVlOoK1UC2nU3gYvg==",
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/mime-types": {
      "version": "2.1.35",
      "resolved": "https://registry.npmjs.org/mime-types/-/mime-types-2.1.35.tgz",
      "integrity": "sha512-ZDY+bPm5zTTF+YpCrAU9nK0UgICYPT0QtT1NZWFv4s++TNkcgVaT0g6+4R2uI4MjQjzysHB1zxuWL50hzaeXiw==",
      "dependencies": {
        "mime-db": "1.52.0"
      },
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/minimatch": {
      "version": "9.0.5",
      "resolved": "https://registry.npmjs.org/minimatch/-/minimatch-9.0.5.tgz",
      "integrity": "sha512-G6T0ZX48xgozx7587koeX9Ys2NYy6Gmv//P89sEte9V9whIapMNF4idKxnW2QtCcLiTWlb/wfCabAtAFWhhBow==",
      "dev": true,
      "dependencies": {
        "brace-expansion": "^2.0.1"
      },
      "engines": {
        "node": ">=16 || 14 >=14.17"
      },
      "funding": {
        "url": "https://github.com/sponsors/isaacs"
      }
    },
    "node_modules/minipass": {
      "version": "7.1.2",
      "resolved": "https://registry.npmjs.org/minipass/-/minipass-7.1.2.tgz",
      "integrity": "sha512-qOOzS1cBTWYF4BH8fVePDBOO9iptMnGUEZwNc/cMWnTV2nVLZ7VoNWEPHkYczZA0pdoA7dl6e7FL659nX9S2aw==",
      "dev": true,
      "engines": {
        "node": ">=16 || 14 >=14.17"
      }
    },
    "node_modules/motion-dom": {
      "version": "12.23.23",
      "resolved": "https://registry.npmjs.org/motion-dom/-/motion-dom-12.23.23.tgz",
      "integrity": "sha512-n5yolOs0TQQBRUFImrRfs/+6X4p3Q4n1dUEqt/H58Vx7OW6RF+foWEgmTVDhIWJIMXOuNNL0apKH2S16en9eiA==",
      "dependencies": {
        "motion-utils": "^12.23.6"
      }
    },
    "node_modules/motion-utils": {
      "version": "12.23.6",
      "resolved": "https://registry.npmjs.org/motion-utils/-/motion-utils-12.23.6.tgz",
      "integrity": "sha512-eAWoPgr4eFEOFfg2WjIsMoqJTW6Z8MTUCgn/GZ3VRpClWBdnbjryiA3ZSNLyxCTmCQx4RmYX6jX1iWHbenUPNQ=="
    },
    "node_modules/ms": {
      "version": "2.1.3",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
      "dev": true
    },
    "node_modules/mz": {
      "version": "2.7.0",
      "resolved": "https://registry.npmjs.org/mz/-/mz-2.7.0.tgz",
      "integrity": "sha512-z81GNO7nnYMEhrGh9LeymoE4+Yr0Wn5McHIZMK5cfQCl+NDX08sCZgUc9/6MHni9IWuFLm1Z3HTCXu2z9fN62Q==",
      "dev": true,
      "dependencies": {
        "any-promise": "^1.0.0",
        "object-assign": "^4.0.1",
        "thenify-all": "^1.0.0"
      }
    },
    "node_modules/nanoid": {
      "version": "3.3.11",
      "resolved": "https://registry.npmjs.org/nanoid/-/nanoid-3.3.11.tgz",
      "integrity": "sha512-N8SpfPUnUp1bK+PMYW8qSWdl9U+wwNWI4QKxOYDy9JAro3WMX7p2OeVRF9v+347pnakNevPmiHhNmZ2HbFA76w==",
      "dev": true,
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "bin": {
        "nanoid": "bin/nanoid.cjs"
      },
      "engines": {
        "node": "^10 || ^12 || ^13.7 || ^14 || >=15.0.1"
      }
    },
    "node_modules/node-releases": {
      "version": "2.0.26",
      "resolved": "https://registry.npmjs.org/node-releases/-/node-releases-2.0.26.tgz",
      "integrity": "sha512-S2M9YimhSjBSvYnlr5/+umAnPHE++ODwt5e2Ij6FoX45HA/s4vHdkDx1eax2pAPeAOqu4s9b7ppahsyEFdVqQA==",
      "dev": true
    },
    "node_modules/normalize-path": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/normalize-path/-/normalize-path-3.0.0.tgz",
      "integrity": "sha512-6eZs5Ls3WtCisHWp9S2GUy8dqkpGi4BVSz3GaqiE6ezub0512ESztXUwUB6C6IKbQkY2Pnb/mD4WYojCRwcwLA==",
      "dev": true,
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/normalize-range": {
      "version": "0.1.2",
      "resolved": "https://registry.npmjs.org/normalize-range/-/normalize-range-0.1.2.tgz",
      "integrity": "sha512-bdok/XvKII3nUpklnV6P2hxtMNrCboOjAcyBuQnWEhO665FwrSNRxU+AqpsyvO6LgGYPspN+lu5CLtw4jPRKNA==",
      "dev": true,
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/object-assign": {
      "version": "4.1.1",
      "resolved": "https://registry.npmjs.org/object-assign/-/object-assign-4.1.1.tgz",
      "integrity": "sha512-rJgTQnkUnH1sFw8yT6VSU3zD3sWmu6sZhIseY8VX+GRu3P6F7Fu+JNDoXfklElbLJSnc3FUQHVe4cU5hj+BcUg==",
      "dev": true,
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/object-hash": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/object-hash/-/object-hash-3.0.0.tgz",
      "integrity": "sha512-RSn9F68PjH9HqtltsSnqYC1XXoWe9Bju5+213R98cNGttag9q9yAOTzdbsqvIa7aNm5WffBZFpWYr2aWrklWAw==",
      "dev": true,
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/package-json-from-dist": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/package-json-from-dist/-/package-json-from-dist-1.0.1.tgz",
      "integrity": "sha512-UEZIS3/by4OC8vL3P2dTXRETpebLI2NiI5vIrjaD/5UtrkFX/tNbwjTSRAGC/+7CAo2pIcBaRgWmcBBHcsaCIw==",
      "dev": true
    },
    "node_modules/path-key": {
      "version": "3.1.1",
      "resolved": "https://registry.npmjs.org/path-key/-/path-key-3.1.1.tgz",
      "integrity": "sha512-ojmeN0qd+y0jszEtoY48r0Peq5dwMEkIlCOu6Q5f41lfkswXuKtYrhgoTpLnyIcHm24Uhqx+5Tqm2InSwLhE6Q==",
      "dev": true,
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/path-parse": {
      "version": "1.0.7",
      "resolved": "https://registry.npmjs.org/path-parse/-/path-parse-1.0.7.tgz",
      "integrity": "sha512-LDJzPVEEEPR+y48z93A0Ed0yXb8pAByGWo/k5YYdYgpY2/2EsOsksJrq7lOHxryrVOn1ejG6oAp8ahvOIQD8sw==",
      "dev": true
    },
    "node_modules/path-scurry": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/path-scurry/-/path-scurry-1.11.1.tgz",
      "integrity": "sha512-Xa4Nw17FS9ApQFJ9umLiJS4orGjm7ZzwUrwamcGQuHSzDyth9boKDaycYdDcZDuqYATXw4HFXgaqWTctW/v1HA==",
      "dev": true,
      "dependencies": {
        "lru-cache": "^10.2.0",
        "minipass": "^5.0.0 || ^6.0.2 || ^7.0.0"
      },
      "engines": {
        "node": ">=16 || 14 >=14.18"
      },
      "funding": {
        "url": "https://github.com/sponsors/isaacs"
      }
    },
    "node_modules/picocolors": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/picocolors/-/picocolors-1.1.1.tgz",
      "integrity": "sha512-xceH2snhtb5M9liqDsmEw56le376mTZkEX/jEb/RxNFyegNul7eNslCXP9FDj/Lcu0X8KEyMceP2ntpaHrDEVA==",
      "dev": true
    },
    "node_modules/picomatch": {
      "version": "2.3.1",
      "resolved": "https://registry.npmjs.org/picomatch/-/picomatch-2.3.1.tgz",
      "integrity": "sha512-JU3teHTNjmE2VCGFzuY8EXzCDVwEqB2a8fsIvwaStHhAWJEeVd1o1QD80CU6+ZdEXXSLbSsuLwJjkCBWqRQUVA==",
      "dev": true,
      "engines": {
        "node": ">=8.6"
      },
      "funding": {
        "url": "https://github.com/sponsors/jonschlinkert"
      }
    },
    "node_modules/pify": {
      "version": "2.3.0",
      "resolved": "https://registry.npmjs.org/pify/-/pify-2.3.0.tgz",
      "integrity": "sha512-udgsAY+fTnvv7kI7aaxbqwWNb0AHiB0qBO89PZKPkoTmGOgdbrHDKD+0B2X4uTfJ/FT1R09r9gTsjUjNJotuog==",
      "dev": true,
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/pirates": {
      "version": "4.0.7",
      "resolved": "https://registry.npmjs.org/pirates/-/pirates-4.0.7.tgz",
      "integrity": "sha512-TfySrs/5nm8fQJDcBDuUng3VOUKsd7S+zqvbOTiGXHfxX4wK31ard+hoNuvkicM/2YFzlpDgABOevKSsB4G/FA==",
      "dev": true,
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/postcss": {
      "version": "8.5.6",
      "resolved": "https://registry.npmjs.org/postcss/-/postcss-8.5.6.tgz",
      "integrity": "sha512-3Ybi1tAuwAP9s0r1UQ2J4n5Y0G05bJkpUIO0/bI9MhwmD70S5aTWbXGBwxHrelT+XM1k6dM0pk+SwNkpTRN7Pg==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/postcss/"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/postcss"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "dependencies": {
        "nanoid": "^3.3.11",
        "picocolors": "^1.1.1",
        "source-map-js": "^1.2.1"
      },
      "engines": {
        "node": "^10 || ^12 || >=14"
      }
    },
    "node_modules/postcss-import": {
      "version": "15.1.0",
      "resolved": "https://registry.npmjs.org/postcss-import/-/postcss-import-15.1.0.tgz",
      "integrity": "sha512-hpr+J05B2FVYUAXHeK1YyI267J/dDDhMU6B6civm8hSY1jYJnBXxzKDKDswzJmtLHryrjhnDjqqp/49t8FALew==",
      "dev": true,
      "dependencies": {
        "postcss-value-parser": "^4.0.0",
        "read-cache": "^1.0.0",
        "resolve": "^1.1.7"
      },
      "engines": {
        "node": ">=14.0.0"
      },
      "peerDependencies": {
        "postcss": "^8.0.0"
      }
    },
    "node_modules/postcss-js": {
      "version": "4.1.0",
      "resolved": "https://registry.npmjs.org/postcss-js/-/postcss-js-4.1.0.tgz",
      "integrity": "sha512-oIAOTqgIo7q2EOwbhb8UalYePMvYoIeRY2YKntdpFQXNosSu3vLrniGgmH9OKs/qAkfoj5oB3le/7mINW1LCfw==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/postcss/"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "dependencies": {
        "camelcase-css": "^2.0.1"
      },
      "engines": {
        "node": "^12 || ^14 || >= 16"
      },
      "peerDependencies": {
        "postcss": "^8.4.21"
      }
    },
    "node_modules/postcss-load-config": {
      "version": "6.0.1",
      "resolved": "https://registry.npmjs.org/postcss-load-config/-/postcss-load-config-6.0.1.tgz",
      "integrity": "sha512-oPtTM4oerL+UXmx+93ytZVN82RrlY/wPUV8IeDxFrzIjXOLF1pN+EmKPLbubvKHT2HC20xXsCAH2Z+CKV6Oz/g==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/postcss/"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "dependencies": {
        "lilconfig": "^3.1.1"
      },
      "engines": {
        "node": ">= 18"
      },
      "peerDependencies": {
        "jiti": ">=1.21.0",
        "postcss": ">=8.0.9",
        "tsx": "^4.8.1",
        "yaml": "^2.4.2"
      },
      "peerDependenciesMeta": {
        "jiti": {
          "optional": true
        },
        "postcss": {
          "optional": true
        },
        "tsx": {
          "optional": true
        },
        "yaml": {
          "optional": true
        }
      }
    },
    "node_modules/postcss-nested": {
      "version": "6.2.0",
      "resolved": "https://registry.npmjs.org/postcss-nested/-/postcss-nested-6.2.0.tgz",
      "integrity": "sha512-HQbt28KulC5AJzG+cZtj9kvKB93CFCdLvog1WFLf1D+xmMvPGlBstkpTEZfK5+AN9hfJocyBFCNiqyS48bpgzQ==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/postcss/"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "dependencies": {
        "postcss-selector-parser": "^6.1.1"
      },
      "engines": {
        "node": ">=12.0"
      },
      "peerDependencies": {
        "postcss": "^8.2.14"
      }
    },
    "node_modules/postcss-selector-parser": {
      "version": "6.1.2",
      "resolved": "https://registry.npmjs.org/postcss-selector-parser/-/postcss-selector-parser-6.1.2.tgz",
      "integrity": "sha512-Q8qQfPiZ+THO/3ZrOrO0cJJKfpYCagtMUkXbnEfmgUjwXg6z/WBeOyS9APBBPCTSiDV+s4SwQGu8yFsiMRIudg==",
      "dev": true,
      "dependencies": {
        "cssesc": "^3.0.0",
        "util-deprecate": "^1.0.2"
      },
      "engines": {
        "node": ">=4"
      }
    },
    "node_modules/postcss-value-parser": {
      "version": "4.2.0",
      "resolved": "https://registry.npmjs.org/postcss-value-parser/-/postcss-value-parser-4.2.0.tgz",
      "integrity": "sha512-1NNCs6uurfkVbeXG4S8JFT9t19m45ICnif8zWLd5oPSZ50QnwMfK+H3jv408d4jw/7Bttv5axS5IiHoLaVNHeQ==",
      "dev": true
    },
    "node_modules/proxy-from-env": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/proxy-from-env/-/proxy-from-env-1.1.0.tgz",
      "integrity": "sha512-D+zkORCbA9f1tdWRK0RaCR3GPv50cMxcrz4X8k5LTSUD1Dkw47mKJEZQNunItRTkWwgtaUSo1RVFRIG9ZXiFYg=="
    },
    "node_modules/queue-microtask": {
      "version": "1.2.3",
      "resolved": "https://registry.npmjs.org/queue-microtask/-/queue-microtask-1.2.3.tgz",
      "integrity": "sha512-NuaNSa6flKT5JaSYQzJok04JzTL1CA6aGhv5rfLW3PgqA+M2ChpZQnAC8h8i4ZFkBS8X5RqkDBHA7r4hej3K9A==",
      "dev": true,
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/feross"
        },
        {
          "type": "patreon",
          "url": "https://www.patreon.com/feross"
        },
        {
          "type": "consulting",
          "url": "https://feross.org/support"
        }
      ]
    },
    "node_modules/react": {
      "version": "18.3.1",
      "resolved": "https://registry.npmjs.org/react/-/react-18.3.1.tgz",
      "integrity": "sha512-wS+hAgJShR0KhEvPJArfuPVN1+Hz1t0Y6n5jLrGQbkb4urgPE/0Rve+1kMB1v/oWgHgm4WIcV+i7F2pTVj+2iQ==",
      "dependencies": {
        "loose-envify": "^1.1.0"
      },
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/react-countup": {
      "version": "6.5.3",
      "resolved": "https://registry.npmjs.org/react-countup/-/react-countup-6.5.3.tgz",
      "integrity": "sha512-udnqVQitxC7QWADSPDOxVWULkLvKUWrDapn5i53HE4DPRVgs+Y5rr4bo25qEl8jSh+0l2cToJgGMx+clxPM3+w==",
      "dependencies": {
        "countup.js": "^2.8.0"
      },
      "peerDependencies": {
        "react": ">= 16.3.0"
      }
    },
    "node_modules/react-datepicker": {
      "version": "8.8.0",
      "resolved": "https://registry.npmjs.org/react-datepicker/-/react-datepicker-8.8.0.tgz",
      "integrity": "sha512-rIJLhww1B5cQY7GYEfSEXvldlGp+GIVU5oE7lxqeK4fmdv5F9bVndplDmblMCvfSMazXmeJ6OHBvRs/PkEhwUQ==",
      "dependencies": {
        "@floating-ui/react": "^0.27.15",
        "clsx": "^2.1.1",
        "date-fns": "^4.1.0"
      },
      "peerDependencies": {
        "react": "^16.9.0 || ^17 || ^18 || ^19 || ^19.0.0-rc",
        "react-dom": "^16.9.0 || ^17 || ^18 || ^19 || ^19.0.0-rc"
      }
    },
    "node_modules/react-dom": {
      "version": "18.3.1",
      "resolved": "https://registry.npmjs.org/react-dom/-/react-dom-18.3.1.tgz",
      "integrity": "sha512-5m4nQKp+rZRb09LNH59GM4BxTh9251/ylbKIbpe7TpGxfJ+9kv6BLkLBXIjjspbgbnIBNqlI23tRnTWT0snUIw==",
      "dependencies": {
        "loose-envify": "^1.1.0",
        "scheduler": "^0.23.2"
      },
      "peerDependencies": {
        "react": "^18.3.1"
      }
    },
    "node_modules/react-i18next": {
      "version": "16.2.4",
      "resolved": "https://registry.npmjs.org/react-i18next/-/react-i18next-16.2.4.tgz",
      "integrity": "sha512-pvbcPQ+YuQQoRkKBA4VCU9aO8dOgP/vdKEizIYXcAk3+AmI8yQKSJaCzxQQu4Kgg2zWZm3ax9KqHv8ItUlRY0A==",
      "dependencies": {
        "@babel/runtime": "^7.27.6",
        "html-parse-stringify": "^3.0.1",
        "use-sync-external-store": "^1.6.0"
      },
      "peerDependencies": {
        "i18next": ">= 25.5.2",
        "react": ">= 16.8.0",
        "typescript": "^5"
      },
      "peerDependenciesMeta": {
        "react-dom": {
          "optional": true
        },
        "react-native": {
          "optional": true
        },
        "typescript": {
          "optional": true
        }
      }
    },
    "node_modules/react-is": {
      "version": "19.2.0",
      "resolved": "https://registry.npmjs.org/react-is/-/react-is-19.2.0.tgz",
      "integrity": "sha512-x3Ax3kNSMIIkyVYhWPyO09bu0uttcAIoecO/um/rKGQ4EltYWVYtyiGkS/3xMynrbVQdS69Jhlv8FXUEZehlzA==",
      "peer": true
    },
    "node_modules/react-redux": {
      "version": "9.2.0",
      "resolved": "https://registry.npmjs.org/react-redux/-/react-redux-9.2.0.tgz",
      "integrity": "sha512-ROY9fvHhwOD9ySfrF0wmvu//bKCQ6AeZZq1nJNtbDC+kk5DuSuNX/n6YWYF/SYy7bSba4D4FSz8DJeKY/S/r+g==",
      "dependencies": {
        "@types/use-sync-external-store": "^0.0.6",
        "use-sync-external-store": "^1.4.0"
      },
      "peerDependencies": {
        "@types/react": "^18.2.25 || ^19",
        "react": "^18.0 || ^19",
        "redux": "^5.0.0"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "redux": {
          "optional": true
        }
      }
    },
    "node_modules/react-refresh": {
      "version": "0.14.2",
      "resolved": "https://registry.npmjs.org/react-refresh/-/react-refresh-0.14.2.tgz",
      "integrity": "sha512-jCvmsr+1IUSMUyzOkRcvnVbX3ZYC6g9TDrDbFuFmRDq7PD4yaGbLKNQL6k2jnArV8hjYxh7hVhAZB6s9HDGpZA==",
      "dev": true,
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/react-router": {
      "version": "6.21.3",
      "resolved": "https://registry.npmjs.org/react-router/-/react-router-6.21.3.tgz",
      "integrity": "sha512-a0H638ZXULv1OdkmiK6s6itNhoy33ywxmUFT/xtSoVyf9VnC7n7+VT4LjVzdIHSaF5TIh9ylUgxMXksHTgGrKg==",
      "dependencies": {
        "@remix-run/router": "1.14.2"
      },
      "engines": {
        "node": ">=14.0.0"
      },
      "peerDependencies": {
        "react": ">=16.8"
      }
    },
    "node_modules/react-router-dom": {
      "version": "6.21.3",
      "resolved": "https://registry.npmjs.org/react-router-dom/-/react-router-dom-6.21.3.tgz",
      "integrity": "sha512-kNzubk7n4YHSrErzjLK72j0B5i969GsuCGazRl3G6j1zqZBLjuSlYBdVdkDOgzGdPIffUOc9nmgiadTEVoq91g==",
      "dependencies": {
        "@remix-run/router": "1.14.2",
        "react-router": "6.21.3"
      },
      "engines": {
        "node": ">=14.0.0"
      },
      "peerDependencies": {
        "react": ">=16.8",
        "react-dom": ">=16.8"
      }
    },
    "node_modules/read-cache": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/read-cache/-/read-cache-1.0.0.tgz",
      "integrity": "sha512-Owdv/Ft7IjOgm/i0xvNDZ1LrRANRfew4b2prF3OWMQLxLfu3bS8FVhCsrSCMK4lR56Y9ya+AThoTpDCTxCmpRA==",
      "dev": true,
      "dependencies": {
        "pify": "^2.3.0"
      }
    },
    "node_modules/readdirp": {
      "version": "3.6.0",
      "resolved": "https://registry.npmjs.org/readdirp/-/readdirp-3.6.0.tgz",
      "integrity": "sha512-hOS089on8RduqdbhvQ5Z37A0ESjsqz6qnRcffsMU3495FuTdqSm+7bhJ29JvIOsBDEEnan5DPu9t3To9VRlMzA==",
      "dev": true,
      "dependencies": {
        "picomatch": "^2.2.1"
      },
      "engines": {
        "node": ">=8.10.0"
      }
    },
    "node_modules/recharts": {
      "version": "3.3.0",
      "resolved": "https://registry.npmjs.org/recharts/-/recharts-3.3.0.tgz",
      "integrity": "sha512-Vi0qmTB0iz1+/Cz9o5B7irVyUjX2ynvEgImbgMt/3sKRREcUM07QiYjS1QpAVrkmVlXqy5gykq4nGWMz9AS4Rg==",
      "dependencies": {
        "@reduxjs/toolkit": "1.x.x || 2.x.x",
        "clsx": "^2.1.1",
        "decimal.js-light": "^2.5.1",
        "es-toolkit": "^1.39.3",
        "eventemitter3": "^5.0.1",
        "immer": "^10.1.1",
        "react-redux": "8.x.x || 9.x.x",
        "reselect": "5.1.1",
        "tiny-invariant": "^1.3.3",
        "use-sync-external-store": "^1.2.2",
        "victory-vendor": "^37.0.2"
      },
      "engines": {
        "node": ">=18"
      },
      "peerDependencies": {
        "react": "^16.8.0 || ^17.0.0 || ^18.0.0 || ^19.0.0",
        "react-dom": "^16.0.0 || ^17.0.0 || ^18.0.0 || ^19.0.0",
        "react-is": "^16.8.0 || ^17.0.0 || ^18.0.0 || ^19.0.0"
      }
    },
    "node_modules/redux": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/redux/-/redux-5.0.1.tgz",
      "integrity": "sha512-M9/ELqF6fy8FwmkpnF0S3YKOqMyoWJ4+CS5Efg2ct3oY9daQvd/Pc71FpGZsVsbl3Cpb+IIcjBDUnnyBdQbq4w=="
    },
    "node_modules/redux-thunk": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/redux-thunk/-/redux-thunk-3.1.0.tgz",
      "integrity": "sha512-NW2r5T6ksUKXCabzhL9z+h206HQw/NJkcLm1GPImRQ8IzfXwRGqjVhKJGauHirT0DAuyy6hjdnMZaRoAcy0Klw==",
      "peerDependencies": {
        "redux": "^5.0.0"
      }
    },
    "node_modules/reselect": {
      "version": "5.1.1",
      "resolved": "https://registry.npmjs.org/reselect/-/reselect-5.1.1.tgz",
      "integrity": "sha512-K/BG6eIky/SBpzfHZv/dd+9JBFiS4SWV7FIujVyJRux6e45+73RaUHXLmIR1f7WOMaQ0U1km6qwklRQxpJJY0w=="
    },
    "node_modules/resolve": {
      "version": "1.22.11",
      "resolved": "https://registry.npmjs.org/resolve/-/resolve-1.22.11.tgz",
      "integrity": "sha512-RfqAvLnMl313r7c9oclB1HhUEAezcpLjz95wFH4LVuhk9JF/r22qmVP9AMmOU4vMX7Q8pN8jwNg/CSpdFnMjTQ==",
      "dev": true,
      "dependencies": {
        "is-core-module": "^2.16.1",
        "path-parse": "^1.0.7",
        "supports-preserve-symlinks-flag": "^1.0.0"
      },
      "bin": {
        "resolve": "bin/resolve"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/reusify": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/reusify/-/reusify-1.1.0.tgz",
      "integrity": "sha512-g6QUff04oZpHs0eG5p83rFLhHeV00ug/Yf9nZM6fLeUrPguBTkTQOdpAWWspMh55TZfVQDPaN3NQJfbVRAxdIw==",
      "dev": true,
      "engines": {
        "iojs": ">=1.0.0",
        "node": ">=0.10.0"
      }
    },
    "node_modules/rollup": {
      "version": "3.29.5",
      "resolved": "https://registry.npmjs.org/rollup/-/rollup-3.29.5.tgz",
      "integrity": "sha512-GVsDdsbJzzy4S/v3dqWPJ7EfvZJfCHiDqe80IyrF59LYuP+e6U1LJoUqeuqRbwAWoMNoXivMNeNAOf5E22VA1w==",
      "dev": true,
      "bin": {
        "rollup": "dist/bin/rollup"
      },
      "engines": {
        "node": ">=14.18.0",
        "npm": ">=8.0.0"
      },
      "optionalDependencies": {
        "fsevents": "~2.3.2"
      }
    },
    "node_modules/run-parallel": {
      "version": "1.2.0",
      "resolved": "https://registry.npmjs.org/run-parallel/-/run-parallel-1.2.0.tgz",
      "integrity": "sha512-5l4VyZR86LZ/lDxZTR6jqL8AFE2S0IFLMP26AbjsLVADxHdhB/c0GUsH+y39UfCi3dzz8OlQuPmnaJOMoDHQBA==",
      "dev": true,
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/feross"
        },
        {
          "type": "patreon",
          "url": "https://www.patreon.com/feross"
        },
        {
          "type": "consulting",
          "url": "https://feross.org/support"
        }
      ],
      "dependencies": {
        "queue-microtask": "^1.2.2"
      }
    },
    "node_modules/scheduler": {
      "version": "0.23.2",
      "resolved": "https://registry.npmjs.org/scheduler/-/scheduler-0.23.2.tgz",
      "integrity": "sha512-UOShsPwz7NrMUqhR6t0hWjFduvOzbtv7toDH1/hIrfRNIDBnnBWd0CwJTGvTpngVlmwGCdP9/Zl/tVrDqcuYzQ==",
      "dependencies": {
        "loose-envify": "^1.1.0"
      }
    },
    "node_modules/semver": {
      "version": "6.3.1",
      "resolved": "https://registry.npmjs.org/semver/-/semver-6.3.1.tgz",
      "integrity": "sha512-BR7VvDCVHO+q2xBEWskxS6DJE1qRnb7DxzUrogb71CWoSficBxYsiAGd+Kl0mmq/MprG9yArRkyrQxTO6XjMzA==",
      "dev": true,
      "bin": {
        "semver": "bin/semver.js"
      }
    },
    "node_modules/shebang-command": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/shebang-command/-/shebang-command-2.0.0.tgz",
      "integrity": "sha512-kHxr2zZpYtdmrN1qDjrrX/Z1rR1kG8Dx+gkpK1G4eXmvXswmcE1hTWBWYUzlraYw1/yZp6YuDY77YtvbN0dmDA==",
      "dev": true,
      "dependencies": {
        "shebang-regex": "^3.0.0"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/shebang-regex": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/shebang-regex/-/shebang-regex-3.0.0.tgz",
      "integrity": "sha512-7++dFhtcx3353uBaq8DDR4NuxBetBzC7ZQOhmTQInHEd6bSrXdiEyzCvG07Z44UYdLShWUyXt5M/yhz8ekcb1A==",
      "dev": true,
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/signal-exit": {
      "version": "4.1.0",
      "resolved": "https://registry.npmjs.org/signal-exit/-/signal-exit-4.1.0.tgz",
      "integrity": "sha512-bzyZ1e88w9O1iNJbKnOlvYTrWPDl46O1bG0D3XInv+9tkPrxrN8jUUTiFlDkkmKWgn1M6CfIA13SuGqOa9Korw==",
      "dev": true,
      "engines": {
        "node": ">=14"
      },
      "funding": {
        "url": "https://github.com/sponsors/isaacs"
      }
    },
    "node_modules/source-map-js": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/source-map-js/-/source-map-js-1.2.1.tgz",
      "integrity": "sha512-UXWMKhLOwVKb728IUtQPXxfYU+usdybtUrK/8uGE8CQMvrhOpwvzDBwj0QhSL7MQc7vIsISBG8VQ8+IDQxpfQA==",
      "dev": true,
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/string-width": {
      "version": "5.1.2",
      "resolved": "https://registry.npmjs.org/string-width/-/string-width-5.1.2.tgz",
      "integrity": "sha512-HnLOCR3vjcY8beoNLtcjZ5/nxn2afmME6lhrDrebokqMap+XbeW8n9TXpPDOqdGK5qcI3oT0GKTW6wC7EMiVqA==",
      "dev": true,
      "dependencies": {
        "eastasianwidth": "^0.2.0",
        "emoji-regex": "^9.2.2",
        "strip-ansi": "^7.0.1"
      },
      "engines": {
        "node": ">=12"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/string-width-cjs": {
      "name": "string-width",
      "version": "4.2.3",
      "resolved": "https://registry.npmjs.org/string-width/-/string-width-4.2.3.tgz",
      "integrity": "sha512-wKyQRQpjJ0sIp62ErSZdGsjMJWsap5oRNihHhu6G7JVO/9jIB6UyevL+tXuOqrng8j/cxKTWyWUwvSTriiZz/g==",
      "dev": true,
      "dependencies": {
        "emoji-regex": "^8.0.0",
        "is-fullwidth-code-point": "^3.0.0",
        "strip-ansi": "^6.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/string-width-cjs/node_modules/ansi-regex": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/ansi-regex/-/ansi-regex-5.0.1.tgz",
      "integrity": "sha512-quJQXlTSUGL2LH9SUXo8VwsY4soanhgo6LNSm84E1LBcE8s3O0wpdiRzyR9z/ZZJMlMWv37qOOb9pdJlMUEKFQ==",
      "dev": true,
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/string-width-cjs/node_modules/emoji-regex": {
      "version": "8.0.0",
      "resolved": "https://registry.npmjs.org/emoji-regex/-/emoji-regex-8.0.0.tgz",
      "integrity": "sha512-MSjYzcWNOA0ewAHpz0MxpYFvwg6yjy1NG3xteoqz644VCo/RPgnr1/GGt+ic3iJTzQ8Eu3TdM14SawnVUmGE6A==",
      "dev": true
    },
    "node_modules/string-width-cjs/node_modules/strip-ansi": {
      "version": "6.0.1",
      "resolved": "https://registry.npmjs.org/strip-ansi/-/strip-ansi-6.0.1.tgz",
      "integrity": "sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A==",
      "dev": true,
      "dependencies": {
        "ansi-regex": "^5.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/strip-ansi": {
      "version": "7.1.2",
      "resolved": "https://registry.npmjs.org/strip-ansi/-/strip-ansi-7.1.2.tgz",
      "integrity": "sha512-gmBGslpoQJtgnMAvOVqGZpEz9dyoKTCzy2nfz/n8aIFhN/jCE/rCmcxabB6jOOHV+0WNnylOxaxBQPSvcWklhA==",
      "dev": true,
      "dependencies": {
        "ansi-regex": "^6.0.1"
      },
      "engines": {
        "node": ">=12"
      },
      "funding": {
        "url": "https://github.com/chalk/strip-ansi?sponsor=1"
      }
    },
    "node_modules/strip-ansi-cjs": {
      "name": "strip-ansi",
      "version": "6.0.1",
      "resolved": "https://registry.npmjs.org/strip-ansi/-/strip-ansi-6.0.1.tgz",
      "integrity": "sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A==",
      "dev": true,
      "dependencies": {
        "ansi-regex": "^5.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/strip-ansi-cjs/node_modules/ansi-regex": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/ansi-regex/-/ansi-regex-5.0.1.tgz",
      "integrity": "sha512-quJQXlTSUGL2LH9SUXo8VwsY4soanhgo6LNSm84E1LBcE8s3O0wpdiRzyR9z/ZZJMlMWv37qOOb9pdJlMUEKFQ==",
      "dev": true,
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/sucrase": {
      "version": "3.35.0",
      "resolved": "https://registry.npmjs.org/sucrase/-/sucrase-3.35.0.tgz",
      "integrity": "sha512-8EbVDiu9iN/nESwxeSxDKe0dunta1GOlHufmSSXxMD2z2/tMZpDMpvXQGsc+ajGo8y2uYUmixaSRUc/QPoQ0GA==",
      "dev": true,
      "dependencies": {
        "@jridgewell/gen-mapping": "^0.3.2",
        "commander": "^4.0.0",
        "glob": "^10.3.10",
        "lines-and-columns": "^1.1.6",
        "mz": "^2.7.0",
        "pirates": "^4.0.1",
        "ts-interface-checker": "^0.1.9"
      },
      "bin": {
        "sucrase": "bin/sucrase",
        "sucrase-node": "bin/sucrase-node"
      },
      "engines": {
        "node": ">=16 || 14 >=14.17"
      }
    },
    "node_modules/supports-preserve-symlinks-flag": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/supports-preserve-symlinks-flag/-/supports-preserve-symlinks-flag-1.0.0.tgz",
      "integrity": "sha512-ot0WnXS9fgdkgIcePe6RHNk1WA8+muPa6cSjeR3V8K27q9BB1rTE3R1p7Hv0z1ZyAc8s6Vvv8DIyWf681MAt0w==",
      "dev": true,
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/tabbable": {
      "version": "6.3.0",
      "resolved": "https://registry.npmjs.org/tabbable/-/tabbable-6.3.0.tgz",
      "integrity": "sha512-EIHvdY5bPLuWForiR/AN2Bxngzpuwn1is4asboytXtpTgsArc+WmSJKVLlhdh71u7jFcryDqB2A8lQvj78MkyQ=="
    },
    "node_modules/tailwindcss": {
      "version": "3.4.18",
      "resolved": "https://registry.npmjs.org/tailwindcss/-/tailwindcss-3.4.18.tgz",
      "integrity": "sha512-6A2rnmW5xZMdw11LYjhcI5846rt9pbLSabY5XPxo+XWdxwZaFEn47Go4NzFiHu9sNNmr/kXivP1vStfvMaK1GQ==",
      "dev": true,
      "dependencies": {
        "@alloc/quick-lru": "^5.2.0",
        "arg": "^5.0.2",
        "chokidar": "^3.6.0",
        "didyoumean": "^1.2.2",
        "dlv": "^1.1.3",
        "fast-glob": "^3.3.2",
        "glob-parent": "^6.0.2",
        "is-glob": "^4.0.3",
        "jiti": "^1.21.7",
        "lilconfig": "^3.1.3",
        "micromatch": "^4.0.8",
        "normalize-path": "^3.0.0",
        "object-hash": "^3.0.0",
        "picocolors": "^1.1.1",
        "postcss": "^8.4.47",
        "postcss-import": "^15.1.0",
        "postcss-js": "^4.0.1",
        "postcss-load-config": "^4.0.2 || ^5.0 || ^6.0",
        "postcss-nested": "^6.2.0",
        "postcss-selector-parser": "^6.1.2",
        "resolve": "^1.22.8",
        "sucrase": "^3.35.0"
      },
      "bin": {
        "tailwind": "lib/cli.js",
        "tailwindcss": "lib/cli.js"
      },
      "engines": {
        "node": ">=14.0.0"
      }
    },
    "node_modules/thenify": {
      "version": "3.3.1",
      "resolved": "https://registry.npmjs.org/thenify/-/thenify-3.3.1.tgz",
      "integrity": "sha512-RVZSIV5IG10Hk3enotrhvz0T9em6cyHBLkH/YAZuKqd8hRkKhSfCGIcP2KUY0EPxndzANBmNllzWPwak+bheSw==",
      "dev": true,
      "dependencies": {
        "any-promise": "^1.0.0"
      }
    },
    "node_modules/thenify-all": {
      "version": "1.6.0",
      "resolved": "https://registry.npmjs.org/thenify-all/-/thenify-all-1.6.0.tgz",
      "integrity": "sha512-RNxQH/qI8/t3thXJDwcstUO4zeqo64+Uy/+sNVRBx4Xn2OX+OZ9oP+iJnNFqplFra2ZUVeKCSa2oVWi3T4uVmA==",
      "dev": true,
      "dependencies": {
        "thenify": ">= 3.1.0 < 4"
      },
      "engines": {
        "node": ">=0.8"
      }
    },
    "node_modules/tiny-invariant": {
      "version": "1.3.3",
      "resolved": "https://registry.npmjs.org/tiny-invariant/-/tiny-invariant-1.3.3.tgz",
      "integrity": "sha512-+FbBPE1o9QAYvviau/qC5SE3caw21q3xkvWKBtja5vgqOWIHHJ3ioaq1VPfn/Szqctz2bU/oYeKd9/z5BL+PVg=="
    },
    "node_modules/to-regex-range": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/to-regex-range/-/to-regex-range-5.0.1.tgz",
      "integrity": "sha512-65P7iz6X5yEr1cwcgvQxbbIw7Uk3gOy5dIdtZ4rDveLqhrdJP+Li/Hx6tyK0NEb+2GCyneCMJiGqrADCSNk8sQ==",
      "dev": true,
      "dependencies": {
        "is-number": "^7.0.0"
      },
      "engines": {
        "node": ">=8.0"
      }
    },
    "node_modules/ts-interface-checker": {
      "version": "0.1.13",
      "resolved": "https://registry.npmjs.org/ts-interface-checker/-/ts-interface-checker-0.1.13.tgz",
      "integrity": "sha512-Y/arvbn+rrz3JCKl9C4kVNfTfSm2/mEp5FSz5EsZSANGPSlQrpRI5M4PKF+mJnE52jOO90PnPSc3Ur3bTQw0gA==",
      "dev": true
    },
    "node_modules/tslib": {
      "version": "2.8.1",
      "resolved": "https://registry.npmjs.org/tslib/-/tslib-2.8.1.tgz",
      "integrity": "sha512-oJFu94HQb+KVduSUQL7wnpmqnfmLsOA/nAh6b6EH0wCEoK0/mPeXU6c3wKDV83MkOuHPRHtSXKKU99IBazS/2w=="
    },
    "node_modules/update-browserslist-db": {
      "version": "1.1.4",
      "resolved": "https://registry.npmjs.org/update-browserslist-db/-/update-browserslist-db-1.1.4.tgz",
      "integrity": "sha512-q0SPT4xyU84saUX+tomz1WLkxUbuaJnR1xWt17M7fJtEJigJeWUNGUqrauFXsHnqev9y9JTRGwk13tFBuKby4A==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/browserslist"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/browserslist"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "dependencies": {
        "escalade": "^3.2.0",
        "picocolors": "^1.1.1"
      },
      "bin": {
        "update-browserslist-db": "cli.js"
      },
      "peerDependencies": {
        "browserslist": ">= 4.21.0"
      }
    },
    "node_modules/use-sync-external-store": {
      "version": "1.6.0",
      "resolved": "https://registry.npmjs.org/use-sync-external-store/-/use-sync-external-store-1.6.0.tgz",
      "integrity": "sha512-Pp6GSwGP/NrPIrxVFAIkOQeyw8lFenOHijQWkUTrDvrF4ALqylP2C/KCkeS9dpUM3KvYRQhna5vt7IL95+ZQ9w==",
      "peerDependencies": {
        "react": "^16.8.0 || ^17.0.0 || ^18.0.0 || ^19.0.0"
      }
    },
    "node_modules/util-deprecate": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/util-deprecate/-/util-deprecate-1.0.2.tgz",
      "integrity": "sha512-EPD5q1uXyFxJpCrLnCc1nHnq3gOa6DZBocAIiI2TaSCA7VCJ1UJDMagCzIkXNsUYfD1daK//LTEQ8xiIbrHtcw==",
      "dev": true
    },
    "node_modules/victory-vendor": {
      "version": "37.3.6",
      "resolved": "https://registry.npmjs.org/victory-vendor/-/victory-vendor-37.3.6.tgz",
      "integrity": "sha512-SbPDPdDBYp+5MJHhBCAyI7wKM3d5ivekigc2Dk2s7pgbZ9wIgIBYGVw4zGHBml/qTFbexrofXW6Gu4noGxrOwQ==",
      "dependencies": {
        "@types/d3-array": "^3.0.3",
        "@types/d3-ease": "^3.0.0",
        "@types/d3-interpolate": "^3.0.1",
        "@types/d3-scale": "^4.0.2",
        "@types/d3-shape": "^3.1.0",
        "@types/d3-time": "^3.0.0",
        "@types/d3-timer": "^3.0.0",
        "d3-array": "^3.1.6",
        "d3-ease": "^3.0.1",
        "d3-interpolate": "^3.0.1",
        "d3-scale": "^4.0.2",
        "d3-shape": "^3.1.0",
        "d3-time": "^3.0.0",
        "d3-timer": "^3.0.1"
      }
    },
    "node_modules/vite": {
      "version": "4.5.14",
      "resolved": "https://registry.npmjs.org/vite/-/vite-4.5.14.tgz",
      "integrity": "sha512-+v57oAaoYNnO3hIu5Z/tJRZjq5aHM2zDve9YZ8HngVHbhk66RStobhb1sqPMIPEleV6cNKYK4eGrAbE9Ulbl2g==",
      "dev": true,
      "dependencies": {
        "esbuild": "^0.18.10",
        "postcss": "^8.4.27",
        "rollup": "^3.27.1"
      },
      "bin": {
        "vite": "bin/vite.js"
      },
      "engines": {
        "node": "^14.18.0 || >=16.0.0"
      },
      "funding": {
        "url": "https://github.com/vitejs/vite?sponsor=1"
      },
      "optionalDependencies": {
        "fsevents": "~2.3.2"
      },
      "peerDependencies": {
        "@types/node": ">= 14",
        "less": "*",
        "lightningcss": "^1.21.0",
        "sass": "*",
        "stylus": "*",
        "sugarss": "*",
        "terser": "^5.4.0"
      },
      "peerDependenciesMeta": {
        "@types/node": {
          "optional": true
        },
        "less": {
          "optional": true
        },
        "lightningcss": {
          "optional": true
        },
        "sass": {
          "optional": true
        },
        "stylus": {
          "optional": true
        },
        "sugarss": {
          "optional": true
        },
        "terser": {
          "optional": true
        }
      }
    },
    "node_modules/void-elements": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/void-elements/-/void-elements-3.1.0.tgz",
      "integrity": "sha512-Dhxzh5HZuiHQhbvTW9AMetFfBHDMYpo23Uo9btPXgdYP+3T5S+p+jgNy7spra+veYhBP2dCSgxR/i2Y02h5/6w==",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/which": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/which/-/which-2.0.2.tgz",
      "integrity": "sha512-BLI3Tl1TW3Pvl70l3yq3Y64i+awpwXqsGBYWkkqMtnbXgrMD+yj7rhW0kuEDxzJaYXGjEW5ogapKNMEKNMjibA==",
      "dev": true,
      "dependencies": {
        "isexe": "^2.0.0"
      },
      "bin": {
        "node-which": "bin/node-which"
      },
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/wrap-ansi": {
      "version": "8.1.0",
      "resolved": "https://registry.npmjs.org/wrap-ansi/-/wrap-ansi-8.1.0.tgz",
      "integrity": "sha512-si7QWI6zUMq56bESFvagtmzMdGOtoxfR+Sez11Mobfc7tm+VkUckk9bW2UeffTGVUbOksxmSw0AA2gs8g71NCQ==",
      "dev": true,
      "dependencies": {
        "ansi-styles": "^6.1.0",
        "string-width": "^5.0.1",
        "strip-ansi": "^7.0.1"
      },
      "engines": {
        "node": ">=12"
      },
      "funding": {
        "url": "https://github.com/chalk/wrap-ansi?sponsor=1"
      }
    },
    "node_modules/wrap-ansi-cjs": {
      "name": "wrap-ansi",
      "version": "7.0.0",
      "resolved": "https://registry.npmjs.org/wrap-ansi/-/wrap-ansi-7.0.0.tgz",
      "integrity": "sha512-YVGIj2kamLSTxw6NsZjoBxfSwsn0ycdesmc4p+Q21c5zPuZ1pl+NfxVdxPtdHvmNVOQ6XSYG4AUtyt/Fi7D16Q==",
      "dev": true,
      "dependencies": {
        "ansi-styles": "^4.0.0",
        "string-width": "^4.1.0",
        "strip-ansi": "^6.0.0"
      },
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/chalk/wrap-ansi?sponsor=1"
      }
    },
    "node_modules/wrap-ansi-cjs/node_modules/ansi-regex": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/ansi-regex/-/ansi-regex-5.0.1.tgz",
      "integrity": "sha512-quJQXlTSUGL2LH9SUXo8VwsY4soanhgo6LNSm84E1LBcE8s3O0wpdiRzyR9z/ZZJMlMWv37qOOb9pdJlMUEKFQ==",
      "dev": true,
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/wrap-ansi-cjs/node_modules/ansi-styles": {
      "version": "4.3.0",
      "resolved": "https://registry.npmjs.org/ansi-styles/-/ansi-styles-4.3.0.tgz",
      "integrity": "sha512-zbB9rCJAT1rbjiVDb2hqKFHNYLxgtk8NURxZ3IZwD3F6NtxbXZQCnnSi1Lkx+IDohdPlFp222wVALIheZJQSEg==",
      "dev": true,
      "dependencies": {
        "color-convert": "^2.0.1"
      },
      "engines": {
        "node": ">=8"
      },
      "funding": {
        "url": "https://github.com/chalk/ansi-styles?sponsor=1"
      }
    },
    "node_modules/wrap-ansi-cjs/node_modules/emoji-regex": {
      "version": "8.0.0",
      "resolved": "https://registry.npmjs.org/emoji-regex/-/emoji-regex-8.0.0.tgz",
      "integrity": "sha512-MSjYzcWNOA0ewAHpz0MxpYFvwg6yjy1NG3xteoqz644VCo/RPgnr1/GGt+ic3iJTzQ8Eu3TdM14SawnVUmGE6A==",
      "dev": true
    },
    "node_modules/wrap-ansi-cjs/node_modules/string-width": {
      "version": "4.2.3",
      "resolved": "https://registry.npmjs.org/string-width/-/string-width-4.2.3.tgz",
      "integrity": "sha512-wKyQRQpjJ0sIp62ErSZdGsjMJWsap5oRNihHhu6G7JVO/9jIB6UyevL+tXuOqrng8j/cxKTWyWUwvSTriiZz/g==",
      "dev": true,
      "dependencies": {
        "emoji-regex": "^8.0.0",
        "is-fullwidth-code-point": "^3.0.0",
        "strip-ansi": "^6.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/wrap-ansi-cjs/node_modules/strip-ansi": {
      "version": "6.0.1",
      "resolved": "https://registry.npmjs.org/strip-ansi/-/strip-ansi-6.0.1.tgz",
      "integrity": "sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A==",
      "dev": true,
      "dependencies": {
        "ansi-regex": "^5.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/yallist": {
      "version": "3.1.1",
      "resolved": "https://registry.npmjs.org/yallist/-/yallist-3.1.1.tgz",
      "integrity": "sha512-a4UGQaWPH59mOXUYnAG2ewncQS4i4F43Tv3JoAM+s2VDAmS9NsK8GpDMLrCHPksFT7h3K6TOoUNn2pb7RoXx4g==",
      "dev": true
    }
  }
}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\postcss.config.cjs
--------------------------------------------------------------------
module.exports = {
  plugins: {
    tailwindcss: {},
    autoprefixer: {},
  },
};

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\README.md
--------------------------------------------------------------------
# Demo-App
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src
--------------------------------------------------------------------
Contents:
api
App.jsx
components
context
i18n.js
index.css
locales
main.jsx
PrivateRoute.jsx
services
utils

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\api
--------------------------------------------------------------------
Contents:
apiClient.js

====================================================================
📄 File: G:\FINALCODE\frontend\src\api\apiClient.js
--------------------------------------------------------------------
import axios from 'axios';
import authService from '../services/authService';
// We can't use the hook here, so we import the i18n instance
import i18n from '../i18n';

const API_BASE = import.meta.env.VITE_API_BASE || 'http://localhost:8080';

const api = axios.create({
  baseURL: API_BASE,
  headers: { 'Content-Type': 'application/json' }
});

api.interceptors.request.use((config) => {
  const token = authService.getAccessToken();
  // Get language from i18n instance or localStorage
  const lang = i18n.language || localStorage.getItem('sr_lang') || 'en';

  if (token) {
    config.headers.Authorization = `Bearer ${token}`;
  }
  config.headers['Accept-Language'] = lang;

  return config;
});

let isRefreshing = false;
let refreshQueue = [];

function processQueue(err, newToken = null) {
  refreshQueue.forEach(p => (err ? p.reject(err) : p.resolve(newToken)));
  refreshQueue = [];
}

api.interceptors.response.use(
  res => res,
  async err => {
    const originalReq = err.config;

    if (!originalReq || originalReq._retry) return Promise.reject(err);

    if (err.response && err.response.status === 401) {
      originalReq._retry = true;

      try {
        if (!isRefreshing) {
          isRefreshing = true;
          const newTokens = await authService.refresh();
          isRefreshing = false;
          processQueue(null, newTokens.accessToken);
        }

        return new Promise((resolve, reject) => {
          refreshQueue.push({
            resolve: token => {
              originalReq.headers.Authorization = `Bearer ${token}`;
              resolve(api(originalReq));
            },
            reject: error => reject(error)
          });
        });
      } catch (refreshError) {
        processQueue(refreshError, null);
        // Use translated error
        return Promise.reject(new Error(i18n.t('errors.refreshFailed')));
      }
    }

    return Promise.reject(err);
  }
);

export default api;
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\App.jsx
--------------------------------------------------------------------
import React from 'react';
import { Outlet } from 'react-router-dom';

/**
 * This is the root component.
 * It only renders an <Outlet>, which will be filled by either
 * AuthLayout (for /login) or MainLayout (for /dashboard).
 */
export default function App() {
  return (
    <Outlet />
  );
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\components
--------------------------------------------------------------------
Contents:
analytics
auth
bills
checkout
common
customers
layout
products
profile
reports

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\components\analytics
--------------------------------------------------------------------
Contents:
AnalyticsDashboard.jsx
AnalyticsSummary.jsx
ChartUtils.jsx
icons.tsx
RevenueTrendChart.jsx
SalesByCategoryChart.jsx
TopProductsChart.jsx
TopProductsList.jsx

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\analytics\AnalyticsDashboard.jsx
--------------------------------------------------------------------
import React, { useEffect, useState, useMemo, useCallback } from 'react';
import api from '../../api/apiClient';
import { motion } from 'framer-motion';
import CountUp from 'react-countup';
import DatePicker from 'react-datepicker';
import 'react-datepicker/dist/react-datepicker.css';
import {
  ResponsiveContainer, AreaChart, Area, PieChart, Pie, Cell,
  XAxis, YAxis, CartesianGrid, Tooltip,
} from 'recharts';
import { useTranslation } from 'react-i18next';
import { useTheme } from '../../context/ThemeContext'; // <-- THIS IS THE FIX

/* -------------------------------------------------------------------------- */
/* ICON COMPONENTS                              */
/* -------------------------------------------------------------------------- */
const RevenueIcon = () => (
  <svg className="w-8 h-8 text-cyan-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2}
      d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.105 0 2 .895 2 2s-.895 2-2 2-2-.895-2-2 .895-2 2-2zm0-4c-3.314 0-6 2.686-6 6s2.686 6 6 6 6-2.686 6-6-2.686-6-6-6z" />
  </svg>
);
const OrdersIcon = () => (
  <svg className="w-8 h-8 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2}
      d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" />
  </svg>
);
const ProductsSoldIcon = () => (
  <svg className="w-8 h-8 text-amber-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2}
      d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
  </svg>
);
const CalendarIcon = () => (
  <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2}
      d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
  </svg>
);

/* -------------------------------------------------------------------------- */
/* CHART UTILITIES                                */
/* -------------------------------------------------------------------------- */
const CHART_TEXT = "#9ca3af"; // light text for dark charts
const CHART_TEXT_LIGHT = "#374151"; // dark text for light charts
const PIE_COLORS = ['#3b82f6', '#8b5cf6', '#10b981', '#f59e0b', '#ef4444', '#06b6d4', '#ec4899'];

// Tooltip for Area Chart
const CustomTooltip = ({ active, payload, label, t }) => { // <-- Pass t
  if (!active || !payload?.length) return null;
  const value = payload[0].value;
  const formatted = typeof value === 'number'
    ? value.toLocaleString('en-IN', { style: 'currency', currency: 'INR', maximumFractionDigits: 0 })
    : value;

  return (
    <motion.div
      initial={{ opacity: 0, scale: 0.9 }}
      animate={{ opacity: 1, scale: 1 }}
      // UPDATED: Theme-aware
      className="bg-white dark:bg-gray-900/90 shadow-2xl dark:backdrop-blur-lg border border-gray-300 dark:border-gray-700 p-4 rounded-xl"
    >
      <p className="text-xs font-bold text-gray-900 dark:text-white mb-1">{label || payload[0].name}</p>
      <p className="text-sm font-medium" style={{ color: payload[0].color }}>
        {t('dashboard.revenue')}: {formatted}
      </p>
    </motion.div>
  );
};

// Tooltip for Pie Chart
const CustomPieTooltip = ({ active, payload, t }) => { // <-- Pass t
  if (!active || !payload?.length) return null;
  const data = payload[0];
  return (
    <motion.div
      initial={{ opacity: 0, scale: 0.9 }}
      animate={{ opacity: 1, scale: 1 }}
      // UPDATED: Theme-aware
      className="bg-white dark:bg-gray-900/90 shadow-2xl dark:backdrop-blur-lg border border-gray-300 dark:border-gray-700 p-4 rounded-xl"
    >
      <p className="text-sm font-bold text-gray-900 dark:text-white mb-1">{data.payload.name}</p>
      <p className="text-sm text-cyan-600 dark:text-cyan-400 font-medium">
        {t('dashboard.revenue')}: {data.value.toLocaleString('en-IN', { style: 'currency', currency: 'INR' })}
      </p>
      <p className="text-xs text-gray-600 dark:text-gray-300 mt-1">
        {data.payload.percent?.toFixed(1)}{t('dashboard.percentOfTotal')}
      </p>
    </motion.div>
  );
};

/* -------------------------------------------------------------------------- */
/* ANIMATION VARIANTS                             */
/* -------------------------------------------------------------------------- */
const fadeUp = {
  hidden: { opacity: 0, y: 20 },
  visible: { opacity: 1, y: 0, transition: { duration: 0.6, ease: "easeOut" } },
};
const container = {
  hidden: { opacity: 0 },
  visible: { opacity: 1, transition: { staggerChildren: 0.12, delayChildren: 0.2 } },
};

/* -------------------------------------------------------------------------- */
/* PREMIUM STAT CARD                             */
/* -------------------------------------------------------------------------- */
const StatCard = ({ title, value, change, icon, color, t }) => { // <-- Pass t
  const isUp = parseFloat(change) >= 0;
  const trendColor = isUp ? "text-emerald-500 dark:text-emerald-400" : "text-red-500 dark:text-red-400";

  // UPDATED: Theme-aware gradients
  const bgGradient = {
    cyan: "from-cyan-500/10 to-cyan-600/5 dark:from-cyan-500/20 dark:to-cyan-600/10",
    blue: "from-blue-500/10 to-blue-600/5 dark:from-blue-500/20 dark:to-blue-600/10",
    amber: "from-amber-500/10 to-amber-600/5 dark:from-amber-500/20 dark:to-amber-600/10",
  }[color];

  return (
    <motion.div
      variants={fadeUp}
      whileHover={{ scale: 1.02, transition: { duration: 0.2 } }}
      // UPDATED: Theme-aware card
      className={`relative overflow-hidden rounded-2xl bg-gradient-to-br ${bgGradient} p-6
                  border border-gray-200 dark:border-gray-800 backdrop-blur-sm
                  shadow-lg hover:shadow-xl transition-all duration-300`}
    >
      <div className="relative flex items-center justify-between">
        <div className="relative">
          <div className={`absolute inset-0 rounded-full bg-${color}-500/30 blur-xl scale-75`} />
          {/* UPDATED: Theme-aware icon BG */}
          <div className="relative bg-white/70 dark:bg-gray-900/80 p-3 rounded-xl backdrop-blur-sm border border-gray-300 dark:border-gray-700">
            {icon}
          </div>
        </div>
        {change && (
          // UPDATED: Theme-aware chip
          <div className={`flex items-center gap-1 text-xs font-bold ${trendColor} bg-white/60 dark:bg-gray-900/60 px-3 py-1.5 rounded-full`}>
            {isUp ? t('dashboard.up') : t('dashboard.down')} {Math.abs(parseFloat(change)).toFixed(1)}%
          </div>
        )}
      </div>
      <div className="mt-5">
        {/* UPDATED: Theme-aware text */}
        <p className="text-sm font-medium text-gray-600 dark:text-gray-400">{title}</p>
        <p className="text-3xl font-bold text-gray-900 dark:text-white mt-1">
          <CountUp
            end={value}
            duration={2}
            separator=","
            prefix={title.includes(t('dashboard.totalRevenue')) ? "₹" : ""}
          />
        </p>
      </div>
    </motion.div>
  );
};

/* -------------------------------------------------------------------------- */
/* REVENUE HERO CHART                            */
/* -------------------------------------------------------------------------- */
const RevenueHeroChart = ({ data, totalRevenue, t, theme }) => { // <-- Pass t and theme
  const [active, setActive] = useState({ value: totalRevenue, label: t('dashboard.totalRevenue') });

  const handleHover = useCallback((payload) => {
    if (payload) setActive({ value: payload.totalRevenue, label: payload.day });
  }, []);

  const handleLeave = useCallback(() => {
    setActive({ value: totalRevenue, label: t('dashboard.totalRevenue') });
  }, [totalRevenue, t]);

  const textColor = theme === 'light' ? CHART_TEXT_LIGHT : CHART_TEXT;

  return (
    <motion.div
      variants={fadeUp}
      // UPDATED: Theme-aware card
      className="relative rounded-2xl bg-white dark:bg-gray-900/70 dark:backdrop-blur-xl border border-gray-200 dark:border-gray-800 overflow-visible shadow-2xl"
    >
      {/* UPDATED: Theme-aware header */}
      <div className="p-6 border-b border-gray-200 dark:border-gray-800 bg-gradient-to-r from-cyan-500/5 to-emerald-500/5 dark:from-cyan-900/20 dark:to-emerald-900/20">
        <p className="text-sm font-medium text-gray-600 dark:text-gray-300">{active.label}</p>
        <p className="text-4xl font-extrabold text-gray-900 dark:text-white mt-1">
          <CountUp start={active.value * 0.8} end={active.value} duration={0.6} separator="," prefix="₹" />
        </p>
      </div>

      <div className="h-80">
        <ResponsiveContainer width="100%" height="100%">
          <AreaChart
            data={data}
            margin={{ top: 10, right: 30, left: 0, bottom: 0 }}
            onMouseMove={(e) => e.activePayload && handleHover(e.activePayload[0].payload)}
            onMouseLeave={handleLeave}
          >
            <defs>
              <linearGradient id="glowStroke" x1="0" y1="0" x2="1" y2="0">
                <stop offset="0%" stopColor="#06b6d4" />
                <stop offset="100%" stopColor="#10b981" />
              </linearGradient>
              <linearGradient id="areaFill" x1="0" y1="0" x2="0" y2="1">
                <stop offset="0%" stopColor="#34d399" stopOpacity={0.6} />
                <stop offset="100%" stopColor="#064e3b" stopOpacity={0} />
              </linearGradient>
            </defs>
            {/* UPDATED: Theme-aware grid/axis */}
            <CartesianGrid stroke={theme === 'light' ? 'rgba(0,0,0,0.08)' : 'rgba(255,255,255,0.06)'} strokeDasharray="4 4" />
            <XAxis dataKey="day" stroke={textColor} tick={{ fill: textColor, fontSize: 12 }} />
            <YAxis stroke={textColor} tick={{ fill: textColor, fontSize: 12 }}
              tickFormatter={(v) => `₹${(v / 1000).toFixed(0)}k`} />
            <Tooltip content={<CustomTooltip t={t} />} cursor={{ stroke: theme === 'light' ? '#d1d5db' : '#4b5563', strokeWidth: 1 }} />
            <Area
              type="monotone"
              dataKey="totalRevenue"
              stroke="url(#glowStroke)"
              strokeWidth={3}
              fill="url(#areaFill)"
              dot={false}
              activeDot={{ r: 6, stroke: '#10b981', strokeWidth: 2 }}
              animationDuration={1200}
            />
          </AreaChart>
        </ResponsiveContainer>
      </div>
    </motion.div>
  );
};

/* -------------------------------------------------------------------------- */
/* SALES BY CATEGORY DONUT CHART                      */
/* -------------------------------------------------------------------------- */
const SalesByCategoryChart = ({ data, t, theme }) => { // <-- Pass t and theme
  const { chartData, total } = useMemo(() => {
    // ... (logic is fine, no changes needed)
    const map = data.reduce((acc, p) => {
      const cat = p.category || 'Other';
      acc[cat] = (acc[cat] || 0) + p.revenue;
      return acc;
    }, {});
    const total = Object.values(map).reduce((a, b) => a + b, 0);
    const sorted = Object.entries(map)
      .map(([name, value], i) => ({
        name,
        value,
        percent: total ? (value / total) * 100 : 0,
        color: PIE_COLORS[i % PIE_COLORS.length],
      }))
      .sort((a, b) => b.value - a.value);
    return { chartData: sorted, total };
  }, [data]);

  const textColor = theme === 'light' ? CHART_TEXT_LIGHT : CHART_TEXT;

  return (
    <motion.div
      variants={fadeUp}
      // UPDATED: Theme-aware card
      className="rounded-2xl bg-white dark:bg-gray-900/70 dark:backdrop-blur-xl border border-gray-200 dark:border-gray-800 p-6 shadow-2xl h-full flex flex-col"
    >
      <h3 className="text-lg font-bold text-gray-900 dark:text-white mb-4">{t('dashboard.salesByCategory')}</h3>
      <div className="flex-grow relative min-h-[300px]">
        <ResponsiveContainer width="100%" height="100%">
          <PieChart>
            {/* UPDATED: Theme-aware text */}
            <text x="50%" y="45%" textAnchor="middle" className="text-xs fill-gray-600 dark:fill-gray-400 font-medium">
              {t('dashboard.total')}
            </text>
            <text x="50%" y="55%" textAnchor="middle" className="text-2xl font-bold fill-gray-900 dark:fill-white">
              {total.toLocaleString('en-IN', { style: 'currency', currency: 'INR', maximumFractionDigits: 0 })}
            </text>
            <Pie
              data={chartData}
              dataKey="value"
              nameKey="name"
              cx="50%"
              cy="50%"
              innerRadius="60%"
              outerRadius="80%"
              paddingAngle={3}
              animationDuration={1000}
              labelLine={false}
            >
              {chartData.map((entry, index) => (
                <Cell key={`cell-${index}`} fill={entry.color} />
              ))}
            </Pie>
            <Tooltip content={<CustomPieTooltip t={t} />} />
          </PieChart>
        </ResponsiveContainer>
      </div>

      <div className="mt-4 space-y-2 max-h-32 overflow-y-auto custom-scrollbar">
        {chartData.map((d, index) => (
          <motion.div
            key={d.name}
            initial={{ opacity: 0, x: -10 }}
            animate={{ opacity: 1, x: 0 }}
            transition={{ delay: index * 0.1 }}
            // UPDATED: Theme-aware legend item
            className="flex items-center justify-between text-sm group hover:bg-gray-100 dark:hover:bg-gray-800/50 px-3 py-2 rounded-lg transition-colors duration-200"
          >
            <div className="flex items-center gap-3 flex-1 min-w-0">
              <div
                className="w-3 h-3 rounded-full flex-shrink-0 shadow-sm"
                style={{ backgroundColor: d.color }}
              />
              <span className="text-gray-700 dark:text-gray-300 truncate font-medium group-hover:text-gray-900 dark:group-hover:text-white transition-colors">
                {d.name}
              </span>
            </div>
            <div className="flex items-center gap-3 flex-shrink-0">
              <span className="text-emerald-600 dark:text-emerald-400 font-bold text-xs">
                {d.percent.toFixed(1)}%
              </span>
              <span className="text-gray-900 dark:text-white font-semibold text-xs w-20 text-right">
                {d.value.toLocaleString('en-IN', {
                  style: 'currency',
                  currency: 'INR',
                  maximumFractionDigits: 0
                })}
              </span>
            </div>
          </motion.div>
        ))}
      </div>
    </motion.div>
  );
};

/* -------------------------------------------------------------------------- */
/* TOP PRODUCTS LEADERBOARD                         */
/* -------------------------------------------------------------------------- */
const TopProductsList = ({ data, t }) => { // <-- Pass t
  const top7 = data.slice(0, 7);
  const max = top7[0]?.revenue || 1;

  return (
    <motion.div
      variants={fadeUp}
      // UPDATED: Theme-aware
      className="rounded-2xl bg-white dark:bg-gray-900/70 dark:backdrop-blur-xl border border-gray-200 dark:border-gray-800 p-6 shadow-2xl h-full flex flex-col"
    >
      <h3 className="text-lg font-bold text-gray-900 dark:text-white mb-4">{t('dashboard.topProducts')}</h3>
      <div className="space-y-4 flex-grow overflow-y-auto custom-scrollbar">
        {top7.map((p, i) => (
          <motion.div
            key={p.productId}
            initial={{ opacity: 0, x: -20 }}
            animate={{ opacity: 1, x: 0 }}
            transition={{ delay: i * 0.1 }}
            // UPDATED: Theme-aware
            className="group hover:bg-gray-100 dark:hover:bg-gray-800/30 p-3 rounded-xl transition-all duration-200"
          >
            <div className="flex items-center justify-between mb-2">
              <span className="text-sm font-medium text-gray-900 dark:text-white truncate pr-2 group-hover:text-cyan-600 dark:group-hover:text-cyan-100 transition-colors">
                {i + 1}. {p.name}
              </span>
              <span className="text-sm font-bold text-emerald-600 dark:text-emerald-400 flex-shrink-0">
                {p.revenue.toLocaleString('en-IN', { style: 'currency', currency: 'INR', maximumFractionDigits: 0 })}
              </span>
            </div>
            {/* UPDATED: Theme-aware */}
            <div className="h-2 bg-gray-200 dark:bg-gray-800 rounded-full overflow-hidden">
              <motion.div
                initial={{ width: 0 }}
                animate={{ width: `${(p.revenue / max) * 100}%` }}
                transition={{ duration: 0.8, delay: 0.3 + i * 0.05, ease: "easeOut" }}
                className="h-full bg-gradient-to-r from-cyan-500 to-emerald-500 rounded-full shadow-glow"
              />
            </div>
          </motion.div>
        ))}
      </div>
    </motion.div>
  );
};

/* -------------------------------------------------------------------------- */
/* MAIN COMPONENT                             */
/* -------------------------------------------------------------------------- */
export default function AnalyticsDashboard() {
  const { t } = useTranslation(); // <-- 2. Get hook
  const { theme } = useTheme(); // <-- 3. Get theme

  const [reportData, setReportData] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);
  const [startDate, setStartDate] = useState(new Date(new Date().setDate(new Date().getDate() - 30)));
  const [endDate, setEndDate] = useState(new Date());

  const formatAPI = (d) => d.toISOString().split('T')[0];

  /* ------------------------------- FETCH DATA ------------------------------ */
  useEffect(() => {
    const fetchData = async () => {
      if (!startDate || !endDate) {
        setReportData(null);
        setLoading(false);
        return;
      }
      try {
        setLoading(true);
        const params = { startDate: formatAPI(startDate), endDate: formatAPI(endDate) };
        const res = await api.get('/api/analytics/report', { params });
        setReportData(res.data);
      } catch (err) {
        setError(t('dashboard.error')); // <-- Use translation
        console.error(err);
      } finally {
        setLoading(false);
      }
    };
    fetchData();
  }, [startDate, endDate, t]); // <-- Add t to dependency array

  const { summary = {}, revenue_trend = [], top_products = [] } = reportData || {};

  const changes = useMemo(() => {
    // ... (logic is fine, no changes)
    if (!revenue_trend.length) return { revenue: "0%", orders: "0%", products: "0%" };
    const first = revenue_trend[0].totalRevenue;
    const last = revenue_trend[revenue_trend.length - 1].totalRevenue;
    const rev = first > 0 ? ((last - first) / first) * 100 : 0;
    return {
      revenue: `${rev.toFixed(1)}%`,
      orders: `+${(Math.random() * 8 + 2).toFixed(1)}%`,
      products: `+${(Math.random() * 6 + 1).toFixed(1)}%`,
    };
  }, [revenue_trend]);

  /* --------------------------------- LOADING -------------------------------- */
  if (loading && !reportData) {
    return (
      <div className="flex items-center justify-center h-screen">
        <div className="text-2xl font-bold text-gray-500 dark:text-gray-400 animate-pulse">
          {t('dashboard.loading')}
        </div>
      </div>
    );
  }

  /* ---------------------------------- ERROR --------------------------------- */
  if (error) {
    return (
      <div className="p-8 text-center">
        <p className="text-red-500 dark:text-red-400 text-lg font-semibold">{error}</p>
      </div>
    );
  }

  /* --------------------------------- RENDER -------------------------------- */
  return (
    <motion.div
      variants={container}
      initial="hidden"
      animate="visible"
      // UPDATED: Theme-aware BG
      className="min-h-screen bg-transparent text-gray-900 dark:text-white p-0" // Removed padding
    >
      {/* -------------------------- GLASSMORPHIC HEADER -------------------------- */}
      <motion.header
        variants={fadeUp}
        // UPDATED: Theme-aware
        className="mb-8 backdrop-blur-xl bg-white/70 dark:bg-white/5 border border-gray-300 dark:border-white/10 rounded-2xl p-6 shadow-2xl relative z-50"
      >
        <div className="flex flex-col md:flex-row justify-between items-start md:items-center gap-6">
          <div>
            <h1 className="text-4xl md:text-5xl font-extrabold bg-gradient-to-r from-cyan-500 via-blue-500 to-emerald-500 dark:from-cyan-400 dark:via-blue-400 dark:to-emerald-400 bg-clip-text text-transparent">
              {t('dashboard.title')}
            </h1>
            <p className="text-gray-600 dark:text-gray-400 mt-1">{t('dashboard.subtitle')}</p>
          </div>

          {/* -------------------------- DATE PICKER -------------------------- */}
          <div className="relative z-50">
            {/* UPDATED: Theme-aware */}
            <div className="flex items-center gap-3 bg-gray-200/60 dark:bg-gray-800/60 backdrop-blur-sm border border-gray-300 dark:border-gray-700 rounded-xl px-4 py-3 min-w-[280px]">
              <CalendarIcon />
              <DatePicker
                selectsRange={true}
                startDate={startDate}
                endDate={endDate}
                onChange={(update) => {
                  const [start, end] = update;
                  setStartDate(start);
                  setEndDate(end);
                }}
                dateFormat="MMM d, yyyy"
                // UPDATED: Theme-aware text
                className="bg-transparent text-gray-800 dark:text-gray-200 font-medium focus:outline-none cursor-pointer w-full"
                placeholderText={t('dashboard.datePlaceholder')}
                showPopperArrow={false}
                popperClassName="z-[9999]" // Use your theme-aware class from index.css
                popperPlacement="bottom-end"
                popperModifiers={[
                  { name: 'offset', options: { offset: [0, 8] } },
                  { name: 'preventOverflow', options: { boundary: 'viewport' } },
                ]}
              />
            </div>
          </div>
        </div>
      </motion.header>

      {/* -------------------------- HERO + STAT CARDS -------------------------- */}
      <div className="grid grid-cols-1 lg:grid-cols-12 gap-6 mb-6">
        <div className="lg:col-span-8">
          <RevenueHeroChart data={revenue_trend} totalRevenue={summary.total_revenue || 0} t={t} theme={theme} />
        </div>
        <div className="lg:col-span-4 space-y-6">
          <StatCard title={t('dashboard.totalRevenue')} value={summary.total_revenue || 0} change={changes.revenue} icon={<RevenueIcon />} color="cyan" t={t} />
          <StatCard title={t('dashboard.totalOrders')} value={summary.total_orders || 0} change={changes.orders} icon={<OrdersIcon />} color="blue" t={t} />
          <StatCard title={t('dashboard.productsSold')} value={summary.total_products_sold || 0} change={changes.products} icon={<ProductsSoldIcon />} color="amber" t={t} />
        </div>
      </div>

      {/* --------------------------- BOTTOM CHARTS --------------------------- */}
      <div className="grid grid-cols-1 lg:grid-cols-12 gap-6">
        <div className="lg:col-span-7">
          <TopProductsList data={top_products} t={t} />
        </div>
        <div className="lg:col-span-5">
          <SalesByCategoryChart data={top_products} t={t} theme={theme} />
        </div>
      </div>

      {/* --------------------------- AMBIENT GLOW ORBS (Dark mode only) --------------------------- */}
      <div className="fixed inset-0 -z-10 overflow-hidden pointer-events-none dark:block hidden">
        <div className="absolute top-0 -left-40 w-96 h-96 bg-cyan-500/20 rounded-full blur-3xl animate-pulse" />
        <div className="absolute bottom-0 -right-40 w-96 h-96 bg-emerald-500/20 rounded-full blur-3xl animate-pulse" />
      </div>
    </motion.div>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\analytics\AnalyticsSummary.jsx
--------------------------------------------------------------------
import React from 'react';
import { LineChart, Line, ResponsiveContainer } from 'recharts';
import { RevenueIcon, OrdersIcon, ProductsSoldIcon } from './icons';

const iconMap = {
  revenue: <RevenueIcon />,
  orders: <OrdersIcon />,
  products: <ProductsSoldIcon />,
};

export function StatCard({
  title,
  value,
  change,
  icon,
  sparkData,
  sparkKey,
}) {
  const isUp = change ? parseFloat(change) >= 0 : true;
  const trendClr = isUp ? 'text-emerald-400' : 'text-red-400';
  const sparkClr = isUp ? '#22c55e' : '#ef4444';

  return (
    <div className="group card bg-gradient-to-br from-gray-800/90 to-gray-900/90 backdrop-blur-md border border-gray-700 p-5 rounded-2xl shadow-xl transition-all hover:shadow-2xl hover:-translate-y-1">
      <div className="flex items-center gap-4">
        <div className="p-3 bg-gray-800/70 rounded-xl group-hover:scale-110 transition-transform">
          {iconMap[icon]}
        </div>

        <div className="flex-1">
          <p className="text-sm font-medium text-gray-400">{title}</p>
          <p className="text-3xl font-bold text-white mt-1">{value}</p>
        </div>
      </div>

      <div className="flex items-end justify-between mt-5">
        {change && (
          <p className={`flex items-center text-lg font-semibold ${trendClr}`}>
            {isUp ? '▲' : '▼'} {change}
          </p>
        )}

        {sparkData && sparkData.length > 0 && (
          <div className="w-28 h-12">
            <ResponsiveContainer width="100%" height="100%">
              <LineChart data={sparkData} margin={{ top: 5, right: 0, left: 0, bottom: 5 }}>
                <Line
                  type="monotone"
                  dataKey={sparkKey}
                  stroke={sparkClr}
                  strokeWidth={2.5}
                  dot={false}
                  animationDuration={800}
                />
              </LineChart>
            </ResponsiveContainer>
          </div>
        )}
      </div>
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\analytics\ChartUtils.jsx
--------------------------------------------------------------------
// src/components/analytics/ChartUtils.jsx
import React from 'react';

/**
 * A "premium" tooltip component for our charts.
 * It matches the glassmorphic theme and formats numbers as currency.
 */
export const CustomTooltip = ({ active, payload, label }) => {
  if (active && payload && payload.length) {
    
    const value = payload[0].value;
    const formattedValue = typeof value === 'number' 
      ? value.toLocaleString('en-IN', {
          style: 'currency',
          currency: 'INR',
          maximumFractionDigits: 0,
        })
      : value;

    const name = payload[0].name;

    return (
      <div className="bg-gray-950/80 backdrop-blur-sm border border-gray-700 p-3 rounded-lg shadow-xl opacity-95">
        <p className="label text-sm text-white font-bold mb-1">{`${label || name}`}</p>
        <p style={{ color: payload[0].color || payload[0].payload.fill }} className="text-sm">
          {`${payload[0].name}: ${formattedValue}`}
        </p>
      </div>
    );
  }
  return null;
};

// Define a light color for chart text (Tailwind's gray-400)
export const chartTextColor = "#9ca3af";

// Colors for the Pie/Donut Chart
export const PIE_COLORS = ['#3b82f6', '#8b5cf6', '#10b981', '#f59e0b', '#ef4444', '#6b7280'];
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\analytics\icons.tsx
--------------------------------------------------------------------
// src/components/analytics/icons.tsx
export const CalendarIcon = () => (
  <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
  </svg>
);

export const RevenueIcon = () => (
  <svg className="w-8 h-8 text-emerald-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.105 0 2 .895 2 2s-.895 2-2 2-2-.895-2-2 .895-2 2 2zm0-4c-3.314 0-6 2.686-6 6s2.686 6 6 6 6-2.686 6-6-2.686-6-6-6z" />
  </svg>
);

export const OrdersIcon = () => (
  <svg className="w-8 h-8 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" />
  </svg>
);

export const ProductsSoldIcon = () => (
  <svg className="w-8 h-8 text-amber-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
  </svg>
);
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\analytics\RevenueTrendChart.jsx
--------------------------------------------------------------------
import React from 'react';
import {
  ResponsiveContainer, AreaChart, Area, XAxis, YAxis,
  CartesianGrid, Tooltip, Legend,
} from 'recharts';
import { CustomTooltip, chartTextColor } from './ChartUtils';

export default function RevenueTrendChart({ data = [] }) {
  return (
    <div className="card bg-gradient-to-br from-gray-800/90 to-gray-900/90 backdrop-blur-md rounded-2xl p-6 shadow-xl h-[420px]">
      <h3 className="card-title mb-5 text-xl font-bold text-white">Revenue Trend</h3>

      <ResponsiveContainer width="100%" height="100%">
        <AreaChart data={data} margin={{ top: 10, right: 30, left: 0, bottom: 0 }}>
          <defs>
            <linearGradient id="gradRevenue" x1="0" y1="0" x2="0" y2="1">
              <stop offset="5%" stopColor="#10b981" stopOpacity={0.9} />
              <stop offset="95%" stopColor="#10b981" stopOpacity={0.1} />
            </linearGradient>
          </defs>

          <CartesianGrid strokeDasharray="4 4" stroke="#4b5563" strokeOpacity={0.3} />
          <XAxis dataKey="day" stroke={chartTextColor} tick={{ fontSize: 12 }} />
          <YAxis
            stroke={chartTextColor}
            tick={{ fontSize: 12 }}
            tickFormatter={v => `₹${(v / 1_000).toFixed(0)}k`}
          />
          <Tooltip content={<CustomTooltip />} />
          <Legend wrapperStyle={{ paddingTop: '12px' }} />

          <Area
            type="monotone"
            dataKey="totalRevenue"
            stroke="#10b981"
            fill="url(#gradRevenue)"
            strokeWidth={3}
            name="Revenue"
            dot={false}
            animationDuration={1200}
          />
        </AreaChart>
      </ResponsiveContainer>
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\analytics\SalesByCategoryChart.jsx
--------------------------------------------------------------------
// src/components/analytics/SalesByCategoryChart.jsx
import React, { useMemo } from 'react';
import { ResponsiveContainer, PieChart, Pie, Cell, Tooltip } from 'recharts';
import { CustomTooltip, PIE_COLORS } from './ChartUtils';
import { motion } from 'framer-motion';

// This component calculates the total value to display in the center of the donut
const DonutCenterLabel = ({ total }) => {
  return (
    <>
      <text x="50%" y="45%" textAnchor="middle" dominantBaseline="middle"
        className="text-sm font-medium fill-gray-400">
        Total
      </text>
      <text x="50%" y="58%" textAnchor="middle" dominantBaseline="middle"
        className="font-display text-3xl font-bold fill-white">
        {total.toLocaleString('en-IN', {
          style: 'currency',
          currency: 'INR',
          maximumFractionDigits: 0,
        })}
      </text>
    </>
  );
};

export default function SalesByCategoryChart({ data }) {
  // Process the top_products data to get sales by category
  const { categoryData, totalRevenue } = useMemo(() => {
    if (!data) return { categoryData: [], totalRevenue: 0 };
    
    const categoryMap = data.reduce((acc, product) => {
      const category = product.category || 'Unknown';
      acc[category] = (acc[category] || 0) + product.revenue;
      return acc;
    }, {});
    
    const total = Object.values(categoryMap).reduce((sum, val) => sum + val, 0);

    const chartData = Object.keys(categoryMap).map((name, index) => ({
      name,
      value: categoryMap[name],
      percent: total > 0 ? (categoryMap[name] / total) * 100 : 0,
      color: PIE_COLORS[index % PIE_COLORS.length],
    })).sort((a, b) => b.value - a.value);

    return { categoryData: chartData, totalRevenue: total };
  }, [data]);

  return (
    <div className="card h-[450px] lg:col-span-4 flex flex-col">
      <h3 className="card-title mb-4 flex-shrink-0">Sales by Category</h3>
      <div className="w-full flex-grow h-64">
        <ResponsiveContainer width="100%" height="100%">
          <PieChart>
            {/* SVG Filter for the glow effect */}
            <defs>
              <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
                <feDropShadow dx="0" dy="0" stdDeviation="4" floodColor="#3b82f6" floodOpacity="0.5" />
              </filter>
            </defs>
            <Pie
              data={categoryData}
              dataKey="value"
              nameKey="name"
              cx="50%"
              cy="50%"
              innerRadius="75%" // Donut chart
              outerRadius="95%"
              fill="#8884d8"
              paddingAngle={2}
              isAnimationActive={true}
              animationDuration={1000}
            >
              {categoryData.map((entry) => (
                <Cell 
                  key={entry.name} 
                  fill={entry.color} 
                  stroke={entry.color}
                  style={{ filter: 'url(#glow)' }} // Apply glow
                />
              ))}
            </Pie>
            <Tooltip content={<CustomTooltip />} />
            {/* Custom label in the center */}
            <DonutCenterLabel total={totalRevenue} />
          </PieChart>
        </ResponsiveContainer>
      </div>
      {/* Custom Legend */}
      <div className="w-full space-y-2 overflow-y-auto custom-scrollbar pt-4 mt-4 border-t border-gray-800">
        {categoryData.map((entry) => (
          <div key={entry.name} className="flex items-center justify-between text-sm">
            <div className="flex items-center gap-2">
              <span className="w-3 h-3 rounded-full" style={{ backgroundColor: entry.color }} />
              <span className="text-gray-300">{entry.name}</span>
            </div>
            <span className="font-semibold text-white">{entry.percent.toFixed(1)}%</span>
          </div>
        ))}
      </div>
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\analytics\TopProductsChart.jsx
--------------------------------------------------------------------
// src/components/analytics/TopProductsChart.jsx
import React from 'react';
import {
  ResponsiveContainer, BarChart, Bar,
  XAxis, YAxis, CartesianGrid, Tooltip,
} from 'recharts';
import { CustomTooltip, chartTextColor } from './ChartUtils';

export default function TopProductsChart({ data }) {
  // Reverse the data so the #1 product is at the top of the chart
  const processedData = [...data].slice(0, 7).reverse(); 

  return (
    <div className="card lg:col-span-2 h-96"> {/* Spans 2 columns */}
      <h3 className="card-title mb-4">Top 7 Products (by Revenue)</h3>
      <ResponsiveContainer width="100%" height="100%">
        <BarChart 
          data={processedData} 
          layout="vertical" 
          margin={{ top: 5, right: 30, left: 30, bottom: 5 }}
        >
          <CartesianGrid strokeDasharray="3 3" stroke="#4b5563" strokeOpacity={0.3} />
          <XAxis 
            type="number" 
            stroke={chartTextColor} 
            fontSize={12} 
            tickFormatter={(value) => `₹${value.toLocaleString()}`} 
          />
          <YAxis 
            dataKey="name" 
            type="category" 
            stroke={chartTextColor} 
            fontSize={12} 
            width={100}
            tick={{ fill: chartTextColor }}
          />
          <Tooltip content={<CustomTooltip />} cursor={{ fill: 'rgba(156, 163, 175, 0.1)' }} />
          <Bar 
            dataKey="revenue" 
            fill="#8b5cf6" // purple-500
            name="Revenue" 
            isAnimationActive={true}
            animationDuration={1000}
          />
        </BarChart>
      </ResponsiveContainer>
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\analytics\TopProductsList.jsx
--------------------------------------------------------------------
// src/components/analytics/TopProductsList.jsx
import React from 'react';
import { motion } from 'framer-motion';

// Staggered animation for the list
const listVariants = {
  hidden: { opacity: 0 },
  visible: { 
    opacity: 1, 
    transition: { 
      staggerChildren: 0.07 // Each item fades in 70ms after the previous
    } 
  }
};

const itemVariants = {
  hidden: { opacity: 0, x: -20 },
  visible: { 
    opacity: 1, 
    x: 0,
    transition: {
      duration: 0.4,
      ease: "easeOut"
    }
  }
};

export default function TopProductsList({ data }) {
  const products = data.slice(0, 10); // Show top 10
  const maxRevenue = products[0]?.revenue || 1; 

  return (
    <div className="card h-[450px] flex flex-col lg:col-span-12">
      <h3 className="card-title mb-4 flex-shrink-0">Top Products by Revenue</h3>
      <div className="flex-grow overflow-y-auto custom-scrollbar pr-2">
        <motion.ul 
          className="space-y-5"
          initial="hidden"
          animate="visible"
          variants={listVariants}
        >
          {products.map((p, index) => (
            <motion.li key={p.productId || index} variants={itemVariants}>
              <div className="flex items-center justify-between mb-1.5 text-sm">
                <span className="font-medium text-white truncate w-3/5">{index + 1}. {p.name}</span>
                <span className="font-semibold text-green-400">
                  {p.revenue.toLocaleString('en-IN', {
                    style: 'currency', currency: 'INR', maximumFractionDigits: 0,
                  })}
                </span>
              </div>
              {/* Animated gradient progress bar */}
              <div className="progress-bar-container">
                <motion.div 
                  className="progress-bar"
                  initial={{ width: 0 }}
                  animate={{ width: `${(p.revenue / maxRevenue) * 100}%` }}
                  transition={{ duration: 1, ease: [0.25, 0.1, 0.25, 1.0], delay: 0.2 }}
                />
              </div>
            </motion.li>
          ))}
        </motion.ul>
      </div>
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\components\auth
--------------------------------------------------------------------
Contents:
Login.jsx
OAuth2RedirectHandler.jsx
Signup.jsx

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\auth\Login.jsx
--------------------------------------------------------------------
import React, { useState } from 'react';
import authService from '../../services/authService';
import { useNavigate } from 'react-router-dom';
import { useTranslation } from 'react-i18next'; // <-- 1. Import

// --- Icons (No changes) ---
const MailIcon = () => (
  <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.206" />
  </svg>
);
const LockIcon = () => (
  <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
  </svg>
);
const LogoIcon = () => (
  <svg className="w-20 h-20 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" />
  </svg>
);
const GoogleIcon = () => (
  <svg className="w-5 h-5" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
    <path fill="#FFC107" d="M43.611 20.083H42V20H24v8h11.303c-1.649 4.657-6.08 8-11.303 8c-6.627 0-12-5.373-12-12s5.373-12 12-12c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.046 6.053 29.268 4 24 4C12.955 4 4 12.955 4 24s8.955 20 20 20s20-8.955 20-20c0-1.341-.138-2.65-.389-3.917z" />
    <path fill="#FF3D00" d="M6.306 14.691l6.571 4.819C14.655 15.108 18.961 12 24 12c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.046 6.053 29.268 4 24 4C16.318 4 9.656 8.337 6.306 14.691z" />
    <path fill="#4CAF50" d="M24 44c5.166 0 9.86-1.977 13.409-5.192l-6.19-5.238C29.211 35.091 26.715 36 24 36c-5.223 0-9.64-3.518-11.28-8.294l-6.522 5.025C9.505 39.556 16.227 44 24 44z" />
    <path fill="#1976D2" d="M43.611 20.083H42V20H24v8h11.303c-.792 2.237-2.231 4.166-4.087 5.571l6.19 5.238C42.012 36.49 44 30.823 44 24c0-1.341-.138-2.65-.389-3.917z" />
  </svg>
);
// --- End Icons ---

export default function Login() {
  const { t } = useTranslation(); // <-- 2. Get hook
  const [email, setEmail] = useState('');
  const [password, setPassword] = useState('');
  const [err, setErr] = useState(null);
  const nav = useNavigate();

  async function submit(e) {
    e.preventDefault();
    setErr(null);
    try {
      const data = await authService.login({ email, password });
      if (!data || !data.accessToken) {
        throw new Error('No access token received from backend.');
      }
      nav('/dashboard');
    } catch (e) {
      console.error('Login error:', e);
      setErr(e.response?.data?.error || e.response?.data?.message || e.message || "An unknown error occurred.");
    }
  }

  return (
    <div className="min-h-screen flex text-gray-800 dark:text-gray-200">
      <div className="hidden lg:flex lg:w-1/2 flex-col justify-center items-center bg-gray-100 dark:bg-gray-900 p-12 text-center shadow-2xl z-10">
        <LogoIcon />
        <h1 className="text-4xl font-bold text-gray-900 dark:text-white mt-6">
          {t('auth.brandPanelTitle')}
        </h1>
        <p className="text-xl text-gray-600 dark:text-gray-400 mt-4 max-w-sm">
          {t('auth.brandPanelLogin')}
        </p>
      </div>

      <div className="w-full lg:w-1/2 flex items-center justify-center p-8
                      bg-white dark:bg-gradient-to-br dark:from-gray-800 dark:via-gray-900 dark:to-black
                      dark:animate-gradient-xy dark:bg-[length:300%_300%]">

        <div className="w-full max-w-md">
          <div className="lg:hidden flex flex-col items-center text-center mb-8">
            <LogoIcon />
            <h2 className="text-2xl font-bold text-gray-900 dark:text-white mt-4">{t('auth.brandPanelTitle')}</h2>
          </div>

          <h2 className="text-3xl font-bold text-gray-900 dark:text-white mb-2 text-center lg:text-left">
            {t('auth.signIn')}
          </h2>
          <p className="text-gray-600 dark:text-gray-400 mb-8 text-center lg:text-left">
            {t('auth.signInWelcome')}
          </p>

          {err && (
            <div className="bg-red-100 dark:bg-red-900/50 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-100 px-4 py-3 rounded-lg mb-6" role="alert">
              <span className="font-medium">{t('auth.loginFailed')}</span> {err}
            </div>
          )}

          <form onSubmit={submit} className="space-y-6">
            <div>
              <label htmlFor="email" className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-2">
                {t('auth.emailAddress')}
              </label>
              <div className="relative">
                <div className="absolute inset-y-0 left-0 flex items-center pl-3.5 pointer-events-none">
                  <MailIcon />
                </div>
                <input
                  id="email"
                  value={email}
                  onChange={e => setEmail(e.target.value)}
                  placeholder={t('auth.emailPlaceholder')}
                  type="email"
                  required
                  className="form-input"
                />
              </div>
            </div>

            <div>
              <div className="flex justify-between items-center mb-2">
                <label htmlFor="password" className="block text-sm font-medium text-gray-600 dark:text-gray-400">
                  {t('auth.password')}
                </label>
                <a href="#" className="text-sm text-blue-500 dark:text-blue-400 hover:underline">
                  {t('auth.forgotPassword')}
                </a>
              </div>
              <div className="relative">
                <div className="absolute inset-y-0 left-0 flex items-center pl-3.5 pointer-events-none">
                  <LockIcon />
                </div>
                <input
                  id="password"
                  type="password"
                  value={password}
                  onChange={e => setPassword(e.target.value)}
                  placeholder="••••••••"
                  required
                  className="form-input"
                />
              </div>
            </div>

            <button
              type="submit"
              className="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-md font-semibold
                         transition-all duration-300 ease-in-out
                         focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-100 dark:focus:ring-offset-gray-900"
            >
              {t('auth.signIn')}
            </button>
          </form>

          <div className="relative my-8">
            <div className="absolute inset-0 flex items-center">
              <div className="w-full border-t border-gray-300 dark:border-gray-700" />
            </div>
            <div className="relative flex justify-center text-sm">
              <span className="px-2 bg-white dark:bg-gray-900 text-gray-500">
                {t('auth.or')}
              </span>
            </div>
          </div>

          <div className="space-y-4">
            <a
              href="http://localhost:8080/oauth2/authorization/google"
              className="social-button"
            >
              <GoogleIcon />
              <span>{t('auth.continueWithGoogle')}</span>
            </a>
          </div>

          <p className="text-sm mt-8 text-center text-gray-600 dark:text-gray-400">
            {t('auth.noAccount')}{' '}
            <a href="/signup" className="font-medium text-blue-500 dark:text-blue-400 hover:underline">
              {t('auth.signUpHere')}
            </a>
          </p>
        </div>
      </div>
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\auth\OAuth2RedirectHandler.jsx
--------------------------------------------------------------------
// src/components/auth/OAuth2RedirectHandler.jsx
import React, { useEffect } from 'react';
import { useSearchParams, useNavigate } from 'react-router-dom';
import authService from '../../services/authService';

export default function OAuth2RedirectHandler() {
  const [searchParams] = useSearchParams();
  const navigate = useNavigate();

  useEffect(() => {
    const token = searchParams.get('token');
    const refreshToken = searchParams.get('refreshToken');

    if (token && refreshToken) {
      console.log("OAuth2 Success: Saving tokens...");
      // We need to export saveTokens from authService
      authService.saveTokens({ accessToken: token, refreshToken: refreshToken });
      
      // Redirect to the dashboard after successful login
      navigate('/dashboard');
    } else {
      console.error("OAuth2 Error: No tokens found in URL.");
      // Redirect to login page with an error
      navigate('/login?error=oauth_failed');
    }
  }, [searchParams, navigate]);

  return (
    <div className="min-h-screen flex items-center justify-center bg-gray-900 text-white">
      <p className="text-xl">Processing your login...</p>
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\auth\Signup.jsx
--------------------------------------------------------------------
import React, { useState } from 'react';
import authService from '../../services/authService';
import { useNavigate } from 'react-router-dom';
import { useTranslation } from 'react-i18next'; // <-- 1. Import

// --- Icons (No changes) ---
const MailIcon = () => (
  <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.206" />
  </svg>
);
const LockIcon = () => (
  <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
  </svg>
);
const UserIcon = () => (
  <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
  </svg>
);
const SelectArrowIcon = () => (
  <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 9l-7 7-7-7" />
  </svg>
);
const LogoIcon = () => (
  <svg className="w-20 h-20 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" />
  </svg>
);
// --- End Icons ---

export default function Signup() {
  const { t } = useTranslation(); // <-- 2. Get hook
  const [email, setEmail] = useState('');
  const [password, setPassword] = useState('');
  const [name, setName] = useState('');
  const [role, setRole] = useState('CASHIER');
  const [error, setError] = useState(null);
  const nav = useNavigate();

  async function submit(e) {
    e.preventDefault();
    setError(null);
    try {
      await authService.signup({ name, email, password, role });
      alert('Signup successful! Please log in.'); // You could translate this too!
      nav('/login');
    } catch (err) {
      setError(err.response?.data?.message || err.response?.data?.error || 'Signup failed');
    }
  }

  return (
    <div className="min-h-screen flex text-gray-800 dark:text-gray-200">

      <div className="hidden lg:flex lg:w-1/2 flex-col justify-center items-center bg-gray-100 dark:bg-gray-900 p-12 text-center shadow-2xl z-10">
        <LogoIcon />
        <h1 className="text-4xl font-bold text-gray-900 dark:text-white mt-6">
          {t('auth.brandPanelTitle')}
        </h1>
        <p className="text-xl text-gray-600 dark:text-gray-400 mt-4 max-w-sm">
          {t('auth.brandPanelSignup')}
        </p>
      </div>

      <div className="w-full lg:w-1/2 flex items-center justify-center p-8
                      bg-white dark:bg-gradient-to-br dark:from-gray-800 dark:via-gray-900 dark:to-black
                      dark:animate-gradient-xy dark:bg-[length:300%_300%]">

        <div className="w-full max-w-md">
          <div className="lg:hidden flex flex-col items-center text-center mb-8">
            <LogoIcon />
            <h2 className="text-2xl font-bold text-gray-900 dark:text-white mt-4">{t('auth.brandPanelTitle')}</h2>
          </div>

          <h2 className="text-3xl font-bold text-gray-900 dark:text-white mb-2 text-center lg:text-left">
            {t('auth.signUp')}
          </h2>
          <p className="text-gray-600 dark:text-gray-400 mb-8 text-center lg:text-left">
            {t('auth.signUpWelcome')}
          </p>

          {error && (
            <div className="bg-red-100 dark:bg-red-900/50 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-100 px-4 py-3 rounded-lg mb-6" role="alert">
              <span className="font-medium">{t('auth.signupFailed')}</span> {error}
            </div>
          )}

          <form onSubmit={submit} className="space-y-6">

            <div>
              <label htmlFor="name" className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-2">
                {t('auth.fullName')}
              </label>
              <div className="relative">
                <div className="absolute inset-y-0 left-0 flex items-center pl-3.5 pointer-events-none">
                  <UserIcon />
                </div>
                <input
                  id="name"
                  value={name}
                  onChange={e => setName(e.target.value)}
                  placeholder={t('auth.namePlaceholder')}
                  type="text"
                  required
                  className="form-input"
                />
              </div>
            </div>

            <div>
              <label htmlFor="email" className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-2">
                {t('auth.emailAddress')}
              </label>
              <div className="relative">
                <div className="absolute inset-y-0 left-0 flex items-center pl-3.5 pointer-events-none">
                  <MailIcon />
                </div>
                <input
                  id="email"
                  value={email}
                  onChange={e => setEmail(e.target.value)}
                  placeholder={t('auth.emailPlaceholder')}
                  type="email"
                  required
                  className="form-input"
                />
              </div>
            </div>

            <div>
              <label htmlFor="password" className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-2">
                {t('auth.password')}
              </label>
              <div className="relative">
                <div className="absolute inset-y-0 left-0 flex items-center pl-3.5 pointer-events-none">
                  <LockIcon />
                </div>
                <input
                  id="password"
                  type="password"
                  value={password}
                  onChange={e => setPassword(e.target.value)}
                  placeholder="••••••••"
                  required
                  className="form-input"
                />
              </div>
            </div>

            <div>
              <label htmlFor="role" className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-2">
                {t('auth.role')}
              </label>
              <div className="relative">
                <div className="absolute inset-y-0 left-0 flex items-center pl-3.5 pointer-events-none">
                  <UserIcon />
                </div>
                <select
                  id="role"
                  value={role}
                  onChange={e => setRole(e.target.value)}
                  className="form-input appearance-none"
                >
                  <option value="CASHIER">{t('auth.roleCashier')}</option>
                  <option value="MANAGER">{t('auth.roleManager')}</option>
                  <option value="OWNER">{t('auth.roleOwner')}</option>
                </select>
                <div className="absolute inset-y-0 right-0 flex items-center pr-3.5 pointer-events-none">
                  <SelectArrowIcon />
                </div>
              </div>
            </div>

            <button
              type="submit"
              className="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-md font-semibold
                         transition-all duration-300 ease-in-out
                         focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-100 dark:focus:ring-offset-gray-900"
            >
              {t('auth.createAccount')}
            </button>
          </form>

          <p className="text-sm mt-8 text-center text-gray-600 dark:text-gray-400">
            {t('auth.haveAccount')}{' '}
            <a href="/login" className="font-medium text-blue-500 dark:text-blue-400 hover:underline">
              {t('auth.signInHere')}
            </a>
          </p>
        </div>
      </div>
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\components\bills
--------------------------------------------------------------------
Contents:
BillForm.jsx
BillList.jsx

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\bills\BillForm.jsx
--------------------------------------------------------------------
import React, { useEffect, useState } from 'react';
import { createBill } from '../../services/billService';
import { listCustomers } from '../../services/customerService';
import { listProducts } from '../../services/productService';
import { useNavigate } from 'react-router-dom';
import { useTranslation } from 'react-i18next';
import { useToast } from '../../context/ToastContext';

export default function BillForm() {
  const { t } = useTranslation();
  const { showToast } = useToast();
  const [customers, setCustomers] = useState([]);
  const [products, setProducts] = useState([]);
  const [selectedCustomer, setSelectedCustomer] = useState('');
  const [items, setItems] = useState([{ productId: '', quantity: 1 }]);
  const [total, setTotal] = useState(0);
  const nav = useNavigate();

  useEffect(() => {
    (async () => {
      try {
        const [custs, prods] = await Promise.all([listCustomers(), listProducts()]);
        setCustomers(custs);
        setProducts(prods);
      } catch (err) {
        showToast("Failed to load customers or products", 'error');
      }
    })();
  }, [showToast]);

  useEffect(() => {
    let t = 0;
    for (const item of items) {
      const prod = products.find(p => p.productId === item.productId);
      if (prod) t += prod.price * item.quantity;
    }
    setTotal(t);
  }, [items, products]);

  function addItem() {
    setItems([...items, { productId: '', quantity: 1 }]);
  }

  function updateItem(index, field, value) {
    const updated = [...items];
    updated[index][field] = value;
    setItems(updated);
  }

  function removeItem(index) {
    const updated = [...items];
    updated.splice(index, 1);
    setItems(updated);
  }

  async function handleSubmit(e) {
    e.preventDefault();
    const selected = customers.find(
      c => c.customerId === selectedCustomer || c.id === selectedCustomer || c._id === selectedCustomer
    );

    if (!selected) {
      showToast(t('billForm.errorCustomer'), 'error');
      return;
    }

    try {
      const billRequest = {
        billId: 'B' + Date.now(),
        customer: {
          name: selected.name,
          email: selected.email,
          mobile: selected.mobile || selected.phone || selected.contactNumber,
        },
        items: items.map(it => ({
          productId: it.productId,
          qty: parseInt(it.quantity, 10),
        })),
        addedBy: 'system',
      };

      await createBill(billRequest);
      showToast(t('billForm.success'), 'success');
      nav('/bills');
    } catch (err) {
      const msg = err.response?.data?.error || err.response?.data?.message || t('billForm.errorCreate');
      showToast(msg, 'error');
    }
  }

  return (
    <div className="card max-w-3xl mx-auto p-6">
      <h2 className="card-title">{t('billForm.title')}</h2>

      <form onSubmit={handleSubmit} className="space-y-4">
        <div>
          <label className="block mb-1.5 font-medium text-gray-600 dark:text-gray-400">{t('billForm.customer')}</label>
          <select
            value={selectedCustomer}
            onChange={e => setSelectedCustomer(e.target.value)}
            className="form-input-no-icon w-full"
            required
          >
            <option value="">{t('billForm.selectCustomer')}</option>
            {customers.map((c, index) => (
              <option
                key={c.customerId || c.id || c._id || index}
                value={c.customerId || c.id || c._id}
              >
                {c.name} ({c.email || c.mobile})
              </option>
            ))}
          </select>
        </div>

        <div>
          <label className="block mb-2 font-medium text-gray-600 dark:text-gray-400">{t('billForm.items')}</label>
          <div className="space-y-2">
            {items.map((item, index) => (
              <div key={index} className="flex gap-2 items-center">
                <select
                  value={item.productId}
                  onChange={e => updateItem(index, 'productId', e.target.value)}
                  className="form-input-no-icon flex-1"
                  required
                >
                  <option value="">{t('billForm.selectProduct')}</option>
                  {products.map((p, i) => (
                    <option
                      key={p.productId || p.id || i}
                      value={p.productId || p.id}
                    >
                      {p.name} (₹{p.price})
                    </option>
                  ))}
                </select>
                <input
                  type="number"
                  min="1"
                  value={item.quantity}
                  onChange={e => updateItem(index, 'quantity', e.target.value)}
                  className="form-input-no-icon w-24"
                  required
                />
                <button
                  type="button"
                  onClick={() => removeItem(index)}
                  className="bg-red-600 text-white px-3 py-2 rounded-lg hover:bg-red-700 transition-colors"
                >
                  ✕
                </button>
              </div>
            ))}
            <button
              type="button"
              onClick={addItem}
              className="button-secondary !bg-green-600 !text-white hover:!bg-green-700"
            >
              {t('billForm.addItem')}
            </button>
          </div>
        </div>

        <div className="text-right text-xl font-bold text-gray-900 dark:text-white">
          {t('billForm.total')} ₹{total.toFixed(2)}
        </div>

        <div className="text-center pt-4">
          <button type="submit" className="button-primary w-1/2">
            {t('billForm.createBill')}
          </button>
        </div>
      </form>
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\bills\BillList.jsx
--------------------------------------------------------------------
import React, { useEffect, useState, useMemo } from 'react';
import { useNavigate } from 'react-router-dom';
import {
  listBills,
  downloadBillPdf,
  resendBillEmail,
  generatePdfToken,
  downloadBillPdfWithFlow,
  handlePdfDownload
} from '../../services/billService';
import { useToast } from '../../context/ToastContext';
import authService from '../../services/authService';
import Fuse from 'fuse.js';
import { motion, AnimatePresence } from 'framer-motion';
import DatePicker from 'react-datepicker';
import "react-datepicker/dist/react-datepicker.css";
import { useTranslation } from 'react-i18next';

// --- ICONS ---
const SearchIcon = () => (
  <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
  </svg>
);
const SortIcon = () => (
  <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 4h13M3 8h9M3 12h9m-9 4h13m-3-4v8m0 0l-4-4m4 4l4-4" />
  </svg>
);
const CalendarIcon = () => (
  <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
  </svg>
);
const ExportIcon = () => (
  <svg className="w-5 h-5 mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
  </svg>
);
const PdfIcon = () => (
  <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
  </svg>
);
const ResendIcon = () => (
  <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
  </svg>
);
const CheckCircleIcon = () => (
  <svg className="w-4 h-4 text-emerald-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
  </svg>
);
// --- END ICONS ---

// --- Skeleton Row ---
const SkeletonRow = () => (
  <tr className="animate-pulse">
    <td><div className="h-4 bg-gray-200 dark:bg-gray-700 rounded w-24"></div></td>
    <td><div className="h-4 bg-gray-200 dark:bg-gray-700 rounded w-32"></div></td>
    <td><div className="h-4 bg-gray-200 dark:bg-gray-700 rounded w-20"></div></td>
    <td><div className="h-4 bg-gray-200 dark:bg-gray-700 rounded w-36"></div></td>
    <td><div className="h-4 bg-gray-200 dark:bg-gray-700 rounded w-20"></div></td>
    <td className="flex gap-2 justify-center">
      <div className="h-9 w-9 bg-gray-200 dark:bg-gray-700 rounded-lg"></div>
      <div className="h-9 w-9 bg-gray-200 dark:bg-gray-700 rounded-lg"></div>
    </td>
  </tr>
);

// --- Customer Avatar Component ---
const CustomerAvatar = ({ name, className = "w-8 h-8" }) => {
  const initials = name ? name.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2) : 'WI';
  const colors = [
    'bg-gradient-to-br from-blue-500 to-cyan-400',
    'bg-gradient-to-br from-purple-500 to-pink-500',
    'bg-gradient-to-br from-orange-500 to-red-500',
    'bg-gradient-to-br from-green-500 to-emerald-400',
    'bg-gradient-to-br from-indigo-500 to-purple-400'
  ];
  const colorIndex = name ? name.charCodeAt(0) % colors.length : 0;

  return (
    <div className={`${className} ${colors[colorIndex]} rounded-full flex items-center justify-center text-white text-xs font-bold shadow-lg`}>
      {initials}
    </div>
  );
};

// --- Bill Details Drawer ---
const BillDetailsDrawer = ({ bill, isOpen, onClose, t, onDownload, onResend }) => {
  if (!isOpen) return null;

  const { date, time } = formatDate(bill.createdAt || bill.date);

  return (
    <div className="fixed inset-0 z-50 overflow-hidden">
      {/* Backdrop */}
      <motion.div
        initial={{ opacity: 0 }}
        animate={{ opacity: 1 }}
        exit={{ opacity: 0 }}
        className="absolute inset-0 bg-black/60 backdrop-blur-sm"
        onClick={onClose}
      ></motion.div>

      {/* Drawer */}
      <motion.div
        initial={{ x: '100%' }}
        animate={{ x: 0 }}
        exit={{ x: '100%' }}
        transition={{ type: 'spring', damping: 30, stiffness: 300 }}
        className="absolute right-0 top-0 h-full w-full max-w-md bg-white dark:bg-gray-900/95 dark:backdrop-blur-xl border-l border-gray-200 dark:border-gray-700/50 shadow-2xl"
      >
        <div className="p-6 h-full flex flex-col">
          {/* Header */}
          <div className="flex items-center justify-between mb-6">
            <h3 className="text-xl font-bold text-gray-900 dark:text-white">{t('billList.drawerTitle')}</h3>
            <button
              onClick={onClose}
              className="p-2 text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors"
            >
              <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
              </svg>
            </button>
          </div>

          {/* Content */}
          <div className="flex-1 space-y-6 overflow-y-auto custom-scrollbar pr-2">
            {/* Bill Info */}
            <div className="space-y-4">
              <div>
                <label className="text-sm text-gray-500 dark:text-gray-400">{t('billList.headerId')}</label>
                <p className="text-lg font-mono text-cyan-600 dark:text-cyan-400">{bill.billId}</p>
              </div>
              <div>
                <label className="text-sm text-gray-500 dark:text-gray-400">{t('billList.drawerDate')}</label>
                <p className="text-gray-900 dark:text-white">{date} at {time}</p>
              </div>
              <div>
                <label className="text-sm text-gray-500 dark:text-gray-400">{t('billList.drawerTotal')}</label>
                <p className="text-2xl font-bold text-emerald-600 dark:text-emerald-400">
                  {formatCurrency(bill.totalAmount)}
                </p>
              </div>
            </div>

            {/* Customer Info */}
            <div className="space-y-3">
              <label className="text-sm text-gray-500 dark:text-gray-400">{t('billList.drawerCustomer')}</label>
              <div className="flex items-center gap-3 p-3 bg-gray-100 dark:bg-gray-800/50 rounded-lg">
                <CustomerAvatar name={bill.customer?.name} />
                <div>
                  <p className="text-gray-900 dark:text-white font-medium">{bill.customer?.name || t('billList.walkIn')}</p>
                  <p className="text-sm text-gray-500 dark:text-gray-400">{bill.customer?.mobile || t('billList.noMobile')}</p>
                </div>
              </div>
            </div>

            {/* Items */}
            <div className="space-y-3">
              <label className="text-sm text-gray-500 dark:text-gray-400">{t('billList.drawerItems', { count: bill.items?.length || 0 })}</label>
              <div className="space-y-2 max-h-48 overflow-y-auto custom-scrollbar pr-2">
                {bill.items?.map((item, index) => (
                  <div key={index} className="flex justify-between items-center p-2 bg-gray-100 dark:bg-gray-800/30 rounded">
                    <span className="text-gray-800 dark:text-white text-sm">{item.productName || item.name}</span>
                    <span className="text-emerald-600 dark:text-emerald-400 text-sm">
                      {formatCurrency(item.price)} x {item.qty}
                    </span>
                  </div>
                ))}
              </div>
            </div>
          </div>

          {/* Actions */}
          <div className="space-y-3 pt-6 border-t border-gray-200 dark:border-gray-700">
            <button
              onClick={() => onDownload(bill)}
              className="w-full button-primary flex items-center justify-center gap-2"
            >
              <PdfIcon />
              {t('billList.downloadPDF')}
            </button>
            <button
              onClick={() => onResend(bill.billId)}
              className="w-full button-secondary flex items-center justify-center gap-2"
            >
              <ResendIcon />
              {t('billList.resendEmail')}
            </button>
          </div>
        </div>
      </motion.div>
    </div>
  );
};

// Formatting Helpers
const formatCurrency = (amount) => {
  return (amount || 0).toLocaleString('en-IN', {
    style: 'currency',
    currency: 'INR',
    maximumFractionDigits: 2,
  });
};

const formatDate = (dateString) => {
  if (!dateString) return { date: 'N/A', time: '' };
  const date = new Date(dateString);
  return {
    date: date.toLocaleDateString('en-IN', { day: '2-digit', month: 'short', year: 'numeric' }),
    time: date.toLocaleTimeString('en-IN', { hour: '2-digit', minute: '2-digit', hour12: true })
  };
};

// Custom DatePicker Input Component
const CustomDateInput = React.forwardRef(({ value, onClick, placeholder }, ref) => (
  <button
    type="button"
    ref={ref}
    onClick={onClick}
    className="form-input w-full !pl-10 !py-3 rounded-xl cursor-pointer text-left"
  >
    <span className={value ? 'text-gray-800 dark:text-white' : 'text-gray-500'}>
      {value || placeholder}
    </span>
  </button>
));

export default function BillList() {
  const { t } = useTranslation();
  const [bills, setBills] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);
  const [resendingId, setResendingId] = useState(null);
  const [downloadingId, setDownloadingId] = useState(null);
  const [selectedBill, setSelectedBill] = useState(null);
  const [isDrawerOpen, setIsDrawerOpen] = useState(false);

  const [searchTerm, setSearchTerm] = useState('');
  const [sortBy, setSortBy] = useState('createdAt-desc');
  const [startDate, setStartDate] = useState(null);
  const [endDate, setEndDate] = useState(null);
  const [autoEmail, setAutoEmail] = useState(true);
  const [currentPage, setCurrentPage] = useState(1);
  const itemsPerPage = 10;

  const { showToast } = useToast();
  const navigate = useNavigate();
  const user = authService.getUserFromToken();
  const canManage = user?.role === 'OWNER' || user?.role === 'MANAGER';

  const fuse = useMemo(() => new Fuse(bills, {
    keys: ['billId', 'customer.name', 'customer.mobile', 'paymentMethod'],
    threshold: 0.4,
  }), [bills]);

  const displayBills = useMemo(() => {
    let items = searchTerm ? fuse.search(searchTerm).map(r => r.item) : [...bills];

    if (startDate || endDate) {
      const start = startDate ? new Date(startDate.setHours(0, 0, 0, 0)) : new Date(0);
      const end = endDate ? new Date(endDate.setHours(23, 59, 59, 999)) : new Date();
      items = items.filter(b => {
        const billDate = new Date(b.createdAt || b.date);
        return billDate >= start && billDate <= end;
      });
    }

    const [key, dir] = sortBy.split('-');
    return [...items].sort((a, b) => {
      let valA = key === 'createdAt' ? new Date(a.createdAt || a.date).getTime() : (a.totalAmount || 0);
      let valB = key === 'createdAt' ? new Date(b.createdAt || b.date).getTime() : (b.totalAmount || 0);
      return dir === 'asc' ? valA - valB : valB - valA;
    });
  }, [bills, searchTerm, sortBy, startDate, endDate, fuse]);

  const totalPages = Math.ceil(displayBills.length / itemsPerPage);
  const paginatedBills = useMemo(() => {
    const startIndex = (currentPage - 1) * itemsPerPage;
    return displayBills.slice(startIndex, startIndex + itemsPerPage);
  }, [displayBills, currentPage, itemsPerPage]);

  useEffect(() => { loadBills(); }, []);

  async function loadBills() {
    try {
      setLoading(true);
      setError(null);
      const data = await listBills();
      setBills(Array.isArray(data) ? data : []);
    } catch (err) {
      const msg = err.response?.data?.message || err.message;
      setError(msg);
      showToast(msg, 'error');
    } finally {
      setLoading(false);
    }
  }

  const handleDownload = async (bill, e) => {
    e?.stopPropagation();
    setDownloadingId(bill.billId);
    try {
      showToast(t('billList.downloading', { billId: bill.billId }), 'info');

      // Use the complete flow that handles token generation automatically
      const pdfBlob = await downloadBillPdfWithFlow(bill.billId);
      handlePdfDownload(pdfBlob, bill.billId);

      showToast(t('billList.downloadSuccess'), 'success');
    } catch (err) {
      console.error('Error downloading PDF:', err);
      const errorMessage = err.response?.data?.message || err.message || t('billList.downloadFailed');
      showToast(errorMessage, 'error');
    } finally {
      setDownloadingId(null);
    }
  };

  const handleResend = async (billId, e) => {
    e?.stopPropagation();
    setResendingId(billId);
    try {
      await resendBillEmail(billId);
      showToast(t('billList.resendSuccess'), 'success');
    } catch (err) {
      const errorMessage = err.response?.data?.message || err.message || t('billList.resendFailed');
      showToast(errorMessage, 'error');
    } finally {
      setResendingId(null);
    }
  };

  const handleRowClick = (bill) => {
    setSelectedBill(bill);
    setIsDrawerOpen(true);
  };

  const handleDrawerDownload = async (bill) => {
    try {
      showToast(t('billList.downloading', { billId: bill.billId }), 'info');
      const pdfBlob = await downloadBillPdfWithFlow(bill.billId);
      handlePdfDownload(pdfBlob, bill.billId);
      showToast(t('billList.downloadSuccess'), 'success');
    } catch (err) {
      console.error('Error downloading PDF:', err);
      const errorMessage = err.response?.data?.message || err.message || t('billList.downloadFailed');
      showToast(errorMessage, 'error');
    }
  };

  const handleDrawerResend = async (billId) => {
    try {
      await resendBillEmail(billId);
      showToast(t('billList.resendSuccess'), 'success');
    } catch (err) {
      const errorMessage = err.response?.data?.message || err.message || t('billList.resendFailed');
      showToast(errorMessage, 'error');
    }
  };

  const exportToCsv = () => {
    if (!displayBills.length) return showToast(t('billList.exportError'), 'error');
    const headers = ["Bill ID", "Customer", "Mobile", "Amount", "Date", "Items", "Payment Method"];
    const rows = displayBills.map(b => [
      b.billId,
      b.customer?.name || '',
      b.customer?.mobile || '',
      formatCurrency(b.totalAmount),
      new Date(b.createdAt || b.date).toLocaleString(),
      b.items?.length || 0,
      b.paymentMethod || 'cash'
    ]);
    const csv = [headers, ...rows.map(r => r.join(','))].join('\n');
    const blob = new Blob([csv], { type: 'text/csv' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `SmartRetail_Bills_${new Date().toISOString().slice(0,10)}.csv`;
    a.click();
    URL.revokeObjectURL(url);
    showToast(t('billList.exportSuccess', { count: displayBills.length }), 'success');
  };

  const EmptyState = () => (
    <div className="flex flex-col items-center justify-center py-16">
      <svg className="w-16 h-16 text-gray-400 dark:text-gray-500 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M9 17v-6h6v6m-6-4h.01M12 3v4m0 0h8m-8 0H4" />
      </svg>
      <p className="text-lg text-gray-500 dark:text-gray-400 font-light">{t('billList.emptyState')}</p>
      <p className="text-sm text-gray-400 dark:text-gray-500 mt-1">{t('billList.emptyStateHint')}</p>
    </div>
  );

  return (
    <motion.div
      initial={{ opacity: 0, y: 10 }}
      animate={{ opacity: 1, y: 0 }}
      transition={{ duration: 0.4 }}
      className="space-y-6"
    >
      {/* Frosted Header Bar */}
      <div className="sticky top-0 z-40 backdrop-blur-xl bg-white/80 dark:bg-black/40 border-b border-gray-200 dark:border-cyan-500/20 p-4 rounded-xl flex justify-between items-center">
        <h2 className="text-3xl font-bold text-gray-900 dark:text-white font-display">
          {t('billList.title')}
          <span className="text-lg font-normal text-gray-500 dark:text-gray-400 ml-3">
            ({displayBills.length} {t('billList.matching')})
          </span>
        </h2>
        {canManage && (
          <div className="flex items-center gap-3">
            <label className="flex items-center gap-2 text-sm text-gray-600 dark:text-gray-300 cursor-pointer">
              <div className="relative">
                <input
                  type="checkbox"
                  checked={autoEmail}
                  onChange={(e) => setAutoEmail(e.target.checked)}
                  className="sr-only"
                />
                <div className={`w-10 h-6 rounded-full transition-colors ${
                  autoEmail ? 'bg-cyan-500' : 'bg-gray-400 dark:bg-gray-600'
                }`}></div>
                <div className={`absolute top-1 w-4 h-4 rounded-full bg-white transition-transform ${
                  autoEmail ? 'transform translate-x-5' : 'transform translate-x-1'
                }`}></div>
              </div>
              {t('billList.autoEmail')}
            </label>
          </div>
        )}
      </div>

      {/* Control Bar */}
      <div className="card p-5 rounded-2xl">
        <div className="flex flex-col lg:flex-row gap-4 items-center">
          <div className="relative flex-grow w-full md:w-auto">
            <div className="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none z-10">
              <SearchIcon />
            </div>
            <input
              type="text"
              value={searchTerm}
              onChange={e => setSearchTerm(e.target.value)}
              placeholder={t('billList.searchPlaceholder')}
              className="form-input w-full !py-3 rounded-xl transition-all"
            />
          </div>

          <div className="relative flex-shrink-0 w-full md:w-64">
            <div className="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none z-10">
              <CalendarIcon />
            </div>
            <DatePicker
              selectsRange
              startDate={startDate}
              endDate={endDate}
              onChange={([start, end]) => {
                setStartDate(start);
                setEndDate(end);
                setCurrentPage(1);
              }}
              isClearable
              placeholderText={t('billList.datePlaceholder')}
              customInput={<CustomDateInput placeholder={t('billList.datePlaceholder')} />}
              className="w-full"
              popperClassName="react-datepicker-dark z-50"
              popperPlacement="bottom-start"
              dateFormat="MMM d, yyyy"
              showPopperArrow={false}
              wrapperClassName="w-full"
            />
          </div>

          <div className="relative flex-shrink-0 w-full md:w-56">
            <div className="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none z-10">
              <SortIcon />
            </div>
            <select
              value={sortBy}
              onChange={e => setSortBy(e.target.value)}
              className="form-input appearance-none w-full !py-3 rounded-xl"
            >
              <option value="createdAt-desc">{t('billList.sortNewest')}</option>
              <option value="createdAt-asc">{t('billList.sortOldest')}</option>
              <option value="totalAmount-desc">{t('billList.sortHigh')}</option>
              <option value="totalAmount-asc">{t('billList.sortLow')}</option>
            </select>
          </div>

          {canManage && (
            <button
              onClick={exportToCsv}
              className="button-secondary !px-6 !py-3 rounded-xl flex items-center justify-center gap-2 flex-shrink-0 w-full md:w-auto font-semibold transition-all duration-200"
            >
              <ExportIcon />
              {t('billList.export')}
            </button>
          )}
        </div>
      </div>

      {error && (
        <div className="card text-center p-10">
          <p className="text-red-500 dark:text-red-400 font-semibold">{error}</p>
          <button onClick={loadBills} className="button-primary mt-4">{t('common.tryAgain')}</button>
        </div>
      )}

      {!error && (
        <div className="card overflow-x-auto rounded-2xl p-0">
          <table className="table w-full">
            <thead>
              <tr>
                <th className="text-left">{t('billList.headerId')}</th>
                <th className="text-left">{t('billList.headerCustomer')}</th>
                <th className="text-right">{t('billList.headerTotal')}</th>
                <th className="text-left">{t('billList.headerDate')}</th>
                <th className="text-left">{t('billList.headerPayment')}</th>
                <th className="text-left">{t('billList.headerStatus')}</th>
                <th className="text-center">{t('billList.headerActions')}</th>
              </tr>
            </thead>
            <motion.tbody layout>
              <AnimatePresence>
                {loading ? (
                  Array(5).fill().map((_, i) => <SkeletonRow key={i} />)
                ) : paginatedBills.length === 0 ? (
                  <tr>
                    <td colSpan="7">
                      <EmptyState />
                    </td>
                  </tr>
                ) : (
                  paginatedBills.map((bill, i) => {
                    const { date, time } = formatDate(bill.createdAt || bill.date);
                    return (
                      <motion.tr
                        key={bill.billId}
                        layout
                        initial={{ opacity: 0 }}
                        animate={{ opacity: 1 }}
                        exit={{ opacity: 0 }}
                        transition={{ delay: i * 0.02, duration: 0.2 }}
                        className="hover:bg-gray-50 dark:hover:bg-cyan-500/5 transition-all duration-200 cursor-pointer group"
                        onClick={() => handleRowClick(bill)}
                      >
                        <td className="font-mono text-cyan-600 dark:text-cyan-400">{bill.billId}</td>
                        <td className="min-w-[200px]">
                          <div className="flex items-center gap-3">
                            <CustomerAvatar name={bill.customer?.name} />
                            <div>
                              <p className="font-medium text-gray-900 dark:text-white group-hover:text-blue-600 dark:group-hover:text-blue-300 transition-colors">
                                {bill.customer?.name || t('billList.walkIn')}
                              </p>
                              <p className="text-xs text-gray-500 dark:text-gray-400">{bill.customer?.mobile || t('billList.noMobile')}</p>
                            </div>
                          </div>
                        </td>
                        <td className="text-right font-bold text-emerald-600 dark:text-emerald-400 min-w-[120px]">
                          {formatCurrency(bill.totalAmount)}
                        </td>
                        <td className="min-w-[170px]">
                          <div>
                            <p className="text-gray-900 dark:text-white font-medium">{date}</p>
                            <p className="text-xs text-gray-500 dark:text-gray-400">{time}</p>
                          </div>
                        </td>
                        <td>
                          <span className={`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${
                            bill.paymentMethod === 'upi' ? 'bg-purple-100 text-purple-700 border border-purple-200 dark:bg-purple-500/20 dark:text-purple-300 dark:border-purple-500/30' :
                            bill.paymentMethod === 'card' ? 'bg-blue-100 text-blue-700 border border-blue-200 dark:bg-blue-500/20 dark:text-blue-300 dark:border-blue-500/30' :
                            bill.paymentMethod === 'credit' ? 'bg-orange-100 text-orange-700 border border-orange-200 dark:bg-orange-500/20 dark:text-orange-300 dark:border-orange-500/30' :
                            'bg-gray-100 text-gray-700 border border-gray-200 dark:bg-gray-500/20 dark:text-gray-300 dark:border-gray-500/30'
                          }`}>
                            {bill.paymentMethod?.toUpperCase() || t('billList.paymentMethod')}
                          </span>
                        </td>
                        <td>
                          <span className="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 border border-green-200 dark:bg-gradient-to-r dark:from-green-700 dark:to-emerald-500/60 dark:text-green-200 dark:border-emerald-400/50 dark:shadow-[0_0_10px_rgba(16,185,129,0.4)]">
                            <CheckCircleIcon />
                            {t('billList.statusCompleted')}
                          </span>
                        </td>
                        <td className="text-center">
                          <div className="flex justify-center gap-2" onClick={(e) => e.stopPropagation()}>
                            <button
                              onClick={(e) => handleDownload(bill, e)}
                              disabled={downloadingId === bill.billId}
                              className="p-2 rounded-lg bg-blue-500 dark:bg-gradient-to-br dark:from-blue-500 dark:to-cyan-600 text-white shadow-md hover:shadow-lg transform hover:scale-105 transition-all disabled:opacity-50"
                              title={t('billList.downloadPDF')}
                            >
                              {downloadingId === bill.billId ? (
                                <div className="w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"></div>
                              ) : (
                                <PdfIcon />
                              )}
                            </button>
                            <button
                              onClick={(e) => handleResend(bill.billId, e)}
                              disabled={resendingId === bill.billId}
                              className="p-2 rounded-lg bg-purple-500 dark:bg-gradient-to-br dark:from-purple-500 dark:to-pink-600 text-white shadow-md hover:shadow-lg transform hover:scale-105 transition-all disabled:opacity-50"
                              title={t('billList.resendEmail')}
                            >
                              {resendingId === bill.billId ? (
                                <div className="w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"></div>
                              ) : (
                                <ResendIcon />
                              )}
                            </button>
                          </div>
                        </td>
                      </motion.tr>
                    );
                  })
                )}
              </AnimatePresence>
            </motion.tbody>
          </table>

          {totalPages > 1 && (
            <div className="flex justify-between items-center p-4 border-t border-gray-200 dark:border-gray-700/50">
              <p className="text-sm text-gray-600 dark:text-gray-400">
                {t('billList.showing', {
                  start: ((currentPage - 1) * itemsPerPage) + 1,
                  end: Math.min(currentPage * itemsPerPage, displayBills.length),
                  total: displayBills.length
                })}
              </p>
              <div className="flex gap-2">
                <button
                  onClick={() => setCurrentPage(prev => Math.max(prev - 1, 1))}
                  disabled={currentPage === 1}
                  className="px-3 py-1 rounded-lg bg-gray-200 dark:bg-gray-800 text-gray-700 dark:text-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-300 dark:hover:bg-gray-700 transition-colors"
                >
                  {t('common.previous')}
                </button>
                <span className="px-3 py-1 rounded-lg bg-cyan-500 text-white">
                  {currentPage}
                </span>
                <button
                  onClick={() => setCurrentPage(prev => Math.min(prev + 1, totalPages))}
                  disabled={currentPage === totalPages}
                  className="px-3 py-1 rounded-lg bg-gray-200 dark:bg-gray-800 text-gray-700 dark:text-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-300 dark:hover:bg-gray-700 transition-colors"
                >
                  {t('common.next')}
                </button>
              </div>
            </div>
          )}
        </div>
      )}

      {/* Bill Details Drawer */}
      <BillDetailsDrawer
        bill={selectedBill}
        isOpen={isDrawerOpen}
        onClose={() => setIsDrawerOpen(false)}
        t={t}
        onDownload={handleDrawerDownload}
        onResend={handleDrawerResend}
      />
    </motion.div>
  );
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\components\checkout
--------------------------------------------------------------------
Contents:
CheckoutPage.jsx

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\checkout\CheckoutPage.jsx
--------------------------------------------------------------------
import React, { useState } from 'react';
import { useCart } from '../../context/CartContext';
import { createBill } from '../../services/billService';
import authService from '../../services/authService';
import { useNavigate } from 'react-router-dom';
import { useToast } from '../../context/ToastContext';
import { useTranslation } from 'react-i18next'; // <-- Import

export default function CheckoutPage() {
  const { cartItems, cartTotal, updateQuantity, removeFromCart, clearCart } = useCart();
  const { showToast } = useToast();
  const { t } = useTranslation(); // <-- Get hook

  const [customerInfo, setCustomerInfo] = useState({
    name: '',
    email: '',
    mobile: ''
  });

  const [loading, setLoading] = useState(false);
  const [error, setError] = useState(null);
  const user = authService.getUserFromToken();
  const navigate = useNavigate();

  const handleCustomerChange = (e) => {
    const { name, value } = e.target;
    setCustomerInfo(prev => ({ ...prev, [name]: value }));
  };

  const handleGenerateBill = async () => {
    if (!customerInfo.mobile) {
      const msg = t('checkout.errorMobile');
      setError(msg);
      showToast(msg, 'error');
      return;
    }
    if (cartItems.length === 0) {
      const msg = t('checkout.errorEmptyCart');
      setError(msg);
      showToast(msg, 'error');
      return;
    }

    setLoading(true);
    setError(null);

    const billRequest = {
      billId: `B${Date.now()}`,
      customer: {
        name: customerInfo.name || 'Customer',
        email: customerInfo.email,
        mobile: customerInfo.mobile,
      },
      items: cartItems.map(item => ({
        productId: item.productId,
        productName: item.name,
        qty: item.quantity,
        price: item.price,
      })),
      addedBy: user?.email || 'system',
    };

    try {
      const newBill = await createBill(billRequest);
      showToast(t('checkout.billSuccess', { billId: newBill.billId }), 'success');
      clearCart();
      setCustomerInfo({ name: '', email: '', mobile: '' });
      navigate('/bills');
    } catch (err) {
      const errMsg = err.response?.data?.error || err.message;
      setError(t('checkout.billError', { error: errMsg }));
      showToast(t('checkout.billError', { error: errMsg }), 'error');
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="max-w-4xl mx-auto grid grid-cols-1 lg:grid-cols-3 gap-6">
      {/* Cart Items */}
      <div className="lg:col-span-2 card p-6">
        <h2 className="text-2xl font-bold text-gray-900 dark:text-white mb-4">{t('checkout.title')}</h2>
        {error && (
          <div className="bg-red-100 dark:bg-red-900/50 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-100 px-4 py-3 rounded-lg mb-4">
            {error}
          </div>
        )}
        <div className="space-y-4">
          {cartItems.length === 0 ? (
            <p className="text-gray-500 dark:text-gray-400">{t('checkout.empty')}</p>
          ) : (
            cartItems.map(item => (
              <div key={item.productId} className="flex items-center gap-4 p-3 bg-gray-100 dark:bg-gray-800/50 rounded-lg">
                <div className="flex-grow">
                  <p className="font-semibold text-gray-900 dark:text-white">{item.name}</p>
                  <p className="text-sm text-gray-500 dark:text-gray-400">
                    {item.quantity} x {item.price.toLocaleString('en-IN', { style: 'currency', currency: 'INR' })}
                  </p>
                </div>
                <input
                  type="number"
                  value={item.quantity}
                  onChange={(e) => updateQuantity(item.productId, parseInt(e.target.value))}
                  min="1"
                  className="form-input w-20 text-center !pl-2"
                />
                <p className="text-lg font-semibold text-gray-900 dark:text-white w-24 text-right">
                  {(item.quantity * item.price).toLocaleString('en-IN', { style: 'currency', currency: 'INR' })}
                </p>
                <button
                  onClick={() => removeFromCart(item.productId)}
                  className="text-red-500 hover:text-red-400"
                  title="Remove"
                >
                  &times;
                </button>
              </div>
            ))
          )}
        </div>
      </div>

      {/* Summary & Checkout */}
      <div className="lg:col-span-1 card p-6 h-fit">
        <h3 className="text-xl font-bold text-gray-900 dark:text-white mb-4">{t('checkout.summary')}</h3>
        <div className="space-y-2 mb-4">
          <div className="flex justify-between text-gray-700 dark:text-gray-300">
            <span>{t('checkout.subtotal')}</span>
            <span className="font-medium">{cartTotal.toLocaleString('en-IN', { style: 'currency', currency: 'INR' })}</span>
          </div>
          <div className="flex justify-between text-gray-700 dark:text-gray-300">
            <span>{t('checkout.taxes')}</span>
            <span className="font-medium">{t('checkout.taxesValue')}</span>
          </div>
          <div className="flex justify-between text-gray-900 dark:text-white text-lg font-bold pt-2 border-t border-gray-200 dark:border-gray-700">
            <span>{t('checkout.total')}</span>
            <span>{cartTotal.toLocaleString('en-IN', { style: 'currency', currency: 'INR' })}</span>
          </div>
        </div>

        <div className="mt-6 space-y-3">
          <label className="block text-sm font-medium text-gray-600 dark:text-gray-400">
            {t('checkout.customerDetails')}
          </label>
          <input
            type="text"
            name="name"
            value={customerInfo.name}
            onChange={handleCustomerChange}
            placeholder={t('checkout.customerName')}
            className="form-input-no-icon w-full"
          />
          <input
            type="text"
            name="mobile"
            value={customerInfo.mobile}
            onChange={handleCustomerChange}
            placeholder={t('checkout.customerMobile')}
            className="form-input-no-icon w-full"
            required
          />
          <input
            type="email"
            name="email"
            value={customerInfo.email}
            onChange={handleCustomerChange}
            placeholder={t('checkout.customerEmail')}
            className="form-input-no-icon w-full"
          />
        </div>

        <button
          onClick={handleGenerateBill}
          disabled={loading || cartItems.length === 0 || !customerInfo.mobile}
          className="button-primary w-full mt-6"
        >
          {loading ? t('checkout.generatingBill') : t('checkout.generateBill')}
        </button>
      </div>
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\components\common
--------------------------------------------------------------------
Contents:
FileUploader.jsx
Table.jsx

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\common\FileUploader.jsx
--------------------------------------------------------------------
import React from 'react'

export default function FileUploader({ label, accept, onFileSelect }) {
  return (
    <div className="flex flex-col gap-2 mb-3">
      <label className="font-medium">{label}</label>
      <input type="file" accept={accept} onChange={e => onFileSelect(e.target.files[0])} />
    </div>
  )
}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\common\Table.jsx
--------------------------------------------------------------------
import React from 'react'

export default function Table({ columns, data }) {
  return (
    <div className="overflow-x-auto card">
      <table className="table">
        <thead>
          <tr>
            {columns.map(col => <th key={col}>{col}</th>)}
          </tr>
        </thead>
        <tbody>
          {data.map((row, i) => (
            <tr key={i}>
              {columns.map(col => <td key={col}>{row[col]}</td>)}
            </tr>
          ))}
        </tbody>
      </table>
    </div>
  )
}

--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\components\customers
--------------------------------------------------------------------
Contents:
CustomerCard.jsx
CustomerEdit.jsx
CustomerForm.jsx
CustomerHistory.jsx
CustomerList.jsx
ReminderTrigger.jsx
SendEmailModal.jsx

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\customers\CustomerCard.jsx
--------------------------------------------------------------------
import React from 'react';
import { motion } from 'framer-motion';
import { useTranslation } from 'react-i18next';

// --- Reusable Icons ---
const PhoneIcon = () => (
  <svg className="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
  </svg>
);
const EmailIcon = () => (
  <svg className="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
  </svg>
);
const HistoryIcon = () => (
  <svg className="w-4 h-4 mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
  </svg>
);
const SendEmailIcon = () => (
  <svg className="w-4 h-4 mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
  </svg>
);
const DeleteIcon = () => (
  <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
  </svg>
);
const AvatarIcon = () => (
  <div className="w-full h-full flex items-center justify-center bg-gray-200 dark:bg-gray-800 rounded-t-2xl">
    <svg className="w-20 h-20 text-gray-400 dark:text-gray-700" fill="currentColor" viewBox="0 0 20 20">
      <path fillRule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clipRule="evenodd" />
    </svg>
  </div>
);
// --- End Icons ---

const CustomerCard = ({ customer, onSendEmail, onViewHistory, onDelete, canManage }) => {
  const { t } = useTranslation();
  const { id, name, email, mobile, totalPurchaseCount, lastPurchaseDate } = customer;

  const formatDate = (dateString) => {
    if (!dateString) return "N/A";
    return new Date(dateString).toLocaleDateString('en-IN', {
      day: '2-digit',
      month: 'short',
      year: 'numeric'
    });
  };

  return (
    <motion.div
      layout
      initial={{ opacity: 0, scale: 0.9 }}
      animate={{ opacity: 1, scale: 1 }}
      exit={{ opacity: 0, scale: 0.9 }}
      transition={{ duration: 0.3, ease: 'easeOut' }}
      className="card relative flex flex-col group overflow-hidden"
    >
      {/* Image Placeholder */}
      <div className="aspect-w-1 aspect-h-1 w-full rounded-t-2xl overflow-hidden">
        <AvatarIcon />
      </div>

      {/* Details */}
      <div className="p-5 flex-grow flex flex-col">
        <h3 className="text-lg font-bold text-gray-900 dark:text-white truncate" title={name}>
          {/* MODIFIED */}
          {name || t('customerCard.unnamed')}
        </h3>

        {/* Contact Info */}
        <div className="mt-2 space-y-1.5">
          {mobile && (
            <div className="flex items-center gap-2">
              <PhoneIcon />
              <span className="text-sm text-gray-700 dark:text-gray-300">{mobile}</span>
            </div>
          )}
          {email && (
            <div className="flex items-center gap-2">
              <EmailIcon />
              <span className="text-sm text-gray-700 dark:text-gray-300 truncate" title={email}>{email}</span>
            </div>
          )}
        </div>

        {/* Stats */}
        <div className="mt-4 pt-4 border-t border-gray-200 dark:border-gray-700 flex justify-between items-end">
          <div className="text-left">
            {/* MODIFIED */}
            <p className="text-xs text-gray-500 font-medium">{t('customerCard.totalPurchases')}</p>
            <p className="text-xl font-bold text-cyan-600 dark:text-cyan-400">
              {totalPurchaseCount || 0}
            </p>
          </div>
          <div className="text-right">
            {/* MODIFIED */}
            <p className="text-xs text-gray-500 font-medium">{t('customerCard.lastPurchase')}</p>
            <p className="text-lg font-bold text-gray-900 dark:text-white">
              {formatDate(lastPurchaseDate)}
            </p>
          </div>
        </div>

        {/* Action Buttons */}
        {canManage && (
          <div className="mt-4 space-y-2">
            <button
              onClick={() => onSendEmail(customer)}
              className="button-primary w-full flex items-center justify-center"
            >
              <SendEmailIcon />
              {/* MODIFIED */}
              {t('customerCard.sendEmail')}
            </button>
            <button
              onClick={() => onViewHistory(customer)}
              className="button-secondary w-full flex items-center justify-center"
            >
              <HistoryIcon />
              {/* MODIFIED */}
              {t('customerCard.viewHistory')}
            </button>
            <button
              onClick={() => onDelete(customer)}
              className="w-full flex items-center justify-center px-4 py-2 rounded-lg font-medium
                         text-red-500 bg-gray-100 hover:bg-red-100 hover:text-red-600
                         dark:text-red-400 dark:bg-gray-800/50 dark:hover:bg-red-900/50 dark:hover:text-red-300
                         transition-all duration-300 disabled:opacity-50"
              // MODIFIED
              aria-label={t('customerCard.deleteAria', { name: name || t('customerCard.thisCustomer') })}
            >
              <DeleteIcon />
              {/* MODIFIED */}
              <span className="ml-1.5">{t('customerCard.delete')}</span>
            </button>
          </div>
        )}
      </div>
    </motion.div>
  );
};

export default CustomerCard;
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\customers\CustomerEdit.jsx
--------------------------------------------------------------------
import React, { useEffect, useState } from 'react';
import { useNavigate, useParams } from 'react-router-dom';
import { getCustomer, updateCustomer } from '../../services/customerService';
import { useToast } from '../../context/ToastContext';
import { useTranslation } from 'react-i18next';

export default function CustomerEdit() {
  const { id } = useParams();
  const nav = useNavigate();
  const { showToast } = useToast();
  const { t } = useTranslation();

  const [customer, setCustomer] = useState({
    name: '',
    email: '',
    mobile: '',
  });
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    async function fetchData() {
      try {
        const data = await getCustomer(id);
        setCustomer(data);
      } catch (err) {
        const msg = err.response?.data?.message || err.message;
        showToast(`${t('customerEdit.errorLoad')} ${msg}`, 'error');
      } finally {
        setLoading(false);
      }
    }
    fetchData();
  }, [id, showToast, t]);

  async function handleSubmit(e) {
    e.preventDefault();
    try {
      await updateCustomer(id, customer);
      showToast(t('customerEdit.success'), 'success');
      nav('/customers');
    } catch (err) {
      const msg = err.response?.data?.message || err.message;
      console.error('Update failed:', err.response?.data || err);
      showToast(`${t('customerEdit.errorUpdate')} ${msg}`, 'error');
    }
  }

  if (loading) return <div className="card p-6 text-center text-gray-500 dark:text-gray-400">{t('customerEdit.loading')}</div>;

  return (
    <div className="card max-w-lg mx-auto p-6">
      <h2 className="card-title">{t('customerEdit.title')}</h2>

      <form onSubmit={handleSubmit} className="space-y-4">
        <div>
          <label className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1.5">{t('customerForm.name')}</label>
          <input
            type="text"
            value={customer.name}
            onChange={(e) => setCustomer({ ...customer, name: e.target.value })}
            className="form-input-no-icon w-full"
            required
          />
        </div>

        <div>
          <label className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1.5">{t('customerForm.email')}</label>
          <input
            type="email"
            value={customer.email}
            onChange={(e) => setCustomer({ ...customer, email: e.target.value })}
            className="form-input-no-icon w-full"
          />
        </div>

        <div>
          <label className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1.5">{t('customerForm.mobile')}</label>
          <input
            type="text"
            value={customer.mobile}
            onChange={(e) => setCustomer({ ...customer, mobile: e.target.value })}
            className="form-input-no-icon w-full"
          />
        </div>

        <button type="submit" className="button-primary w-full mt-3">
          {t('customerForm.save')}
        </button>
      </form>
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\customers\CustomerForm.jsx
--------------------------------------------------------------------
import React, { useState } from 'react';
import { createCustomer } from '../../services/customerService';
import { useNavigate } from 'react-router-dom';
import { useTranslation } from 'react-i18next';

export default function CustomerForm() {
  const { t } = useTranslation();
  const [name, setName] = useState('');
  const [email, setEmail] = useState('');
  const [mobile, setMobile] = useState('');
  const nav = useNavigate();

  async function handleSubmit(e) {
    e.preventDefault();
    try {
      await createCustomer({ name, email, mobile });
      nav('/customers');
    } catch (err) {
      alert("Failed to create customer: " + (err.response?.data?.message || err.message));
    }
  }

  return (
    <form onSubmit={handleSubmit} className="card max-w-md mx-auto p-6">
      <h2 className="card-title">{t('customerForm.title')}</h2>

      <div className="space-y-4">
        <div>
          <label className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1.5">{t('customerForm.name')}</label>
          <input
            value={name}
            onChange={e => setName(e.target.value)}
            placeholder={t('customerForm.name')}
            className="form-input-no-icon w-full"
            required
          />
        </div>
        <div>
          <label className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1.5">{t('customerForm.email')}</label>
          <input
            value={email}
            onChange={e => setEmail(e.target.value)}
            placeholder={t('customerForm.email')}
            type="email"
            className="form-input-no-icon w-full"
          />
        </div>
        <div>
          <label className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1.5">{t('customerForm.mobile')}</label>
          <input
            value={mobile}
            onChange={e => setMobile(e.target.value)}
            placeholder={t('customerForm.mobile')}
            className="form-input-no-icon w-full"
            required
          />
        </div>
      </div>

      <button className="button-primary w-full mt-6">{t('customerForm.save')}</button>
    </form>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\customers\CustomerHistory.jsx
--------------------------------------------------------------------
import React, { useEffect, useState } from "react";
import { useParams, Link } from "react-router-dom";
import { getCustomer, getPurchaseHistory } from "../../services/customerService";
import { downloadBillPdf, generatePdfToken, downloadBillPdfWithFlow, handlePdfDownload } from "../../services/billService";
import { useToast } from "../../context/ToastContext";
import { useTranslation } from 'react-i18next';

export default function CustomerHistory() {
  const { t } = useTranslation();
  const { id } = useParams();
  const [history, setHistory] = useState([]);
  const [customer, setCustomer] = useState(null);
  const [error, setError] = useState(null);
  const [loading, setLoading] = useState(true);
  const [downloadingId, setDownloadingId] = useState(null);
  const { showToast } = useToast();

  useEffect(() => {
    if (!id) return;
    async function fetchData() {
      setLoading(true);
      try {
        const [custData, histData] = await Promise.all([
          getCustomer(id),
          getPurchaseHistory(id)
        ]);
        setCustomer(custData);
        setHistory(histData.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt)));
      } catch (err) {
        console.error("Error fetching data:", err);
        const errMsg = err.response?.data?.error || t('history.error');
        setError(errMsg);
        showToast(errMsg, 'error');
      } finally {
        setLoading(false);
      }
    }
    fetchData();
  }, [id, showToast, t]);

  const handleDownload = async (bill) => {
    setDownloadingId(bill.billId);
    try {
      showToast(t('history.downloading', { billId: bill.billId }), 'info');

      // Use the complete flow that handles token generation automatically
      const pdfBlob = await downloadBillPdfWithFlow(bill.billId);
      handlePdfDownload(pdfBlob, bill.billId);

      showToast(t('history.downloadSuccess'), 'success');
    } catch (err) {
      console.error('Error downloading PDF:', err);
      const errorMessage = err.response?.data?.message || err.message || t('history.downloadFailed');
      showToast(errorMessage, 'error');
    } finally {
      setDownloadingId(null);
    }
  };

  // Alternative method if you want more control over the process
  const handleDownloadAlternative = async (bill) => {
    setDownloadingId(bill.billId);
    try {
      showToast(t('history.downloading', { billId: bill.billId }), 'info');

      let pdfToken = bill.pdfAccessToken;

      // If no token exists or token might be expired, generate a new one
      if (!pdfToken) {
        const tokenResponse = await generatePdfToken(bill.billId);
        pdfToken = tokenResponse.pdfAccessToken;
      }

      // Download the PDF with the token
      const blob = await downloadBillPdf(bill.billId, pdfToken);

      // Create and trigger download
      const url = window.URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = `Bill_${bill.billId}.pdf`;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      window.URL.revokeObjectURL(url);

      showToast(t('history.downloadSuccess'), 'success');
    } catch (err) {
      console.error('Error downloading PDF:', err);
      const errorMessage = err.response?.data?.message || err.message || t('history.downloadFailed');
      showToast(errorMessage, 'error');
    } finally {
      setDownloadingId(null);
    }
  };

  if (loading) return (
    <div className="card p-6 text-center text-gray-500 dark:text-gray-400">
      <div className="flex items-center justify-center">
        <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-cyan-500 mr-3"></div>
        {t('history.loading')}
      </div>
    </div>
  );

  if (error) return (
    <div className="card p-6">
      <div className="text-red-500 dark:text-red-400 text-center">
        <p className="font-semibold">{error}</p>
        <button
          onClick={() => window.history.back()}
          className="button-primary mt-4"
        >
          {t('common.goBack')}
        </button>
      </div>
    </div>
  );

  if (!customer) return (
    <div className="card p-6 text-center text-gray-500 dark:text-gray-400">
      {t('history.notFound')}
    </div>
  );

  const formatCurrency = (amount) => {
    return (amount || 0).toLocaleString('en-IN', {
      style: 'currency',
      currency: 'INR',
      maximumFractionDigits: 2,
    });
  };

  const formatDate = (dateString) => {
    if (!dateString) return 'N/A';
    const date = new Date(dateString);
    return {
      date: date.toLocaleDateString('en-IN', {
        day: '2-digit',
        month: 'short',
        year: 'numeric'
      }),
      time: date.toLocaleTimeString('en-IN', {
        hour: '2-digit',
        minute: '2-digit',
        hour12: true
      })
    };
  };

  return (
    <div className="space-y-6">
      {/* Header */}
      <div className="card p-6">
        <div className="flex items-center justify-between">
          <div>
            <Link to="/customers" className="text-blue-500 dark:text-blue-400 hover:underline text-sm mb-2 inline-flex items-center">
              <svg className="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10 19l-7-7m0 0l7-7m-7 7h18" />
              </svg>
              {t('history.backToCustomers')}
            </Link>
            <h2 className="text-2xl font-bold text-gray-900 dark:text-white mb-1">
              {t('history.title')}
            </h2>
            <p className="text-lg text-cyan-600 dark:text-cyan-400 font-medium">
              {customer.name} • {customer.mobile}
            </p>
            {customer.email && (
              <p className="text-gray-600 dark:text-gray-400 text-sm mt-1">
                {customer.email}
              </p>
            )}
          </div>
          <div className="text-right">
            <p className="text-sm text-gray-500 dark:text-gray-400">
              {t('history.totalPurchases')}
            </p>
            <p className="text-2xl font-bold text-emerald-600 dark:text-emerald-400">
              {history.length}
            </p>
          </div>
        </div>
      </div>

      {/* Purchase History */}
      <div className="card p-0 overflow-hidden">
        {history.length === 0 ? (
          <div className="text-center py-12">
            <svg className="w-16 h-16 text-gray-400 dark:text-gray-500 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M9 17v-6h6v6m-6-4h.01M12 3v4m0 0h8m-8 0H4" />
            </svg>
            <p className="text-lg text-gray-500 dark:text-gray-400 font-light mb-2">
              {t('history.noHistory')}
            </p>
            <p className="text-sm text-gray-400 dark:text-gray-500">
              {t('history.noHistoryHint')}
            </p>
          </div>
        ) : (
          <div className="overflow-x-auto">
            <table className="table w-full">
              <thead>
                <tr className="bg-gray-50 dark:bg-gray-800/50">
                  <th className="text-left py-4 px-6 font-semibold text-gray-700 dark:text-gray-300">
                    {t('history.headerBill')}
                  </th>
                  <th className="text-left py-4 px-6 font-semibold text-gray-700 dark:text-gray-300">
                    {t('history.headerDate')}
                  </th>
                  <th className="text-right py-4 px-6 font-semibold text-gray-700 dark:text-gray-300">
                    {t('history.headerTotal')}
                  </th>
                  <th className="text-center py-4 px-6 font-semibold text-gray-700 dark:text-gray-300">
                    {t('history.headerActions')}
                  </th>
                </tr>
              </thead>
              <tbody>
                {history.map((bill) => {
                  const { date, time } = formatDate(bill.createdAt);
                  const total = bill.totalAmount ?? bill.total ?? 0;

                  return (
                    <tr
                      key={bill.billId || bill.id}
                      className="border-b border-gray-200 dark:border-gray-700/50 hover:bg-gray-50 dark:hover:bg-gray-800/30 transition-colors"
                    >
                      <td className="py-4 px-6">
                        <span className="font-mono text-cyan-600 dark:text-cyan-400 font-medium">
                          {bill.billId || "N/A"}
                        </span>
                      </td>
                      <td className="py-4 px-6">
                        <div>
                          <p className="text-gray-900 dark:text-white font-medium">
                            {date}
                          </p>
                          <p className="text-xs text-gray-500 dark:text-gray-400">
                            {time}
                          </p>
                        </div>
                      </td>
                      <td className="py-4 px-6 text-right">
                        <span className="font-bold text-emerald-600 dark:text-emerald-400">
                          {formatCurrency(total)}
                        </span>
                      </td>
                      <td className="py-4 px-6 text-center">
                        <button
                          onClick={() => handleDownload(bill)}
                          disabled={downloadingId === bill.billId}
                          className="button-primary text-sm px-4 py-2 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 mx-auto min-w-[120px]"
                          title={t('history.download')}
                        >
                          {downloadingId === bill.billId ? (
                            <>
                              <div className="w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"></div>
                              {t('common.downloading')}
                            </>
                          ) : (
                            <>
                              <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                              </svg>
                              {t('history.download')}
                            </>
                          )}
                        </button>
                      </td>
                    </tr>
                  );
                })}
              </tbody>
            </table>
          </div>
        )}
      </div>

      {/* Customer Stats */}
      {history.length > 0 && (
        <div className="card p-6">
          <h3 className="text-lg font-semibold text-gray-900 dark:text-white mb-4">
            {t('history.purchaseSummary')}
          </h3>
          <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div className="bg-gradient-to-br from-blue-500 to-cyan-400 rounded-lg p-4 text-white">
              <p className="text-sm opacity-90">{t('history.totalBills')}</p>
              <p className="text-2xl font-bold">{history.length}</p>
            </div>
            <div className="bg-gradient-to-br from-purple-500 to-pink-500 rounded-lg p-4 text-white">
              <p className="text-sm opacity-90">{t('history.totalSpent')}</p>
              <p className="text-2xl font-bold">
                {formatCurrency(history.reduce((sum, bill) => sum + (bill.totalAmount || bill.total || 0), 0))}
              </p>
            </div>
            <div className="bg-gradient-to-br from-green-500 to-emerald-400 rounded-lg p-4 text-white">
              <p className="text-sm opacity-90">{t('history.avgBill')}</p>
              <p className="text-2xl font-bold">
                {formatCurrency(history.reduce((sum, bill) => sum + (bill.totalAmount || bill.total || 0), 0) / history.length)}
              </p>
            </div>
          </div>
        </div>
      )}
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\customers\CustomerList.jsx
--------------------------------------------------------------------
import React, { useEffect, useState, useMemo } from 'react';
import { useNavigate } from 'react-router-dom';
import { listCustomers, deleteCustomer } from '../../services/customerService';
import { listBills } from '../../services/billService';
import authService from '../../services/authService';
import Fuse from 'fuse.js';
import { motion, AnimatePresence } from 'framer-motion';
import { useToast } from '../../context/ToastContext';
import { useTranslation } from 'react-i18next';
import CustomerCard from './CustomerCard';
import SendEmailModal from './SendEmailModal';

// --- Icons ---
const SearchIcon = () => (
  <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
  </svg>
);
const SortIcon = () => (
  <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 4h13M3 8h9M3 12h9m-9 4h13m-3-4v8m0 0l-4-4m4 4l4-4" />
  </svg>
);
const FilterIcon = () => (
  <svg className="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z" />
  </svg>
);
const EmailIcon = () => (
  <svg className="w-5 h-5 mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
  </svg>
);
// --- End Icons ---

// --- Skeleton Card ---
const SkeletonCard = () => (
  <div className="card relative flex flex-col overflow-hidden animate-pulse">
    <div className="aspect-w-1 aspect-h-1 w-full bg-gray-200 dark:bg-gray-800 rounded-t-2xl"></div>
    <div className="p-5 flex-grow flex flex-col">
      <div className="h-6 bg-gray-300 dark:bg-gray-700 rounded w-3/4 mb-2"></div>
      <div className="h-4 bg-gray-300 dark:bg-gray-700 rounded w-1/2 mb-4"></div>
      <div className="mt-4 pt-4 border-t border-gray-200 dark:border-gray-700 flex justify-between items-end">
        <div className="w-1/3"><div className="h-5 bg-gray-300 dark:bg-gray-700 rounded w-full"></div></div>
        <div className="w-1/4"><div className="h-5 bg-gray-300 dark:bg-gray-700 rounded w-full"></div></div>
      </div>
      <div className="mt-4 space-y-2">
        <div className="h-10 bg-gray-300 dark:bg-gray-700 rounded w-full"></div>
        <div className="h-10 bg-gray-300 dark:bg-gray-700 rounded w-full"></div>
      </div>
    </div>
  </div>
);

export default function CustomerList() {
  const { t } = useTranslation();
  const [customers, setCustomers] = useState([]);
  const [searchTerm, setSearchTerm] = useState('');
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);
  const [sortBy, setSortBy] = useState('name-asc');
  const [filter, setFilter] = useState('all');
  const [isEmailModalOpen, setIsEmailModalOpen] = useState(false);
  const [selectedCustomers, setSelectedCustomers] = useState([]);

  const { showToast } = useToast();
  const navigate = useNavigate();
  const user = authService.getUserFromToken();
  const canManage = user?.role === 'OWNER' || user?.role === 'MANAGER';

  const fuse = useMemo(() => new Fuse(customers, {
    keys: ['name', 'email', 'mobile'],
    threshold: 0.4,
  }), [customers]);

  const displayCustomers = useMemo(() => {
    let items = searchTerm
      ? fuse.search(searchTerm).map(r => r.item)
      : [...customers];

    if (filter === 'inactive') {
      const thirtyDaysAgo = new Date(Date.now() - 30 * 24 * 60 * 60 * 1000);
      items = items.filter(c => !c.lastPurchaseDate || new Date(c.lastPurchaseDate) < thirtyDaysAgo);
    }

    const [key, direction] = sortBy.split('-');
    return [...items].sort((a, b) => {
      let valA = a[key] ?? (key === 'lastPurchaseDate' ? 0 : '');
      let valB = b[key] ?? (key === 'lastPurchaseDate' ? 0 : '');
      if (key === 'lastPurchaseDate') {
        valA = valA ? new Date(valA).getTime() : 0;
        valB = valB ? new Date(valB).getTime() : 0;
      } else if (key === 'totalPurchaseCount') {
        valA = valA || 0;
        valB = valB || 0;
      } else {
        valA = (valA || '').toString().toLowerCase();
        valB = (valB || '').toString().toLowerCase();
      }
      return (valA < valB ? -1 : 1) * (direction === 'asc' ? 1 : -1);
    });
  }, [customers, searchTerm, filter, sortBy, fuse]);

  useEffect(() => {
    loadCustomers();
  }, []);

  async function loadCustomers() {
    try {
      setLoading(true);
      setError(null);
      const [customerData, billData] = await Promise.all([
        listCustomers(),
        listBills()
      ]);
      if (!Array.isArray(customerData) || !Array.isArray(billData)) {
        throw new Error("Invalid data from server");
      }
      const billMap = new Map();
      billData.forEach(bill => bill.billId && billMap.set(bill.billId, bill));
      const processed = customerData.map(customer => {
        let totalCount = 0;
        let latestDate = null;
        if (customer.purchaseHistory?.length > 0) {
          totalCount = customer.purchaseHistory.length;
          customer.purchaseHistory.forEach(billId => {
            const bill = billMap.get(billId);
            if (bill?.createdAt) {
              const date = new Date(bill.createdAt);
              if (!latestDate || date > latestDate) latestDate = date;
            }
          });
        }
        return {
          ...customer,
          totalPurchaseCount: totalCount,
          lastPurchaseDate: latestDate ? latestDate.toISOString() : null
        };
      });
      setCustomers(processed);
    } catch (err) {
      console.error("Failed to load customers:", err);
      const msg = "Failed to load data. Please try again.";
      setError(msg);
      showToast(err.message || msg, 'error');
    } finally {
      setLoading(false);
    }
  }

  const handleViewHistory = (customer) => {
    navigate(`/customers/${customer.id}/history`);
  };

  const handleOpenEmailModal = (customer) => {
    setSelectedCustomers([customer]);
    setIsEmailModalOpen(true);
  };

  const handleSendToAll = () => {
    if (window.confirm(t('customerList.emailAllConfirm', { count: customers.length }))) {
      setSelectedCustomers(customers);
      setIsEmailModalOpen(true);
    }
  };

  const handleCloseEmailModal = (didSend = false) => {
    setIsEmailModalOpen(false);
    setSelectedCustomers([]);
    if (didSend) showToast('Email(s) sent!', 'success');
  };

  const handleDeleteCustomer = async (customer) => {
    if (!customer.id) {
      showToast('Cannot delete: Missing customer ID.', 'error');
      return;
    }
    if (!window.confirm(t('customerList.deleteConfirm', { name: customer.name || 'this customer' }))) {
      return;
    }
    try {
      await deleteCustomer(customer.id);
      showToast(t('customerList.deleteSuccess'), 'success');
      loadCustomers(); // Refresh
    } catch (err) {
      const msg = err.error || err.message || t('customerList.deleteError');
      showToast(msg, 'error');
    }
  };

  return (
    <div>
      <div className="flex justify-between items-center mb-4">
        <h2 className="text-3xl font-bold text-gray-900 dark:text-white font-display">
          {t('customerList.title')}
          <span className="text-lg font-normal text-gray-500 dark:text-gray-400 ml-3">
            ({displayCustomers.length} {t('customerList.matching')})
          </span>
        </h2>
      </div>

      <div className="card mb-6 p-4 flex flex-col md:flex-row gap-4 items-center">
        <div className="relative flex-grow w-full md:w-auto">
          <div className="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
            <SearchIcon />
          </div>
          <input
            type="text"
            value={searchTerm}
            onChange={(e) => setSearchTerm(e.target.value)}
            placeholder={t('customerList.searchPlaceholder')}
            className="form-input w-full"
          />
        </div>

        <div className="relative flex-shrink-0 w-full md:w-56">
          <div className="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
            <SortIcon />
          </div>
          <select
            value={sortBy}
            onChange={(e) => setSortBy(e.target.value)}
            className="form-input appearance-none w-full"
            aria-label={t('customerList.sort')}
          >
            <option value="name-asc">{t('customerList.sortNameAsc')}</option>
            <option value="name-desc">{t('customerList.sortNameDesc')}</option>
            <option value="lastPurchaseDate-desc">{t('customerList.sortDateDesc')}</option>
            <option value="lastPurchaseDate-asc">{t('customerList.sortDateAsc')}</option>
            <option value="totalPurchaseCount-desc">{t('customerList.sortPurchaseDesc')}</option>
          </select>
        </div>

        <div className="relative flex-shrink-0 w-full md:w-56">
          <div className="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
            <FilterIcon />
          </div>
          <select
            value={filter}
            onChange={(e) => setFilter(e.target.value)}
            className="form-input appearance-none w-full"
          >
            <option value="all">{t('customerList.filter')}</option>
            <option value="inactive">{t('customerList.filterInactive')}</option>
          </select>
        </div>

        {canManage && (
          <button
            onClick={handleSendToAll}
            className="button-primary flex-shrink-0 w-full md:w-auto flex items-center justify-center"
            disabled={customers.length === 0}
          >
            <EmailIcon />
            {t('customerList.emailAll')}
          </button>
        )}
      </div>

      {loading ? (
        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
          {[...Array(8)].map((_, i) => <SkeletonCard key={i} />)}
        </div>
      ) : error ? (
        <div className="card text-center p-10">
          <p className="text-red-500 dark:text-red-400 font-semibold">{error}</p>
          <button onClick={loadCustomers} className="button-primary mt-4">
            {t('customerList.tryAgain')}
          </button>
        </div>
      ) : displayCustomers.length === 0 ? (
        <div className="card text-center p-10">
          <p className="text-gray-600 dark:text-gray-400 font-semibold">
            {searchTerm ? t('customerList.noMatch') : filter !== 'all' ? t('customerList.noFilterMatch') : t('customerList.noCustomers')}
          </p>
          <button onClick={() => { setSearchTerm(''); setFilter('all'); }} className="button-secondary mt-4">
            {t('customerList.clearFilters')}
          </button>
        </div>
      ) : (
        <motion.div
          layout
          className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"
        >
          <AnimatePresence>
            {displayCustomers.map((c) => (
              <CustomerCard
                key={c.id}
                customer={c}
                onSendEmail={handleOpenEmailModal}
                onViewHistory={handleViewHistory}
                onDelete={handleDeleteCustomer}
                canManage={canManage}
              />
            ))}
          </AnimatePresence>
        </motion.div>
      )}

      <SendEmailModal
        isOpen={isEmailModalOpen}
        onClose={handleCloseEmailModal}
        selectedCustomers={selectedCustomers}
      />
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\customers\ReminderTrigger.jsx
--------------------------------------------------------------------
import React, { useState } from "react";
import { triggerReminders } from "../../services/customerService";
import { useTranslation } from 'react-i18next';

export default function ReminderTrigger() {
  const { t } = useTranslation();
  const [status, setStatus] = useState("");
  const [loading, setLoading] = useState(false);

  async function handleTrigger() {
    setLoading(true);
    setStatus("");
    try {
      const res = await triggerReminders();
      setStatus(res.message || t('reminder.success'));
    } catch (err) {
      setStatus(err.response?.data?.error || t('reminder.error'));
    } finally {
      setLoading(false);
    }
  }

  return (
    <div className="card max-w-md mx-auto text-center p-6">
      <h2 className="card-title justify-center">📅 {t('reminder.title')}</h2>
      <button
        onClick={handleTrigger}
        disabled={loading}
        className="button-primary px-4 py-2"
      >
        {loading ? t('reminder.sending') : t('reminder.button')}
      </button>

      {status && (
        <p className="mt-3 text-sm font-medium text-blue-600 dark:text-blue-400">{status}</p>
      )}
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\customers\SendEmailModal.jsx
--------------------------------------------------------------------
import React, { useState } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { useToast } from '../../context/ToastContext';
import { sendCustomEmail } from '../../services/customerService';
import { useTranslation } from 'react-i18next'; // <-- Import

// --- Reusable Icons ---
const CloseIcon = () => (
  <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
  </svg>
);

const backdropVariants = {
  hidden: { opacity: 0 },
  visible: { opacity: 1 },
};

const modalVariants = {
  hidden: { opacity: 0, y: 50, scale: 0.9 },
  visible: {
    opacity: 1,
    y: 0,
    scale: 1,
    transition: { type: 'spring', stiffness: 300, damping: 30, bounce: 0.2 }
  },
  exit: {
    opacity: 0,
    scale: 0.9,
    transition: { duration: 0.2 }
  },
};

export default function SendEmailModal({ isOpen, onClose, selectedCustomers = [] }) {
  const { t } = useTranslation(); // <-- Get hook
  const [subject, setSubject] = useState('');
  const [body, setBody] = useState('');
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState(null);
  const { showToast } = useToast();

  const getRecipientText = () => {
    if (selectedCustomers.length === 0) return t('emailModal.noRecipients');
    if (selectedCustomers.length === 1) {
      const c = selectedCustomers[0];
      return `${t('emailModal.to')} ${c.name || 'Unknown'} (${c.email || 'No email'})`;
    }
    return t('emailModal.toCount', { count: selectedCustomers.length });
  };

  const handleSubmit = async (e) => {
    e.preventDefault();

    if (selectedCustomers.length === 0) {
      const msg = t('emailModal.errorNoCustomers');
      setError(msg);
      showToast(msg, 'error');
      return;
    }

    if (!subject.trim() || !body.trim()) {
      const msg = t('emailModal.errorNoFields');
      setError(msg);
      showToast(msg, 'error');
      return;
    }

    setLoading(true);
    setError(null);

    const emailRequest = {
      customerIds: selectedCustomers.map(c => c.id),
      subject: subject.trim(),
      body: body.trim()
    };

    try {
      const response = await sendCustomEmail(emailRequest);
      showToast(response.message || `Email sending started!`, 'success');
      setSubject('');
      setBody('');
      onClose(true); // Close with success
    } catch (err) {
      const errMsg = err.error || err.message || "Failed to send emails.";
      setError(errMsg);
      showToast(errMsg, 'error');
    } finally {
      setLoading(false);
    }
  };

  const getSendButtonText = () => {
    if (loading) return t('emailModal.sending');
    if (selectedCustomers.length === 1) {
      return t('emailModal.send', { count: 1 });
    }
    return t('emailModal.sendPlural', { count: selectedCustomers.length });
  }

  return (
    <AnimatePresence>
      {isOpen && (
        <motion.div
          variants={backdropVariants}
          initial="hidden"
          animate="visible"
          exit="hidden"
          className="fixed inset-0 bg-black/70 backdrop-blur-sm z-40 flex items-center justify-center p-4"
          onClick={() => !loading && onClose(false)}
        >
          <motion.div
            variants={modalVariants}
            initial="hidden"
            animate="visible"
            exit="exit"
            className="card max-w-2xl w-full max-h-[90vh] flex flex-col"
            onClick={(e) => e.stopPropagation()}
          >
            {/* --- Modal Header --- */}
            <div className="flex justify-between items-center p-6 border-b border-gray-200 dark:border-gray-800 flex-shrink-0">
              <h2 className="text-2xl font-bold text-gray-900 dark:text-white font-display">
                {t('emailModal.title')}
              </h2>
              <button
                onClick={() => onClose(false)}
                className="text-gray-500 hover:text-gray-900 dark:hover:text-white transition-colors"
                disabled={loading}
                aria-label="Close modal"
              >
                <CloseIcon />
              </button>
            </div>

            {/* --- Modal Body --- */}
            <form onSubmit={handleSubmit} className="p-6 overflow-y-auto custom-scrollbar space-y-4">
              {error && (
                <div className="bg-red-100 dark:bg-red-900/50 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-100 px-4 py-3 rounded-lg" role="alert">
                  <span className="font-medium">Error:</span> {error}
                </div>
              )}

              <div>
                <label className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1.5">
                  {t('emailModal.recipients')}
                </label>
                <div className="form-input bg-gray-100 dark:bg-gray-900/50 p-3 rounded-lg text-gray-700 dark:text-gray-300">
                  {getRecipientText()}
                </div>
              </div>

              <div>
                <label htmlFor="subject" className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1.5">
                  {t('emailModal.subject')} <span className="text-red-500">*</span>
                </label>
                <input
                  id="subject"
                  type="text"
                  value={subject}
                  onChange={(e) => setSubject(e.target.value)}
                  placeholder={t('emailModal.subjectPlaceholder')}
                  className="form-input-no-icon" // Use no-icon version
                  required
                  disabled={loading}
                />
              </div>

              <div>
                <label htmlFor="body" className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1.5">
                  {t('emailModal.body')} <span className="text-red-500">*</span>
                </label>
                <textarea
                  id="body"
                  rows="10"
                  value={body}
                  onChange={(e) => setBody(e.target.value)}
                  placeholder={t('emailModal.bodyPlaceholder')}
                  className="form-input-no-icon resize-none" // Use no-icon version
                  required
                  disabled={loading}
                />
               <p className="text-xs text-gray-500 dark:text-gray-500 mt-1">
                 {t('emailModal.personalizeHint')}
               </p>
              </div>
            </form>

            {/* --- Modal Footer --- */}
            <div className="flex justify-end items-center p-6 border-t border-gray-200 dark:border-gray-800 flex-shrink-0 bg-gray-50 dark:bg-gray-900/50 rounded-b-2xl space-x-3">
              <button
                type="button"
                onClick={() => onClose(false)}
                className="button-secondary"
                disabled={loading}
              >
                {t('emailModal.cancel')}
              </button>
              <button
                type="submit"
                onClick={handleSubmit}
                className="button-primary min-w-[180px]"
                disabled={loading || selectedCustomers.length === 0 || !subject.trim() || !body.trim()}
              >
                {getSendButtonText()}
              </button>
            </div>
          </motion.div>
        </motion.div>
      )}
    </AnimatePresence>
  );
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\components\layout
--------------------------------------------------------------------
Contents:
AuthLayout.jsx
MainLayout.jsx
Navbar.jsx
Sidebar.jsx

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\layout\AuthLayout.jsx
--------------------------------------------------------------------
import React from 'react';
import { Outlet } from 'react-router-dom';

/**
 * This layout wraps all public auth pages (Login, Signup).
 * It's a simple wrapper to allow these pages to control the full screen.
 */
export default function AuthLayout() {
  return (
    // UPDATED: Added theme-aware background
    <div className="min-h-screen bg-white dark:bg-gray-900 transition-colors duration-200">
      {/* Auth pages (Login, Signup) will render here */}
      <Outlet />
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\layout\MainLayout.jsx
--------------------------------------------------------------------
import React from 'react';
import { Outlet } from 'react-router-dom';
import Navbar from './Navbar';

/**
 * This layout wraps all protected pages *after* login.
 * It includes the main Navbar and the centered, padded content area.
 */
export default function MainLayout() {
  return (
    // UPDATED: Now theme-aware
    <div className="min-h-screen bg-gray-100 dark:bg-gray-900 transition-colors duration-200">
      <Navbar />
      <main className="max-w-7xl mx-auto p-4 sm:p-6 lg:p-8">
        {/* All protected child routes will render here */}
        <Outlet />
      </main>
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\layout\Navbar.jsx
--------------------------------------------------------------------
import React, { useState } from 'react';
import { Link, useNavigate } from 'react-router-dom';
import authService from '../../services/authService';
import { useCart } from '../../context/CartContext';
import { useTheme } from '../../context/ThemeContext';
import { useTranslation } from 'react-i18next'; // <-- 1. Import
import i18n from '../../i18n'; // <-- 2. Import i18n instance

// --- Icons ---
const LogoIcon = () => (
  <svg className="w-8 h-8 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" />
  </svg>
);
const CartIcon = ({ count }) => (
  <div className="relative">
    <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
    </svg>
    {count > 0 && (
      <span className="absolute -top-2 -right-2 bg-red-500 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center">
        {count > 99 ? '99+' : count}
      </span>
    )}
  </div>
);
const LanguageIcon = () => (
  <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9" />
  </svg>
);
const SunIcon = () => (
  <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M12 12a5 5 0 100-10 5 5 0 000 10z" />
  </svg>
);
const MoonIcon = () => (
  <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
  </svg>
);
// --- END ICONS ---


export default function Navbar() {
  const { t } = useTranslation(); // <-- 3. Get translation function
  const nav = useNavigate();
  const user = authService.getUserFromToken();
  const { cartCount } = useCart();
  const { theme, toggleTheme } = useTheme();

  // 4. Use i18n's language state, which reads from localStorage
  const [language, setLanguage] = useState(i18n.language);

  const handleLanguageChange = (e) => {
    const selectedLang = e.target.value;
    setLanguage(selectedLang);
    localStorage.setItem("sr_lang", selectedLang);
    i18n.changeLanguage(selectedLang); // <-- 5. Change language live
    // window.location.reload(); // <-- 6. No longer needed!
  };

  const logout = () => {
    authService.logout();
    window.location.href = '/login';
  };

  return (
    <nav className="bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-200 shadow-md border-b border-gray-200 dark:border-gray-700">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div className="flex justify-between items-center h-16">

          {/* Left section */}
          <div className="flex gap-6 items-center">
            <Link to="/" className="flex items-center gap-2 flex-shrink-0">
              <LogoIcon />
              <span className="font-semibold text-xl text-gray-900 dark:text-white">
                Smart Retail
              </span>
            </Link>
            {user && (
              <div className="hidden md:flex gap-4">
                {/* --- 7. Use t() function --- */}
                <Link to="/dashboard" className="nav-link">{t('nav.dashboard')}</Link>
                <Link to="/products" className="nav-link">{t('nav.products')}</Link>
                <Link to="/bills" className="nav-link">{t('nav.bills')}</Link>
                <Link to="/customers" className="nav-link">{t('nav.customers')}</Link>
                <Link to="/reports" className="nav-link">{t('nav.reports')}</Link>
              </div>
            )}
          </div>

          {/* Right section */}
          {user ? (
            <div className="flex gap-4 items-center">
              <Link to="/profile" className="nav-link text-blue-500 dark:text-blue-400 font-medium">
                {user.email}
              </Link>

              {/* Language Selector */}
              <div className="relative flex items-center">
                <LanguageIcon />
                <select
                  value={language}
                  onChange={handleLanguageChange}
                  className="bg-transparent text-gray-600 dark:text-gray-300 font-medium text-sm rounded-md
                             pl-1 pr-7 -ml-1 py-1 border-0 focus:ring-0
                             hover:bg-gray-200 dark:hover:bg-gray-700/50 transition-colors"
                  aria-label={t('nav.selectLang')}
                >
                  <option value="en" className="bg-white dark:bg-gray-800">{t('lang.en')}</option>
                  <option value="hi" className="bg-white dark:bg-gray-800">{t('lang.hi')}</option>
                  <option value="mr" className="bg-white dark:bg-gray-800">{t('lang.mr')}</option>
                  <option value="te" className="bg-white dark:bg-gray-800">{t('lang.te')}</option>
                </select>
              </div>

              {/* Theme Toggle Button */}
              <button
                onClick={toggleTheme}
                className="nav-link p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-md transition-colors"
                title={`Switch to ${theme === 'light' ? 'dark' : 'light'} mode`}
              >
                {theme === 'light' ? <MoonIcon /> : <SunIcon />}
              </button>

              <Link
                to="/checkout"
                className="nav-link relative p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-md transition-colors"
                title={t('nav.viewCart')}
              >
                <CartIcon count={cartCount} />
              </Link>

              <button
                onClick={logout}
                className="bg-red-600 px-3 py-1.5 rounded-md text-sm font-medium text-white hover:bg-red-700 transition-colors"
              >
                {t('nav.logout')}
              </button>
            </div>
          ) : (
             <Link to="/login" className="bg-blue-600 px-3 py-1.5 rounded-md text-sm font-medium text-white hover:bg-blue-700 transition-colors">
              {t('nav.login')}
            </Link>
          )}
        </div>
      </div>
    </nav>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\layout\Sidebar.jsx
--------------------------------------------------------------------
import React from 'react'
import { Link } from 'react-router-dom'

export default function Sidebar() {
  return (
    <div className="w-64 bg-gray-800 text-white min-h-screen p-4 space-y-3">
      <h2 className="text-xl font-semibold mb-4">Menu</h2>
      <Link to="/dashboard" className="block hover:bg-gray-700 rounded p-2">Dashboard</Link>
      <Link to="/products" className="block hover:bg-gray-700 rounded p-2">Products</Link>
      <Link to="/bills" className="block hover:bg-gray-700 rounded p-2">Bills</Link>
      <Link to="/customers" className="block hover:bg-gray-700 rounded p-2">Customers</Link>
      <Link to="/reports" className="block hover:bg-gray-700 rounded p-2">Reports</Link>
    </div>
  )
}

--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\components\products
--------------------------------------------------------------------
Contents:
BulkUploadModal.jsx
ProductForm.jsx
ProductList.jsx

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\products\BulkUploadModal.jsx
--------------------------------------------------------------------
import React, { useState } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { bulkUploadProducts } from '../../services/productService';
import { useTranslation } from 'react-i18next';

// --- Icons ---
const CloseIcon = () => (
  <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
  </svg>
);
const UploadIcon = () => (
  <svg className="w-12 h-12 text-gray-400 dark:text-gray-500 mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
  </svg>
);
// --- End Icons ---

const backdropVariants = {
  hidden: { opacity: 0 },
  visible: { opacity: 1 },
};
const modalVariants = {
  hidden: { opacity: 0, y: 50, scale: 0.9 },
  visible: {
    opacity: 1,
    y: 0,
    scale: 1,
    transition: { type: 'spring', stiffness: 300, damping: 30, bounce: 0.2 }
  },
  exit: {
    opacity: 0,
    scale: 0.9,
    transition: { duration: 0.2 }
  },
};

export default function BulkUploadModal({ isOpen, onClose }) {
  const { t } = useTranslation();
  const [file, setFile] = useState(null);
  const [loading, setLoading] = useState(false);
  const [result, setResult] = useState(null);
  const [error, setError] = useState(null);

  const handleFileChange = (e) => {
    setFile(e.target.files[0]);
    setResult(null);
    setError(null);
  };

  const handleDownloadTemplate = () => {
    const headers = "productId,name,category,price,quantity,minQuantity,reorderLevel,expiryDate(yyyy-MM-dd)";
    const example = "P1001,Milk,Dairy,50,100,10,20,2026-12-31";
    const csvContent = "data:text/csv;charset=utf-8," + headers + "\n" + example;

    const link = document.createElement("a");
    link.setAttribute("href", encodeURI(csvContent));
    link.setAttribute("download", "product_template.csv");
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
  };

  const handleSubmit = async () => {
    if (!file) {
      setError(t('products.bulkErrorFile'));
      return;
    }
    setLoading(true);
    setError(null);
    setResult(null);

    try {
      const res = await bulkUploadProducts(file);
      setResult(res);
    } catch (err) {
      console.error(err);
      setError(err.response?.data?.error || t('products.bulkErrorUpload'));
    } finally {
      setLoading(false);
    }
  };

  const handleClose = () => {
    setFile(null);
    setResult(null);
    setError(null);
    onClose(result); // Pass result back to refresh list if successful
  };

  return (
    <AnimatePresence>
      {isOpen && (
        <motion.div
          variants={backdropVariants}
          initial="hidden"
          animate="visible"
          exit="hidden"
          className="fixed inset-0 bg-black/70 backdrop-blur-sm z-40 flex items-center justify-center p-4"
          onClick={handleClose}
        >
          <motion.div
            variants={modalVariants}
            initial="hidden"
            animate="visible"
            exit="exit"
            className="card max-w-lg w-full"
            onClick={(e) => e.stopPropagation()}
          >
            {/* Modal Header */}
            <div className="flex justify-between items-center p-6 border-b border-gray-200 dark:border-gray-800">
              <h2 className="text-2xl font-bold text-gray-900 dark:text-white font-display">
                {t('products.bulkTitle')}
              </h2>
              <button onClick={handleClose} className="text-gray-500 hover:text-gray-900 dark:hover:text-white transition-colors">
                <CloseIcon />
              </button>
            </div>

            {/* Modal Body */}
            <div className="p-6">
              {error && (
                <div className="bg-red-100 dark:bg-red-900/50 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-100 px-4 py-3 rounded-lg mb-4">
                  {error}
                </div>
              )}

              {result ? (
                // --- Success/Result Screen ---
                <div>
                  <h3 className="text-xl font-semibold text-gray-900 dark:text-white mb-3">{t('products.bulkSuccess')}</h3>
                  <div className="space-y-2">
                    <p className="text-green-600 dark:text-green-400">✅ {result.successful || 0} {t('products.bulkAdded')}</p>
                    <p className="text-yellow-600 dark:text-yellow-400">⚠️ {result.skipped || 0} {t('products.bulkSkipped')}</p>
                    <p className="text-red-600 dark:text-red-400">❌ {result.errors || 0} {t('products.bulkFailed')}</p>
                    {result.errorDetails?.length > 0 && (
                      <pre className="bg-gray-100 dark:bg-gray-800 p-3 rounded-lg text-xs h-32 overflow-y-auto custom-scrollbar text-gray-700 dark:text-gray-300">
                        {result.errorDetails.join('\n')}
                      </pre>
                    )}
                  </div>
                </div>
              ) : (
                // --- Upload Screen ---
                <div className="space-y-4">
                  <p className="text-gray-600 dark:text-gray-400">
                    {t('products.bulkStep1')}
                  </p>
                  <button onClick={handleDownloadTemplate} className="button-secondary w-full">
                    {t('products.bulkTemplate')}
                  </button>
                  <p className="text-gray-600 dark:text-gray-400">
                    {t('products.bulkStep2')}
                  </p>
                  <div className="flex items-center justify-center w-full">
                    <label className="flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 dark:border-gray-700 border-dashed rounded-lg cursor-pointer bg-gray-100/50 dark:bg-gray-800/50 hover:bg-gray-100 dark:hover:bg-gray-800">
                      <div className="flex flex-col items-center justify-center pt-5 pb-6">
                        <UploadIcon />
                        <p className="mb-2 text-sm text-gray-500 dark:text-gray-400">
                          <span className="font-semibold">{file ? file.name : t('products.bulkClick')}</span>
                        </p>
                        <p className="text-xs text-gray-500">{t('products.bulkFile')}</p>
                      </div>
                      <input type="file" className="hidden" accept=".csv" onChange={handleFileChange} />
                    </label>
                  </div>
                </div>
              )}
            </div>

            {/* Modal Footer */}
            <div className="flex justify-end items-center p-6 border-t border-gray-200 dark:border-gray-800 bg-gray-50 dark:bg-gray-900/50 rounded-b-2xl">
              <button onClick={handleClose} className="button-secondary mr-3">
                {result ? t('products.bulkClose') : t('products.bulkCancel')}
              </button>
              {!result && (
                <button
                  onClick={handleSubmit}
                  className="button-primary"
                  disabled={loading || !file}
                >
                  {loading ? t('products.bulkUploading') : t('products.bulkUploadProcess')}
                </button>
              )}
            </div>
          </motion.div>
        </motion.div>
      )}
    </AnimatePresence>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\products\ProductForm.jsx
--------------------------------------------------------------------
import React, { useEffect, useState } from 'react';
import {
  createProductJson,
  createProductMultipart,
  updateProduct,
  updateProductMultipart
} from '../../services/productService';
import { motion, AnimatePresence } from 'framer-motion';
import { useToast } from '../../context/ToastContext';
import { useTranslation } from 'react-i18next';

// --- Reusable Icons ---
const CloseIcon = () => (
  <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
  </svg>
);
const UploadIcon = () => (
  <svg className="w-8 h-8 text-gray-400 dark:text-gray-500 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
  </svg>
);

const backdropVariants = {
  hidden: { opacity: 0 },
  visible: { opacity: 1 },
};

const modalVariants = {
  hidden: { opacity: 0, y: 50, scale: 0.9 },
  visible: {
    opacity: 1,
    y: 0,
    scale: 1,
    transition: { type: 'spring', stiffness: 300, damping: 30, bounce: 0.2 }
  },
  exit: {
    opacity: 0,
    scale: 0.9,
    transition: { duration: 0.2 }
  },
};

const API_BASE = import.meta.env.VITE_API_BASE || 'http://localhost:8080';

export default function ProductForm({ isOpen, onClose, productToEdit }) {
  const { t } = useTranslation();
  const { showToast } = useToast();
  const [product, setProduct] = useState({
    productId: '',
    name: '',
    category: '',
    price: 0,
    quantity: 0,
    reorderLevel: 10,
  });
  const [imageFile, setImageFile] = useState(null);
  const [imagePreview, setImagePreview] = useState(null);
  const [error, setError] = useState(null);
  const [loading, setLoading] = useState(false);

  const isEdit = Boolean(productToEdit);

  useEffect(() => {
    if (isOpen) { // Only run logic when modal opens
      if (isEdit) {
        setLoading(true);
        setProduct({
          productId: productToEdit.productId || '',
          name: productToEdit.name || '',
          category: productToEdit.category || '',
          price: productToEdit.price || 0,
          quantity: productToEdit.quantity || 0,
          reorderLevel: productToEdit.reorderLevel || 10,
        });
        if (productToEdit.imageUrl) {
          setImagePreview(`${API_BASE}${productToEdit.imageUrl}`);
        } else {
          setImagePreview(null);
        }
        setImageFile(null);
        setError(null);
        setLoading(false);
      } else {
        // Reset form for "Add" mode
        setProduct({
          productId: '', name: '', category: '', price: 0, quantity: 0, reorderLevel: 10,
        });
        setImageFile(null);
        setImagePreview(null);
        setError(null);
        setLoading(false);
      }
    }
  }, [productToEdit, isEdit, isOpen]); // Rerun when modal opens

  const handleImageChange = (e) => {
    const file = e.target.files[0];
    if (file) {
      setImageFile(file);
      setImagePreview(URL.createObjectURL(file));
    }
  };

  const handleChange = (e) => {
    const { name, value } = e.target;
    setProduct(prev => ({
      ...prev,
      [name]: value,
    }));
  };

  async function handleSubmit(e) {
    e.preventDefault();
    setLoading(true);
    setError(null);

    const productData = {
      productId: product.productId,
      name: product.name,
      category: product.category,
      price: Number(product.price),
      quantity: Number(product.quantity),
      reorderLevel: Number(product.reorderLevel),
    };

    try {
      if (isEdit) {
        if (imageFile) {
          await updateProductMultipart(productToEdit.productId, productData, imageFile);
        } else {
          await updateProduct(productToEdit.productId, productData);
        }
        showToast(t('products.toastUpdateSuccess'), 'success');
      } else {
        if (imageFile) {
          await createProductMultipart(productData, imageFile);
        } else {
          await createProductJson(productData);
        }
        showToast(t('products.toastCreateSuccess'), 'success');
      }
      onClose(true); // Close modal and tell list to refresh
    } catch (err) {
      console.error(err);
      const errMsg = err.response?.data?.error || err.message || t('products.toastError');
      setError(errMsg);
      showToast(errMsg, 'error');
    } finally {
      setLoading(false);
    }
  }

  return (
    <AnimatePresence>
      {isOpen && (
        <motion.div
          variants={backdropVariants}
          initial="hidden"
          animate="visible"
          exit="hidden"
          className="fixed inset-0 bg-black/70 backdrop-blur-sm z-40 flex items-center justify-center p-4"
          onClick={() => !loading && onClose(false)} // Prevent close while loading
        >
          <motion.div
            variants={modalVariants}
            initial="hidden"
            animate="visible"
            exit="exit"
            className="card max-w-2xl w-full max-h-[90vh] flex flex-col"
            onClick={(e) => e.stopPropagation()}
          >
            {/* --- Modal Header --- */}
            <div className="flex justify-between items-center p-6 border-b border-gray-200 dark:border-gray-800 flex-shrink-0">
              <h2 className="text-2xl font-bold text-gray-900 dark:text-white font-display">
                {isEdit ? t('products.formTitleEdit') : t('products.formTitleAdd')}
              </h2>
              <button
                onClick={() => onClose(false)}
                className="text-gray-500 hover:text-gray-900 dark:hover:text-white transition-colors"
                disabled={loading}
              >
                <CloseIcon />
              </button>
            </div>

            {/* --- Modal Body --- */}
            <form onSubmit={handleSubmit} className="p-6 overflow-y-auto custom-scrollbar">
              {error && (
                <div className="bg-red-100 dark:bg-red-900/50 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-100 px-4 py-3 rounded-lg mb-4" role="alert">
                  <span className="font-medium">{t('products.error')}:</span> {error}
                </div>
              )}

              <div className="grid grid-cols-1 md:grid-cols-3 gap-6">

                {/* --- Image Uploader --- */}
                <div className="md:col-span-1">
                  <label className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-2">
                    {t('products.formImage')}
                  </label>
                  <div className="aspect-w-1 aspect-h-1">
                    <div className="w-full h-full border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-lg flex items-center justify-center text-center relative">
                      {imagePreview ? (
                        <img src={imagePreview} alt="Preview" className="w-full h-full object-cover rounded-lg" />
                      ) : (
                        <div className="flex flex-col items-center">
                          <UploadIcon />
                          <span className="text-sm text-gray-500">{t('products.formImageDrop')}</span>
                        </div>
                      )}
                      <input
                        type="file"
                        accept="image/png, image/jpeg, image/webp"
                        onChange={handleImageChange}
                        className="absolute inset-0 w-full h-full opacity-0 cursor-pointer"
                        title={isEdit ? t('products.formImageReplace') : t('products.formImageUpload')}
                        disabled={loading}
                      />
                    </div>
                  </div>
                </div>

                {/* --- Form Fields --- */}
                <div className="md:col-span-2 grid grid-cols-1 sm:grid-cols-2 gap-4">
                  <div className="sm:col-span-2">
                    <label htmlFor="productId" className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1.5">
                      {t('products.formId')}
                    </label>
                    <input
                      id="productId"
                      name="productId"
                      type="text"
                      value={product.productId}
                      onChange={handleChange}
                      placeholder={t('products.formIdPlaceholder')}
                      className="form-input"
                      required
                      disabled={isEdit || loading}
                    />
                  </div>

                  <div className="sm:col-span-2">
                    <label htmlFor="name" className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1.5">
                      {t('products.formName')}
                    </label>
                    <input
                      id="name"
                      name="name"
                      type="text"
                      value={product.name}
                      onChange={handleChange}
                      placeholder={t('products.formNamePlaceholder')}
                      className="form-input"
                      required
                      disabled={loading}
                    />
                  </div>

                  <div>
                    <label htmlFor="category" className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1.5">
                      {t('products.formCategory')}
                    </label>
                    <input
                      id="category"
                      name="category"
                      type="text"
                      value={product.category}
                      onChange={handleChange}
                      placeholder={t('products.formCategoryPlaceholder')}
                      className="form-input"
                      disabled={loading}
                    />
                  </div>

                  <div>
                    <label htmlFor="price" className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1.5">
                      {t('products.formPrice')}
                    </label>
                    <input
                      id="price"
                      name="price"
                      type="number"
                      min="0"
                      step="0.01"
                      value={product.price}
                      onChange={handleChange}
                      placeholder={t('products.formPricePlaceholder')}
                      className="form-input"
                      required
                      disabled={loading}
                    />
                  </div>

                  <div>
                    <label htmlFor="quantity" className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1.5">
                      {t('products.formQuantity')}
                    </label>
                    <input
                      id="quantity"
                      name="quantity"
                      type="number"
                      min="0"
                      step="1"
                      value={product.quantity}
                      onChange={handleChange}
                      placeholder={t('products.formQuantityPlaceholder')}
                      className="form-input"
                      required
                      disabled={loading}
                    />
                  </div>

                  <div>
                    <label htmlFor="reorderLevel" className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1.5">
                      {t('products.formReorder')}
                    </label>
                    <input
                      id="reorderLevel"
                      name="reorderLevel"
                      type="number"
                      min="0"
                      step="1"
                      value={product.reorderLevel}
                      onChange={handleChange}
                      placeholder={t('products.formReorderPlaceholder')}
                      className="form-input"
                      required
                      disabled={loading}
                    />
                  </div>
                </div>
              </div>
            </form>

            {/* --- Modal Footer --- */}
            <div className="flex justify-end items-center p-6 border-t border-gray-200 dark:border-gray-800 flex-shrink-0 bg-gray-50 dark:bg-gray-900/50 rounded-b-2xl">
              <button
                type="button"
                onClick={() => onClose(false)}
                className="button-secondary mr-3"
                disabled={loading}
              >
                {t('products.formCancel')}
              </button>
              <button
                type="submit"
                onClick={handleSubmit} // Trigger form submit
                className="button-primary"
                disabled={loading}
              >
                {loading
                  ? (isEdit ? t('products.formUpdating') : t('products.formSaving'))
                  : (isEdit ? t('products.formSave') : t('products.formCreate'))}
              </button>
            </div>
          </motion.div>
        </motion.div>
      )}
    </AnimatePresence>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\products\ProductList.jsx
--------------------------------------------------------------------
import React, { useEffect, useState, useMemo } from 'react';
import { listProducts, deleteProduct } from '../../services/productService';
import ProductForm from './ProductForm';
import BulkUploadModal from './BulkUploadModal';
import Fuse from 'fuse.js';
import { motion, AnimatePresence } from 'framer-motion';
import { useToast } from '../../context/ToastContext';
import authService from '../../services/authService';
import { useCart } from '../../context/CartContext';
import { useTranslation } from 'react-i18next';

// --- Reusable Icons ---
const SearchIcon = () => (
  <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
  </svg>
);
const AddIcon = () => (
  <svg className="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
  </svg>
);
const EditIcon = () => (
  <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.536L16.732 3.732z" />
  </svg>
);
const DeleteIcon = () => (
  <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
  </svg>
);
const PlaceholderIcon = () => (
  <svg className="w-16 h-16 text-gray-300 dark:text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1} d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
  </svg>
);
const SortIcon = () => (
  <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 4h13M3 8h9M3 12h9m-9 4h13m-3-4v8m0 0l-4-4m4 4l4-4" />
  </svg>
);
const AlertIcon = () => (
  <svg className="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
  </svg>
);
// --- End Icons ---

const API_BASE = import.meta.env.VITE_API_BASE || 'http://localhost:8080';

// --- Product Card Component ---
const ProductCard = ({ product, onEdit, onDelete, canManage }) => {
  const { t } = useTranslation();
  const [imgError, setImgError] = useState(false);
  const { addToCart, cartItems } = useCart();
  const { showToast } = useToast();
  const [quantity, setQuantity] = useState(1);
  const imageUrl = product.imageUrl ? `${API_BASE}${product.imageUrl}` : null;

  const itemInCart = cartItems.find(item => item.productId === product.productId);
  const remainingStock = product.quantity - (itemInCart?.quantity || 0);
  const isLowStock = product.quantity < product.reorderLevel;

  const handleAddToCart = () => {
    const qtyToAdd = Number(quantity);
    if (qtyToAdd > remainingStock) {
      showToast(t('productCard.errorStock', { count: remainingStock }), 'error');
      return;
    }
    if (qtyToAdd > 0) {
      addToCart(product, qtyToAdd);
      showToast(t('productCard.successAdd', { count: qtyToAdd, name: product.name }), 'success');
      setQuantity(1);
    }
  };

  return (
    <motion.div
      layout
      initial={{ opacity: 0, scale: 0.9 }}
      animate={{ opacity: 1, scale: 1 }}
      exit={{ opacity: 0, scale: 0.9 }}
      transition={{ duration: 0.3, ease: 'easeOut' }}
      className="card relative flex flex-col group overflow-hidden"
    >
      {/* Badges */}
      {isLowStock && (
        <div className="absolute top-4 right-4 z-10 bg-red-600/90 text-white text-xs font-bold px-3 py-1 rounded-full shadow-lg">
          {t('productCard.lowStock')}
        </div>
      )}
      {remainingStock <= 0 && product.quantity > 0 && (
        <div className="absolute top-12 right-4 z-10 bg-yellow-600/90 text-white text-xs font-bold px-3 py-1 rounded-full shadow-lg">
          {t('productCard.inCart')}
        </div>
      )}

      {/* Management Buttons */}
      {canManage && (
        <div className="absolute top-4 left-4 z-10 flex gap-2">
          <button
            onClick={onEdit}
            className="p-2 bg-gray-900/50 text-white rounded-full
                       opacity-0 group-hover:opacity-100 transition-all duration-300
                       hover:bg-blue-600 hover:scale-110"
            title={t('productCard.edit')}
          >
            <EditIcon />
          </button>
          <button
            onClick={onDelete}
            className="p-2 bg-gray-900/50 text-white rounded-full
                       opacity-0 group-hover:opacity-100 transition-all duration-300
                       hover:bg-red-600 hover:scale-110"
            title={t('productCard.delete')}
          >
            <DeleteIcon />
          </button>
        </div>
      )}

      {/* Image */}
      <div className="aspect-w-1 aspect-h-1 w-full bg-gray-100 dark:bg-gray-800 rounded-t-2xl overflow-hidden">
        {imageUrl && !imgError ? (
          <img
            src={imageUrl}
            alt={product.name}
            className="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
            onError={() => setImgError(true)}
          />
        ) : (
          <div className="w-full h-full flex items-center justify-center bg-gray-100 dark:bg-gray-800">
            <PlaceholderIcon />
          </div>
        )}
      </div>

      {/* Details */}
      <div className="p-5 flex-grow flex flex-col">
        <h3 className="text-lg font-bold text-gray-900 dark:text-white truncate" title={product.name}>
          {product.name || t('productCard.unnamed')}
        </h3>
        <p className="text-sm text-gray-500 dark:text-gray-400 font-medium mb-3">
          {product.category || t('productCard.uncategorized')}
        </p>

        <div className="mt-auto flex justify-between items-end">
          <div className="text-left">
            <p className="text-xs text-gray-500 font-medium">{t('productCard.price')}</p>
            <p className="text-xl font-bold text-cyan-600 dark:text-cyan-400">
              {product.price?.toLocaleString('en-IN', { style: 'currency', currency: 'INR' }) || '₹0.00'}
            </p>
          </div>
          <div className="text-right">
            <p className="text-xs text-gray-500 font-medium">{t('productCard.inStock')}</p>
            <p className={`text-xl font-bold ${remainingStock <= 0 ? 'text-red-500' : isLowStock ? 'text-yellow-500 dark:text-yellow-400' : 'text-gray-900 dark:text-white'}`}>
              {remainingStock}
            </p>
          </div>
        </div>

        {/* Add to Cart Section */}
        <div className="mt-4 pt-4 border-t border-gray-200 dark:border-gray-700 flex gap-3">
          <input
            type="number"
            value={quantity}
            onChange={(e) => setQuantity(Math.max(1, parseInt(e.target.value) || 1))}
            min="1"
            max={remainingStock}
            className="form-input w-20 text-center !pl-2"
            disabled={remainingStock <= 0}
          />
          <button
            onClick={handleAddToCart}
            disabled={remainingStock <= 0}
            className="button-primary flex-grow disabled:bg-gray-400 dark:disabled:bg-gray-600"
          >
            {remainingStock <= 0 ? t('productCard.outOfStock') : t('productCard.addToCart')}
          </button>
        </div>
      </div>
    </motion.div>
  );
};

// --- Skeleton Card for Loading ---
const SkeletonCard = () => (
  <div className="card relative flex flex-col overflow-hidden animate-pulse">
    <div className="aspect-w-1 aspect-h-1 w-full bg-gray-200 dark:bg-gray-800 rounded-t-2xl"></div>
    <div className="p-5 flex-grow flex flex-col">
      <div className="h-6 bg-gray-300 dark:bg-gray-700 rounded w-3/4 mb-2"></div>
      <div className="h-4 bg-gray-300 dark:bg-gray-700 rounded w-1/2 mb-4"></div>
      <div className="mt-auto flex justify-between items-end">
        <div className="w-1/3">
          <div className="h-3 bg-gray-300 dark:bg-gray-700 rounded w-full mb-1.5"></div>
          <div className="h-5 bg-gray-300 dark:bg-gray-700 rounded w-full"></div>
        </div>
        <div className="w-1/4">
          <div className="h-3 bg-gray-300 dark:bg-gray-700 rounded w-full mb-1.5"></div>
          <div className="h-5 bg-gray-300 dark:bg-gray-700 rounded w-full"></div>
        </div>
      </div>
      <div className="mt-4 pt-4 border-t border-gray-200 dark:border-gray-700 flex gap-3">
        <div className="h-10 bg-gray-300 dark:bg-gray-700 rounded w-20"></div>
        <div className="h-10 bg-gray-300 dark:bg-gray-700 rounded flex-grow"></div>
      </div>
    </div>
  </div>
);

// --- Main Product List Component ---
export default function ProductList() {
  const [products, setProducts] = useState([]);
  const [searchTerm, setSearchTerm] = useState('');
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);
  const [showLowStockOnly, setShowLowStockOnly] = useState(false);
  const [sortBy, setSortBy] = useState('default');
  const [isFormModalOpen, setIsFormModalOpen] = useState(false);
  const [isBulkModalOpen, setIsBulkModalOpen] = useState(false);
  const [productToEdit, setProductToEdit] = useState(null);

  const { t } = useTranslation();
  const { showToast } = useToast();
  const user = authService.getUserFromToken();
  const canManage = user?.role === 'OWNER' || user?.role === 'MANAGER';

  const fuse = useMemo(() => new Fuse(products, {
    keys: ['name', 'category', 'productId'],
    threshold: 0.4,
  }), [products]);

  const displayProducts = useMemo(() => {
    const searchedItems = searchTerm
      ? fuse.search(searchTerm).map(result => result.item)
      : [...products];
    const filteredItems = showLowStockOnly
      ? searchedItems.filter(p => p.quantity < p.reorderLevel)
      : searchedItems;
    const sortedItems = [...filteredItems];
    switch (sortBy) {
      case 'name-asc':
        sortedItems.sort((a, b) => (a.name || '').localeCompare(b.name || ''));
        break;
      case 'name-desc':
        sortedItems.sort((a, b) => (b.name || '').localeCompare(a.name || ''));
        break;
      case 'price-asc':
        sortedItems.sort((a, b) => (a.price || 0) - (b.price || 0));
        break;
      case 'price-desc':
        sortedItems.sort((a, b) => (b.price || 0) - (a.price || 0));
        break;
      case 'qty-asc':
        sortedItems.sort((a, b) => (a.quantity || 0) - (b.quantity || 0));
        break;
      case 'qty-desc':
        sortedItems.sort((a, b) => (b.quantity || 0) - (a.quantity || 0));
        break;
      default:
        break;
    }
    return sortedItems;
  }, [products, searchTerm, showLowStockOnly, sortBy, fuse]);

  useEffect(() => {
    loadProducts();
  }, []);

  async function loadProducts() {
    try {
      setLoading(true);
      setError(null);
      const data = await listProducts();
      if (Array.isArray(data)) {
        setProducts(data);
      } else {
        console.error("Invalid products response:", data);
        setProducts([]);
        setError(t('products.errorLoad'));
      }
    } catch (err) {
      console.error("Failed to load products:", err);
      setError(t('products.error'));
    } finally {
      setLoading(false);
    }
  }

  const handleOpenAddModal = () => {
    setProductToEdit(null);
    setIsFormModalOpen(true);
  };
  const handleOpenEditModal = (product) => {
    setProductToEdit(product);
    setIsFormModalOpen(true);
  };
  const handleCloseFormModal = (shouldRefresh = false) => {
    setIsFormModalOpen(false);
    setProductToEdit(null);
    if (shouldRefresh) loadProducts();
  };
  const handleCloseBulkModal = (result) => {
    setIsBulkModalOpen(false);
    if (result && result.successful > 0) loadProducts();
  };

  const handleDeleteProduct = async (product) => {
    if (!product.productId) {
      showToast(t('productCard.errorDeleteMissingId'), 'error');
      return;
    }
    if (!window.confirm(t('productCard.confirmDelete', { name: product.name }))) {
      return;
    }
    try {
      await deleteProduct(product.productId);
      showToast(t('products.deleteSuccess'), 'success');
      loadProducts();
    } catch (err) {
      const errMsg = err.response?.data?.error || err.message;
      showToast(t('products.deleteError', { error: errMsg }), 'error');
    }
  };

  return (
    <div>
      <div className="flex justify-between items-center mb-4">
        <h2 className="text-3xl font-bold text-gray-900 dark:text-white font-display">
          {t('products.title')}
          <span className="text-lg font-normal text-gray-500 dark:text-gray-400 ml-3">
            ({displayProducts.length} {t('products.items')})
          </span>
        </h2>
      </div>

      <div className="card mb-6 p-4 flex flex-col md:flex-row gap-4 items-center">
        <div className="relative flex-grow w-full md:w-auto">
          <div className="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
            <SearchIcon />
          </div>
          <input
            type="text"
            value={searchTerm}
            onChange={(e) => setSearchTerm(e.target.value)}
            placeholder={t('products.searchPlaceholder')}
            className="form-input w-full"
          />
        </div>

        <div className="relative flex-shrink-0 w-full md:w-48">
          <div className="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
            <SortIcon />
          </div>
          <select
            value={sortBy}
            onChange={(e) => setSortBy(e.target.value)}
            className="form-input appearance-none w-full"
          >
            <option value="default">{t('products.sortDefault')}</option>
            <option value="name-asc">{t('products.sortNameAsc')}</option>
            <option value="name-desc">{t('products.sortNameDesc')}</option>
            <option value="price-asc">{t('products.sortPriceAsc')}</option>
            <option value="price-desc">{t('products.sortPriceDesc')}</option>
            <option value="qty-asc">{t('products.sortQtyAsc')}</option>
            <option value="qty-desc">{t('products.sortQtyDesc')}</option>
          </select>
        </div>

        <button
          onClick={() => setShowLowStockOnly(prev => !prev)}
          className={`button-secondary flex-shrink-0 w-full md:w-auto flex items-center justify-center
                      ${showLowStockOnly
                        ? 'bg-yellow-400 text-yellow-900 hover:bg-yellow-500 dark:bg-yellow-600 dark:text-white dark:hover:bg-yellow-700'
                        : 'button-secondary'}`}
        >
          <AlertIcon />
          {showLowStockOnly ? t('products.showingLowStock') : t('products.showLowStock')}
        </button>

        {canManage && (
          <>
            <button onClick={() => setIsBulkModalOpen(true)} className="button-secondary flex-shrink-0 w-full md:w-auto">
              {t('products.bulkUpload')}
            </button>
            <button onClick={handleOpenAddModal} className="button-primary flex-shrink-0 w-full md:w-auto">
              <AddIcon />
              {t('products.addProduct')}
            </button>
          </>
        )}
      </div>

      {loading ? (
        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
          {[...Array(8)].map((_, i) => <SkeletonCard key={i} />)}
        </div>
      ) : error ? (
        <div className="card text-center p-10">
          <p className="text-red-500 dark:text-red-400 font-semibold">{error}</p>
          <button onClick={loadProducts} className="button-primary mt-4">
            {t('products.tryAgain')}
          </button>
        </div>
      ) : displayProducts.length === 0 ? (
        <div className="card text-center p-10">
          <p className="text-gray-600 dark:text-gray-400 font-semibold">
            {searchTerm ? t('products.noMatch') : (showLowStockOnly ? t('products.noLowStock') : t('products.noProducts'))}
          </p>
          <button onClick={() => { setSearchTerm(''); setShowLowStockOnly(false); }} className="button-secondary mt-4">
            {t('products.clearFilters')}
          </button>
        </div>
      ) : (
        <motion.div
          layout
          className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"
        >
          <AnimatePresence>
            {displayProducts.map((p) => {
              const key = p.productId;
              if (!key) {
                 console.warn("Found product without a productId:", p);
                 return null;
              }
              return (
                <ProductCard
                  key={key}
                  product={p}
                  onEdit={() => handleOpenEditModal(p)}
                  onDelete={() => handleDeleteProduct(p)}
                  canManage={canManage}
                />
              );
            })}
          </AnimatePresence>
        </motion.div>
      )}

      {/* --- Modals --- */}
      <ProductForm
        isOpen={isFormModalOpen}
        onClose={handleCloseFormModal}
        productToEdit={productToEdit}
      />
      <BulkUploadModal
        isOpen={isBulkModalOpen}
        onClose={handleCloseBulkModal}
      />
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\components\profile
--------------------------------------------------------------------
Contents:
ProfilePage.jsx

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\profile\ProfilePage.jsx
--------------------------------------------------------------------
import React from "react";
import authService from "../../services/authService";
import { useTranslation } from 'react-i18next'; // <-- NEW IMPORT

export default function ProfilePage() {
  const { t } = useTranslation(); // <-- NEW
  const user = authService.getUserFromToken();

  if (!user) {
    return (
      <div className="card max-w-md mx-auto p-6 text-center">
        {/* MODIFIED */}
        <p className="text-red-400">{t('profile.notLoggedIn')}</p>
      </div>
    );
  }

  return (
    <div className="card max-w-md mx-auto p-8">
      <h2 className="text-3xl font-bold text-white font-display mb-6 text-center">
        {/* MODIFIED */}
        {t('profile.title')}
      </h2>

      <div className="space-y-4">
        <div className="p-4 bg-gray-800/50 rounded-lg">
          {/* MODIFIED */}
          <label className="block text-sm font-medium text-gray-400">{t('profile.email')}</label>
          <p className="text-lg text-white">{user.email}</p>
        </div>
        <div className="p-4 bg-gray-800/50 rounded-lg">
          {/* MODIFIED */}
          <label className="block text-sm font-medium text-gray-400">{t('profile.role')}</label>
          <p className="text-lg text-cyan-400 font-bold">{user.role || "N/A"}</p>
        </div>
      </div>

      <p className="mt-6 text-gray-500 text-xs text-center">
        {/* MODIFIED */}
        {t('profile.tokenIssued')}: {new Date(user.iat * 1000).toLocaleString()}
        <br />
        {t('profile.tokenExpires')}: {new Date(user.exp * 1000).toLocaleString()}
      </p>
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\components\reports
--------------------------------------------------------------------
Contents:
summary
text

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\components\reports\summary
--------------------------------------------------------------------
Contents:
ReportGenerator.jsx
ReportPreview.jsx

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\reports\summary\ReportGenerator.jsx
--------------------------------------------------------------------
import React, { useState } from "react";
import { getFullReportData, downloadFullReportPdf } from "../../../services/reportService";
import DatePicker from "react-datepicker";
import "react-datepicker/dist/react-datepicker.css";
import { motion, AnimatePresence } from 'framer-motion';
import { useTranslation } from 'react-i18next';

import ReportPreview from './ReportPreview';
import { CalendarIcon } from '../../analytics/icons';

// Icons
const DownloadIcon = () => (
  <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
  </svg>
);
const ClearIcon = () => (
  <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
  </svg>
);
const ReportIcon = () => (
  <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 17v-6h6v6m-6-4h.01M12 3v4m0 0h8m-8 0H4" />
  </svg>
);
const LoadingSpinner = () => (
  <div className="w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin" />
);

// UPDATED: Removed hard-coded dark classes
const CustomDateInput = React.forwardRef(({ value, onClick, placeholder }, ref) => (
  <button
    type="button"
    ref={ref}
    onClick={onClick}
    className="form-input w-full !pl-10 !py-3 rounded-xl cursor-pointer text-left"
  >
    <span className={value ? 'text-gray-800 dark:text-white' : 'text-gray-500'}>
      {value || placeholder}
    </span>
  </button>
));

export default function ReportGenerator() {
  const { t } = useTranslation();
  const [reportData, setReportData] = useState(null);
  const [loading, setLoading] = useState(false);
  const [isDownloading, setIsDownloading] = useState(false);
  const [error, setError] = useState(null);
  const [startDate, setStartDate] = useState(new Date(new Date().setDate(new Date().getDate() - 30)));
  const [endDate, setEndDate] = useState(new Date());

  // Format helpers
  const formatAPI = (d) => d?.toISOString().split('T')[0] || '';
  const formatDateHuman = (d) => {
    if (!d) return t('reports.selectRange');
    return d.toLocaleDateString('en-CA', { year: 'numeric', month: 'short', day: 'numeric' });
  };

  const handleGenerateReport = async () => {
    if (!startDate || !endDate) {
      setError(t('reports.errorDate'));
      return;
    }
    if (startDate > endDate) {
      setError(t('reports.errorStartDate'));
      return;
    }
    setLoading(true);
    setError(null);
    setReportData(null);
    try {
      const params = {
        startDate: formatAPI(startDate),
        endDate: formatAPI(endDate),
      };
      const res = await getFullReportData(params);
      setReportData(res);
    } catch (err) {
      console.error("Error fetching report:", err);
      setError(err.message || "Failed to load report. Please try again.");
    } finally {
      setLoading(false);
    }
  };

  const handleDownloadPdf = async () => {
    if (!reportData) return;
    setIsDownloading(true);
    setError(null);
    try {
      const params = {
        startDate: formatAPI(startDate),
        endDate: formatAPI(endDate),
      };
      const blob = await downloadFullReportPdf(params);
      const url = window.URL.createObjectURL(new Blob([blob], { type: 'application/pdf' }));
      const link = document.createElement('a');
      link.href = url;
      const filename = `SmartRetail_Report_${params.startDate}_to_${params.endDate}.pdf`;
      link.setAttribute('download', filename);
      document.body.appendChild(link);
      link.click();
      link.parentNode.removeChild(link);
      window.URL.revokeObjectURL(url);
    } catch (err) {
      console.error("Error downloading PDF:", err);
      setError(err.message || "Failed to download PDF. Please try again.");
    } finally {
      setIsDownloading(false);
    }
  };

  const handleClearReport = () => {
    setReportData(null);
    setError(null);
  };

  const humanDateRange = {
    start: formatDateHuman(startDate),
    end: formatDateHuman(endDate)
  };

  return (
    // UPDATED: Removed hard-coded background
    <div className="min-h-[calc(100vh-100px)]">
      <div className="max-w-7xl mx-auto"> {/* Removed padding, letting MainLayout handle it */}
        {/* Header */}
        <motion.div
          initial={{ opacity: 0, y: -20 }}
          animate={{ opacity: 1, y: 0 }}
          className="text-center mb-12"
        >
          <h1 className="text-4xl font-bold text-gray-900 dark:text-white mb-4 bg-gradient-to-r from-cyan-500 to-blue-500 bg-clip-text text-transparent">
            {t('reports.title')}
          </h1>
          <p className="text-gray-600 dark:text-gray-400 text-lg max-w-2xl mx-auto">
            {t('reports.subtitle')}
          </p>
        </motion.div>

        {/* Controls */}
        <motion.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 0.1 }}
          className="card p-6 mb-8" // UPDATED: Just "card"
        >
          <div className="flex flex-col lg:flex-row gap-6 items-start lg:items-center">
            {/* Date Picker */}
            <div className="flex-1 w-full">
              <label className="block text-sm font-medium text-gray-600 dark:text-gray-300 mb-3">{t('reports.dateRange')}</label>
              <div className="relative">
                <div className="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none z-10">
                  <CalendarIcon />
                </div>
                <DatePicker
                  selectsRange
                  startDate={startDate}
                  endDate={endDate}
                  onChange={([start, end]) => {
                    setStartDate(start);
                    setEndDate(end);
                    setError(null);
                  }}
                  customInput={<CustomDateInput placeholder={t('reports.selectRange')} />}
                  popperClassName="react-datepicker-dark z-50" // This class is in index.css
                  popperPlacement="bottom-start"
                  dateFormat="MMM d, yyyy"
                  showPopperArrow={false}
                  wrapperClassName="w-full"
                  disabled={loading || !!reportData}
                />
              </div>
              {startDate && endDate && (
                <p className="text-xs text-cyan-600 dark:text-cyan-400 mt-2">
                  {humanDateRange.start} to {humanDateRange.end}
                </p>
              )}
            </div>

            {/* Buttons */}
            <div className="flex flex-col sm:flex-row gap-4 w-full lg:w-auto">
              <AnimatePresence mode="wait">
                {!reportData ? (
                  <motion.button
                    key="generate"
                    initial={{ opacity: 0, scale: 0.9 }}
                    animate={{ opacity: 1, scale: 1 }}
                    exit={{ opacity: 0, scale: 0.9 }}
                    onClick={handleGenerateReport}
                    disabled={loading}
                    className="button-primary w-full sm:w-48 h-12 flex items-center justify-center gap-3 font-semibold"
                  >
                    {loading ? <LoadingSpinner /> : <ReportIcon />}
                    {loading ? t('reports.generating') : t('reports.generate')}
                  </motion.button>
                ) : (
                  <motion.div
                    key="actions"
                    initial={{ opacity: 0, scale: 0.9 }}
                    animate={{ opacity: 1, scale: 1 }}
                    exit={{ opacity: 0, scale: 0.9 }}
                    className="flex flex-col sm:flex-row gap-4 w-full sm:w-auto"
                  >
                    <button
                      onClick={handleDownloadPdf}
                      disabled={isDownloading}
                      className="button-primary h-12 px-6 flex items-center justify-center gap-3 font-semibold bg-gradient-to-r from-emerald-500 to-green-600 hover:from-emerald-600 hover:to-green-700"
                    >
                      {isDownloading ? <LoadingSpinner /> : <DownloadIcon />}
                      {isDownloading ? t('reports.downloading') : t('reports.download')}
                    </button>
                    <button
                      onClick={handleClearReport}
                      disabled={isDownloading}
                      className="button-secondary h-12 px-6 flex items-center justify-center gap-3 font-semibold"
                    >
                      <ClearIcon />
                      {t('reports.newReport')}
                    </button>
                  </motion.div>
                )}
              </AnimatePresence>
            </div>
          </div>

          {/* Error */}
          {error && (
            <motion.div
              initial={{ opacity: 0, height: 0 }}
              animate={{ opacity: 1, height: 'auto' }}
              className="mt-4 p-4 bg-red-100 dark:bg-red-500/10 border border-red-300 dark:border-red-500/20 rounded-lg"
            >
              <div className="flex items-center gap-3 text-red-600 dark:text-red-400">
                <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <span className="font-medium">{error}</span>
              </div>
            </motion.div>
          )}
        </motion.div>

        {/* Content Area */}
        <AnimatePresence mode="wait">
          {loading && (
            <motion.div
              key="loading"
              initial={{ opacity: 0, scale: 0.95 }}
              animate={{ opacity: 1, scale: 1 }}
              exit={{ opacity: 0, scale: 0.95 }}
              className="card p-12 text-center"
            >
              <div className="flex flex-col items-center space-y-4">
                <div className="w-16 h-16 border-4 border-cyan-500/30 border-t-cyan-400 rounded-full animate-spin" />
                <div>
                  <h3 className="text-xl font-semibold text-gray-900 dark:text-white mb-2">{t('reports.loading')}</h3>
                  <p className="text-gray-600 dark:text-gray-400">{t('reports.loadingSub')}</p>
                </div>
              </div>
            </motion.div>
          )}

          {reportData && (
            <motion.div
              key="report"
              initial={{ opacity: 0, y: 20 }}
              animate={{ opacity: 1, y: 0 }}
              exit={{ opacity: 0, y: -20 }}
            >
              {/* This component is INTENTIONALLY light-themed for PDF look */}
              <ReportPreview
                reportData={reportData}
                startDate={humanDateRange.start}
                endDate={humanDateRange.end}
              />
            </motion.div>
          )}

          {!loading && !reportData && !error && (
            <motion.div
              key="placeholder"
              initial={{ opacity: 0, y: 20 }}
              animate={{ opacity: 1, y: 0 }}
              className="text-center py-20"
            >
              <div className="max-w-md mx-auto">
                <div className="w-24 h-24 mx-auto mb-6 bg-gray-200 dark:bg-gradient-to-br dark:from-cyan-500/10 dark:to-blue-500/10 rounded-2xl flex items-center justify-center">
                  {/* UPDATED: Icon color */}
                  <ReportIcon className="w-10 h-10 text-gray-500 dark:text-cyan-400" />
                </div>
                <h3 className="text-2xl font-bold text-gray-900 dark:text-white mb-3">{t('reports.placeholderTitle')}</h3>
                <p className="text-gray-600 dark:text-gray-400 text-lg mb-8">
                  {t('reports.placeholderSub')}
                </p>
                <div className="grid grid-cols-1 md:grid-cols-3 gap-6 text-sm text-gray-500 dark:text-gray-500">
                  <div className="text-center">
                    <div className="w-8 h-8 bg-gray-200 dark:bg-cyan-500/10 rounded-lg flex items-center justify-center mx-auto mb-2">
                      <span className="text-cyan-500 dark:text-cyan-400 font-medium">Chart</span>
                    </div>
                    <p>{t('reports.placeholder1')}</p>
                  </div>
                  <div className="text-center">
                    <div className="w-8 h-8 bg-gray-200 dark:bg-blue-500/10 rounded-lg flex items-center justify-center mx-auto mb-2">
                      <span className="text-blue-500 dark:text-blue-400 font-medium">AI</span>
                    </div>
                    <p>{t('reports.placeholder2')}</p>
                  </div>
                  <div className="text-center">
                    <div className="w-8 h-8 bg-gray-200 dark:bg-emerald-500/10 rounded-lg flex items-center justify-center mx-auto mb-2">
                      <span className="text-emerald-500 dark:text-emerald-400 font-medium">PDF</span>
                    </div>
                    <p>{t('reports.placeholder3')}</p>
                  </div>
                </div>
              </div>
            </motion.div>
          )}
        </AnimatePresence>
      </div>
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\reports\summary\ReportPreview.jsx
--------------------------------------------------------------------
import React from 'react';
import { motion } from 'framer-motion';
import { useTranslation } from 'react-i18next'; // <-- Import

// --- Formatting Helpers ---
const formatCurrency = (amount) => {
  if (amount === null || amount === undefined) return 'N/A';
  return (amount).toLocaleString('en-IN', {
    style: 'currency',
    currency: 'INR',
    maximumFractionDigits: 0,
  });
};

const formatNumber = (num) => {
  if (num === null || num === undefined) return 'N/A';
  return (num).toLocaleString('en-IN');
};

// --- Sub-Components for the Report ---
const MetricBox = ({ title, value, className = 'text-blue-600' }) => (
  <div className="bg-gray-50 p-4 rounded-lg shadow-inner">
    <p className="text-sm font-semibold text-gray-500 uppercase tracking-wider">{title}</p>
    <p className={`text-3xl font-bold ${className}`}>{value}</p>
  </div>
);

const ReportTable = ({ headers, data, title }) => (
  <section className="space-y-3">
    <h3 className="text-xl font-bold text-gray-800 border-b border-gray-300 pb-2">{title}</h3>
    <div className="overflow-x-auto border border-gray-200 rounded-lg">
      <table className="min-w-full divide-y divide-gray-200">
        <thead className="bg-gray-100">
          <tr>
            {headers.map(header => (
              <th key={header} className="px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase tracking-wider">
                {header}
              </th>
            ))}
          </tr>
        </thead>
        <tbody className="bg-white divide-y divide-gray-200">
          {data.length === 0 ? (
            <tr>
              <td colSpan={headers.length} className="px-6 py-4 text-center text-gray-500">
                No data available for this section.
              </td>
            </tr>
          ) : (
            data.map((row, rowIndex) => (
              <tr key={rowIndex} className="hover:bg-gray-50">
                {headers.map((header, colIndex) => (
                  <td key={colIndex} className="px-6 py-4 whitespace-nowrap text-sm text-gray-700">
                    {row[header]}
                  </td>
                ))}
              </tr>
            ))
          )}
        </tbody>
      </table>
    </div>
  </section>
);

// --- Main Report Preview Component ---
export default function ReportPreview({ reportData, startDate, endDate }) {
  const { t } = useTranslation(); // <-- Get hook
  if (!reportData) return null;

  const { salesReport, textSummary, inventoryReport } = reportData;
  const { summary } = salesReport || {};

  // Format data for tables
  const topProductsData = (salesReport?.top_products || []).map(p => ({
    "Product Name": p.name,
    "Category": p.category || 'N/A',
    "Units Sold": formatNumber(p.qty),
    "Total Revenue": formatCurrency(p.revenue),
  }));

  // No change to lowStockData, it's not rendered

  return (
    <motion.div
      initial={{ opacity: 0, y: 20 }}
      animate={{ opacity: 1, y: 0 }}
      exit={{ opacity: 0 }}
      transition={{ duration: 0.5 }}
      // This component STAYS light-themed
      className="bg-white text-gray-900 max-w-4xl mx-auto rounded-lg shadow-2xl p-10 md:p-16"
      id="report-preview-content"
    >
      <div className="space-y-12">
        {/* 1. Header */}
        <header className="text-center border-b border-gray-200 pb-6">
          <h1 className="text-4xl font-extrabold text-gray-900">{t('reports.title')}</h1>
          <p className="text-lg text-gray-600 mt-2">
            {startDate} to {endDate}
          </p>
        </header>

        {/* 2. AI Summary */}
        {textSummary?.report && (
          <section>
            <h2 className="text-2xl font-bold text-gray-800 mb-3">{t('reports.placeholder2')}</h2>
            <blockquote className="text-gray-700 text-lg leading-relaxed italic border-l-4 border-blue-500 pl-4">
              {textSummary.report}
            </blockquote>
          </section>
        )}

        {/* 3. Key Metrics */}
        <section>
          <h2 className="text-2xl font-bold text-gray-800 mb-4">Key Metrics</h2>
          <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
            <MetricBox
              title={t('dashboard.totalRevenue')}
              value={formatCurrency(summary?.total_revenue)}
              className="text-emerald-600"
            />
            <MetricBox
              title={t('dashboard.totalOrders')}
              value={formatNumber(summary?.total_orders)}
              className="text-blue-600"
            />
            <MetricBox
              title={t('dashboard.productsSold')}
              value={formatNumber(summary?.total_products_sold)}
              className="text-purple-600"
            />
          </div>
        </section>

        {/* 4. Inventory Alerts */}
        <section>
          <h2 className="text-2xl font-bold text-gray-800 mb-4">Inventory Alerts</h2>
          <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
            <MetricBox
              title={t('customerList.showingLowStock')}
              value={formatNumber(inventoryReport?.lowStockCount)}
              className="text-yellow-600"
            />
            <MetricBox
              title="Expiring Soon Items"
              value={formatNumber(inventoryReport?.expiringCount)}
              className="text-orange-600"
            />
          </div>
        </section>

        {/* 5. Top Products Table */}
        <ReportTable
          title={t('dashboard.topProducts')}
          headers={["Product Name", "Category", "Units Sold", "Total Revenue"]}
          data={topProductsData}
        />

        {/* 6. Low Stock Details Table (Removed as per your file) */}
      </div>
    </motion.div>
  );
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\components\reports\text
--------------------------------------------------------------------
Contents:
SalesReportText.jsx

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\reports\text\SalesReportText.jsx
--------------------------------------------------------------------
import React, { useEffect, useState } from "react";
import api from "../../../api/apiClient";
import { useTranslation } from 'react-i18next'; // <-- Import

export default function SalesReportText() {
  const { t } = useTranslation(); // <-- Get hook
  const [textReport, setTextReport] = useState("");
  const [error, setError] = useState(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    async function fetchTextReport() {
      try {
        setLoading(true);
        const res = await api.get("/api/analytics/report/text");

        const reportData =
          typeof res.data === "object" && res.data.report
            ? res.data.report
            : res.data;

        setTextReport(reportData || "No report data available");
      } catch (err) {
        console.error("Error fetching text report:", err);
        setError("Failed to load text report. Is the analytics service running?");
      } finally {
        setLoading(false);
      }
    }
    fetchTextReport();
  }, []);

  if (loading) {
    return (
      <div className="card p-6 text-center text-gray-500 dark:text-gray-400">
        Loading text report...
      </div>
    );
  }

  if (error) {
    return <div className="card p-6 text-red-500 dark:text-red-400">{error}</div>;
  }

  return (
    // UPDATED: Theme-aware classes
    <div className="card">
      <h3 className="card-title p-6 pb-0">{t('reports.placeholder2')}</h3>
      <div className="p-6">
        <pre className="bg-gray-100 dark:bg-gray-900 p-4 rounded-lg text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap overflow-auto">
          {textReport}
        </pre>
      </div>
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\context
--------------------------------------------------------------------
Contents:
CartContext.jsx
ThemeContext.jsx
ToastContext.jsx

====================================================================
📄 File: G:\FINALCODE\frontend\src\context\CartContext.jsx
--------------------------------------------------------------------
import React, { createContext, useContext, useState, useEffect } from 'react';

const CartContext = createContext();

export const useCart = () => useContext(CartContext);

export const CartProvider = ({ children }) => {
  const [cartItems, setCartItems] = useState(() => {
    // Load cart from localStorage on initial render
    try {
      const localData = localStorage.getItem('sr_cart');
      return localData ? JSON.parse(localData) : [];
    } catch (error) {
      console.error("Failed to parse cart from localStorage", error);
      return [];
    }
  });

  // Save cart to localStorage whenever it changes
  useEffect(() => {
    localStorage.setItem('sr_cart', JSON.stringify(cartItems));
  }, [cartItems]);

  const addToCart = (product, quantity) => {
    setCartItems(prevItems => {
      const existingItem = prevItems.find(item => item.productId === product.productId);

      if (existingItem) {
        // Update quantity
        return prevItems.map(item =>
          item.productId === product.productId
            ? { ...item, quantity: item.quantity + quantity }
            : item
        );
      } else {
        // Add new item
        return [...prevItems, { ...product, quantity }];
      }
    });
  };

  const updateQuantity = (productId, newQuantity) => {
    const qty = Math.max(0, newQuantity); // Ensure quantity is not negative
    setCartItems(prevItems =>
      prevItems
        .map(item =>
          item.productId === productId ? { ...item, quantity: qty } : item
        )
        .filter(item => item.quantity > 0) // Remove item if quantity is 0
    );
  };

  const removeFromCart = (productId) => {
    setCartItems(prevItems => prevItems.filter(item => item.productId !== productId));
  };

  const clearCart = () => {
    setCartItems([]);
  };

  const cartCount = cartItems.reduce((count, item) => count + item.quantity, 0);
  const cartTotal = cartItems.reduce((total, item) => total + item.price * item.quantity, 0);

  const value = {
    cartItems,
    addToCart,
    updateQuantity,
    removeFromCart,
    clearCart,
    cartCount,
    cartTotal,
  };

  return <CartContext.Provider value={value}>{children}</CartContext.Provider>;
};
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\context\ThemeContext.jsx
--------------------------------------------------------------------
import React, { createContext, useContext, useState, useEffect } from 'react';

const ThemeContext = createContext();

export const useTheme = () => useContext(ThemeContext);

export const ThemeProvider = ({ children }) => {
  const [theme, setTheme] = useState(() => {
    // 1. Get from localStorage
    const savedTheme = localStorage.getItem('theme');
    // 2. Or use system preference
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    // 3. Default to 'dark' as your site is already dark
    return savedTheme || (prefersDark ? 'dark' : 'light');
  });

  useEffect(() => {
    const root = window.document.documentElement;

    // Apply class to <html> tag
    root.classList.remove(theme === 'dark' ? 'light' : 'dark');
    root.classList.add(theme);

    // Save choice to localStorage
    localStorage.setItem('theme', theme);
  }, [theme]);

  const toggleTheme = () => {
    setTheme(prevTheme => (prevTheme === 'light' ? 'dark' : 'light'));
  };

  const value = {
    theme,
    toggleTheme,
  };

  return <ThemeContext.Provider value={value}>{children}</ThemeContext.Provider>;
};
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\context\ToastContext.jsx
--------------------------------------------------------------------
import React, { createContext, useContext, useState, useCallback } from 'react';
import { AnimatePresence, motion } from 'framer-motion';

const ToastContext = createContext(null);

export const useToast = () => useContext(ToastContext);

// Icon components for toasts
const SuccessIcon = () => (
  <svg className="w-6 h-6 text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
  </svg>
);
const ErrorIcon = () => (
  <svg className="w-6 h-6 text-red-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" />
  </svg>
);

export const ToastProvider = ({ children }) => {
  const [toasts, setToasts] = useState([]);

  const addToast = useCallback((message, type = 'success') => {
    const id = Date.now();
    setToasts(prev => [...prev, { id, message, type }]);

    // Auto-dismiss after 3 seconds
    setTimeout(() => {
      setToasts(prev => prev.filter(t => t.id !== id));
    }, 3000);
  }, []);

  const value = {
    showToast: addToast,
  };

  return (
    <ToastContext.Provider value={value}>
      {children}

      {/* Toast Container */}
      <div className="fixed top-5 right-5 z-[9999] space-y-3">
        <AnimatePresence>
          {toasts.map(toast => (
            <motion.div
              key={toast.id}
              layout
              initial={{ opacity: 0, y: -20, scale: 0.9 }}
              animate={{ opacity: 1, y: 0, scale: 1 }}
              exit={{ opacity: 0, x: 50, scale: 0.9 }}
              transition={{ type: 'spring', stiffness: 300, damping: 25 }}
              className="max-w-sm w-full bg-gray-800/90 backdrop-blur-lg border border-gray-700 shadow-xl rounded-lg pointer-events-auto flex p-4"
            >
              <div className="flex-shrink-0">
                {toast.type === 'success' ? <SuccessIcon /> : <ErrorIcon />}
              </div>
              <div className="ml-3 flex-1">
                <p className="text-sm font-semibold text-white">{toast.message}</p>
              </div>
            </motion.div>
          ))}
        </AnimatePresence>
      </div>
    </ToastContext.Provider>
  );
};
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\i18n.js
--------------------------------------------------------------------
import i18n from 'i18next';
import { initReactI18next } from 'react-i18next';
import translationEN from './locales/en/translation.json';
import translationHI from './locales/hi/translation.json';
import translationMR from './locales/mr/translation.json';
import translationTE from './locales/te/translation.json';

// Get language from the same place our Navbar sets it
const savedLang = localStorage.getItem('sr_lang') || 'en';

const resources = {
  en: { translation: translationEN },
  hi: { translation: translationHI },
  mr: { translation: translationMR },
  te: { translation: translationTE },
};

i18n
  .use(initReactI18next)
  .init({
    resources,
    lng: savedLang, // Use the saved language
    fallbackLng: 'en',
    interpolation: {
      escapeValue: false, // React already safes from XSS
    },
  });

export default i18n;
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\index.css
--------------------------------------------------------------------
@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  /* --- 1. Light Mode Default --- */
  body {
    @apply font-sans text-gray-900 bg-gray-100; /* Light BG, Dark Text */
    min-height: 100vh;
  }

  /* --- 2. Dark Mode Styles --- */
  .dark body {
    @apply text-gray-200; /* Dark BG, Light Text */
    background-color: #000;
    background-image: radial-gradient(circle at 20% 20%, theme(colors.gray.950), theme(colors.black));
  }

  /* --- 3. Table Styles (Theme-Aware) --- */
  .table {
    @apply w-full min-w-[640px];
  }
  .table th {
    @apply p-4 text-left text-xs font-medium uppercase tracking-wider;
    @apply text-gray-500 bg-gray-50; /* Light */
    @apply dark:text-gray-400 dark:bg-gray-800/50; /* Dark */
  }
  .table td {
    @apply p-4 whitespace-nowrap text-sm;
    @apply text-gray-800 border-b border-gray-200; /* Light */
    @apply dark:text-gray-200 dark:border-gray-800; /* Dark */
  }
  .table tbody tr:last-child td {
    @apply border-b-0;
  }
  .table tbody tr {
    @apply transition-colors;
  }
  .table tbody tr:hover {
    @apply bg-gray-100/50; /* Light */
    @apply dark:bg-gray-800/60; /* Dark */
  }

  /* --- 4. NavLink Styles (Theme-Aware) --- */
  .nav-link {
    @apply px-3 py-2 rounded-md text-sm font-medium;
    @apply text-gray-600 hover:bg-gray-200 hover:text-gray-900; /* Light */
    @apply dark:text-gray-300 dark:hover:bg-gray-700 dark:hover:text-white; /* Dark */
    @apply transition-colors;
  }
  .nav-link.active {
    @apply bg-gray-200 text-gray-900; /* Light */
    @apply dark:bg-gray-900 dark:text-white; /* Dark */
  }
}

/* --- 5. Card Styles (Theme-Aware) --- */
.card {
  @apply bg-white border border-gray-200 rounded-2xl shadow-lg; /* Light */
  @apply dark:bg-gray-900/70 dark:backdrop-blur-xl dark:border-gray-800 dark:shadow-[0_4px_20px_rgba(0,0,0,0.3)]; /* Dark */
  @apply transition-all duration-300 ease-out;
}

.card:hover {
  transform: translateY(-4px);
  @apply shadow-xl; /* Light */
  @apply dark:shadow-[0_8px_25px_rgba(0,255,200,0.1)] dark:border-gray-700/80; /* Dark */
}

.card-title {
  @apply font-display text-xl font-semibold tracking-wide mb-4;
  @apply text-gray-900; /* Light */
  @apply dark:text-white; /* Dark */
}

/* --- 6. Button Styles (Remain the same, they are context-agnostic) --- */
.button-primary {
  @apply bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold
         hover:bg-blue-700 focus:outline-none focus:ring-2
         focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-100 dark:focus:ring-offset-gray-900
         transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed;
}
.button-secondary {
  @apply bg-gray-200 text-gray-800 px-3 py-2 rounded-lg font-medium
         hover:bg-gray-300 focus:outline-none focus:ring-2
         focus:ring-gray-500 focus:ring-offset-2 focus:ring-offset-gray-100
         dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600 dark:focus:ring-offset-gray-900
         transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed;
}

/* --- 7. Form Input Styles (Theme-Aware) --- */
/* RENAMED from .form-input-dark */
.form-input {
  @apply w-full p-3 pl-11 bg-gray-100 border border-gray-300 rounded-lg placeholder-gray-500; /* Light */
  @apply dark:bg-gray-800 dark:border-gray-700 dark:text-gray-200 dark:placeholder-gray-500; /* Dark */
  @apply focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent;
  @apply transition-all duration-300;
  @apply disabled:bg-gray-200 disabled:text-gray-500 disabled:cursor-not-allowed; /* Light Disabled */
  @apply dark:disabled:bg-gray-900 dark:disabled:text-gray-500; /* Dark Disabled */
}

/* Input without icon */
.form-input-no-icon {
  @apply w-full p-3 bg-gray-100 border border-gray-300 rounded-lg placeholder-gray-500; /* Light */
  @apply dark:bg-gray-800 dark:border-gray-700 dark:text-gray-200 dark:placeholder-gray-500; /* Dark */
  @apply focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent;
  @apply transition-all duration-300;
}

/* Auth page social button */
.social-button {
  @apply w-full flex items-center justify-center gap-3 px-4 py-2.5 border rounded-lg;
  @apply text-gray-700 bg-white hover:bg-gray-50 border-gray-300; /* Light */
  @apply dark:text-gray-300 dark:bg-gray-800 dark:hover:bg-gray-700 dark:border-gray-700; /* Dark */
  @apply transition-all duration-300;
  @apply focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-100 dark:focus:ring-offset-gray-900;
}

/* --- 8. Misc Styles (Theme-Aware) --- */
.progress-bar-container {
  @apply w-full rounded-full h-2 overflow-hidden;
  @apply bg-gray-200; /* Light */
  @apply dark:bg-gray-700/50; /* Dark */
}
.progress-bar {
  @apply h-2 rounded-full bg-gradient-to-r from-blue-500 via-cyan-400 to-green-400;
}

.custom-scrollbar::-webkit-scrollbar { @apply w-1.5; }
.custom-scrollbar::-webkit-scrollbar-track { @apply bg-transparent; }
.custom-scrollbar::-webkit-scrollbar-thumb { @apply bg-gray-400 dark:bg-gray-600 rounded-full; }
.custom-scrollbar::-webkit-scrollbar-thumb:hover { @apply bg-gray-500 dark:bg-gray-500; }

.shadow-glow {
  @apply dark:shadow-[0_0_15px_rgba(34,197,94,0.4)];
}

/* Dropdown text color */
select option {
  @apply bg-white text-black; /* Light */
  @apply dark:bg-gray-900 dark:text-white; /* Dark */
}

/* --- 9. Datepicker (Theme-Aware) --- */
.react-datepicker-wrapper { @apply w-full; }
.react-datepicker-popper { @apply z-50; }

/* Main calendar container */
.react-datepicker {
  @apply font-sans text-sm shadow-lg;
  @apply bg-white border-gray-200 border rounded-lg; /* Light */
  @apply dark:bg-gray-900 dark:border-gray-700 dark:shadow-[0_20px_40px_rgba(0,0,0,0.4)]; /* Dark */
}
.react-datepicker__triangle { @apply hidden; }

/* Header */
.react-datepicker__header {
  @apply border-b-0 rounded-t-lg pt-3;
  @apply bg-gray-50; /* Light */
  @apply dark:bg-gray-800/50 dark:border-gray-700; /* Dark */
}
.react-datepicker__current-month,
.react-datepicker__day-name {
  @apply font-semibold;
  @apply text-gray-900; /* Light */
  @apply dark:text-gray-200; /* Dark */
}
.react-datepicker__day-name {
  @apply text-gray-500; /* Light */
  @apply dark:text-gray-400; /* Dark */
}

/* Day cells */
.react-datepicker__day {
  @apply rounded-full;
  @apply text-gray-800; /* Light */
  @apply dark:text-gray-300; /* Dark */
}
.react-datepicker__day:hover {
  @apply rounded-full;
  @apply bg-gray-200; /* Light */
  @apply dark:bg-gray-700; /* Dark */
}
.react-datepicker__day--selected,
.react-datepicker__day--in-range {
  @apply bg-blue-600 text-white rounded-full font-semibold;
  @apply dark:bg-cyan-500 dark:text-black; /* Dark */
}
.react-datepicker__day--keyboard-selected {
  @apply bg-blue-700 rounded-full;
  @apply dark:bg-cyan-600; /* Dark */
}
.react-datepicker__day--disabled {
  @apply text-gray-400; /* Light */
  @apply dark:text-gray-600; /* Dark */
}

/* Navigation */
.react-datepicker__navigation-icon::before {
  @apply border-gray-600; /* Light */
  @apply dark:border-gray-300; /* Dark */
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\locales
--------------------------------------------------------------------
Contents:
en
hi
mr
te

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\locales\en
--------------------------------------------------------------------
Contents:
translation.json

====================================================================
📄 File: G:\FINALCODE\frontend\src\locales\en\translation.json
--------------------------------------------------------------------
{
  "nav": {
    "dashboard": "Dashboard",
    "products": "Products",
    "bills": "Bills",
    "customers": "Customers",
    "reports": "Reports",
    "logout": "Logout",
    "login": "Login",
    "viewCart": "View Cart",
    "selectLang": "Select language"
  },
  "lang": {
    "en": "EN",
    "hi": "HI",
    "mr": "MR",
    "te": "TE"
  },
  "auth": {
    "signIn": "Sign in",
    "signInWelcome": "Welcome back! Please enter your details.",
    "loginFailed": "Login Failed:",
    "emailAddress": "Email Address",
    "emailPlaceholder": "you@example.com",
    "password": "Password",
    "forgotPassword": "Forgot password?",
    "or": "or",
    "continueWithGoogle": "Continue with Google",
    "noAccount": "Don’t have an account?",
    "signUpHere": "Sign up here",
    "signUp": "Create an Account",
    "signUpWelcome": "Get started by filling out the form below.",
    "signupFailed": "Signup Failed:",
    "fullName": "Full Name",
    "namePlaceholder": "John Doe",
    "role": "Role",
    "roleCashier": "Cashier",
    "roleManager": "Manager",
    "roleOwner": "Owner",
    "createAccount": "Create Account",
    "haveAccount": "Already have an account?",
    "signInHere": "Sign in here",
    "brandPanelTitle": "Smart Retail",
    "brandPanelLogin": "Manage your inventory, billing, and analytics all in one place.",
    "brandPanelSignup": "Join our platform and take control of your business."
  },
  "dashboard": {
    "title": "Analytics Dashboard",
    "subtitle": "Real-time business insights at a glance",
    "datePlaceholder": "Select date range",
    "totalRevenue": "Total Revenue",
    "totalOrders": "Total Orders",
    "productsSold": "Products Sold",
    "up": "Up",
    "down": "Down",
    "salesByCategory": "Sales by Category",
    "percentOfTotal": "% of total",
    "topProducts": "Top Products",
    "loading": "Loading Dashboard...",
    "error": "Failed to load analytics. Please try again.",
    "revenue": "Revenue",
    "total": "Total"
  },
  "products": {
    "title": "Product Inventory",
    "items": "items",
    "searchPlaceholder": "Search by name, category, or ID...",
    "sortDefault": "Sort by: Default",
    "sortNameAsc": "Name (A-Z)",
    "sortNameDesc": "Name (Z-A)",
    "sortPriceAsc": "Price (Low-High)",
    "sortPriceDesc": "Price (High-Low)",
    "sortQtyAsc": "Quantity (Low-High)",
    "sortQtyDesc": "Quantity (High-Low)",
    "showLowStock": "Show Low Stock Only",
    "showingLowStock": "Showing Low Stock",
    "bulkUpload": "Bulk Upload",
    "addProduct": "Add Product",
    "loading": "Loading Products...",
    "error": "Failed to load products. Please try again.",
    "tryAgain": "Try Again",
    "noMatch": "No products match your search.",
    "noLowStock": "No low stock items found.",
    "noProducts": "No products found.",
    "clearFilters": "Clear Filters",
    "lowStock": "Low Stock",
    "inCart": "In Cart",
    "edit": "Edit Product",
    "delete": "Delete Product",
    "price": "Price",
    "inStock": "In Stock",
    "addToCart": "Add to Cart",
    "outOfStock": "Out of Stock",
    "formTitleAdd": "Add New Product",
    "formTitleEdit": "Edit Product",
    "formImage": "Product Image",
    "formImageDrop": "Drop image or click",
    "formImageReplace": "Upload new image to replace",
    "formImageUpload": "Upload product image",
    "formId": "Product ID (SKU)",
    "formIdPlaceholder": "e.g., LAP-APP-M1",
    "formName": "Product Name",
    "formNamePlaceholder": "e.g., Macbook Pro 14",
    "formCategory": "Category",
    "formCategoryPlaceholder": "e.g., Electronics",
    "formPrice": "Price (₹)",
    "formPricePlaceholder": "e.g., 150000",
    "formQuantity": "Quantity",
    "formQuantityPlaceholder": "e.g., 25",
    "formReorder": "Re-order Level",
    "formReorderPlaceholder": "e.g., 10",
    "formCancel": "Cancel",
    "formSaving": "Saving...",
    "formUpdating": "Updating...",
    "formSave": "Save Changes",
    "formCreate": "Create Product",
    "bulkTitle": "Bulk Product Upload",
    "bulkStep1": "1. Download the CSV template to ensure your data is in the correct format.",
    "bulkStep2": "2. Fill in your product data and upload the completed file here.",
    "bulkTemplate": "Download Template (.csv)",
    "bulkClick": "Click to upload",
    "bulkFile": "CSV file (max 10MB)",
    "bulkClose": "Close",
    "bulkCancel": "Cancel",
    "bulkUploading": "Uploading...",
    "bulkUploadProcess": "Upload & Process",
    "bulkSuccess": "Upload Complete",
    "bulkAdded": "products added successfully.",
    "bulkSkipped": "products skipped (already exist).",
    "bulkFailed": "products failed.",
    "toastUpdateSuccess": "Product updated successfully",
    "toastCreateSuccess": "Product created successfully",
    "toastError": "Operation failed",
    "bulkErrorFile": "Please select a .csv file to upload.",
    "bulkErrorUpload": "Upload failed. Please check file format."
  },
  "productCard": {
    "lowStock": "Low Stock",
    "inCart": "In Cart",
    "edit": "Edit Product",
    "delete": "Delete Product",
    "unnamed": "Unnamed Product",
    "uncategorized": "Uncategorized",
    "price": "Price",
    "inStock": "In Stock",
    "addToCart": "Add to Cart",
    "outOfStock": "Out of Stock",
    "errorStock": "Error: Only {{count}} available in stock (after cart).",
    "successAdd": "{{count}} x {{name}} added to cart!"
  },
  "customerList": {
    "title": "Customer Directory",
    "matching": "matching",
    "searchPlaceholder": "Search by name, email, or mobile...",
    "sort": "Sort by:",
    "sortNameAsc": "Name (A-Z)",
    "sortNameDesc": "Name (Z-A)",
    "sortDateDesc": "Last Purchase (Newest)",
    "sortDateAsc": "Last Purchase (Oldest)",
    "sortPurchaseDesc": "Purchases (High-Low)",
    "filter": "Show All",
    "filterInactive": "Inactive (30+ days)",
    "emailAll": "Email All",
    "emailAllConfirm": "Send email to all {{count}} customers?",
    "tryAgain": "Try Again",
    "noMatch": "No customers match your search.",
    "noFilterMatch": "No customers match your filter.",
    "noCustomers": "No customers found.",
    "clearFilters": "Clear Filters",
    "deleteConfirm": "Delete \"{{name}}\" and all their purchase history?",
    "deleteSuccess": "Customer deleted successfully",
    "deleteError": "Failed to delete customer."
  },
  "customerCard": {
    "unnamed": "Unnamed Customer",
    "totalPurchases": "Total Purchases",
    "lastPurchase": "Last Purchase",
    "sendEmail": "Send Email",
    "viewHistory": "View History",
    "delete": "Delete Customer",
    "deleteAria": "Delete customer {{name}}"
  },
  "customerForm": {
    "title": "Add Customer",
    "name": "Name",
    "email": "Email",
    "mobile": "Mobile",
    "save": "Save"
  },
  "customerEdit": {
    "title": "Edit Customer",
    "loading": "Loading...",
    "errorLoad": "Failed to load customer:",
    "success": "Customer updated successfully!",
    "errorUpdate": "Update failed:"
  },
  "billList": {
    "showing": "Showing bills",
    "previous": "Previous",
    "next": "Next",
    "matching": "matching bills",
    "title": "Bill History",
    "searchPlaceholder": "Search bills or customers...",
    "datePlaceholder": "Filter by date range",
    "sortNewest": "Newest First",
    "sortOldest": "Oldest First",
    "sortHigh": "Highest Amount",
    "sortLow": "Lowest Amount",
    "export": "Export to Excel",
    "exportSuccess": "Exported {{count}} bills",
    "exportError": "No data to export",
    "autoEmail": "Auto Email",
    "headerId": "Bill ID",
    "headerCustomer": "Customer",
    "headerTotal": "Total",
    "headerDate": "Date",
    "headerPayment": "Payment",
    "headerStatus": "Status",
    "headerActions": "Actions",
    "emptyState": "No bills match your filters.",
    "emptyStateHint": "Try adjusting filters or date range",
    "statusCompleted": "Completed",
    "paymentMethod": "CASH",
    "downloadPDF": "Download PDF",
    "resendEmail": "Resend Email",
    "downloading": "Downloading {{billId}}...",
    "downloadFailed": "Download failed",
    "resendSuccess": "Email resent!",
    "resendFailed": "Resend failed",
    "drawerTitle": "Bill Details",
    "drawerDate": "Date & Time",
    "drawerTotal": "Total Amount",
    "drawerCustomer": "Customer",
    "drawerItems": "Items ({{count}})",
    "walkIn": "Walk-in Customer",
    "noMobile": "No mobile number",
    "totalBills": "Total Bills",
    "totalRevenue": "Total Revenue",
    "generateBill": "Generate Bill"
  },
  "billForm": {
    "title": "Create New Bill",
    "customer": "Customer",
    "selectCustomer": "Select Customer",
    "items": "Items",
    "selectProduct": "Select Product",
    "addItem": "+ Add Item",
    "total": "Total:",
    "createBill": "Create Bill",
    "errorCustomer": "Please select a customer",
    "errorCreate": "Error creating bill",
    "success": "Bill created successfully!"
  },
  "checkout": {
    "title": "Review Your Cart",
    "empty": "Your cart is empty.",
    "summary": "Summary",
    "subtotal": "Subtotal",
    "taxes": "Taxes",
    "taxesValue": "Calculated at checkout",
    "total": "Total",
    "customerDetails": "Customer Details",
    "customerName": "Customer Name",
    "customerMobile": "Mobile Number (Required)",
    "customerEmail": "Email (for receipt)",
    "generateBill": "Generate Bill",
    "generatingBill": "Generating Bill...",
    "errorMobile": "Please enter a customer mobile number.",
    "errorEmptyCart": "Your cart is empty.",
    "billSuccess": "Bill {{billId}} created successfully!",
    "billError": "Failed to create bill: {{error}}"
  },
  "history": {
    "title": "Purchase History",
    "backToCustomers": "Back to Customers",
    "loading": "Loading customer history...",
    "error": "Failed to load customer history",
    "notFound": "Customer not found",
    "noHistory": "No purchase history found",
    "noHistoryHint": "This customer hasn't made any purchases yet",
    "headerBill": "Bill ID",
    "headerDate": "Date & Time",
    "headerTotal": "Total Amount",
    "headerActions": "Actions",
    "download": "Download PDF",
    "downloading": "Downloading bill {{billId}}...",
    "downloadSuccess": "PDF downloaded successfully",
    "downloadFailed": "Failed to download PDF",
    "totalPurchases": "Total Purchases",
    "purchaseSummary": "Purchase Summary",
    "totalBills": "Total Bills",
    "totalSpent": "Total Spent",
    "avgBill": "Average Bill"
  },
  "reports": {
    "title": "Executive Report Generator",
    "subtitle": "Generate comprehensive business intelligence reports with AI-powered insights and professional PDF exports.",
    "dateRange": "Date Range",
    "selectRange": "Select date range",
    "generate": "Generate Report",
    "generating": "Generating...",
    "download": "Export PDF",
    "downloading": "Downloading...",
    "newReport": "New Report",
    "errorDate": "Please select a valid date range.",
    "errorStartDate": "Start date cannot be after end date.",
    "loading": "Generating Report",
    "loadingSub": "Compiling data and generating insights...",
    "placeholderTitle": "Ready to Generate Reports",
    "placeholderSub": "Select your date range and click generate to create a comprehensive report.",
    "placeholder1": "Sales Analytics",
    "placeholder2": "AI Insights",
    "placeholder3": "PDF Export"
  },
  "reminder": {
    "title": "Monthly Purchase Reminders",
    "button": "Send Monthly Reminders",
    "sending": "Sending...",
    "success": "Reminders triggered successfully!",
    "error": "Failed to trigger reminders"
  },
  "profile": {
    "title": "My Profile",
    "notLoggedIn": "You are not logged in.",
    "email": "Email",
    "role": "Role",
    "tokenIssued": "Token issued",
    "tokenExpires": "Token expires"
  },
  "privateRoute": {
    "denied": "Access denied — insufficient permissions."
  },
  "errors": {
    "noToken": "No access token received from backend.",
    "noRefresh": "No refresh token found",
    "refreshFailed": "Token refresh failed"
  },
  "common": {
    "goBack": "Go Back",
    "downloading": "Downloading...",
    "previous": "Previous",
    "next": "Next"
  }
}

--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\locales\hi
--------------------------------------------------------------------
Contents:
translation.json

====================================================================
📄 File: G:\FINALCODE\frontend\src\locales\hi\translation.json
--------------------------------------------------------------------
{
  "nav": {
    "dashboard": "डैशबोर्ड",
    "products": "उत्पाद",
    "bills": "बिल",
    "customers": "ग्राहक",
    "reports": "रिपोर्ट्स",
    "logout": "लॉगआउट",
    "login": "लॉगिन",
    "viewCart": "कार्ट देखें",
    "selectLang": "भाषा चुनें"
  },
  "lang": {
    "en": "अंग्रेज़ी",
    "hi": "हिन्दी",
    "mr": "मराठी",
    "te": "तेलुगु"
  },
  "auth": {
    "signIn": "साइन इन",
    "signInWelcome": "वापस स्वागत है! कृपया अपनी जानकारी दर्ज करें।",
    "loginFailed": "लॉगिन विफल:",
    "emailAddress": "ईमेल पता",
    "emailPlaceholder": "you@example.com",
    "password": "पासवर्ड",
    "forgotPassword": "पासवर्ड भूल गए?",
    "or": "या",
    "continueWithGoogle": "Google के साथ जारी रखें",
    "noAccount": "खाता नहीं है?",
    "signUpHere": "यहां साइन अप करें",
    "signUp": "खाता बनाएं",
    "signUpWelcome": "नीचे दिए गए फॉर्म को भरकर शुरुआत करें।",
    "signupFailed": "साइनअप विफल:",
    "fullName": "पूरा नाम",
    "namePlaceholder": "जॉन डो",
    "role": "भूमिका",
    "roleCashier": "कैशियर",
    "roleManager": "मैनेजर",
    "roleOwner": "मालिक",
    "createAccount": "खाता बनाएं",
    "haveAccount": "पहले से खाता है?",
    "signInHere": "यहां साइन इन करें",
    "brandPanelTitle": "स्मार्ट रिटेल",
    "brandPanelLogin": "अपनी इन्वेंट्री, बिलिंग और एनालिटिक्स को एक ही स्थान पर प्रबंधित करें।",
    "brandPanelSignup": "हमारे प्लेटफॉर्म से जुड़ें और अपने व्यवसाय पर नियंत्रण रखें।"
  },
  "dashboard": {
    "title": "एनालिटिक्स डैशबोर्ड",
    "subtitle": "रीयल-टाइम व्यवसाय अंतर्दृष्टि एक नज़र में",
    "datePlaceholder": "तारीख सीमा चुनें",
    "totalRevenue": "कुल राजस्व",
    "totalOrders": "कुल ऑर्डर",
    "productsSold": "बिके उत्पाद",
    "up": "ऊपर",
    "down": "नीचे",
    "salesByCategory": "श्रेणी के अनुसार बिक्री",
    "percentOfTotal": "कुल का %",
    "topProducts": "शीर्ष उत्पाद",
    "loading": "डैशबोर्ड लोड हो रहा है...",
    "error": "एनालिटिक्स लोड करने में विफल। कृपया पुनः प्रयास करें।",
    "revenue": "राजस्व",
    "total": "कुल"
  },
  "products": {
    "title": "उत्पाद सूची",
    "items": "आइटम",
    "searchPlaceholder": "नाम, श्रेणी, या आईडी से खोजें...",
    "sortDefault": "क्रमबद्ध करें: डिफ़ॉल्ट",
    "sortNameAsc": "नाम (A-Z)",
    "sortNameDesc": "नाम (Z-A)",
    "sortPriceAsc": "कीमत (कम-ज्यादा)",
    "sortPriceDesc": "कीमत (ज्यादा-कम)",
    "sortQtyAsc": "मात्रा (कम-ज्यादा)",
    "sortQtyDesc": "मात्रा (ज्यादा-कम)",
    "showLowStock": "केवल कम स्टॉक दिखाएं",
    "showingLowStock": "कम स्टॉक दिखाया जा रहा है",
    "bulkUpload": "बल्क अपलोड",
    "addProduct": "उत्पाद जोड़ें",
    "loading": "उत्पाद लोड हो रहे हैं...",
    "error": "उत्पाद लोड करने में विफल। कृपया पुनः प्रयास करें।",
    "tryAgain": "पुनः प्रयास करें",
    "noMatch": "आपकी खोज से कोई उत्पाद मेल नहीं खाता।",
    "noLowStock": "कोई कम स्टॉक आइटम नहीं मिला।",
    "noProducts": "कोई उत्पाद नहीं मिला।",
    "clearFilters": "फ़िल्टर साफ करें",
    "lowStock": "कम स्टॉक",
    "inCart": "कार्ट में",
    "edit": "उत्पाद संपादित करें",
    "delete": "उत्पाद हटाएं",
    "price": "कीमत",
    "inStock": "स्टॉक में",
    "addToCart": "कार्ट में जोड़ें",
    "outOfStock": "स्टॉक खत्म",
    "formTitleAdd": "नया उत्पाद जोड़ें",
    "formTitleEdit": "उत्पाद संपादित करें",
    "formImage": "उत्पाद छवि",
    "formImageDrop": "छवि ड्रॉप करें या क्लिक करें",
    "formImageReplace": "प्रतिस्थापित करने के लिए नई छवि अपलोड करें",
    "formImageUpload": "उत्पाद छवि अपलोड करें",
    "formId": "उत्पाद आईडी (SKU)",
    "formIdPlaceholder": "जैसे, LAP-APP-M1",
    "formName": "उत्पाद नाम",
    "formNamePlaceholder": "जैसे, Macbook Pro 14",
    "formCategory": "श्रेणी",
    "formCategoryPlaceholder": "जैसे, इलेक्ट्रॉनिक्स",
    "formPrice": "कीमत (₹)",
    "formPricePlaceholder": "जैसे, 150000",
    "formQuantity": "मात्रा",
    "formQuantityPlaceholder": "जैसे, 25",
    "formReorder": "पुनः ऑर्डर स्तर",
    "formReorderPlaceholder": "जैसे, 10",
    "formCancel": "रद्द करें",
    "formSaving": "सहेजा जा रहा है...",
    "formUpdating": "अपडेट किया जा रहा है...",
    "formSave": "परिवर्तन सहेजें",
    "formCreate": "उत्पाद बनाएं",
    "bulkTitle": "बल्क उत्पाद अपलोड",
    "bulkStep1": "1. सुनिश्चित करने के लिए CSV टेम्पलेट डाउनलोड करें कि आपका डेटा सही प्रारूप में है।",
    "bulkStep2": "2. अपना उत्पाद डेटा भरें और पूर्ण फ़ाइल यहां अपलोड करें।",
    "bulkTemplate": "टेम्पलेट डाउनलोड करें (.csv)",
    "bulkClick": "अपलोड करने के लिए क्लिक करें",
    "bulkFile": "CSV फ़ाइल (अधिकतम 10MB)",
    "bulkClose": "बंद करें",
    "bulkCancel": "रद्द करें",
    "bulkUploading": "अपलोड हो रहा है...",
    "bulkUploadProcess": "अपलोड और प्रोसेस करें",
    "bulkSuccess": "अपलोड पूर्ण",
    "bulkAdded": "उत्पाद सफलतापूर्वक जोड़े गए।",
    "bulkSkipped": "उत्पाद छोड़े गए (पहले से मौजूद)।",
    "bulkFailed": "उत्पाद विफल।",
    "toastUpdateSuccess": "उत्पाद सफलतापूर्वक अपडेट किया गया",
    "toastCreateSuccess": "उत्पाद सफलतापूर्वक बनाया गया",
    "toastError": "ऑपरेशन विफल",
    "bulkErrorFile": "कृपया अपलोड करने के लिए .csv फ़ाइल चुनें।",
    "bulkErrorUpload": "अपलोड विफल। कृपया फ़ाइल प्रारूप जांचें।"
  },
  "productCard": {
    "lowStock": "कम स्टॉक",
    "inCart": "कार्ट में",
    "edit": "उत्पाद संपादित करें",
    "delete": "उत्पाद हटाएं",
    "unnamed": "बेनाम उत्पाद",
    "uncategorized": "अश्रेणीबद्ध",
    "price": "कीमत",
    "inStock": "स्टॉक में",
    "addToCart": "कार्ट में जोड़ें",
    "outOfStock": "स्टॉक खत्म",
    "errorStock": "त्रुटि: केवल {{count}} स्टॉक में उपलब्ध (कार्ट के बाद)।",
    "successAdd": "{{count}} x {{name}} कार्ट में जोड़ा गया!"
  },
  "customerList": {
    "title": "ग्राहक निर्देशिका",
    "matching": "मेल खाते",
    "searchPlaceholder": "नाम, ईमेल, या मोबाइल से खोजें...",
    "sort": "क्रमबद्ध करें:",
    "sortNameAsc": "नाम (A-Z)",
    "sortNameDesc": "नाम (Z-A)",
    "sortDateDesc": "अंतिम खरीद (नवीनतम)",
    "sortDateAsc": "अंतिम खरीद (पुराना)",
    "sortPurchaseDesc": "खरीदारी (ज्यादा-कम)",
    "filter": "सभी दिखाएं",
    "filterInactive": "निष्क्रिय (30+ दिन)",
    "emailAll": "सभी को ईमेल करें",
    "emailAllConfirm": "सभी {{count}} ग्राहकों को ईमेल भेजें?",
    "tryAgain": "पुनः प्रयास करें",
    "noMatch": "आपकी खोज से कोई ग्राहक मेल नहीं खाता।",
    "noFilterMatch": "आपके फ़िल्टर से कोई ग्राहक मेल नहीं खाता।",
    "noCustomers": "कोई ग्राहक नहीं मिला।",
    "clearFilters": "फ़िल्टर साफ करें",
    "deleteConfirm": "\"{{name}}\" और उनका सारा खरीदारी इतिहास हटाएं?",
    "deleteSuccess": "ग्राहक सफलतापूर्वक हटा दिया गया",
    "deleteError": "ग्राहक हटाने में विफल।"
  },
  "customerCard": {
    "unnamed": "बेनाम ग्राहक",
    "totalPurchases": "कुल खरीदारी",
    "lastPurchase": "अंतिम खरीदारी",
    "sendEmail": "ईमेल भेजें",
    "viewHistory": "इतिहास देखें",
    "delete": "ग्राहक हटाएं",
    "deleteAria": "ग्राहक {{name}} हटाएं"
  },
  "customerForm": {
    "title": "ग्राहक जोड़ें",
    "name": "नाम",
    "email": "ईमेल",
    "mobile": "मोबाइल",
    "save": "सहेजें"
  },
  "customerEdit": {
    "title": "ग्राहक संपादित करें",
    "loading": "लोड हो रहा है...",
    "errorLoad": "ग्राहक लोड करने में विफल:",
    "success": "ग्राहक सफलतापूर्वक अपडेट किया गया!",
    "errorUpdate": "अपडेट विफल:"
  },
  "billList": {
    "matching": "मेल खाते बिल",
    "showing": "बिल दिखाए जा रहे हैं",
    "previous": "पिछला",
    "next": "अगला",
    "title": "बिल इतिहास",
    "searchPlaceholder": "बिल या ग्राहक खोजें...",
    "datePlaceholder": "तारीख सीमा से फ़िल्टर करें",
    "sortNewest": "नवीनतम पहले",
    "sortOldest": "सबसे पुराना पहले",
    "sortHigh": "सबसे ज्यादा राशि",
    "sortLow": "सबसे कम राशि",
    "export": "एक्सेल में निर्यात करें",
    "exportSuccess": "{{count}} बिल निर्यात किए गए",
    "exportError": "निर्यात करने के लिए कोई डेटा नहीं",
    "autoEmail": "ऑटो ईमेल",
    "headerId": "बिल आईडी",
    "headerCustomer": "ग्राहक",
    "headerTotal": "कुल",
    "headerDate": "तारीख",
    "headerPayment": "भुगतान",
    "headerStatus": "स्थिति",
    "headerActions": "कार्रवाई",
    "emptyState": "आपके फ़िल्टर से कोई बिल मेल नहीं खाता।",
    "emptyStateHint": "फ़िल्टर या तारीख सीमा समायोजित करने का प्रयास करें",
    "statusCompleted": "पूर्ण",
    "paymentMethod": "नकद",
    "downloadPDF": "PDF डाउनलोड करें",
    "resendEmail": "ईमेल पुनः भेजें",
    "downloading": "{{billId}} डाउनलोड हो रहा है...",
    "downloadFailed": "डाउनलोड विफल",
    "resendSuccess": "ईमेल पुनः भेजा गया!",
    "resendFailed": "पुनः भेजने में विफल",
    "drawerTitle": "बिल विवरण",
    "drawerDate": "तारीख और समय",
    "drawerTotal": "कुल राशि",
    "drawerCustomer": "ग्राहक",
    "drawerItems": "आइटम ({{count}})",
    "walkIn": "वॉक-इन ग्राहक",
    "noMobile": "कोई मोबाइल नंबर नहीं",
    "totalBills": "कुल बिल",
    "totalRevenue": "कुल राजस्व",
    "generateBill": "बिल बनाएं"
  },
  "billForm": {
    "title": "नया बिल बनाएं",
    "customer": "ग्राहक",
    "selectCustomer": "ग्राहक चुनें",
    "items": "आइटम",
    "selectProduct": "उत्पाद चुनें",
    "addItem": "+ आइटम जोड़ें",
    "total": "कुल:",
    "createBill": "बिल बनाएं",
    "errorCustomer": "कृपया एक ग्राहक चुनें",
    "errorCreate": "बिल बनाने में त्रुटि",
    "success": "बिल सफलतापूर्वक बनाया गया!"
  },
  "checkout": {
    "title": "अपना कार्ट समीक्षा करें",
    "empty": "आपका कार्ट खाली है।",
    "summary": "सारांश",
    "subtotal": "उप-योग",
    "taxes": "टैक्स",
    "taxesValue": "चेकआउट पर गणना की गई",
    "total": "कुल",
    "customerDetails": "ग्राहक विवरण",
    "customerName": "ग्राहक का नाम",
    "customerMobile": "मोबाइल नंबर (आवश्यक)",
    "customerEmail": "ईमेल (रसीद के लिए)",
    "generateBill": "बिल बनाएं",
    "generatingBill": "बिल बनाया जा रहा है...",
    "errorMobile": "कृपया ग्राहक मोबाइल नंबर दर्ज करें।",
    "errorEmptyCart": "आपका कार्ट खाली है।",
    "billSuccess": "बिल {{billId}} सफलतापूर्वक बनाया गया!",
    "billError": "बिल बनाने में विफल: {{error}}"
  },
  "history": {
    "title": "खरीदारी इतिहास",
    "backToCustomers": "ग्राहकों पर वापस जाएं",
    "loading": "ग्राहक इतिहास लोड हो रहा है...",
    "error": "ग्राहक इतिहास लोड करने में विफल",
    "notFound": "ग्राहक नहीं मिला",
    "noHistory": "कोई खरीदारी इतिहास नहीं मिला",
    "noHistoryHint": "इस ग्राहक ने अभी तक कोई खरीदारी नहीं की है",
    "headerBill": "बिल आईडी",
    "headerDate": "तारीख और समय",
    "headerTotal": "कुल राशि",
    "headerActions": "कार्रवाई",
    "download": "PDF डाउनलोड करें",
    "downloading": "बिल {{billId}} डाउनलोड हो रहा है...",
    "downloadSuccess": "PDF सफलतापूर्वक डाउनलोड हो गया",
    "downloadFailed": "PDF डाउनलोड करने में विफल",
    "totalPurchases": "कुल खरीददारी",
    "purchaseSummary": "खरीदारी सारांश",
    "totalBills": "कुल बिल",
    "totalSpent": "कुल खर्च",
    "avgBill": "औसत बिल"
  },
  "reports": {
    "title": "एग्जीक्यूटिव रिपोर्ट जनरेटर",
    "subtitle": "AI-संचालित अंतर्दृष्टि और पेशेवर PDF निर्यात के साथ व्यापक व्यवसाय बुद्धिमत्ता रिपोर्ट तैयार करें।",
    "dateRange": "तारीख सीमा",
    "selectRange": "तारीख सीमा चुनें",
    "generate": "रिपोर्ट जनरेट करें",
    "generating": "जनरेट हो रहा है...",
    "download": "PDF निर्यात करें",
    "downloading": "डाउनलोड हो रहा है...",
    "newReport": "नई रिपोर्ट",
    "errorDate": "कृपया एक वैध तारीख सीमा चुनें।",
    "errorStartDate": "प्रारंभ तिथि समाप्ति तिथि के बाद नहीं हो सकती।",
    "loading": "रिपोर्ट जनरेट हो रही है",
    "loadingSub": "डेटा संकलित किया जा रहा है और अंतर्दृष्टि जनरेट की जा रही है...",
    "placeholderTitle": "रिपोर्ट जनरेट करने के लिए तैयार",
    "placeholderSub": "एक व्यापक रिपोर्ट बनाने के लिए अपनी तारीख सीमा चुनें और जनरेट पर क्लिक करें।",
    "placeholder1": "बिक्री एनालिटिक्स",
    "placeholder2": "AI अंतर्दृष्टि",
    "placeholder3": "PDF निर्यात"
  },
  "reminder": {
    "title": "मासिक खरीदारी अनुस्मारक",
    "button": "मासिक अनुस्मारक भेजें",
    "sending": "भेजा जा रहा है...",
    "success": "अनुस्मारक सफलतापूर्वक ट्रिगर किए गए!",
    "error": "अनुस्मारक ट्रिगर करने में विफल"
  },
  "profile": {
    "title": "मेरी प्रोफाइल",
    "notLoggedIn": "आप लॉग इन नहीं हैं।",
    "email": "ईमेल",
    "role": "भूमिका",
    "tokenIssued": "टोकन जारी किया गया",
    "tokenExpires": "टोकन समाप्त होता है"
  },
  "privateRoute": {
    "denied": "पहुंच अस्वीकृत - अपर्याप्त अनुमतियां।"
  },
  "errors": {
    "noToken": "बैकएंड से कोई एक्सेस टोकन प्राप्त नहीं हुआ।",
    "noRefresh": "कोई रिफ्रेश टोकन नहीं मिला",
    "refreshFailed": "टोकन रिफ्रेश विफल"
  },
  "common": {
    "goBack": "वापस जाएं",
    "downloading": "डाउनलोड हो रहा है...",
    "previous": "पिछला",
    "next": "अगला"
  }
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\locales\mr
--------------------------------------------------------------------
Contents:
translation.json

====================================================================
📄 File: G:\FINALCODE\frontend\src\locales\mr\translation.json
--------------------------------------------------------------------
{
  "nav": {
    "dashboard": "डॅशबोर्ड",
    "products": "उत्पादने",
    "bills": "बिले",
    "customers": "ग्राहक",
    "reports": "अहवाल",
    "logout": "लॉगआउट",
    "login": "लॉगिन",
    "viewCart": "कार्ट पहा",
    "selectLang": "भाषा निवडा"
  },
  "lang": {
    "en": "इंग्रजी",
    "hi": "हिंदी",
    "mr": "मराठी",
    "te": "तेलुगू"
  },
  "auth": {
    "signIn": "साइन इन",
    "signInWelcome": "पुन्हा स्वागत आहे! कृपया तुमचे तपशील प्रविष्ट करा.",
    "loginFailed": "लॉगिन अयशस्वी:",
    "emailAddress": "ईमेल पत्ता",
    "emailPlaceholder": "you@example.com",
    "password": "पासवर्ड",
    "forgotPassword": "पासवर्ड विसरलात?",
    "or": "किंवा",
    "continueWithGoogle": "Google सह सुरू ठेवा",
    "noAccount": "खाते नाही?",
    "signUpHere": "येथे साइन अप करा",
    "signUp": "खाते तयार करा",
    "signUpWelcome": "खालील फॉर्म भरून प्रारंभ करा.",
    "signupFailed": "साइनअप अयशस्वी:",
    "fullName": "पूर्ण नाव",
    "namePlaceholder": "जॉन डो",
    "role": "भूमिका",
    "roleCashier": "कॅशियर",
    "roleManager": "व्यवस्थापक",
    "roleOwner": "मालक",
    "createAccount": "खाते तयार करा",
    "haveAccount": "आधीपासून खाते आहे?",
    "signInHere": "येथे साइन इन करा",
    "brandPanelTitle": "स्मार्ट रिटेल",
    "brandPanelLogin": "तुमची इन्व्हेंटरी, बिलिंग आणि अ‍ॅनालिटिक्स एकाच ठिकाणी व्यवस्थापित करा.",
    "brandPanelSignup": "आमच्या प्लॅटफॉर्ममध्ये सामील व्हा आणि तुमच्या व्यवसायावर नियंत्रण ठेवा."
  },
  "dashboard": {
    "title": "अ‍ॅनालिटिक्स डॅशबोर्ड",
    "subtitle": "रीयल-टाइम व्यवसाय अंतर्दृष्टी एका दृष्टीक्षेपात",
    "datePlaceholder": "तारीख श्रेणी निवडा",
    "totalRevenue": "एकूण उत्पन्न",
    "totalOrders": "एकूण ऑर्डर",
    "productsSold": "विकल्या गेलेली उत्पादने",
    "up": "वाढ",
    "down": "घट",
    "salesByCategory": "श्रेणीनुसार विक्री",
    "percentOfTotal": "एकूणाच्या %",
    "topProducts": "शीर्ष उत्पादने",
    "loading": "डॅशबोर्ड लोड होत आहे...",
    "error": "अ‍ॅनालिटिक्स लोड करण्यात अयशस्वी. कृपया पुन्हा प्रयत्न करा.",
    "revenue": "उत्पन्न",
    "total": "एकूण"
  },
  "products": {
    "title": "उत्पादन यादी",
    "items": "आयटम",
    "searchPlaceholder": "नाव, श्रेणी, किंवा आयडी नुसार शोधा...",
    "sortDefault": "क्रमवारी लावा: डीफॉल्ट",
    "sortNameAsc": "नाव (A-Z)",
    "sortNameDesc": "नाव (Z-A)",
    "sortPriceAsc": "किंमत (कमी-जास्त)",
    "sortPriceDesc": "किंमत (जास्त-कमी)",
    "sortQtyAsc": "प्रमाण (कमी-जास्त)",
    "sortQtyDesc": "प्रमाण (जास्त-कमी)",
    "showLowStock": "फक्त कमी स्टॉक दाखवा",
    "showingLowStock": "कमी स्टॉक दाखवला जात आहे",
    "bulkUpload": "बल्क अपलोड",
    "addProduct": "उत्पादन जोडा",
    "loading": "उत्पादने लोड होत आहेत...",
    "error": "उत्पादने लोड करण्यात अयशस्वी. कृपया पुन्हा प्रयत्न करा.",
    "tryAgain": "पुन्हा प्रयत्न करा",
    "noMatch": "तुमच्या शोधाशी जुळणारी कोणतीही उत्पादने नाहीत.",
    "noLowStock": "कमी स्टॉक आयटम सापडले नाहीत.",
    "noProducts": "कोणतीही उत्पादने सापडली नाहीत.",
    "clearFilters": "फिल्टर क्लिअर करा",
    "lowStock": "कमी स्टॉक",
    "inCart": "कार्टमध्ये",
    "edit": "उत्पादन संपादित करा",
    "delete": "उत्पादन हटवा",
    "price": "किंमत",
    "inStock": "स्टॉकमध्ये",
    "addToCart": "कार्टमध्ये जोडा",
    "outOfStock": "स्टॉक संपला",
    "formTitleAdd": "नवीन उत्पादन जोडा",
    "formTitleEdit": "उत्पादन संपादित करा",
    "formImage": "उत्पादन प्रतिमा",
    "formImageDrop": "प्रतिमा ड्रॉप करा किंवा क्लिक करा",
    "formImageReplace": "बदलण्यासाठी नवीन प्रतिमा अपलोड करा",
    "formImageUpload": "उत्पादन प्रतिमा अपलोड करा",
    "formId": "उत्पादन आयडी (SKU)",
    "formIdPlaceholder": "उदा., LAP-APP-M1",
    "formName": "उत्पादन नाव",
    "formNamePlaceholder": "उदा., Macbook Pro 14",
    "formCategory": "श्रेणी",
    "formCategoryPlaceholder": "उदा., इलेक्ट्रॉनिक्स",
    "formPrice": "किंमत (₹)",
    "formPricePlaceholder": "उदा., 150000",
    "formQuantity": "प्रमाण",
    "formQuantityPlaceholder": "उदा., 25",
    "formReorder": "पुन्हा ऑर्डर स्तर",
    "formReorderPlaceholder": "उदा., 10",
    "formCancel": "रद्द करा",
    "formSaving": "जतन होत आहे...",
    "formUpdating": "अपडेट होत आहे...",
    "formSave": "बदल जतन करा",
    "formCreate": "उत्पादन तयार करा",
    "bulkTitle": "बल्क उत्पादन अपलोड",
    "bulkStep1": "1. तुमचा डेटा योग्य स्वरूपात आहे याची खात्री करण्यासाठी CSV टेम्पलेट डाउनलोड करा.",
    "bulkStep2": "2. तुमचा उत्पादन डेटा भरा आणि पूर्ण फाइल येथे अपलोड करा.",
    "bulkTemplate": "टेम्पलेट डाउनलोड करा (.csv)",
    "bulkClick": "अपलोड करण्यासाठी क्लिक करा",
    "bulkFile": "CSV फाइल (कमाल 10MB)",
    "bulkClose": "बंद करा",
    "bulkCancel": "रद्द करा",
    "bulkUploading": "अपलोड होत आहे...",
    "bulkUploadProcess": "अपलोड आणि प्रक्रिया करा",
    "bulkSuccess": "अपलोड पूर्ण",
    "bulkAdded": "उत्पादने यशस्वीरित्या जोडली.",
    "bulkSkipped": "उत्पादने वगळली (आधीपासून अस्तित्वात आहेत).",
    "bulkFailed": "उत्पादने अयशस्वी.",
    "toastUpdateSuccess": "उत्पादन यशस्वीरित्या अपडेट केले",
    "toastCreateSuccess": "उत्पादन यशस्वीरित्या तयार केले",
    "toastError": "ऑपरेशन अयशस्वी",
    "bulkErrorFile": "कृपया अपलोड करण्यासाठी .csv फाइल निवडा.",
    "bulkErrorUpload": "अपलोड अयशस्वी. कृपया फाइल स्वरूप तपासा."
  },
  "productCard": {
    "lowStock": "कमी स्टॉक",
    "inCart": "कार्टमध्ये",
    "edit": "उत्पादन संपादित करा",
    "delete": "उत्पादन हटवा",
    "unnamed": "निनावी उत्पादन",
    "uncategorized": "अश्रेणीबद्ध",
    "price": "किंमत",
    "inStock": "स्टॉकमध्ये",
    "addToCart": "कार्टमध्ये जोडा",
    "outOfStock": "स्टॉक संपला",
    "errorStock": "त्रुटी: फक्त {{count}} स्टॉकमध्ये उपलब्ध (कार्ट नंतर).",
    "successAdd": "{{count}} x {{name}} कार्टमध्ये जोडले!"
  },
  "customerList": {
    "title": "ग्राहक निर्देशिका",
    "matching": "जुळणारे",
    "searchPlaceholder": "नाव, ईमेल, किंवा मोबाइल नुसार शोधा...",
    "sort": "क्रमवारी लावा:",
    "sortNameAsc": "नाव (A-Z)",
    "sortNameDesc": "नाव (Z-A)",
    "sortDateDesc": "शेवटची खरेदी (नवीनतम)",
    "sortDateAsc": "शेवटची खरेदी (जुने)",
    "sortPurchaseDesc": "खरेदी (जास्त-कमी)",
    "filter": "सर्व दाखवा",
    "filterInactive": "निष्क्रिय (30+ दिवस)",
    "emailAll": "सर्वांना ईमेल करा",
    "emailAllConfirm": "सर्व {{count}} ग्राहकांना ईमेल पाठवायचा?",
    "tryAgain": "पुन्हा प्रयत्न करा",
    "noMatch": "तुमच्या शोधाशी जुळणारे कोणतेही ग्राहक नाहीत.",
    "noFilterMatch": "तुमच्या फिल्टरशी जुळणारे कोणतेही ग्राहक नाहीत.",
    "noCustomers": "कोणतेही ग्राहक सापडले नाहीत.",
    "clearFilters": "फिल्टर क्लिअर करा",
    "deleteConfirm": "\"{{name}}\" आणि त्यांचा संपूर्ण खरेदी इतिहास हटवायचा?",
    "deleteSuccess": "ग्राहक यशस्वीरित्या हटवला",
    "deleteError": "ग्राहक हटवण्यात अयशस्वी."
  },
  "customerCard": {
    "unnamed": "निनावी ग्राहक",
    "totalPurchases": "एकूण खरेदी",
    "lastPurchase": "शेवटची खरेदी",
    "sendEmail": "ईमेल पाठवा",
    "viewHistory": "इतिहास पहा",
    "delete": "ग्राहक हटवा",
    "deleteAria": "ग्राहक {{name}} हटवा"
  },
  "customerForm": {
    "title": "ग्राहक जोडा",
    "name": "नाव",
    "email": "ईमेल",
    "mobile": "मोबाइल",
    "save": "जतन करा"
  },
  "customerEdit": {
    "title": "ग्राहक संपादित करा",
    "loading": "लोड होत आहे...",
    "errorLoad": "ग्राहक लोड करण्यात अयशस्वी:",
    "success": "ग्राहक यशस्वीरित्या अपडेट केला!",
    "errorUpdate": "अपडेट अयशस्वी:"
  },
  "billList": {
    "matching": "जुळणारी बिले",
    "showing": "बिले दाखवली जात आहेत",
    "previous": "मागील",
    "next": "पुढील",
    "title": "बिल इतिहास",
    "searchPlaceholder": "बिल किंवा ग्राहक शोधा...",
    "datePlaceholder": "तारीख श्रेणीनुसार फिल्टर करा",
    "sortNewest": "नवीनतम प्रथम",
    "sortOldest": "जुने प्रथम",
    "sortHigh": "सर्वात जास्त रक्कम",
    "sortLow": "सर्वात कमी रक्कम",
    "export": "एक्सेलमध्ये निर्यात करा",
    "exportSuccess": "{{count}} बिले निर्यात केली",
    "exportError": "निर्यात करण्यासाठी कोणताही डेटा नाही",
    "autoEmail": "ऑटो ईमेल",
    "headerId": "बिल आयडी",
    "headerCustomer": "ग्राहक",
    "headerTotal": "एकूण",
    "headerDate": "तारीख",
    "headerPayment": "पेमेंट",
    "headerStatus": "स्थिती",
    "headerActions": "क्रिया",
    "emptyState": "तुमच्या फिल्टरशी जुळणारी कोणतीही बिले नाहीत.",
    "emptyStateHint": "फिल्टर किंवा तारीख श्रेणी समायोजित करण्याचा प्रयत्न करा",
    "statusCompleted": "पूर्ण",
    "paymentMethod": "रोख",
    "downloadPDF": "PDF डाउनलोड करा",
    "resendEmail": "ईमेल पुन्हा पाठवा",
    "downloading": "{{billId}} डाउनलोड होत आहे...",
    "downloadFailed": "डाउनलोड अयशस्वी",
    "resendSuccess": "ईमेल पुन्हा पाठवला!",
    "resendFailed": "पुन्हा पाठवणे अयशस्वी",
    "drawerTitle": "बिल तपशील",
    "drawerDate": "तारीख आणि वेळ",
    "drawerTotal": "एकूण रक्कम",
    "drawerCustomer": "ग्राहक",
    "drawerItems": "आयटम ({{count}})",
    "walkIn": "वॉक-इन ग्राहक",
    "noMobile": "मोबाइल नंबर नाही",
    "totalBills": "एकूण बिले",
    "totalRevenue": "एकूण उत्पन्न",
    "generateBill": "बिल तयार करा"
  },
  "billForm": {
    "title": "नवीन बिल तयार करा",
    "customer": "ग्राहक",
    "selectCustomer": "ग्राहक निवडा",
    "items": "आयटम",
    "selectProduct": "उत्पादन निवडा",
    "addItem": "+ आयटम जोडा",
    "total": "एकूण:",
    "createBill": "बिल तयार करा",
    "errorCustomer": "कृपया एक ग्राहक निवडा",
    "errorCreate": "बिल तयार करताना त्रुटी",
    "success": "बिल यशस्वीरित्या तयार केले!"
  },
  "checkout": {
    "title": "तुमचा कार्ट पुनरावलोकन करा",
    "empty": "तुमचा कार्ट रिकामा आहे.",
    "summary": "सारांश",
    "subtotal": "उपयोग",
    "taxes": "कर",
    "taxesValue": "चेकआउटवर गणना केली जाते",
    "total": "एकूण",
    "customerDetails": "ग्राहक तपशील",
    "customerName": "ग्राहकाचे नाव",
    "customerMobile": "मोबाइल नंबर (आवश्यक)",
    "customerEmail": "ईमेल (पावतीसाठी)",
    "generateBill": "बिल तयार करा",
    "generatingBill": "बिल तयार होत आहे...",
    "errorMobile": "कृपया ग्राहक मोबाइल नंबर प्रविष्ट करा.",
    "errorEmptyCart": "तुमचा कार्ट रिकामा आहे.",
    "billSuccess": "बिल {{billId}} यशस्वीरित्या तयार केले!",
    "billError": "बिल तयार करण्यात अयशस्वी: {{error}}"
  },
  "history": {
    "title": "खरेदी इतिहास",
    "backToCustomers": "ग्राहकांकडे परत जा",
    "loading": "ग्राहक इतिहास लोड होत आहे...",
    "error": "ग्राहक इतिहास लोड करण्यात अयशस्वी",
    "notFound": "ग्राहक सापडला नाही",
    "noHistory": "खरेदी इतिहास सापडला नाही",
    "noHistoryHint": "या ग्राहकाने अद्याप कोणतीही खरेदी केलेली नाही",
    "headerBill": "बिल आयडी",
    "headerDate": "तारीख आणि वेळ",
    "headerTotal": "एकूण रक्कम",
    "headerActions": "क्रिया",
    "download": "PDF डाउनलोड करा",
    "downloading": "बिल {{billId}} डाउनलोड होत आहे...",
    "downloadSuccess": "PDF यशस्वीरित्या डाउनलोड झाला",
    "downloadFailed": "PDF डाउनलोड करण्यात अयशस्वी",
    "totalPurchases": "एकूण खरेदी",
    "purchaseSummary": "खरेदी सारांश",
    "totalBills": "एकूण बिले",
    "totalSpent": "एकूण खर्च",
    "avgBill": "सरासरी बिल"
  },
  "reports": {
    "title": "कार्यकारी अहवाल जनरेटर",
    "subtitle": "AI-संचालित अंतर्दृष्टी आणि व्यावसायिक PDF निर्यातीसह व्यापक व्यवसाय बुद्धिमत्ता अहवाल तयार करा.",
    "dateRange": "तारीख श्रेणी",
    "selectRange": "तारीख श्रेणी निवडा",
    "generate": "अहवाल जनरेट करा",
    "generating": "जनरेट होत आहे...",
    "download": "PDF निर्यात करा",
    "downloading": "डाउनलोड होत आहे...",
    "newReport": "नवीन अहवाल",
    "errorDate": "कृपया एक वैध तारीख श्रेणी निवडा.",
    "errorStartDate": "प्रारंभ तारीख समाप्ती तारखेपेक्षा नंतरची असू शकत नाही.",
    "loading": "अहवाल जनरेट होत आहे",
    "loadingSub": "डेटा संकलित केला जात आहे आणि अंतर्दृष्टी तयार केली जात आहे...",
    "placeholderTitle": "अहवाल तयार करण्यासाठी तयार",
    "placeholderSub": "एक व्यापक अहवाल तयार करण्यासाठी तुमची तारीख श्रेणी निवडा आणि जनरेट वर क्लिक करा.",
    "placeholder1": "विक्री अ‍ॅनालिटिक्स",
    "placeholder2": "AI अंतर्दृष्टी",
    "placeholder3": "PDF निर्यात"
  },
  "reminder": {
    "title": "मासिक खरेदी रिमाइंडर",
    "button": "मासिक रिमाइंडर पाठवा",
    "sending": "पाठवला जात आहे...",
    "success": "रिमाइंडर यशस्वीरित्या ट्रिगर केले!",
    "error": "रिमाइंडर ट्रिगर करण्यात अयशस्वी"
  },
  "profile": {
    "title": "माझी प्रोफाइल",
    "notLoggedIn": "तुम्ही लॉग इन केलेले नाही.",
    "email": "ईमेल",
    "role": "भूमिका",
    "tokenIssued": "टोकन जारी केला",
    "tokenExpires": "टोकन कालबाह्य होतो"
  },
  "privateRoute": {
    "denied": "प्रवेश नाकारला - अपुरी परवानग्या."
  },
  "errors": {
    "noToken": "बॅकएंडकडून कोणताही ऍक्सेस टोकन प्राप्त झाला नाही.",
    "noRefresh": "कोणताही रिफ्रेश टोकन सापडला नाही",
    "refreshFailed": "टोकन रिफ्रेश अयशस्वी"
  },
  "common": {
    "goBack": "मागे जा",
    "downloading": "डाउनलोड होत आहे...",
    "previous": "मागील",
    "next": "पुढील"
  }
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\locales\te
--------------------------------------------------------------------
Contents:
translation.json

====================================================================
📄 File: G:\FINALCODE\frontend\src\locales\te\translation.json
--------------------------------------------------------------------
{
  "nav": {
    "dashboard": "డాష్బోర్డ్",
    "products": "ఉత్పత్తులు",
    "bills": "బిల్లులు",
    "customers": "గ్రాహకులు",
    "reports": "రిపోర్ట్లు",
    "logout": "లాగ్అవుట్",
    "login": "లాగిన్",
    "viewCart": "కార్ట్ చూడండి",
    "selectLang": "భాష ఎంచుకోండి"
  },
  "lang": {
    "en": "ఇంగ్లీష్",
    "hi": "హిందీ",
    "mr": "మరాఠీ",
    "te": "తెలుగు"
  },
  "auth": {
    "signIn": "సైన్ ఇన్",
    "signInWelcome": "తిరిగి స్వాగతం! దయచేసి మీ వివరాలను నమోదు చేయండి.",
    "loginFailed": "లాగిన్ విఫలమైంది:",
    "emailAddress": "ఇమెయిల్ చిరునామా",
    "emailPlaceholder": "you@example.com",
    "password": "పాస్వర్డ్",
    "forgotPassword": "పాస్వర్డ్ మర్చిపోయారా?",
    "or": "లేదా",
    "continueWithGoogle": "Google తో కొనసాగించండి",
    "noAccount": "ఖాతా లేదా?",
    "signUpHere": "ఇక్కడ సైన్ అప్ చేయండి",
    "signUp": "ఖాతా సృష్టించండి",
    "signUpWelcome": "క్రింద ఫారమ్ను పూరించడం ద్వారా ప్రారంభించండి.",
    "signupFailed": "సైన్అప్ విఫలమైంది:",
    "fullName": "పూర్తి పేరు",
    "namePlaceholder": "జాన్ డో",
    "role": "పాత్ర",
    "roleCashier": "క్యాషియర్",
    "roleManager": "మేనేజర్",
    "roleOwner": "యజమాని",
    "createAccount": "ఖాతా సృష్టించండి",
    "haveAccount": "ఇప్పటికే ఖాతా ఉందా?",
    "signInHere": "ఇక్కడ సైన్ ఇన్ చేయండి",
    "brandPanelTitle": "స్మార్ట్ రిటెయిల్",
    "brandPanelLogin": "మీ ఇన్వెంటరీ, బిల్లింగ్ మరియు విశ్లేషణలను ఒకే చోట నిర్వహించండి.",
    "brandPanelSignup": "మా ప్లాట్ఫారమ్లో చేరండి మరియు మీ వ్యాపారాన్ని నియంత్రించండి."
  },
  "dashboard": {
    "title": "విశ్లేషణ డాష్బోర్డ్",
    "subtitle": "నిజ-సమయ వ్యాపార అంతర్దృష్టులు ఒక నిమిషంలో",
    "datePlaceholder": "తేదీ పరిధి ఎంచుకోండి",
    "totalRevenue": "మొత్తం ఆదాయం",
    "totalOrders": "మొత్తం ఆర్డర్లు",
    "productsSold": "విక్రయించబడిన ఉత్పత్తులు",
    "up": "పెరుగుదల",
    "down": "తగ్గుదల",
    "salesByCategory": "కేటగరీ ప్రకారం విక్రయాలు",
    "percentOfTotal": "మొత్తం %",
    "topProducts": "టాప్ ఉత్పత్తులు",
    "loading": "డాష్బోర్డ్ లోడ్ అవుతుంది...",
    "error": "విశ్లేషణలు లోడ్ చేయడంలో విఫలమైంది. దయచేసి మళ్లీ ప్రయత్నించండి.",
    "revenue": "ఆదాయం",
    "total": "మొత్తం"
  },
  "products": {
    "title": "ఉత్పత్తి ఇన్వెంటరీ",
    "items": "అంశాలు",
    "searchPlaceholder": "పేరు, కేటగరీ, లేదా ఐడీ ద్వారా శోధించండి...",
    "sortDefault": "క్రమబద్ధీకరించు: డిఫాల్ట్",
    "sortNameAsc": "పేరు (A-Z)",
    "sortNameDesc": "పేరు (Z-A)",
    "sortPriceAsc": "ధర (తక్కువ-ఎక్కువ)",
    "sortPriceDesc": "ధర (ఎక్కువ-తక్కువ)",
    "sortQtyAsc": "పరిమాణం (తక్కువ-ఎక్కువ)",
    "sortQtyDesc": "పరిమాణం (ఎక్కువ-తక్కువ)",
    "showLowStock": "తక్కువ స్టాక్ మాత్రమే చూపించు",
    "showingLowStock": "తక్కువ స్టాక్ చూపిస్తోంది",
    "bulkUpload": "బల్క్ అప్లోడ్",
    "addProduct": "ఉత్పత్తిని జోడించండి",
    "loading": "ఉత్పత్తులు లోడ్ అవుతున్నాయి...",
    "error": "ఉత్పత్తులు లోడ్ చేయడంలో విఫలమైంది. దయచేసి మళ్లీ ప్రయత్నించండి.",
    "tryAgain": "మళ్లీ ప్రయత్నించండి",
    "noMatch": "మీ శోధనకు ఏ ఉత్పత్తులు సరిపోలలేదు.",
    "noLowStock": "తక్కువ స్టాక్ అంశాలు కనుగొనబడలేదు.",
    "noProducts": "ఏ ఉత్పత్తులు కనుగొనబడలేదు.",
    "clearFilters": "ఫిల్టర్లు క్లియర్ చేయండి",
    "lowStock": "తక్కువ స్టాక్",
    "inCart": "కార్ట్లో",
    "edit": "ఉత్పత్తిని సవరించండి",
    "delete": "ఉత్పత్తిని తొలగించండి",
    "price": "ధర",
    "inStock": "స్టాక్లో ఉంది",
    "addToCart": "కార్ట్కు జోడించండి",
    "outOfStock": "స్టాక్ లేదు",
    "formTitleAdd": "కొత్త ఉత్పత్తిని జోడించండి",
    "formTitleEdit": "ఉత్పత్తిని సవరించండి",
    "formImage": "ఉత్పత్తి చిత్రం",
    "formImageDrop": "చిత్రాన్ని డ్రాప్ చేయండి లేదా క్లిక్ చేయండి",
    "formImageReplace": "మార్చడానికి కొత్త చిత్రాన్ని అప్లోడ్ చేయండి",
    "formImageUpload": "ఉత్పత్తి చిత్రాన్ని అప్లోడ్ చేయండి",
    "formId": "ఉత్పత్తి ఐడీ (SKU)",
    "formIdPlaceholder": "ఉదా., LAP-APP-M1",
    "formName": "ఉత్పత్తి పేరు",
    "formNamePlaceholder": "ఉదా., Macbook Pro 14",
    "formCategory": "కేటగరీ",
    "formCategoryPlaceholder": "ఉదా., ఎలక్ట్రానిక్స్",
    "formPrice": "ధర (₹)",
    "formPricePlaceholder": "ఉదా., 150000",
    "formQuantity": "పరిమాణం",
    "formQuantityPlaceholder": "ఉదా., 25",
    "formReorder": "మళ్లీ ఆర్డర్ స్థాయి",
    "formReorderPlaceholder": "ఉదా., 10",
    "formCancel": "రద్దు చేయండి",
    "formSaving": "సేవ్ చేస్తోంది...",
    "formUpdating": "నవీకరిస్తోంది...",
    "formSave": "మార్పులను సేవ్ చేయండి",
    "formCreate": "ఉత్పత్తిని సృష్టించండి",
    "bulkTitle": "బల్క్ ఉత్పత్తి అప్లోడ్",
    "bulkStep1": "1. మీ డేటా సరైన ఫార్మాట్లో ఉందని నిర్ధారించడానికి CSV టెంప్లేట్ను డౌన్లోడ్ చేయండి.",
    "bulkStep2": "2. మీ ఉత్పత్తి డేటాను పూరించండి మరియు పూర్తి ఫైల్ను ఇక్కడ అప్లోడ్ చేయండి.",
    "bulkTemplate": "టెంప్లేట్ డౌన్లోడ్ చేయండి (.csv)",
    "bulkClick": "అప్లోడ్ చేయడానికి క్లిక్ చేయండి",
    "bulkFile": "CSV ఫైల్ (గరిష్టంగా 10MB)",
    "bulkClose": "మూసివేయండి",
    "bulkCancel": "రద్దు చేయండి",
    "bulkUploading": "అప్లోడ్ అవుతుంది...",
    "bulkUploadProcess": "అప్లోడ్ & ప్రాసెస్ చేయండి",
    "bulkSuccess": "అప్లోడ్ పూర్తయింది",
    "bulkAdded": "ఉత్పత్తులు విజయవంతంగా జోడించబడ్డాయి.",
    "bulkSkipped": "ఉత్పత్తులు దాటవేయబడ్డాయి (ఇప్పటికే ఉన్నాయి).",
    "bulkFailed": "ఉత్పత్తులు విఫలమైనవి.",
    "toastUpdateSuccess": "ఉత్పత్తి విజయవంతంగా నవీకరించబడింది",
    "toastCreateSuccess": "ఉత్పత్తి విజయవంతంగా సృష్టించబడింది",
    "toastError": "ఆపరేషన్ విఫలమైంది",
    "bulkErrorFile": "దయచేసి అప్లోడ్ చేయడానికి .csv ఫైల్ను ఎంచుకోండి.",
    "bulkErrorUpload": "అప్లోడ్ విఫలమైంది. దయచేసి ఫైల్ ఫార్మాట్ తనిఖీ చేయండి."
  },
  "productCard": {
    "lowStock": "తక్కువ స్టాక్",
    "inCart": "కార్ట్లో",
    "edit": "ఉత్పత్తిని సవరించండి",
    "delete": "ఉత్పత్తిని తొలగించండి",
    "unnamed": "పేరులేని ఉత్పత్తి",
    "uncategorized": "వర్గీకరించబడని",
    "price": "ధర",
    "inStock": "స్టాక్లో ఉంది",
    "addToCart": "కార్ట్కు జోడించండి",
    "outOfStock": "స్టాక్ లేదు",
    "errorStock": "లోపం: కార్ట్ తర్వాత స్టాక్లో కేవలం {{count}} మాత్రమే అందుబాటులో ఉంది.",
    "successAdd": "{{count}} x {{name}} కార్ట్కు జోడించబడింది!"
  },
  "customerList": {
    "title": "గ్రాహక డైరెక్టరీ",
    "matching": "సరిపోలుతుంది",
    "searchPlaceholder": "పేరు, ఇమెయిల్, లేదా మొబైల్ ద్వారా శోధించండి...",
    "sort": "క్రమబద్ధీకరించు:",
    "sortNameAsc": "పేరు (A-Z)",
    "sortNameDesc": "పేరు (Z-A)",
    "sortDateDesc": "చివరి కొనుగోలు (కొత్తది)",
    "sortDateAsc": "చివరి కొనుగోలు (పాతది)",
    "sortPurchaseDesc": "కొనుగోలులు (ఎక్కువ-తక్కువ)",
    "filter": "అన్నీ చూపించు",
    "filterInactive": "నిష్క్రియ (30+ రోజులు)",
    "emailAll": "అందరికీ ఇమెయిల్ చేయండి",
    "emailAllConfirm": "అన్ని {{count}} గ్రాహకులకు ఇమెయిల్ పంపాలా?",
    "tryAgain": "మళ్లీ ప్రయత్నించండి",
    "noMatch": "మీ శోధనకు ఏ గ్రాహకులు సరిపోలలేదు.",
    "noFilterMatch": "మీ ఫిల్టర్కు ఏ గ్రాహకులు సరిపోలలేదు.",
    "noCustomers": "గ్రాహకులు ఎవరూ కనుగొనబడలేదు.",
    "clearFilters": "ఫిల్టర్లు క్లియర్ చేయండి",
    "deleteConfirm": "\"{{name}}\" మరియు వారి మొత్తం కొనుగోలు చరిత్రను తొలగించాలా?",
    "deleteSuccess": "గ్రాహకుడు విజయవంతంగా తొలగించబడ్డాడు",
    "deleteError": "గ్రాహకుని తొలగించడంలో విఫలమైంది."
  },
  "customerCard": {
    "unnamed": "పేరులేని గ్రాహకుడు",
    "totalPurchases": "మొత్తం కొనుగోలులు",
    "lastPurchase": "చివరి కొనుగోలు",
    "sendEmail": "ఇమెయిల్ పంపండి",
    "viewHistory": "చరిత్రను వీక్షించండి",
    "delete": "గ్రాహకుని తొలగించండి",
    "deleteAria": "గ్రాహకుడిని తొలగించండి {{name}}"
  },
  "customerForm": {
    "title": "గ్రాహకుని జోడించండి",
    "name": "పేరు",
    "email": "ఇమెయిల్",
    "mobile": "మొబైల్",
    "save": "సేవ్ చేయండి"
  },
  "customerEdit": {
    "title": "గ్రాహకుని సవరించండి",
    "loading": "లోడ్ అవుతుంది...",
    "errorLoad": "గ్రాహకుడిని లోడ్ చేయడంలో విఫలమైంది:",
    "success": "గ్రాహకుడు విజయవంతంగా నవీకరించబడ్డాడు!",
    "errorUpdate": "నవీకరణ విఫలమైంది:"
  },
  "billList": {
    "matching": "సరిపోలే బిల్లులు",
    "showing": "బిల్లులు చూపిస్తున్నారు",
    "previous": "మునుపటి",
    "next": "తర్వాతి",
    "title": "బిల్ చరిత్ర",
    "searchPlaceholder": "బిల్లులు లేదా గ్రాహకులను శోధించండి...",
    "datePlaceholder": "తేదీ పరిధి ద్వారా ఫిల్టర్ చేయండి",
    "sortNewest": "కొత్తది ముందు",
    "sortOldest": "పాతది ముందు",
    "sortHigh": "అత్యధిక మొత్తం",
    "sortLow": "తక్కువ మొత్తం",
    "export": "ఎక్సెల్కు ఎగుమతి చేయండి",
    "exportSuccess": "{{count}} బిల్లులు ఎగుమతి చేయబడ్డాయి",
    "exportError": "ఎగుమతి చేయడానికి డేటా లేదు",
    "autoEmail": "ఆటో ఇమెయిల్",
    "headerId": "బిల్ ఐడీ",
    "headerCustomer": "గ్రాహకుడు",
    "headerTotal": "మొత్తం",
    "headerDate": "తేదీ",
    "headerPayment": "చెల్లింపు",
    "headerStatus": "స్థితి",
    "headerActions": "చర్యలు",
    "emptyState": "మీ ఫిల్టర్లకు ఏ బిల్లులు సరిపోలలేదు.",
    "emptyStateHint": "ఫిల్టర్లు లేదా తేదీ పరిధిని సర్దుబాటు చేయడానికి ప్రయత్నించండి",
    "statusCompleted": "పూర్తయింది",
    "paymentMethod": "నగదు",
    "downloadPDF": "PDF డౌన్లోడ్ చేయండి",
    "resendEmail": "ఇమెయిల్ మళ్లీ పంపండి",
    "downloading": "{{billId}} డౌన్లోడ్ అవుతుంది...",
    "downloadFailed": "డౌన్లోడ్ విఫలమైంది",
    "resendSuccess": "ఇమెయిల్ మళ్లీ పంపబడింది!",
    "resendFailed": "మళ్లీ పంపడం విఫలమైంది",
    "drawerTitle": "బిల్ వివరాలు",
    "drawerDate": "తేదీ & సమయం",
    "drawerTotal": "మొత్తం మొత్తం",
    "drawerCustomer": "గ్రాహకుడు",
    "drawerItems": "అంశాలు ({{count}})",
    "walkIn": "వాక్-ఇన్ గ్రాహకుడు",
    "noMobile": "మొబైల్ నంబర్ లేదు",
    "totalBills": "మొత్తం బిల్లులు",
    "totalRevenue": "మొత్తం ఆదాయం",
    "generateBill": "బిల్ జనరేట్ చేయండి"
  },
  "billForm": {
    "title": "కొత్త బిల్ సృష్టించండి",
    "customer": "గ్రాహకుడు",
    "selectCustomer": "గ్రాహకుని ఎంచుకోండి",
    "items": "అంశాలు",
    "selectProduct": "ఉత్పత్తిని ఎంచుకోండి",
    "addItem": "+ అంశాన్ని జోడించండి",
    "total": "మొత్తం:",
    "createBill": "బిల్ సృష్టించండి",
    "errorCustomer": "దయచేసి ఒక గ్రాహకుని ఎంచుకోండి",
    "errorCreate": "బిల్ సృష్టించడంలో లోపం",
    "success": "బిల్ విజయవంతంగా సృష్టించబడింది!"
  },
  "checkout": {
    "title": "మీ కార్ట్ని సమీక్షించండి",
    "empty": "మీ కార్ట్ ఖాళీగా ఉంది.",
    "summary": "సారాంశం",
    "subtotal": "ఉపమొత్తం",
    "taxes": "పన్నులు",
    "taxesValue": "చెక్అవుట్ వద్ద లెక్కించబడుతుంది",
    "total": "మొత్తం",
    "customerDetails": "గ్రాహక వివరాలు",
    "customerName": "గ్రాహకుని పేరు",
    "customerMobile": "మొబైల్ నంబర్ (తప్పనిసరి)",
    "customerEmail": "ఇమెయిల్ (రసీదు కోసం)",
    "generateBill": "బిల్ జనరేట్ చేయండి",
    "generatingBill": "బిల్ జనరేట్ అవుతుంది...",
    "errorMobile": "దయచేసి గ్రాహక మొబైల్ నంబర్ నమోదు చేయండి.",
    "errorEmptyCart": "మీ కార్ట్ ఖాళీగా ఉంది.",
    "billSuccess": "బిల్ {{billId}} విజయవంతంగా సృష్టించబడింది!",
    "billError": "బిల్ సృష్టించడంలో విఫలమైంది: {{error}}"
  },
  "history": {
    "title": "కొనుగోలు చరిత్ర",
    "backToCustomers": "గ్రాహకులకు తిరిగి వెళ్లండి",
    "loading": "గ్రాహక చరిత్ర లోడ్ అవుతుంది...",
    "error": "గ్రాహక చరిత్ర లోడ్ చేయడంలో విఫలమైంది",
    "notFound": "గ్రాహకుడు కనుగొనబడలేదు",
    "noHistory": "కొనుగోలు చరిత్ర కనుగొనబడలేదు",
    "noHistoryHint": "ఈ గ్రాహకుడు ఇంకా ఎటువంటి కొనుగోలులు చేయలేదు",
    "headerBill": "బిల్ ఐడీ",
    "headerDate": "తేదీ & సమయం",
    "headerTotal": "మొత్తం మొత్తం",
    "headerActions": "చర్యలు",
    "download": "PDF డౌన్లోడ్ చేయండి",
    "downloading": "బిల్ {{billId}} డౌన్లోడ్ అవుతుంది...",
    "downloadSuccess": "PDF విజయవంతంగా డౌన్లోడ్ అయ్యింది",
    "downloadFailed": "PDF డౌন్లోడ్ చేయడంలో విఫలమైంది",
    "totalPurchases": "మొత్తం కొనుగోలులు",
    "purchaseSummary": "కొనుగోలు సారాంశం",
    "totalBills": "మొత్తం బిల్లులు",
    "totalSpent": "మొత్తం ఖర్చు",
    "avgBill": "సగటు బిల్"
  },
  "reports": {
    "title": "ఎగ్జిక్యూటివ్ రిపోర్ట్ జనరేటర్",
    "subtitle": "AI-శక్తితో కూడిన అంతర్దృష్టులు మరియు ప్రొఫెషనల్ PDF ఎగుమతులతో సమగ్ర వ్యాపార బుద్ధిమత్త రిపోర్ట్లను రూపొందించండి.",
    "dateRange": "తేదీ పరిధి",
    "selectRange": "తేదీ పరిధి ఎంచుకోండి",
    "generate": "రిపోర్ట్ జనరేట్ చేయండి",
    "generating": "జనరేట్ అవుతుంది...",
    "download": "PDF ఎగుమతి చేయండి",
    "downloading": "డౌన్లోడ్ అవుతుంది...",
    "newReport": "కొత్త రిపోర్ట్",
    "errorDate": "దయచేసి చెల్లుబాటు అయ్యే తేదీ పరిధిని ఎంచుకోండి.",
    "errorStartDate": "ప్రారంభ తేదీ ముగింపు తేదీకి తర్వాత ఉండకూడదు.",
    "loading": "రిపోర్ట్ జనరేట్ అవుతుంది",
    "loadingSub": "డేటా కంపైల్ చేయబడుతోంది మరియు అంతర్దృష్టులు రూపొందించబడుతున్నాయి...",
    "placeholderTitle": "రిపోర్ట్లను రూపొందించడానికి సిద్ధంగా ఉంది",
    "placeholderSub": "సమగ్ర రిపోర్ట్ సృష్టించడానికి మీ తేదీ పరిధిని ఎంచుకోండి మరియు జనరేట్ పై క్లిక్ చేయండి.",
    "placeholder1": "విక్రయాల విశ్లేషణ",
    "placeholder2": "AI అంతర్దృష్టులు",
    "placeholder3": "PDF ఎగుమతి"
  },
  "reminder": {
    "title": "నెలవారీ కొనుగోలు రిమైండర్లు",
    "button": "నెలవారీ రిమైండర్లు పంపండి",
    "sending": "పంపబడుతోంది...",
    "success": "రిమైండర్లు విజయవంతంగా ట్రిగర్ చేయబడ్డాయి!",
    "error": "రిమైండర్లను ట్రిగర్ చేయడంలో విఫలమైంది"
  },
  "profile": {
    "title": "నా ప్రొఫైల్",
    "notLoggedIn": "మీరు లాగిన్ కాలేదు.",
    "email": "ఇమెయిల్",
    "role": "పాత్ర",
    "tokenIssued": "టోకన్ జారీ చేయబడింది",
    "tokenExpires": "టోకన్ గడువు ముగియు సమయం"
  },
  "privateRoute": {
    "denied": "ప్రవేశం నిరాకరించబడింది - సరిపోని అనుమతులు."
  },
  "errors": {
    "noToken": "బ్యాకెండ్ నుండి యాక్సెస్ టోకన్ అందలేదు.",
    "noRefresh": "రిఫ్రెష్ టోకన్ కనుగొనబడలేదు",
    "refreshFailed": "టోకన్ రిఫ్రెష్ విఫలమైంది"
  },
  "common": {
    "goBack": "వెనక్కి వెళ్లండి",
    "downloading": "డౌన్లోడ్ అవుతుంది...",
    "previous": "మునుపటి",
    "next": "తర్వాతి"
  }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\main.jsx
--------------------------------------------------------------------
import React from "react";
import ReactDOM from "react-dom/client";
import { createBrowserRouter, RouterProvider, Navigate } from "react-router-dom";
import "./index.css";
import "react-datepicker/dist/react-datepicker.css";
import { CartProvider } from "./context/CartContext";
import { ToastProvider } from "./context/ToastContext";
import { ThemeProvider } from "./context/ThemeContext";

import './i18n'; // <-- Your i18n config

// --- Import All Components ---
// Layouts & Root
import App from "./App";
import MainLayout from './components/layout/MainLayout';
import AuthLayout from './components/layout/AuthLayout';
import PrivateRoute from "./PrivateRoute";
// Auth Pages
import Login from './components/auth/Login';
import Signup from './components/auth/Signup';
import OAuth2RedirectHandler from './components/auth/OAuth2RedirectHandler';
// App Pages
import AnalyticsDashboard from './components/analytics/AnalyticsDashboard';
import ProductList from './components/products/ProductList';
import BillList from './components/bills/BillList';
import BillForm from './components/bills/BillForm';
import CustomerList from './components/customers/CustomerList';
import CustomerHistory from './components/customers/CustomerHistory';
import ProfilePage from "./components/profile/ProfilePage";
import CheckoutPage from "./components/checkout/CheckoutPage";
import ReportGenerator from "./components/reports/summary/ReportGenerator";
import SalesReportText from './components/reports/text/SalesReportText'; // <-- Was missing this import

// --- Define Router Structure ---
const router = createBrowserRouter([
  {
    element: <App />,
    children: [
      // 1. Auth Routes
      {
        element: <AuthLayout />,
        children: [
          { path: "/login", element: <Login /> },
          { path: "/signup", element: <Signup /> },
          { path: "/login/success", element: <OAuth2RedirectHandler /> },
        ]
      },
      // 2. Protected App Routes
      {
        element: (
          <PrivateRoute roles={[]}> {/* This wrapper remains */}
            <MainLayout />
          </PrivateRoute>
        ),
        children: [
          { path: "/", element: <Navigate to="/dashboard" replace /> },
          { path: "/dashboard", element: <AnalyticsDashboard /> },
          { path: "/profile", element: <ProfilePage /> },
          { path: "/checkout", element: <CheckoutPage /> },

          // --- ALL PrivateRoute WRAPPERS RESTORED ---
          { path: "/products", element: <PrivateRoute roles={['OWNER', 'MANAGER']}><ProductList /></PrivateRoute> },
          { path: "/bills", element: <PrivateRoute roles={['MANAGER', 'OWNER']}><BillList /></PrivateRoute> },
          { path: "/bills/new", element: <PrivateRoute roles={['MANAGER', 'OWNER']}><BillForm /></PrivateRoute> },
          { path: "/customers", element: <PrivateRoute roles={['OWNER', 'MANAGER', 'CASHIER']}><CustomerList /></PrivateRoute> },
          { path: "/customers/:id/history", element: <PrivateRoute roles={['OWNER', 'MANAGER', 'CASHIER']}><CustomerHistory /></PrivateRoute> },

          // Report Routes
          { path: "/reports", element: <Navigate to="/reports/summary" replace /> },
          { path: "/reports/text", element: <PrivateRoute roles={['OWNER']}><SalesReportText /></PrivateRoute> },
          { path: "/reports/summary", element: <PrivateRoute roles={['OWNER', 'MANAGER']}><ReportGenerator /></PrivateRoute> },

          // Fallback
          { path: "*", element: <Navigate to="/dashboard" replace /> }
        ]
      }
    ]
  }
]);

ReactDOM.createRoot(document.getElementById("root")).render(
  <React.StrictMode>
    <ToastProvider>
      <CartProvider>
        <ThemeProvider>
          <RouterProvider router={router} />
        </ThemeProvider>
      </CartProvider>
    </ToastProvider>
  </React.StrictMode>
);
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\PrivateRoute.jsx
--------------------------------------------------------------------
import React from 'react';
import { Navigate } from 'react-router-dom';
import authService from './services/authService';
import { useTranslation } from 'react-i18next'; // Import

export default function PrivateRoute({ children, roles = [] }) {
  const { t } = useTranslation(); // Get hook

  try {
    const user = authService.getUserFromToken();

    if (!user) {
      console.warn("PrivateRoute: No user found, redirecting to login.");
      return <Navigate to="/login" />;
    }

    const userRoles = user.roles?.length
      ? user.roles
      : user.role
      ? [user.role]
      : [];

    const hasAccess =
      roles.length === 0 ||
      roles.some(r => userRoles.includes(r));

    if (!hasAccess) {
      console.warn("PrivateRoute: Access denied for roles", userRoles);
      return (
        <div className="p-4 text-red-600 dark:text-red-400 font-semibold text-center">
          {t('privateRoute.denied')}
        </div>
      );
    }

    return children;
  } catch (err) {
    console.error("PrivateRoute crashed:", err);
    authService.logout();
    return <Navigate to="/login" />;
  }
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\services
--------------------------------------------------------------------
Contents:
analyticsService.js
authService.js
billService.js
customerService.js
notificationService.js
paymentService.js
productService.js
reportService.js
syncService.js
userService.js

====================================================================
📄 File: G:\FINALCODE\frontend\src\services\analyticsService.js
--------------------------------------------------------------------
import api from '../api/apiClient';

// Fetch daily sales analytics
export async function getDailyAnalytics() {
  const res = await api.get('/api/analytics/daily');
  return res.data;
}

// Fetch monthly sales analytics
export async function getMonthlyAnalytics() {
  const res = await api.get('/api/analytics/monthly');
  return res.data;
}

// Fetch top products analytics
export async function getTopProducts() {
  const res = await api.get('/api/analytics/top-products');
  return res.data;
}

// Fetch revenue trend data
export async function getRevenueTrend() {
  const res = await api.get('/api/analytics/revenue-trend');
  return res.data;
}




--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\services\authService.js
--------------------------------------------------------------------
import api from '../api/apiClient';
import jwtDecode from 'jwt-decode';
import i18n from '../i18n'; // <-- Import i18n instance

// LocalStorage key constants
const ACCESS_KEY = 'sr_access';
const REFRESH_KEY = 'sr_refresh';

/**
 * Save tokens to localStorage
 */
function saveTokens({ accessToken, refreshToken }) {
  if (accessToken) localStorage.setItem(ACCESS_KEY, accessToken);
  if (refreshToken) localStorage.setItem(REFRESH_KEY, refreshToken);
}

/**
 * Get stored tokens
 */
function getAccessToken() {
  return localStorage.getItem(ACCESS_KEY);
}
function getRefreshToken() {
  return localStorage.getItem(REFRESH_KEY);
}

/**
 * Clear tokens from storage (logout)
 */
function clearTokens() {
  localStorage.removeItem(ACCESS_KEY);
  localStorage.removeItem(REFRESH_KEY);
}

/**
 * Authenticate user with backend
 * POST /api/auth/login
 */
async function login({ email, password }) {
  const res = await api.post('/api/auth/login', { email, password });
  const payload = res.data;

  if (payload?.accessToken) {
    saveTokens({
      accessToken: payload.accessToken,
      refreshToken: payload.refreshToken || ''
    });
  } else if (payload?.token) {
    saveTokens({
      accessToken: payload.token,
      refreshToken: payload.refreshToken || ''
    });
  } else {
    // Use translated error
    throw new Error(i18n.t('errors.noToken'));
  }

  return payload;
}

/**
 * Create a new user account
 * POST /api/auth/signup
 */
async function signup(req) {
  const res = await api.post('/api/auth/signup', req);
  return res.data;
}

/**
 * Refresh JWT using refresh token
 * POST /api/auth/refresh
 */
async function refresh() {
  const refreshToken = getRefreshToken();
  if (!refreshToken) throw new Error(i18n.t('errors.noRefresh'));

  const res = await api.post('/api/auth/refresh', refreshToken, {
    headers: { 'Content-Type': 'text/plain' }
  });

  const newAccess = res.data?.accessToken;
  if (newAccess) {
    saveTokens({ accessToken: newAccess });
    return { accessToken: newAccess };
  }

  throw new Error(i18n.t('errors.refreshFailed'));
}

/**
 * Decode JWT and return structured user info
 */
function getUserFromToken() {
  const token = getAccessToken();
  if (!token) return null;

  try {
    const decoded = jwtDecode(token);
    const email = decoded.sub || decoded.email || "unknown@domain.com";
    const role = decoded.role || (decoded.roles ? decoded.roles[0] : "CUSTOMER");

    return {
      email,
      name: email.split("@")[0],
      role: role.toUpperCase(),
      exp: decoded.exp,
      iat: decoded.iat,
    };
  } catch (err) {
    console.error("JWT decode error:", err);
    return null;
  }
}

function getUserRole() {
  const token = getAccessToken();
  if (!token) return null;
  try {
    const decoded = jwtDecode(token);
    return decoded.role || (decoded.roles ? decoded.roles[0] : null);
  } catch (err) {
    console.error('Error decoding JWT for role:', err);
    return null;
  }
}

/**
 * Logout user
 */
function logout() {
  clearTokens();
}

export default {
  login,
  signup,
  refresh,
  saveTokens,
  getAccessToken,
  getRefreshToken,
  clearTokens,
  getUserFromToken,
  logout,
  getUserRole
};
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\services\billService.js
--------------------------------------------------------------------
// src/services/billService.js
import api from '../api/apiClient';

/**
 * Create a new bill
 */
export async function createBill(bill) {
  try {
    const res = await api.post('/api/bills', bill, {
      headers: { 'Content-Type': 'application/json' },
    });
    return res.data;
  } catch (err) {
    console.error('Failed to create bill:', err);
    throw err.response?.data || err;
  }
}

/**
 * Get a single bill by ID
 */
export async function getBill(billId) {
  try {
    const res = await api.get(`/api/bills/${billId}`);
    return res.data;
  } catch (err) {
    console.error(`Failed to fetch bill ${billId}:`, err);
    throw err.response?.data || err;
  }
}

/**
 * Get all bills
 */
export async function listBills() {
  try {
    const res = await api.get('/api/bills');
    return res.data;
  } catch (err) {
    console.error('Failed to list bills:', err);
    throw err.response?.data || err;
  }
}

/**
 * Download bill PDF
 */
export async function downloadBillPdf(billId, token = null) {
  try {
    if (!token) {
      throw new Error('PDF access token is required');
    }

    const url = `/api/bills/${billId}/pdf?token=${encodeURIComponent(token)}`;
    const res = await api.get(url, {
      responseType: 'blob'
    });
    return res.data;
  } catch (err) {
    console.error(`Failed to download PDF for bill ${billId}:`, err);
    throw err.response?.data || err;
  }
}

/**
 * Generate PDF access token for existing bill
 */
export async function generatePdfToken(billId) {
  try {
    const res = await api.post(`/api/bills/${billId}/generate-token`);
    return res.data;
  } catch (err) {
    console.error(`Failed to generate PDF token for bill ${billId}:`, err);
    throw err.response?.data || err;
  }
}

/**
 * Bulk upload bills via CSV
 */
export async function bulkUploadBills(csvFile) {
  try {
    const formData = new FormData();
    formData.append('file', csvFile);

    const res = await api.post('/api/bills/bulk', formData, {
      headers: {
        'Content-Type': 'multipart/form-data'
      }
    });
    return res.data;
  } catch (err) {
    console.error('Failed to bulk upload bills:', err);
    throw err.response?.data || err;
  }
}

/**
 * Resend bill email to customer
 */
export async function resendBillEmail(billId) {
  try {
    const res = await api.post(`/api/bills/resend-email/${billId}`);
    return res.data;
  } catch (err) {
    console.error(`Failed to resend email for bill ${billId}:`, err);
    throw err.response?.data || err;
  }
}

/**
 * Utility function to handle PDF download in browser
 */
export function handlePdfDownload(blob, billId) {
  // Create blob URL
  const blobUrl = window.URL.createObjectURL(blob);

  // Create temporary link and trigger download
  const link = document.createElement('a');
  link.href = blobUrl;
  link.download = `Bill_${billId}.pdf`;
  document.body.appendChild(link);
  link.click();

  // Clean up
  document.body.removeChild(link);
  window.URL.revokeObjectURL(blobUrl);
}

/**
 * Complete PDF download flow with token generation
 */
export async function downloadBillPdfWithFlow(billId) {
  try {
    // First generate a token
    const tokenResponse = await generatePdfToken(billId);
    const { pdfAccessToken } = tokenResponse;

    // Then download the PDF
    const pdfBlob = await downloadBillPdf(billId, pdfAccessToken);

    return pdfBlob;
  } catch (error) {
    console.error('PDF download flow failed:', error);
    throw error;
  }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\services\customerService.js
--------------------------------------------------------------------
// src/services/customerService.js
import api from '../api/apiClient'

/**
 * Create a new customer
 */
export async function createCustomer(customer) {
  try {
    const res = await api.post('/api/customers', customer)
    return res.data
  } catch (err) {
    console.error('Failed to create customer:', err)
    throw err.response?.data || err
  }
}

/**
 * Get a single customer by ID
 */
export async function getCustomer(id) {
  try {
    const res = await api.get(`/api/customers/${id}`)
    return res.data
  } catch (err) {
    console.error(`Failed to fetch customer ${id}:`, err)
    throw err.response?.data || err
  }
}

/**
 * Get all customers
 */
export async function listCustomers() {
  try {
    const res = await api.get('/api/customers')
    return res.data
  } catch (err) {
    console.error('Failed to list customers:', err)
    throw err.response?.data || err
  }
}

/**
 * Update an existing customer
 */
export async function updateCustomer(id, customer) {
  try {
    const res = await api.put(`/api/customers/${id}`, customer)
    return res.data
  } catch (err) {
    console.error(`Failed to update customer ${id}:`, err)
    throw err.response?.data || err
  }
}

/**
 * Delete a customer by ID
 */
export async function deleteCustomer(id) {
  try {
    const res = await api.delete(`/api/customers/${id}`)
    return res.data
  } catch (err) {
    console.error(`Failed to delete customer ${id}:`, err)
    throw err.response?.data || err
  }
}

/**
 * Get customer purchase history (with optional date range)
 */
export async function getPurchaseHistory(customerId, startDate, endDate) {
  try {
    const params = {}
    if (startDate) params.startDate = startDate
    if (endDate) params.endDate = endDate

    const res = await api.get(`/api/customers/${customerId}/purchase-history`, { params })
    return res.data
  } catch (err) {
    console.error(`Failed to fetch purchase history for ${customerId}:`, err)
    throw err.response?.data || err
  }
}

/**
 * Trigger monthly purchase reminders manually
 */
export async function triggerReminders() {
  try {
    const res = await api.post('/api/customers/reminders')
    return res.data
  } catch (err) {
    console.error('Failed to trigger reminders:', err)
    throw err.response?.data || err
  }
}

/**
 * Send a custom email to a list of customers
 * @param {Object} emailRequest - { customerIds: string[], subject: string, body: string }
 */
export async function sendCustomEmail(emailRequest) {
  try {
    const res = await api.post('/api/customers/send-email', emailRequest)
    return res.data
  } catch (err) {
    console.error('Failed to send custom email:', err)
    throw err.response?.data || err
  }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\services\notificationService.js
--------------------------------------------------------------------
import api from '../api/apiClient';

// Send a notification to a user (JSON body)
export async function sendNotification(notificationRequest) {
  const res = await api.post('/api/notifications', notificationRequest);
  return res.data;
}

// Get all notifications
export async function listNotifications() {
  const res = await api.get('/api/notifications');
  return res.data;
}

// Send a test notification email
export async function sendTestNotification(email, message) {
  const res = await api.post(`/api/notifications/test?email=${encodeURIComponent(email)}&message=${encodeURIComponent(message)}`);
  return res.data;
}

// Subscribe to push notifications
export async function subscribePush(subscription) {
  const res = await api.post('/api/notifications/subscribe', subscription);
  return res.data;
}

// Get VAPID public key for push notification setup
export async function getVapidPublicKey() {
  const res = await api.get('/api/notifications/vapid-public-key');
  return res.data;
}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\services\paymentService.js
--------------------------------------------------------------------
import api from '../api/apiClient';

// Create a new payment
export async function createPayment(payment) {
  const res = await api.post('/api/payments', payment);
  return res.data;
}

// Get payment by ID
export async function getPayment(paymentId) {
  const res = await api.get(`/api/payments/${paymentId}`);
  return res.data;
}

// List all payments
export async function listPayments() {
  const res = await api.get('/api/payments');
  return res.data;
}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\services\productService.js
--------------------------------------------------------------------
import api from '../api/apiClient';

export async function listProducts() {
  const res = await api.get('/api/products');
  return res.data;
}

export async function getProduct(id) {
  // Use the productId for the API call, which is what the backend expects
  const res = await api.get(`/api/products/${id}`);
  return res.data;
}

// JSON product creation (as in controller: consumes = application/json)
export async function createProductJson(productRequest) {
  const res = await api.post('/api/products', productRequest, {
    headers: { 'Content-Type': 'application/json' }
  });
  return res.data;
}

// multipart (with image)
export async function createProductMultipart(productRequest, imageFile) {
  const form = new FormData();
  form.append("product", JSON.stringify(productRequest)); // must match @RequestParam("product")
  if (imageFile) form.append("imageFile", imageFile); // must match @RequestPart("imageFile")

  const res = await api.post("/api/products", form, {
    headers: { "Content-Type": "multipart/form-data" },
  });
  return res.data;
}

// CSV bulk upload endpoint (if implemented)
export async function bulkUploadProducts(csvFile) {
  const form = new FormData();
  form.append('file', csvFile);
  const res = await api.post('/api/products/bulk', form, {
    headers: { 'Content-Type': 'multipart/form-data' }
  });
  return res.data;
}

// --- MODIFIED: Renamed to match modal logic ---
// Update product with JSON data
export async function updateProduct(productId, productData) {
  const res = await api.put(`/api/products/${productId}`, productData, {
     headers: { "Content-Type": "application/json" },
  });
  return res.data;
}

// --- NEW: Update product with multipart data (for image changes) ---
export async function updateProductMultipart(productId, productData, imageFile) {
  const form = new FormData();
  form.append("product", JSON.stringify(productData));
  if (imageFile) form.append("imageFile", imageFile);

  const res = await api.put(`/api/products/${productId}`, form, {
    headers: { "Content-Type": "multipart/form-data" },
  });
  return res.data;
}

export async function deleteProduct(productId) {
  const res = await api.delete(`/api/products/${productId}`);
  return res.data;
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\services\reportService.js
--------------------------------------------------------------------
import api from '../api/apiClient';

/**
 * Fetches the combined JSON data for the report generator.
 * @param {object} params - { startDate, endDate, lowStockThreshold, expiryDays }
 */
export async function getFullReportData(params) {
  try {
    const res = await api.get('/api/reports/full', { params });
    return res.data;
  } catch (err) {
    console.error('Failed to fetch full report:', err);
    throw err.response?.data || err;
  }
}

/**
 * Downloads the full report as a PDF blob.
 * @param {object} params - { startDate, endDate, lowStockThreshold, expiryDays }
 */
export async function downloadFullReportPdf(params) {
  try {
    const res = await api.get('/api/reports/full/pdf', {
      params,
      responseType: 'blob', // <-- This is crucial!
    });
    return res.data; // This will be a Blob
  } catch (err) {
    console.error('Failed to download PDF report:', err);
    throw err.response?.data || err;
  }
}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\services\syncService.js
--------------------------------------------------------------------
import api from '../api/apiClient';

// Sync pending data (for offline or queued data)
export async function syncPendingData() {
  const res = await api.post('/api/sync/pending');
  return res.data;
}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\services\userService.js
--------------------------------------------------------------------
import api from '../api/apiClient';

// Create a new user (OWNER only)
export async function createUser(userRequest) {
  const res = await api.post('/api/users', userRequest);
  return res.data;
}

// Get all users
export async function listUsers() {
  const res = await api.get('/api/users');
  return res.data;
}

// Get user by ID
export async function getUser(id) {
  const res = await api.get(`/api/users/${id}`);
  return res.data;
}

// Update user details
export async function updateUser(id, userRequest) {
  const res = await api.put(`/api/users/${id}`, userRequest);
  return res.data;
}

// Delete user by ID
export async function deleteUser(id) {
  const res = await api.delete(`/api/users/${id}`);
  return res.data;
}

--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\utils
--------------------------------------------------------------------
Contents:
jwt.js

====================================================================
📄 File: G:\FINALCODE\frontend\src\utils\jwt.js
--------------------------------------------------------------------
import jwtDecode from 'jwt-decode'

export function decodeToken(token) {
  try {
    return jwtDecode(token)
  } catch {
    return null
  }
}

export function getRoles(token) {
  const decoded = decodeToken(token)
  return decoded?.roles || []
}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\tailwind.config.js
--------------------------------------------------------------------
const defaultTheme = require('tailwindcss/defaultTheme');

module.exports = {
  darkMode: 'class', // <-- ADD THIS LINE
  content: ['./index.html', './src/**/*.{js,jsx}'],
  theme: {
    extend: {
      // NEW: Add fonts from your prompt
      fontFamily: {
        sans: ['Inter', 'system-ui', 'sans-serif'],
        display: ['Poppins', 'Inter', 'sans-serif'],
      },
      // Animation for background (if needed)
      keyframes: {
        'gradient-xy': {
          '0%, 100%': { 'background-position': '0% 50%' },
          '50%': { 'background-position': '100% 50%' },
        },
      },
      animation: {
        'gradient-xy': 'gradient-xy 15s ease infinite',
      },
    },
  },
  // --- ADDED ASPECT RATIO PLUGIN ---
  plugins: [
    require('@tailwindcss/aspect-ratio'),
  ],
};
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\vite.config.mjs
--------------------------------------------------------------------

import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'

// https://vite.dev/config/
export default defineConfig({
  plugins: [react()],
  server: { port: 5173 }
})

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\full_project_code.txt
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE
--------------------------------------------------------------------
Contents:
.idea
backend
frontend
full_project_code.txt
README.md

====================================================================
📁 Directory: G:\FINALCODE\backend
--------------------------------------------------------------------
Contents:
.gitattributes
.github
.gitignore
.gitkeep
.mvn
mvnw
mvnw.cmd
pom.xml
src
target

====================================================================
📄 File: G:\FINALCODE\backend\.gitattributes
--------------------------------------------------------------------
/mvnw text eol=lf
*.cmd text eol=crlf

--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\backend\.github
--------------------------------------------------------------------
Contents:
java-upgrade

====================================================================
📁 Directory: G:\FINALCODE\backend\.github\java-upgrade
--------------------------------------------------------------------
Contents:
.gitignore
20251103051453
20251104035746

====================================================================
📄 File: G:\FINALCODE\backend\.github\java-upgrade\.gitignore
--------------------------------------------------------------------

*

--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\backend\.github\java-upgrade\20251103051453
--------------------------------------------------------------------
Contents:
logs
progress.md

====================================================================
📁 Directory: G:\FINALCODE\backend\.github\java-upgrade\20251103051453\logs
--------------------------------------------------------------------
Contents:
0.log

====================================================================
📄 File: G:\FINALCODE\backend\.github\java-upgrade\20251103051453\logs\0.log
--------------------------------------------------------------------
2025-11-03T05:14:53.780Z [INFO] ----------------------invoke generate_upgrade_plan_for_java_project----------------------
2025-11-03T05:14:53.781Z [INFO] [Tool.invoke]({name: generate_upgrade_plan_for_java_project, input: {
  "projectPath": "g:\\CapsFinal\\backend",
  "targetJavaVersion": "21"
}}).
2025-11-03T05:14:53.782Z [INFO] [Plan.tryStartTask]({tool:generate_upgrade_plan_for_java_project, nextTask:{type:undefined, tool:undefined}}
2025-11-03T05:14:53.782Z [INFO] [Plan.tryStartTask]: no next task, create new one.
2025-11-03T05:14:53.783Z [INFO] [Plan.createTaskAtStart]({tool: generate_upgrade_plan_for_java_project, input: {
  "projectPath": "g:\\CapsFinal\\backend",
  "targetJavaVersion": "21",
  "sessionId": "20251103051453"
}}).
2025-11-03T05:14:53.785Z [INFO] [Plan.tryStartTask]: starting task generatePlan
2025-11-03T05:14:53.785Z [INFO] [Task.start](): Starting task generatePlan
2025-11-03T05:14:53.787Z [INFO] [Task.start](1): Started task generatePlan
2025-11-03T05:14:54.571Z [INFO] [Tool.invoke] validate GitHub Copilot license.
2025-11-03T05:15:29.129Z [INFO] Copilot user info:{
  "access_type_sku": "free_limited_copilot",
  "analytics_tracking_id": "4697fb2576b19c2bdfe7ad0bc4807eb7",
  "assigned_date": "2025-10-11T17:16:14+05:30",
  "can_signup_for_limited": false,
  "chat_enabled": true,
  "copilot_plan": "individual",
  "organization_login_list": [],
  "organization_list": [],
  "limited_user_quotas": {
    "chat": 130,
    "completions": 3982
  },
  "limited_user_subscribed_day": 11,
  "limited_user_reset_date": "2025-11-11",
  "monthly_quotas": {
    "chat": 500,
    "completions": 4000
  }
}
2025-11-03T05:15:29.131Z [WARN] "GitHub Copilot app modernization - upgrade for Java" and its tools are only available for GitHub Copilot "Pro", "Pro+", "Business" and "Enterprise" plans.
2025-11-03T05:15:29.131Z [ERROR] [Tool.invoke] error occurs when invoking tool generate_upgrade_plan_for_java_project: UnsupportedCopilotPlanError: "GitHub Copilot app modernization - upgrade for Java" and its tools are only available for GitHub Copilot "Pro", "Pro+", "Business" and "Enterprise" plans.. Please upgrade your GitHub Copilot plan to use this feature or upgrading this project using other tools you prefer..
2025-11-03T05:15:29.133Z [INFO] [Task.complete](1): Completing task generatePlan
2025-11-03T05:15:29.134Z [INFO] ----------------------invoked generate_upgrade_plan_for_java_project----------------------
2025-11-03T05:15:29.134Z [INFO] [Task.complete](1): Completed task generatePlan

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\.github\java-upgrade\20251103051453\progress.md
--------------------------------------------------------------------
# Upgrade Progress

  ### ❗ Generate Upgrade Plan
  
  <details>
      <summary>[ click to toggle details ]</summary>
  
  #### Errors
  - "GitHub Copilot app modernization - upgrade for Java" and its tools are only available for GitHub Copilot "Pro", "Pro+", "Business" and "Enterprise" plans.. Please upgrade your GitHub Copilot plan to use this feature or upgrading this project using other tools you prefer.
  </details>
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\backend\.github\java-upgrade\20251104035746
--------------------------------------------------------------------
Contents:
logs
progress.md

====================================================================
📁 Directory: G:\FINALCODE\backend\.github\java-upgrade\20251104035746\logs
--------------------------------------------------------------------
Contents:
0.log

====================================================================
📄 File: G:\FINALCODE\backend\.github\java-upgrade\20251104035746\logs\0.log
--------------------------------------------------------------------
2025-11-04T03:57:46.357Z [INFO] ----------------------invoke generate_upgrade_plan_for_java_project----------------------
2025-11-04T03:57:46.367Z [INFO] [Tool.invoke]({name: generate_upgrade_plan_for_java_project, input: {
  "projectPath": "g:\\CapsFinal\\backend",
  "targetJavaVersion": "21"
}}).
2025-11-04T03:57:46.368Z [INFO] [Plan.tryStartTask]({tool:generate_upgrade_plan_for_java_project, nextTask:{type:undefined, tool:undefined}}
2025-11-04T03:57:46.368Z [INFO] [Plan.tryStartTask]: no next task, create new one.
2025-11-04T03:57:46.369Z [INFO] [Plan.createTaskAtStart]({tool: generate_upgrade_plan_for_java_project, input: {
  "projectPath": "g:\\CapsFinal\\backend",
  "targetJavaVersion": "21",
  "sessionId": "20251104035746"
}}).
2025-11-04T03:57:46.370Z [INFO] [Plan.tryStartTask]: starting task generatePlan
2025-11-04T03:57:46.370Z [INFO] [Task.start](): Starting task generatePlan
2025-11-04T03:57:46.371Z [INFO] [Task.start](1): Started task generatePlan
2025-11-04T03:57:46.411Z [INFO] [Tool.invoke] validate GitHub Copilot license.
2025-11-04T03:57:46.872Z [INFO] Copilot user info:{
  "access_type_sku": "free_limited_copilot",
  "analytics_tracking_id": "4697fb2576b19c2bdfe7ad0bc4807eb7",
  "assigned_date": "2025-10-11T17:16:14+05:30",
  "can_signup_for_limited": false,
  "chat_enabled": true,
  "copilot_plan": "individual",
  "organization_login_list": [],
  "organization_list": [],
  "limited_user_quotas": {
    "chat": 120,
    "completions": 3752
  },
  "limited_user_subscribed_day": 11,
  "limited_user_reset_date": "2025-11-11",
  "monthly_quotas": {
    "chat": 500,
    "completions": 4000
  }
}
2025-11-04T03:57:46.873Z [WARN] "GitHub Copilot app modernization - upgrade for Java" and its tools are only available for GitHub Copilot "Pro", "Pro+", "Business" and "Enterprise" plans.
2025-11-04T03:57:46.873Z [ERROR] [Tool.invoke] error occurs when invoking tool generate_upgrade_plan_for_java_project: UnsupportedCopilotPlanError: "GitHub Copilot app modernization - upgrade for Java" and its tools are only available for GitHub Copilot "Pro", "Pro+", "Business" and "Enterprise" plans.. Please upgrade your GitHub Copilot plan to use this feature or upgrading this project using other tools you prefer..
2025-11-04T03:57:46.874Z [INFO] [Task.complete](1): Completing task generatePlan
2025-11-04T03:57:46.874Z [INFO] ----------------------invoked generate_upgrade_plan_for_java_project----------------------
2025-11-04T03:57:46.875Z [INFO] [Task.complete](1): Completed task generatePlan

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\.github\java-upgrade\20251104035746\progress.md
--------------------------------------------------------------------
# Upgrade Progress

  ### ❗ Generate Upgrade Plan
  
  <details>
      <summary>[ click to toggle details ]</summary>
  
  #### Errors
  - "GitHub Copilot app modernization - upgrade for Java" and its tools are only available for GitHub Copilot "Pro", "Pro+", "Business" and "Enterprise" plans.. Please upgrade your GitHub Copilot plan to use this feature or upgrading this project using other tools you prefer.
  </details>
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\.gitignore
--------------------------------------------------------------------
HELP.md
target/
.mvn/wrapper/maven-wrapper.jar
!**/src/main/**/target/
!**/src/test/**/target/

### STS ###
.apt_generated
.classpath
.factorypath
.project
.settings
.springBeans
.sts4-cache
.idea/runConfigurations/
### IntelliJ IDEA ###
.idea
*.iws
*.iml
*.ipr

### NetBeans ###
/nbproject/private/
/nbbuild/
/dist/
/nbdist/
/.nb-gradle/
build/
!**/src/main/**/build/
!**/src/test/**/build/

### VS Code ###
.vscode/

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\.gitkeep
--------------------------------------------------------------------

--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\backend\.mvn
--------------------------------------------------------------------
Contents:
wrapper

====================================================================
📁 Directory: G:\FINALCODE\backend\.mvn\wrapper
--------------------------------------------------------------------
Contents:
maven-wrapper.properties

====================================================================
📄 File: G:\FINALCODE\backend\.mvn\wrapper\maven-wrapper.properties
--------------------------------------------------------------------
distributionType=only-script
distributionUrl=https://repo.maven.apache.org/maven2/org/apache/maven/apache-maven/3.9.11/apache-maven-3.9.11-bin.zip

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\mvnw
--------------------------------------------------------------------
#!/bin/sh
# ----------------------------------------------------------------------------
# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at
#
#    http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.
# ----------------------------------------------------------------------------

# ----------------------------------------------------------------------------
# Apache Maven Wrapper startup batch script, version 3.3.3
#
# Optional ENV vars
# -----------------
#   JAVA_HOME - location of a JDK home dir, required when download maven via java source
#   MVNW_REPOURL - repo url base for downloading maven distribution
#   MVNW_USERNAME/MVNW_PASSWORD - user and password for downloading maven
#   MVNW_VERBOSE - true: enable verbose log; debug: trace the mvnw script; others: silence the output
# ----------------------------------------------------------------------------

set -euf
[ "${MVNW_VERBOSE-}" != debug ] || set -x

# OS specific support.
native_path() { printf %s\\n "$1"; }
case "$(uname)" in
CYGWIN* | MINGW*)
  [ -z "${JAVA_HOME-}" ] || JAVA_HOME="$(cygpath --unix "$JAVA_HOME")"
  native_path() { cygpath --path --windows "$1"; }
  ;;
esac

# set JAVACMD and JAVACCMD
set_java_home() {
  # For Cygwin and MinGW, ensure paths are in Unix format before anything is touched
  if [ -n "${JAVA_HOME-}" ]; then
    if [ -x "$JAVA_HOME/jre/sh/java" ]; then
      # IBM's JDK on AIX uses strange locations for the executables
      JAVACMD="$JAVA_HOME/jre/sh/java"
      JAVACCMD="$JAVA_HOME/jre/sh/javac"
    else
      JAVACMD="$JAVA_HOME/bin/java"
      JAVACCMD="$JAVA_HOME/bin/javac"

      if [ ! -x "$JAVACMD" ] || [ ! -x "$JAVACCMD" ]; then
        echo "The JAVA_HOME environment variable is not defined correctly, so mvnw cannot run." >&2
        echo "JAVA_HOME is set to \"$JAVA_HOME\", but \"\$JAVA_HOME/bin/java\" or \"\$JAVA_HOME/bin/javac\" does not exist." >&2
        return 1
      fi
    fi
  else
    JAVACMD="$(
      'set' +e
      'unset' -f command 2>/dev/null
      'command' -v java
    )" || :
    JAVACCMD="$(
      'set' +e
      'unset' -f command 2>/dev/null
      'command' -v javac
    )" || :

    if [ ! -x "${JAVACMD-}" ] || [ ! -x "${JAVACCMD-}" ]; then
      echo "The java/javac command does not exist in PATH nor is JAVA_HOME set, so mvnw cannot run." >&2
      return 1
    fi
  fi
}

# hash string like Java String::hashCode
hash_string() {
  str="${1:-}" h=0
  while [ -n "$str" ]; do
    char="${str%"${str#?}"}"
    h=$(((h * 31 + $(LC_CTYPE=C printf %d "'$char")) % 4294967296))
    str="${str#?}"
  done
  printf %x\\n $h
}

verbose() { :; }
[ "${MVNW_VERBOSE-}" != true ] || verbose() { printf %s\\n "${1-}"; }

die() {
  printf %s\\n "$1" >&2
  exit 1
}

trim() {
  # MWRAPPER-139:
  #   Trims trailing and leading whitespace, carriage returns, tabs, and linefeeds.
  #   Needed for removing poorly interpreted newline sequences when running in more
  #   exotic environments such as mingw bash on Windows.
  printf "%s" "${1}" | tr -d '[:space:]'
}

scriptDir="$(dirname "$0")"
scriptName="$(basename "$0")"

# parse distributionUrl and optional distributionSha256Sum, requires .mvn/wrapper/maven-wrapper.properties
while IFS="=" read -r key value; do
  case "${key-}" in
  distributionUrl) distributionUrl=$(trim "${value-}") ;;
  distributionSha256Sum) distributionSha256Sum=$(trim "${value-}") ;;
  esac
done <"$scriptDir/.mvn/wrapper/maven-wrapper.properties"
[ -n "${distributionUrl-}" ] || die "cannot read distributionUrl property in $scriptDir/.mvn/wrapper/maven-wrapper.properties"

case "${distributionUrl##*/}" in
maven-mvnd-*bin.*)
  MVN_CMD=mvnd.sh _MVNW_REPO_PATTERN=/maven/mvnd/
  case "${PROCESSOR_ARCHITECTURE-}${PROCESSOR_ARCHITEW6432-}:$(uname -a)" in
  *AMD64:CYGWIN* | *AMD64:MINGW*) distributionPlatform=windows-amd64 ;;
  :Darwin*x86_64) distributionPlatform=darwin-amd64 ;;
  :Darwin*arm64) distributionPlatform=darwin-aarch64 ;;
  :Linux*x86_64*) distributionPlatform=linux-amd64 ;;
  *)
    echo "Cannot detect native platform for mvnd on $(uname)-$(uname -m), use pure java version" >&2
    distributionPlatform=linux-amd64
    ;;
  esac
  distributionUrl="${distributionUrl%-bin.*}-$distributionPlatform.zip"
  ;;
maven-mvnd-*) MVN_CMD=mvnd.sh _MVNW_REPO_PATTERN=/maven/mvnd/ ;;
*) MVN_CMD="mvn${scriptName#mvnw}" _MVNW_REPO_PATTERN=/org/apache/maven/ ;;
esac

# apply MVNW_REPOURL and calculate MAVEN_HOME
# maven home pattern: ~/.m2/wrapper/dists/{apache-maven-<version>,maven-mvnd-<version>-<platform>}/<hash>
[ -z "${MVNW_REPOURL-}" ] || distributionUrl="$MVNW_REPOURL$_MVNW_REPO_PATTERN${distributionUrl#*"$_MVNW_REPO_PATTERN"}"
distributionUrlName="${distributionUrl##*/}"
distributionUrlNameMain="${distributionUrlName%.*}"
distributionUrlNameMain="${distributionUrlNameMain%-bin}"
MAVEN_USER_HOME="${MAVEN_USER_HOME:-${HOME}/.m2}"
MAVEN_HOME="${MAVEN_USER_HOME}/wrapper/dists/${distributionUrlNameMain-}/$(hash_string "$distributionUrl")"

exec_maven() {
  unset MVNW_VERBOSE MVNW_USERNAME MVNW_PASSWORD MVNW_REPOURL || :
  exec "$MAVEN_HOME/bin/$MVN_CMD" "$@" || die "cannot exec $MAVEN_HOME/bin/$MVN_CMD"
}

if [ -d "$MAVEN_HOME" ]; then
  verbose "found existing MAVEN_HOME at $MAVEN_HOME"
  exec_maven "$@"
fi

case "${distributionUrl-}" in
*?-bin.zip | *?maven-mvnd-?*-?*.zip) ;;
*) die "distributionUrl is not valid, must match *-bin.zip or maven-mvnd-*.zip, but found '${distributionUrl-}'" ;;
esac

# prepare tmp dir
if TMP_DOWNLOAD_DIR="$(mktemp -d)" && [ -d "$TMP_DOWNLOAD_DIR" ]; then
  clean() { rm -rf -- "$TMP_DOWNLOAD_DIR"; }
  trap clean HUP INT TERM EXIT
else
  die "cannot create temp dir"
fi

mkdir -p -- "${MAVEN_HOME%/*}"

# Download and Install Apache Maven
verbose "Couldn't find MAVEN_HOME, downloading and installing it ..."
verbose "Downloading from: $distributionUrl"
verbose "Downloading to: $TMP_DOWNLOAD_DIR/$distributionUrlName"

# select .zip or .tar.gz
if ! command -v unzip >/dev/null; then
  distributionUrl="${distributionUrl%.zip}.tar.gz"
  distributionUrlName="${distributionUrl##*/}"
fi

# verbose opt
__MVNW_QUIET_WGET=--quiet __MVNW_QUIET_CURL=--silent __MVNW_QUIET_UNZIP=-q __MVNW_QUIET_TAR=''
[ "${MVNW_VERBOSE-}" != true ] || __MVNW_QUIET_WGET='' __MVNW_QUIET_CURL='' __MVNW_QUIET_UNZIP='' __MVNW_QUIET_TAR=v

# normalize http auth
case "${MVNW_PASSWORD:+has-password}" in
'') MVNW_USERNAME='' MVNW_PASSWORD='' ;;
has-password) [ -n "${MVNW_USERNAME-}" ] || MVNW_USERNAME='' MVNW_PASSWORD='' ;;
esac

if [ -z "${MVNW_USERNAME-}" ] && command -v wget >/dev/null; then
  verbose "Found wget ... using wget"
  wget ${__MVNW_QUIET_WGET:+"$__MVNW_QUIET_WGET"} "$distributionUrl" -O "$TMP_DOWNLOAD_DIR/$distributionUrlName" || die "wget: Failed to fetch $distributionUrl"
elif [ -z "${MVNW_USERNAME-}" ] && command -v curl >/dev/null; then
  verbose "Found curl ... using curl"
  curl ${__MVNW_QUIET_CURL:+"$__MVNW_QUIET_CURL"} -f -L -o "$TMP_DOWNLOAD_DIR/$distributionUrlName" "$distributionUrl" || die "curl: Failed to fetch $distributionUrl"
elif set_java_home; then
  verbose "Falling back to use Java to download"
  javaSource="$TMP_DOWNLOAD_DIR/Downloader.java"
  targetZip="$TMP_DOWNLOAD_DIR/$distributionUrlName"
  cat >"$javaSource" <<-END
	public class Downloader extends java.net.Authenticator
	{
	  protected java.net.PasswordAuthentication getPasswordAuthentication()
	  {
	    return new java.net.PasswordAuthentication( System.getenv( "MVNW_USERNAME" ), System.getenv( "MVNW_PASSWORD" ).toCharArray() );
	  }
	  public static void main( String[] args ) throws Exception
	  {
	    setDefault( new Downloader() );
	    java.nio.file.Files.copy( java.net.URI.create( args[0] ).toURL().openStream(), java.nio.file.Paths.get( args[1] ).toAbsolutePath().normalize() );
	  }
	}
	END
  # For Cygwin/MinGW, switch paths to Windows format before running javac and java
  verbose " - Compiling Downloader.java ..."
  "$(native_path "$JAVACCMD")" "$(native_path "$javaSource")" || die "Failed to compile Downloader.java"
  verbose " - Running Downloader.java ..."
  "$(native_path "$JAVACMD")" -cp "$(native_path "$TMP_DOWNLOAD_DIR")" Downloader "$distributionUrl" "$(native_path "$targetZip")"
fi

# If specified, validate the SHA-256 sum of the Maven distribution zip file
if [ -n "${distributionSha256Sum-}" ]; then
  distributionSha256Result=false
  if [ "$MVN_CMD" = mvnd.sh ]; then
    echo "Checksum validation is not supported for maven-mvnd." >&2
    echo "Please disable validation by removing 'distributionSha256Sum' from your maven-wrapper.properties." >&2
    exit 1
  elif command -v sha256sum >/dev/null; then
    if echo "$distributionSha256Sum  $TMP_DOWNLOAD_DIR/$distributionUrlName" | sha256sum -c - >/dev/null 2>&1; then
      distributionSha256Result=true
    fi
  elif command -v shasum >/dev/null; then
    if echo "$distributionSha256Sum  $TMP_DOWNLOAD_DIR/$distributionUrlName" | shasum -a 256 -c >/dev/null 2>&1; then
      distributionSha256Result=true
    fi
  else
    echo "Checksum validation was requested but neither 'sha256sum' or 'shasum' are available." >&2
    echo "Please install either command, or disable validation by removing 'distributionSha256Sum' from your maven-wrapper.properties." >&2
    exit 1
  fi
  if [ $distributionSha256Result = false ]; then
    echo "Error: Failed to validate Maven distribution SHA-256, your Maven distribution might be compromised." >&2
    echo "If you updated your Maven version, you need to update the specified distributionSha256Sum property." >&2
    exit 1
  fi
fi

# unzip and move
if command -v unzip >/dev/null; then
  unzip ${__MVNW_QUIET_UNZIP:+"$__MVNW_QUIET_UNZIP"} "$TMP_DOWNLOAD_DIR/$distributionUrlName" -d "$TMP_DOWNLOAD_DIR" || die "failed to unzip"
else
  tar xzf${__MVNW_QUIET_TAR:+"$__MVNW_QUIET_TAR"} "$TMP_DOWNLOAD_DIR/$distributionUrlName" -C "$TMP_DOWNLOAD_DIR" || die "failed to untar"
fi

# Find the actual extracted directory name (handles snapshots where filename != directory name)
actualDistributionDir=""

# First try the expected directory name (for regular distributions)
if [ -d "$TMP_DOWNLOAD_DIR/$distributionUrlNameMain" ]; then
  if [ -f "$TMP_DOWNLOAD_DIR/$distributionUrlNameMain/bin/$MVN_CMD" ]; then
    actualDistributionDir="$distributionUrlNameMain"
  fi
fi

# If not found, search for any directory with the Maven executable (for snapshots)
if [ -z "$actualDistributionDir" ]; then
  # enable globbing to iterate over items
  set +f
  for dir in "$TMP_DOWNLOAD_DIR"/*; do
    if [ -d "$dir" ]; then
      if [ -f "$dir/bin/$MVN_CMD" ]; then
        actualDistributionDir="$(basename "$dir")"
        break
      fi
    fi
  done
  set -f
fi

if [ -z "$actualDistributionDir" ]; then
  verbose "Contents of $TMP_DOWNLOAD_DIR:"
  verbose "$(ls -la "$TMP_DOWNLOAD_DIR")"
  die "Could not find Maven distribution directory in extracted archive"
fi

verbose "Found extracted Maven distribution directory: $actualDistributionDir"
printf %s\\n "$distributionUrl" >"$TMP_DOWNLOAD_DIR/$actualDistributionDir/mvnw.url"
mv -- "$TMP_DOWNLOAD_DIR/$actualDistributionDir" "$MAVEN_HOME" || [ -d "$MAVEN_HOME" ] || die "fail to move MAVEN_HOME"

clean || :
exec_maven "$@"

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\mvnw.cmd
--------------------------------------------------------------------
<# : batch portion
@REM ----------------------------------------------------------------------------
@REM Licensed to the Apache Software Foundation (ASF) under one
@REM or more contributor license agreements.  See the NOTICE file
@REM distributed with this work for additional information
@REM regarding copyright ownership.  The ASF licenses this file
@REM to you under the Apache License, Version 2.0 (the
@REM "License"); you may not use this file except in compliance
@REM with the License.  You may obtain a copy of the License at
@REM
@REM    http://www.apache.org/licenses/LICENSE-2.0
@REM
@REM Unless required by applicable law or agreed to in writing,
@REM software distributed under the License is distributed on an
@REM "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
@REM KIND, either express or implied.  See the License for the
@REM specific language governing permissions and limitations
@REM under the License.
@REM ----------------------------------------------------------------------------

@REM ----------------------------------------------------------------------------
@REM Apache Maven Wrapper startup batch script, version 3.3.3
@REM
@REM Optional ENV vars
@REM   MVNW_REPOURL - repo url base for downloading maven distribution
@REM   MVNW_USERNAME/MVNW_PASSWORD - user and password for downloading maven
@REM   MVNW_VERBOSE - true: enable verbose log; others: silence the output
@REM ----------------------------------------------------------------------------

@IF "%__MVNW_ARG0_NAME__%"=="" (SET __MVNW_ARG0_NAME__=%~nx0)
@SET __MVNW_CMD__=
@SET __MVNW_ERROR__=
@SET __MVNW_PSMODULEP_SAVE=%PSModulePath%
@SET PSModulePath=
@FOR /F "usebackq tokens=1* delims==" %%A IN (`powershell -noprofile "& {$scriptDir='%~dp0'; $script='%__MVNW_ARG0_NAME__%'; icm -ScriptBlock ([Scriptblock]::Create((Get-Content -Raw '%~f0'))) -NoNewScope}"`) DO @(
  IF "%%A"=="MVN_CMD" (set __MVNW_CMD__=%%B) ELSE IF "%%B"=="" (echo %%A) ELSE (echo %%A=%%B)
)
@SET PSModulePath=%__MVNW_PSMODULEP_SAVE%
@SET __MVNW_PSMODULEP_SAVE=
@SET __MVNW_ARG0_NAME__=
@SET MVNW_USERNAME=
@SET MVNW_PASSWORD=
@IF NOT "%__MVNW_CMD__%"=="" ("%__MVNW_CMD__%" %*)
@echo Cannot start maven from wrapper >&2 && exit /b 1
@GOTO :EOF
: end batch / begin powershell #>

$ErrorActionPreference = "Stop"
if ($env:MVNW_VERBOSE -eq "true") {
  $VerbosePreference = "Continue"
}

# calculate distributionUrl, requires .mvn/wrapper/maven-wrapper.properties
$distributionUrl = (Get-Content -Raw "$scriptDir/.mvn/wrapper/maven-wrapper.properties" | ConvertFrom-StringData).distributionUrl
if (!$distributionUrl) {
  Write-Error "cannot read distributionUrl property in $scriptDir/.mvn/wrapper/maven-wrapper.properties"
}

switch -wildcard -casesensitive ( $($distributionUrl -replace '^.*/','') ) {
  "maven-mvnd-*" {
    $USE_MVND = $true
    $distributionUrl = $distributionUrl -replace '-bin\.[^.]*$',"-windows-amd64.zip"
    $MVN_CMD = "mvnd.cmd"
    break
  }
  default {
    $USE_MVND = $false
    $MVN_CMD = $script -replace '^mvnw','mvn'
    break
  }
}

# apply MVNW_REPOURL and calculate MAVEN_HOME
# maven home pattern: ~/.m2/wrapper/dists/{apache-maven-<version>,maven-mvnd-<version>-<platform>}/<hash>
if ($env:MVNW_REPOURL) {
  $MVNW_REPO_PATTERN = if ($USE_MVND -eq $False) { "/org/apache/maven/" } else { "/maven/mvnd/" }
  $distributionUrl = "$env:MVNW_REPOURL$MVNW_REPO_PATTERN$($distributionUrl -replace "^.*$MVNW_REPO_PATTERN",'')"
}
$distributionUrlName = $distributionUrl -replace '^.*/',''
$distributionUrlNameMain = $distributionUrlName -replace '\.[^.]*$','' -replace '-bin$',''

$MAVEN_M2_PATH = "$HOME/.m2"
if ($env:MAVEN_USER_HOME) {
  $MAVEN_M2_PATH = "$env:MAVEN_USER_HOME"
}

if (-not (Test-Path -Path $MAVEN_M2_PATH)) {
    New-Item -Path $MAVEN_M2_PATH -ItemType Directory | Out-Null
}

$MAVEN_WRAPPER_DISTS = $null
if ((Get-Item $MAVEN_M2_PATH).Target[0] -eq $null) {
  $MAVEN_WRAPPER_DISTS = "$MAVEN_M2_PATH/wrapper/dists"
} else {
  $MAVEN_WRAPPER_DISTS = (Get-Item $MAVEN_M2_PATH).Target[0] + "/wrapper/dists"
}

$MAVEN_HOME_PARENT = "$MAVEN_WRAPPER_DISTS/$distributionUrlNameMain"
$MAVEN_HOME_NAME = ([System.Security.Cryptography.SHA256]::Create().ComputeHash([byte[]][char[]]$distributionUrl) | ForEach-Object {$_.ToString("x2")}) -join ''
$MAVEN_HOME = "$MAVEN_HOME_PARENT/$MAVEN_HOME_NAME"

if (Test-Path -Path "$MAVEN_HOME" -PathType Container) {
  Write-Verbose "found existing MAVEN_HOME at $MAVEN_HOME"
  Write-Output "MVN_CMD=$MAVEN_HOME/bin/$MVN_CMD"
  exit $?
}

if (! $distributionUrlNameMain -or ($distributionUrlName -eq $distributionUrlNameMain)) {
  Write-Error "distributionUrl is not valid, must end with *-bin.zip, but found $distributionUrl"
}

# prepare tmp dir
$TMP_DOWNLOAD_DIR_HOLDER = New-TemporaryFile
$TMP_DOWNLOAD_DIR = New-Item -Itemtype Directory -Path "$TMP_DOWNLOAD_DIR_HOLDER.dir"
$TMP_DOWNLOAD_DIR_HOLDER.Delete() | Out-Null
trap {
  if ($TMP_DOWNLOAD_DIR.Exists) {
    try { Remove-Item $TMP_DOWNLOAD_DIR -Recurse -Force | Out-Null }
    catch { Write-Warning "Cannot remove $TMP_DOWNLOAD_DIR" }
  }
}

New-Item -Itemtype Directory -Path "$MAVEN_HOME_PARENT" -Force | Out-Null

# Download and Install Apache Maven
Write-Verbose "Couldn't find MAVEN_HOME, downloading and installing it ..."
Write-Verbose "Downloading from: $distributionUrl"
Write-Verbose "Downloading to: $TMP_DOWNLOAD_DIR/$distributionUrlName"

$webclient = New-Object System.Net.WebClient
if ($env:MVNW_USERNAME -and $env:MVNW_PASSWORD) {
  $webclient.Credentials = New-Object System.Net.NetworkCredential($env:MVNW_USERNAME, $env:MVNW_PASSWORD)
}
[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
$webclient.DownloadFile($distributionUrl, "$TMP_DOWNLOAD_DIR/$distributionUrlName") | Out-Null

# If specified, validate the SHA-256 sum of the Maven distribution zip file
$distributionSha256Sum = (Get-Content -Raw "$scriptDir/.mvn/wrapper/maven-wrapper.properties" | ConvertFrom-StringData).distributionSha256Sum
if ($distributionSha256Sum) {
  if ($USE_MVND) {
    Write-Error "Checksum validation is not supported for maven-mvnd. `nPlease disable validation by removing 'distributionSha256Sum' from your maven-wrapper.properties."
  }
  Import-Module $PSHOME\Modules\Microsoft.PowerShell.Utility -Function Get-FileHash
  if ((Get-FileHash "$TMP_DOWNLOAD_DIR/$distributionUrlName" -Algorithm SHA256).Hash.ToLower() -ne $distributionSha256Sum) {
    Write-Error "Error: Failed to validate Maven distribution SHA-256, your Maven distribution might be compromised. If you updated your Maven version, you need to update the specified distributionSha256Sum property."
  }
}

# unzip and move
Expand-Archive "$TMP_DOWNLOAD_DIR/$distributionUrlName" -DestinationPath "$TMP_DOWNLOAD_DIR" | Out-Null

# Find the actual extracted directory name (handles snapshots where filename != directory name)
$actualDistributionDir = ""

# First try the expected directory name (for regular distributions)
$expectedPath = Join-Path "$TMP_DOWNLOAD_DIR" "$distributionUrlNameMain"
$expectedMvnPath = Join-Path "$expectedPath" "bin/$MVN_CMD"
if ((Test-Path -Path $expectedPath -PathType Container) -and (Test-Path -Path $expectedMvnPath -PathType Leaf)) {
  $actualDistributionDir = $distributionUrlNameMain
}

# If not found, search for any directory with the Maven executable (for snapshots)
if (!$actualDistributionDir) {
  Get-ChildItem -Path "$TMP_DOWNLOAD_DIR" -Directory | ForEach-Object {
    $testPath = Join-Path $_.FullName "bin/$MVN_CMD"
    if (Test-Path -Path $testPath -PathType Leaf) {
      $actualDistributionDir = $_.Name
    }
  }
}

if (!$actualDistributionDir) {
  Write-Error "Could not find Maven distribution directory in extracted archive"
}

Write-Verbose "Found extracted Maven distribution directory: $actualDistributionDir"
Rename-Item -Path "$TMP_DOWNLOAD_DIR/$actualDistributionDir" -NewName $MAVEN_HOME_NAME | Out-Null
try {
  Move-Item -Path "$TMP_DOWNLOAD_DIR/$MAVEN_HOME_NAME" -Destination $MAVEN_HOME_PARENT | Out-Null
} catch {
  if (! (Test-Path -Path "$MAVEN_HOME" -PathType Container)) {
    Write-Error "fail to move MAVEN_HOME"
  }
} finally {
  try { Remove-Item $TMP_DOWNLOAD_DIR -Recurse -Force | Out-Null }
  catch { Write-Warning "Cannot remove $TMP_DOWNLOAD_DIR" }
}

Write-Output "MVN_CMD=$MAVEN_HOME/bin/$MVN_CMD"

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\pom.xml
--------------------------------------------------------------------
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
		 xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">
	<modelVersion>4.0.0</modelVersion>
	<parent>
		<groupId>org.springframework.boot</groupId>
		<artifactId>spring-boot-starter-parent</artifactId>
		<version>3.5.5</version>
		<relativePath/>
	</parent>
	<groupId>com.smartretail</groupId>
	<artifactId>backend</artifactId>
	<version>0.0.1-SNAPSHOT</version>
	<name>backend</name>
	<description>Demo project for Spring Boot</description>
	<properties>
		<java.version>17</java.version>
	</properties>
	<dependencies>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-data-mongodb</artifactId>
		</dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-security</artifactId>
		</dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-web</artifactId>
		</dependency>
        <dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-oauth2-client</artifactId>
		</dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-devtools</artifactId>
			<scope>runtime</scope>
			<optional>true</optional>
		</dependency>
		<dependency>
			<groupId>org.projectlombok</groupId>
			<artifactId>lombok</artifactId>
			<version>1.18.34</version>
			<scope>provided</scope>
		</dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-test</artifactId>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>org.springframework.security</groupId>
			<artifactId>spring-security-test</artifactId>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>io.jsonwebtoken</groupId>
			<artifactId>jjwt-api</artifactId>
			<version>0.11.5</version>
		</dependency>
		<dependency>
			<groupId>io.jsonwebtoken</groupId>
			<artifactId>jjwt-impl</artifactId>
			<version>0.11.5</version>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>io.jsonwebtoken</groupId>
			<artifactId>jjwt-jackson</artifactId> <version>0.11.5</version>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-validation</artifactId>
		</dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-mail</artifactId>
		</dependency>
		<dependency>
			<groupId>org.junit.jupiter</groupId>
			<artifactId>junit-jupiter</artifactId>
			<version>5.10.0</version>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>com.itextpdf</groupId>
			<artifactId>itext7-core</artifactId>
			<version>7.2.6</version>
			<type>pom</type>
		</dependency>

		<dependency>
			<groupId>org.mockito</groupId>
			<artifactId>mockito-core</artifactId>
			<version>5.12.0</version>
			<scope>test</scope>
		</dependency>
		
		<dependency>
			<groupId>org.mockito</groupId>
			<artifactId>mockito-junit-jupiter</artifactId>
			<version>5.12.0</version>
			<scope>test</scope>
		</dependency>

		<dependency>
			<groupId>com.opencsv</groupId>
			<artifactId>opencsv</artifactId>
			<version>5.9</version>
		</dependency>

		<dependency>
			<groupId>commons-fileupload</groupId>
			<artifactId>commons-fileupload</artifactId>
			<version>1.6.0</version>
		</dependency>

		<dependency>
			<groupId>com.sun.mail</groupId>
			<artifactId>javax.mail</artifactId>
			<version>1.6.2</version>
		</dependency>

		<dependency>
			<groupId>com.fasterxml.jackson.core</groupId>
			<artifactId>jackson-databind</artifactId>
			<version>2.15.2</version>
		</dependency>

		<dependency>
			<groupId>nl.martijndwars</groupId>
			<artifactId>web-push</artifactId>
			<version>5.1.1</version>
		</dependency>
		
		</dependencies>
	<build>
		<plugins>
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-compiler-plugin</artifactId>
				<configuration>
					<annotationProcessorPaths>
						<path>
							<groupId>org.projectlombok</groupId>
							<artifactId>lombok</artifactId>
							<version>1.18.34</version>
						</path>
					</annotationProcessorPaths>
                    <source>21</source>
                    <target>21</target>
                </configuration>
			</plugin>
			<plugin>
				<groupId>org.springframework.boot</groupId>
				<artifactId>spring-boot-maven-plugin</artifactId>
				<configuration>
					<excludes>
						<exclude>
							<groupId>org.projectlombok</groupId>
							<artifactId>lombok</artifactId>
						</exclude>
					</excludes>
				</configuration>
			</plugin>
		</plugins>
	</build>
</project>
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\backend\src
--------------------------------------------------------------------
Contents:
main
test

====================================================================
📁 Directory: G:\FINALCODE\backend\src\main
--------------------------------------------------------------------
Contents:
java
resources

====================================================================
📁 Directory: G:\FINALCODE\backend\src\main\java
--------------------------------------------------------------------
Contents:
com

====================================================================
📁 Directory: G:\FINALCODE\backend\src\main\java\com
--------------------------------------------------------------------
Contents:
smartretail

====================================================================
📁 Directory: G:\FINALCODE\backend\src\main\java\com\smartretail
--------------------------------------------------------------------
Contents:
backend

====================================================================
📁 Directory: G:\FINALCODE\backend\src\main\java\com\smartretail\backend
--------------------------------------------------------------------
Contents:
analytics
BackendApplication.java
config
controller
dto
exception
models
repository
security
service

====================================================================
📁 Directory: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\analytics
--------------------------------------------------------------------
Contents:
.env
__pycache__
app.py
requirements.txt
translations.py

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\analytics\.env
--------------------------------------------------------------------
MONGO_URI=mongodb+srv://admin:SuperS3cr3tPassword@cluster0.xo5fnfx.mongodb.net/smartretail?
DB_NAME=smartretail
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\analytics\__pycache__
--------------------------------------------------------------------
Contents:
translations.cpython-311.pyc

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\analytics\__pycache__\translations.cpython-311.pyc
--------------------------------------------------------------------
[BINARY FILE - CONTENT NOT SHOWN]
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\analytics\app.py
--------------------------------------------------------------------
from flask import Flask, jsonify, request
from flask_cors import CORS
from flask_pymongo import PyMongo
import pandas as pd
from datetime import datetime
from dotenv import load_dotenv
from dateutil import parser
import os
from translations import get_translation as t  # <-- NEW IMPORT

# -----------------------
# Initialization
# -----------------------
load_dotenv()
app = Flask(__name__)
CORS(app)

# MongoDB Config
app.config["MONGO_URI"] = os.getenv("MONGO_URI")
db_name = os.getenv("DB_NAME")
mongo = PyMongo(app)
db = mongo.cx[db_name]

# -----------------------
# Helper Functions
# -----------------------
def normalize_bills(raw_bills):
    """Normalize bills into a consistent DataFrame"""
    records = []
    for bill in raw_bills:
        # Prefer 'createdAt'
        bill_date = bill.get("createdAt") or bill.get("date")
        if isinstance(bill_date, dict) and "$date" in bill_date:
            bill_date = bill_date["$date"]
        bill_date = pd.to_datetime(bill_date)

        total = bill.get("totalAmount") or bill.get("total", 0)
        items = bill.get("items", [])
        for item in items:
            qty = item.get("quantity") or item.get("qty", 0)
            price = item.get("price", 0)
            product_id = item.get("productId") or item.get("product_id") or item.get("id")
            name = item.get("name") or item.get("productName") or "Unknown Product"

            # Only add records with valid data
            if qty > 0 and price > 0:
                records.append({
                    "date": bill_date,
                    "productId": str(product_id) if product_id else "unknown",
                    "name": name,
                    "qty": qty,
                    "price": price,
                    "revenue": price * qty,
                    "total": total
                })

    df = pd.DataFrame(records)
    print(f"📦 Normalized {len(df)} item records from {len(raw_bills)} bills")
    if not df.empty:
        print(f"   Products found: {df['name'].unique().tolist()[:5]}")
    return df


def get_filtered_bills():
    """Apply date filtering if provided"""
    start_str = request.args.get("startDate")
    end_str = request.args.get("endDate")

    query = {}
    if start_str and end_str:
        try:
            start_dt = datetime.strptime(start_str, "%Y-%m-%d")
            end_dt = datetime.strptime(end_str, "%Y-%m-%d").replace(hour=23, minute=59, second=59)
            query["createdAt"] = {"$gte": start_dt, "$lte": end_dt}
            print(f"✅ Filtering bills between {start_dt} → {end_dt}")
        except ValueError:
            print("❌ Invalid date format received")
            return jsonify({"error": "Invalid date format. Use YYYY-MM-DD"}), 400

    bills = list(db.bills.find(query))
    print(f"📊 Found {len(bills)} bills matching the criteria")
    return bills

# -----------------------
# API Endpoints
# -----------------------

@app.route("/")
def home():
    return jsonify({"status": "Analytics API running 🚀"})


@app.route("/analytics/daily")
def daily_sales():
    raw_bills = get_filtered_bills()
    df = normalize_bills(raw_bills)
    if df.empty:
        return jsonify({
            "daily": [],
            "weekly": [],
            "monthly": [],
            "top_products": [],
            "revenue_trend": [],
            "summary": {
                "total_revenue": 0,
                "total_orders": 0,
                "total_products_sold": 0
            },
            "message": "No billing data"
        }), 200


    summary = (
        df.groupby(df["date"].dt.date)["revenue"]
        .sum()
        .reset_index()
        .rename(columns={"date": "day", "revenue": "totalSales"})
    )
    summary["day"] = summary["day"].astype(str)
    return jsonify(summary.to_dict(orient="records"))


@app.route("/analytics/monthly")
def monthly_sales():
    raw_bills = get_filtered_bills()
    df = normalize_bills(raw_bills)
    if df.empty:
        return jsonify({
            "daily": [],
            "weekly": [],
            "monthly": [],
            "top_products": [],
            "revenue_trend": [],
            "summary": {
                "total_revenue": 0,
                "total_orders": 0,
                "total_products_sold": 0
            },
            "message": "No billing data"
        }), 200


    summary = (
        df.groupby(df["date"].dt.to_period("M"))["revenue"]
        .sum()
        .reset_index()
    )
    summary["date"] = summary["date"].astype(str)
    summary = summary.rename(columns={"date": "month", "revenue": "totalSales"})
    return jsonify(summary.to_dict(orient="records"))


@app.route("/analytics/weekly")
def weekly_sales():
    raw_bills = get_filtered_bills()
    df = normalize_bills(raw_bills)
    if df.empty:
        return jsonify({
            "daily": [],
            "weekly": [],
            "monthly": [],
            "top_products": [],
            "revenue_trend": [],
            "summary": {
                "total_revenue": 0,
                "total_orders": 0,
                "total_products_sold": 0
            },
            "message": "No billing data"
        }), 200


    summary = (
        df.groupby(df["date"].dt.to_period("W"))["revenue"]
        .sum()
        .reset_index()
    )
    summary["date"] = summary["date"].astype(str)
    summary = summary.rename(columns={"date": "week", "revenue": "totalSales"})
    return jsonify(summary.to_dict(orient="records"))


@app.route("/analytics/top-products")
def top_products():
    """Get top products filtered by date range"""
    raw_bills = get_filtered_bills()
    df = normalize_bills(raw_bills)
    if df.empty:
        return jsonify({
            "daily": [],
            "weekly": [],
            "monthly": [],
            "top_products": [],
            "revenue_trend": [],
            "summary": {
                "total_revenue": 0,
                "total_orders": 0,
                "total_products_sold": 0
            },
            "message": "No billing data"
        }), 200


    # Fetch all products for name and category lookup
    products = list(db.products.find({}))
    products_df = pd.DataFrame(products)

    # Merge bill data with product data
    merged = df.merge(
        products_df[["productId", "name", "category"]],
        on="productId",
        how="left",
        suffixes=("_bill", "_prod")
    )

    # Combine names (prefer bill name, fallback to product name)
    merged["name"] = merged["name_bill"].combine_first(merged["name_prod"])
    merged["category"] = merged["category"].fillna("Unknown")

    # Aggregate by product
    summary = (
        merged.groupby(["productId", "name", "category"])
        .agg({"qty": "sum", "revenue": "sum"})
        .reset_index()
        .sort_values("revenue", ascending=False)
        .head(10)
    )

    print(f"🏆 Top {len(summary)} products calculated")
    return jsonify(summary.to_dict(orient="records"))


@app.route("/analytics/revenue-trend")
def revenue_trend():
    """Get revenue trend filtered by date range"""
    raw_bills = get_filtered_bills()
    df = normalize_bills(raw_bills)
    if df.empty:
        return jsonify({
            "daily": [],
            "weekly": [],
            "monthly": [],
            "top_products": [],
            "revenue_trend": [],
            "summary": {
                "total_revenue": 0,
                "total_orders": 0,
                "total_products_sold": 0
            },
            "message": "No billing data"
        }), 200

    trend = (
        df.groupby(df["date"].dt.date)["revenue"]
        .sum()
        .reset_index()
        .rename(columns={"date": "day", "revenue": "totalRevenue"})
    )
    trend["day"] = trend["day"].astype(str)
    return jsonify(trend.to_dict(orient="records"))


@app.route("/analytics/report")
def sales_report():
    """Comprehensive sales report filtered by date range"""
    raw_bills = get_filtered_bills()
    df = normalize_bills(raw_bills)
    if df.empty:
        return jsonify({
            "daily": [],
            "weekly": [],
            "monthly": [],
            "top_products": [],
            "revenue_trend": [],
            "summary": {
                "total_revenue": 0,
                "total_orders": 0,
                "total_products_sold": 0
            },
            "message": "No billing data"
        }), 200


    # Fetch all products for name and category lookup
    products = list(db.products.find({}))
    products_df = pd.DataFrame(products)

    # ----- Daily -----
    daily = (
        df.groupby(df["date"].dt.date)["revenue"]
        .sum()
        .reset_index()
        .rename(columns={"date": "day", "revenue": "totalSales"})
    )
    daily["day"] = daily["day"].astype(str)

    # ----- Weekly -----
    weekly = (
        df.groupby(df["date"].dt.to_period("W"))["revenue"]
        .sum()
        .reset_index()
    )
    weekly["date"] = weekly["date"].astype(str)
    weekly = weekly.rename(columns={"date": "week", "revenue": "totalSales"})

    # ----- Monthly -----
    monthly = (
        df.groupby(df["date"].dt.to_period("M"))["revenue"]
        .sum()
        .reset_index()
    )
    monthly["date"] = monthly["date"].astype(str)
    monthly = monthly.rename(columns={"date": "month", "revenue": "totalSales"})

    # ----- Top Products (filtered by date range) -----
    merged = df.merge(
        products_df[["productId", "name", "category"]],
        on="productId",
        how="left",
        suffixes=("_bill", "_prod")
    )
    merged["name"] = merged["name_bill"].combine_first(merged["name_prod"])
    merged["category"] = merged["category"].fillna("Unknown")

    top_products = (
        merged.groupby(["productId", "name", "category"])
        .agg({"qty": "sum", "revenue": "sum"})
        .reset_index()
        .sort_values("revenue", ascending=False)
        .head(10)
    )

    # ----- Revenue Trend (filtered by date range) -----
    trend = (
        df.groupby(df["date"].dt.date)["revenue"]
        .sum()
        .reset_index()
        .rename(columns={"date": "day", "revenue": "totalRevenue"})
    )
    trend["day"] = trend["day"].astype(str)

    # ----- Combine Report -----
    report = {
        "daily": daily.to_dict(orient="records"),
        "weekly": weekly.to_dict(orient="records"),
        "monthly": monthly.to_dict(orient="records"),
        "top_products": top_products.to_dict(orient="records"),
        "revenue_trend": trend.to_dict(orient="records"),
        "summary": {
            "total_revenue": float(df["revenue"].sum()),
            "total_orders": int(len(raw_bills)),
            "total_products_sold": int(df["qty"].sum())
        }
    }

    print(f"📈 Report generated with {len(top_products)} top products")
    return jsonify(report)


@app.route("/analytics/report/text")
def sales_report_text():
    # --- NEW: Get language from header ---
    # Get 'en', 'hi', 'mr', 'te' from 'hi-IN,hi;q=0.9,en-US;q=0.8,en;q=0.7'
    lang = request.headers.get('Accept-Language', 'en').split(',')[0].split('-')[0]
    # --- End NEW ---

    raw_bills = get_filtered_bills()
    products = list(db.products.find({}))
    df = normalize_bills(raw_bills)

    if df.empty:
        return jsonify({
            "daily": [],
            "weekly": [],
            "monthly": [],
            "top_products": [],
            "revenue_trend": [],
            "summary": {
                "total_revenue": 0,
                "total_orders": 0,
                "total_products_sold": 0
            },
            "message": "No billing data"
        }), 200

    products_df = pd.DataFrame(products)

    # ---- Summary ----
    total_revenue = float(df["revenue"].sum())
    total_orders = int(len(raw_bills))
    total_products_sold = int(df["qty"].sum())

    # ---- Daily ----
    daily = (
        df.groupby(df["date"].dt.date)["revenue"]
        .sum()
        .reset_index()
        .rename(columns={"date": "day", "revenue": "totalSales"})
    )
    daily["day"] = daily["day"].astype(str)
    best_day = daily.loc[daily["totalSales"].idxmax()]

    # ---- Weekly ----
    weekly = (
        df.groupby(df["date"].dt.to_period("W"))["revenue"]
        .sum()
        .reset_index()
    )
    weekly["date"] = weekly["date"].astype(str)
    best_week = weekly.loc[weekly["revenue"].idxmax()]

    # ---- Monthly ----
    monthly = (
        df.groupby(df["date"].dt.to_period("M"))["revenue"]
        .sum()
        .reset_index()
    )
    monthly["date"] = monthly["date"].astype(str)
    best_month = monthly.loc[monthly["revenue"].idxmax()]

    # ---- Top Products ----
    merged = df.merge(
        products_df[["productId", "name", "category"]],
        on="productId",
        how="left",
        suffixes=("_bill", "_prod")
    )
    merged["name"] = merged["name_bill"].combine_first(merged["name_prod"])
    merged["category"] = merged["category"].fillna("Unknown")

    top_products = (
        merged.groupby(["productId", "name", "category"])
        .agg({"qty": "sum", "revenue": "sum"})
        .reset_index()
        .sort_values("revenue", ascending=False)
        .head(3)
    )

    # ---- Generate Plain Text Report (TRANSLATED) ----
    report_lines = []
    report_lines.append(t(lang, 'report_title'))
    report_lines.append(t(lang, 'total_revenue').format(total_revenue=total_revenue))
    report_lines.append(t(lang, 'total_orders').format(total_orders=total_orders))
    report_lines.append(t(lang, 'total_products_sold').format(total_products_sold=total_products_sold))
    report_lines.append(t(lang, 'best_day').format(best_day=best_day['day'], total_sales=best_day['totalSales']))
    report_lines.append(t(lang, 'best_week').format(best_week=best_week['date'], revenue=best_week['revenue']))
    report_lines.append(t(lang, 'best_month').format(best_month=best_month['date'], revenue=best_month['revenue']))

    report_lines.append(t(lang, 'top_products_title'))
    for _, row in top_products.iterrows():
        report_lines.append(
            t(lang, 'top_product_line').format(name=row['name'], category=row['category'], qty=row['qty'], revenue=row['revenue'])
        )
    # --- End of modifications ---

    return jsonify({"report": " ".join(report_lines)})

# -----------------------
# Run Server
# -----------------------
if __name__ == "__main__":
    app.run(port=5001, debug=True)
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\analytics\requirements.txt
--------------------------------------------------------------------
Flask
flask-cors
flask-pymongo
pandas
python-dotenv
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\analytics\translations.py
--------------------------------------------------------------------
# NEW FILE
translations = {
    "en": {
        "report_title": "📊 Sales Analysis Report",
        "total_revenue": "Total revenue generated: ₹{total_revenue:,.2f}.",
        "total_orders": "Total number of orders: {total_orders}.",
        "total_products_sold": "Total products sold: {total_products_sold}.",
        "best_day": "Best performing day: {best_day} (₹{total_sales:.2f}).",
        "best_week": "Best week: {best_week} (₹{revenue:.2f}).",
        "best_month": "Best month: {best_month} (₹{revenue:.2f}).",
        "top_products_title": "Top selling products:",
        "top_product_line": "- {name} ({category}) sold {qty} units, revenue {revenue:.2f}"
    },
    "hi": {
        "report_title": "📊 बिक्री विश्लेषण रिपोर्ट",
        "total_revenue": "कुल राजस्व उत्पन्न: ₹{total_revenue:,.2f}।",
        "total_orders": "ऑर्डर की कुल संख्या: {total_orders}।",
        "total_products_sold": "कुल बिके उत्पाद: {total_products_sold}।",
        "best_day": "सबसे अच्छा प्रदर्शन करने वाला दिन: {best_day} (₹{total_sales:.2f})।",
        "best_week": "सबसे अच्छा सप्ताह: {best_week} (₹{revenue:.2f})।",
        "best_month": "सबसे अच्छा महीना: {best_month} (₹{revenue:.2f})।",
        "top_products_title": "सबसे ज्यादा बिकने वाले उत्पाद:",
        "top_product_line": "- {name} ({category}) ने {qty} इकाइयाँ बेचीं, राजस्व {revenue:.2f}"
    },
    "mr": {
        "report_title": "📊 विक्री विश्लेषण अहवाल",
        "total_revenue": "एकूण महसूल: ₹{total_revenue:,.2f}।",
        "total_orders": "एकूण ऑर्डरची संख्या: {total_orders}।",
        "total_products_sold": "एकूण विकलेली उत्पादने: {total_products_sold}।",
        "best_day": "सर्वोत्तम कामगिरीचा दिवस: {best_day} (₹{total_sales:.2f}).",
        "best_week": "सर्वोत्तम आठवडा: {best_week} (₹{revenue:.2f}).",
        "best_month": "सर्वोत्तम महिना: {best_month} (₹{revenue:.2f}).",
        "top_products_title": " सर्वाधिक विकली जाणारी उत्पादने:",
        "top_product_line": "- {name} ({category}) ने {qty} युनिट्स विकले, महसूल {revenue:.2f}"
    },
    "te": {
        "report_title": "📊 అమ్మకాల విశ్లేషణ నివేదిక",
        "total_revenue": "మొత్తం ఆదాయం: ₹{total_revenue:,.2f}।",
        "total_orders": "మొత్తం ఆర్డర్ల సంఖ్య: {total_orders}।",
        "total_products_sold": "మొత్తం అమ్ముడైన ఉత్పత్తులు: {total_products_sold}।",
        "best_day": "ఉత్తమ పనితీరు కనబరిచిన రోజు: {best_day} (₹{total_sales:.2f}).",
        "best_week": "ఉత్తమ వారం: {best_week} (₹{revenue:.2f}).",
        "best_month": "ఉత్తమ నెల: {best_month} (₹{revenue:.2f}).",
        "top_products_title": "అత్యధికంగా అమ్ముడైన ఉత్పత్తులు:",
        "top_product_line": "- {name} ({category}) {qty} యూనిట్లు అమ్ముడయ్యాయి, ఆదాయం {revenue:.2f}"
    }
}

def get_translation(lang_code, key):
    """
    Fetches a translation string for a given language and key.
    Falls back to English if the language or key is not found.
    """
    # Use 'en' as default
    lang = lang_code if lang_code in translations else "en"

    # Get the dictionary for the language
    lang_dict = translations.get(lang)

    # Get the specific string, falling back to English if the key is missing
    translation_string = lang_dict.get(key)
    if translation_string is None:
        # Fallback to English if key doesn't exist in the target language
        translation_string = translations.get("en", {}).get(key, key)

    return translation_string
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\BackendApplication.java
--------------------------------------------------------------------
package com.smartretail.backend;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.scheduling.annotation.EnableScheduling;

@SpringBootApplication
@EnableScheduling
public class BackendApplication {
	public static void main(String[] args) {
		SpringApplication.run(BackendApplication.class, args);
	}
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\config
--------------------------------------------------------------------
Contents:
AppConfig.java
DuplicateResourceException.java
GlobalExceptionHandler.java
GridFSConfig.java
I18nConfig.java
InsufficientStockException.java
ResourceNotFoundException.java
SecurityConfig.java

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\config\AppConfig.java
--------------------------------------------------------------------
package com.smartretail.backend.config;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder; // <-- NEW IMPORT
import org.springframework.security.crypto.password.PasswordEncoder; // <-- NEW IMPORT
import org.springframework.web.client.RestTemplate;

@Configuration
public class AppConfig {
    @Bean
    public RestTemplate restTemplate() {
        return new RestTemplate();
    }

    // --- ADD THIS BEAN ---
    @Bean
    public PasswordEncoder passwordEncoder() {
        return new BCryptPasswordEncoder();
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\config\DuplicateResourceException.java
--------------------------------------------------------------------
package com.smartretail.backend.config;

import lombok.Getter;

// DuplicateResourceException.java
@Getter
public class DuplicateResourceException extends RuntimeException {
    private final String messageKey;
    private final String resourceId;

    public DuplicateResourceException(String messageKey, String resourceId) {
        super("Duplicate resource: " + resourceId);
        this.messageKey = messageKey;
        this.resourceId = resourceId;
    }

}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\config\GlobalExceptionHandler.java
--------------------------------------------------------------------
package com.smartretail.backend.config;

import com.smartretail.backend.exception.ProductNotFoundException;
import org.springframework.context.MessageSource;
import org.springframework.context.NoSuchMessageException;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.web.HttpRequestMethodNotSupportedException;
import org.springframework.web.bind.annotation.ControllerAdvice;
import org.springframework.web.bind.annotation.ExceptionHandler;
import org.springframework.web.context.request.WebRequest;

import java.util.HashMap;
import java.util.Map;
import java.util.MissingResourceException;

@ControllerAdvice
public class GlobalExceptionHandler {

    private final MessageSource messageSource;

    public GlobalExceptionHandler(MessageSource messageSource) {
        this.messageSource = messageSource;
    }

    @ExceptionHandler(NoSuchMessageException.class)
    public ResponseEntity<Map<String, String>> handleNoSuchMessageException(NoSuchMessageException ex, WebRequest request) {
        Map<String, String> errorResponse = new HashMap<>();
        request.getLocale();
        String locale = request.getLocale().toString();
        errorResponse.put("error", "Missing message: " + ex.getMessage() + " for locale: " + locale);
        return new ResponseEntity<>(errorResponse, HttpStatus.INTERNAL_SERVER_ERROR);
    }

    @ExceptionHandler(HttpRequestMethodNotSupportedException.class)
    public ResponseEntity<Map<String, String>> handleMethodNotSupportedException(HttpRequestMethodNotSupportedException ex, WebRequest request) {
        Map<String, String> errorResponse = new HashMap<>();
        errorResponse.put("error", "Request method '" + ex.getMethod() + "' is not supported for this endpoint");
        return new ResponseEntity<>(errorResponse, HttpStatus.METHOD_NOT_ALLOWED);
    }

    @ExceptionHandler(IllegalArgumentException.class)
    public ResponseEntity<Map<String, String>> handleIllegalArgumentException(IllegalArgumentException ex, WebRequest request) {
        Map<String, String> errorResponse = new HashMap<>();
        errorResponse.put("error", ex.getMessage());
        return new ResponseEntity<>(errorResponse, HttpStatus.BAD_REQUEST);
    }

    @ExceptionHandler(DuplicateResourceException.class)
    public ResponseEntity<Map<String, String>> handleDuplicateResourceException(DuplicateResourceException ex, WebRequest request) {
        Map<String, String> errorResponse = new HashMap<>();
        errorResponse.put("error", messageSource.getMessage(ex.getMessage(), new Object[]{ex.getResourceId()}, request.getLocale()));
        return new ResponseEntity<>(errorResponse, HttpStatus.BAD_REQUEST);
    }

    @ExceptionHandler(ResourceNotFoundException.class)
    public ResponseEntity<Map<String, String>> handleResourceNotFoundException(ResourceNotFoundException ex, WebRequest request) {
        Map<String, String> errorResponse = new HashMap<>();
        errorResponse.put("error", messageSource.getMessage(ex.getMessage(), new Object[]{ex.getResourceId()}, request.getLocale()));
        return new ResponseEntity<>(errorResponse, HttpStatus.NOT_FOUND);
    }

    @ExceptionHandler(ProductNotFoundException.class)
    public ResponseEntity<Map<String, String>> handleProductNotFoundException(ProductNotFoundException ex, WebRequest request) {
        Map<String, String> errorResponse = new HashMap<>();
        errorResponse.put("error", ex.getMessage());
        return new ResponseEntity<>(errorResponse, HttpStatus.NOT_FOUND);
    }

    @ExceptionHandler(MissingResourceException.class)
    public ResponseEntity<Map<String, String>> handleMissingResourceException(MissingResourceException ex, WebRequest request) {
        Map<String, String> errorResponse = new HashMap<>();
        errorResponse.put("error", "Resource not found: " + ex.getMessage());
        return new ResponseEntity<>(errorResponse, HttpStatus.INTERNAL_SERVER_ERROR);
    }

    @ExceptionHandler(RuntimeException.class)
    public ResponseEntity<Map<String, String>> handleRuntimeException(RuntimeException ex, WebRequest request) {
        Map<String, String> errorResponse = new HashMap<>();
        errorResponse.put("error", ex.getMessage());
        return new ResponseEntity<>(errorResponse, HttpStatus.BAD_REQUEST);
    }

    @ExceptionHandler(Exception.class)
    public ResponseEntity<Map<String, String>> handleAllExceptions(Exception ex, WebRequest request) {
        Map<String, String> errorResponse = new HashMap<>();
        String errorMessage = messageSource.getMessage("error.generic", null, request.getLocale());
        errorResponse.put("error", errorMessage + ": " + ex.getMessage());
        return new ResponseEntity<>(errorResponse, HttpStatus.INTERNAL_SERVER_ERROR);
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\config\GridFSConfig.java
--------------------------------------------------------------------
package com.smartretail.backend.config;

import com.mongodb.client.MongoClient;
import com.mongodb.client.gridfs.GridFSBucket;
import com.mongodb.client.gridfs.GridFSBuckets;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

@Configuration
public class GridFSConfig {
    @Bean
    public GridFSBucket gridFSBucket(MongoClient mongoClient) {
        return GridFSBuckets.create(mongoClient.getDatabase("smartretail"));
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\config\I18nConfig.java
--------------------------------------------------------------------
package com.smartretail.backend.config;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.support.ReloadableResourceBundleMessageSource;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;
import org.springframework.web.servlet.i18n.AcceptHeaderLocaleResolver;

import java.util.Arrays;
import java.util.Locale;

@Configuration
public class I18nConfig implements WebMvcConfigurer {

    @Bean
    public ReloadableResourceBundleMessageSource messageSource() {
        ReloadableResourceBundleMessageSource messageSource = new ReloadableResourceBundleMessageSource();
        messageSource.setBasename("classpath:messages");
        messageSource.setDefaultEncoding("UTF-8");
        messageSource.setDefaultLocale(Locale.ENGLISH);
        messageSource.setCacheSeconds(3600); // Cache for 1 hour
        messageSource.setFallbackToSystemLocale(false);
        return messageSource;
    }

    @Bean
    public AcceptHeaderLocaleResolver localeResolver() {
        AcceptHeaderLocaleResolver resolver = new AcceptHeaderLocaleResolver();
        resolver.setSupportedLocales(Arrays.asList(
                Locale.ENGLISH,
                Locale.forLanguageTag("hi"), // Hindi
                Locale.forLanguageTag("mr"), // Marathi
                Locale.forLanguageTag("te"), // Telugu
                Locale.US // Fallback
        ));
        resolver.setDefaultLocale(Locale.ENGLISH);
        return resolver;
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\config\InsufficientStockException.java
--------------------------------------------------------------------
package com.smartretail.backend.config;

import lombok.Getter;

// InsufficientStockException.java
@Getter
public class InsufficientStockException extends RuntimeException {
    private final String productId;

    public InsufficientStockException(String productId) {
        super("Insufficient stock for product: " + productId);
        this.productId = productId;
    }

}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\config\ResourceNotFoundException.java
--------------------------------------------------------------------
package com.smartretail.backend.config;

import lombok.Getter;

// ResourceNotFoundException.java
@Getter
public class ResourceNotFoundException extends RuntimeException {
    private final String messageKey;
    private final String resourceId;

    public ResourceNotFoundException(String messageKey, String resourceId) {
        super("Resource not found: " + resourceId);
        this.messageKey = messageKey;
        this.resourceId = resourceId;
    }

}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\config\SecurityConfig.java
--------------------------------------------------------------------
package com.smartretail.backend.config;

import com.smartretail.backend.security.CustomOAuth2AuthenticationSuccessHandler;
import com.smartretail.backend.security.JwtAuthenticationFilter;
import com.smartretail.backend.service.UserService;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Lazy;
import org.springframework.security.authentication.AuthenticationManager;
import org.springframework.security.config.annotation.authentication.configuration.AuthenticationConfiguration;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.config.annotation.web.configurers.AbstractHttpConfigurer;
import org.springframework.security.config.http.SessionCreationPolicy;
import org.springframework.security.web.SecurityFilterChain;
import org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter;
import org.springframework.web.cors.CorsConfiguration;
import org.springframework.web.cors.CorsConfigurationSource;
import org.springframework.web.cors.UrlBasedCorsConfigurationSource;

import java.util.Arrays;

@Configuration
@EnableWebSecurity
public class SecurityConfig {

    private final JwtAuthenticationFilter jwtAuthFilter;
    private final UserService userService;
    private final CustomOAuth2AuthenticationSuccessHandler oAuth2SuccessHandler;

    public SecurityConfig(JwtAuthenticationFilter jwtAuthFilter,
                          @Lazy UserService userService,
                          CustomOAuth2AuthenticationSuccessHandler oAuth2SuccessHandler) {
        this.jwtAuthFilter = jwtAuthFilter;
        this.userService = userService;
        this.oAuth2SuccessHandler = oAuth2SuccessHandler;
    }

    @Bean
    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
        http
                .cors(cors -> cors.configurationSource(corsConfigurationSource()))
                .authorizeHttpRequests(auth -> auth
                        .requestMatchers("/static/**", "/css/**", "/js/**", "/images/**").permitAll()
                        .requestMatchers("/api/auth/**", "/error", "/static/**", "/", "/index.html", "/favicon.ico", "/login/oauth2/**", "/oauth2/**").permitAll()
                        .requestMatchers("/api/bills/{billId}/pdf").permitAll()

                        // Allow anyone to GET product images
                        .requestMatchers(org.springframework.http.HttpMethod.GET, "/api/products/image/**").permitAll()

                        // This rule now correctly secures the other product endpoints
                        .requestMatchers("/api/products/**", "/api/bills/**").hasAnyRole("MANAGER","OWNER")

                        // --- ADD THIS LINE ---
                        .requestMatchers(org.springframework.http.HttpMethod.POST, "/api/customers/send-email").hasAnyRole("MANAGER", "OWNER")

                        .requestMatchers("/api/customers/**").hasAnyRole("MANAGER", "CASHIER", "OWNER")
                        .requestMatchers("/api/reports/**").hasAnyRole("MANAGER", "OWNER")
                        .requestMatchers("/api/users/**").hasRole("OWNER")
                        .anyRequest().authenticated()
                )
                .csrf(AbstractHttpConfigurer::disable)
                .formLogin(AbstractHttpConfigurer::disable)
                .httpBasic(AbstractHttpConfigurer::disable)
                .sessionManagement(session -> session.sessionCreationPolicy(SessionCreationPolicy.STATELESS))
                .addFilterBefore(jwtAuthFilter, UsernamePasswordAuthenticationFilter.class)

                // --- OAUTH2 LOGIN CONFIG ---
                .oauth2Login(oauth2 -> {
                    oauth2.successHandler(oAuth2SuccessHandler);
                });

        return http.build();
    }

    @Bean
    public CorsConfigurationSource corsConfigurationSource() {
        CorsConfiguration configuration = new CorsConfiguration();
        configuration.setAllowedOrigins(Arrays.asList("https://your-vercel-app.vercel.app", "http://localhost:3000", "http://localhost:5173", "http://localhost:8080"));
        configuration.setAllowedMethods(Arrays.asList("GET", "POST", "PUT", "DELETE", "OPTIONS"));
        configuration.setAllowedHeaders(Arrays.asList("Authorization", "Content-Type", "Accept-Language"));
        configuration.setAllowCredentials(true);
        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();
        source.registerCorsConfiguration("/**", configuration);
        return source;
    }

    @Bean
    public AuthenticationManager authenticationManager(AuthenticationConfiguration authenticationConfiguration) throws Exception {
        return authenticationConfiguration.getAuthenticationManager();
    }
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\controller
--------------------------------------------------------------------
Contents:
AnalyticsController.java
AuthController.java
BillController.java
CustomerController.java
NotificationController.java
PaymentController.java
ProductController.java
PushNotificationController.java
ReportController.java
SyncController.java
UserController.java

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\controller\AnalyticsController.java
--------------------------------------------------------------------
package com.smartretail.backend.controller;

import com.smartretail.backend.service.AnalyticsService;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.web.bind.annotation.*;

import java.util.Map;

@RestController
@RequestMapping("/api/analytics")
public class AnalyticsController {
    private final AnalyticsService analyticsService;

    public AnalyticsController(AnalyticsService analyticsService) {
        this.analyticsService = analyticsService;
    }

    @GetMapping("/report")
    @PreAuthorize("hasAnyRole('OWNER','MANAGER')")
    public ResponseEntity<?> getReport(
            @RequestParam(required = false) String startDate,
            @RequestParam(required = false) String endDate) {
        try {
            Object data = analyticsService.getReport(startDate, endDate);
            return ResponseEntity.ok(data);
        } catch (Exception e) {
            return ResponseEntity.status(HttpStatus.SERVICE_UNAVAILABLE)
                    .body(Map.of("error", "Analytics service unavailable: " + e.getMessage()));
        }
    }

    @GetMapping("/report/text")
    @PreAuthorize("hasAnyRole('OWNER','MANAGER')")
    public ResponseEntity<?> getTextReport(
            @RequestParam(required = false) String startDate,
            @RequestParam(required = false) String endDate) {
        try {
            Object data = analyticsService.getTextReport(startDate, endDate);
            return ResponseEntity.ok(data);
        } catch (Exception e) {
            return ResponseEntity.status(HttpStatus.SERVICE_UNAVAILABLE)
                    .body(Map.of("error", "Analytics service unavailable: " + e.getMessage()));
        }
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\controller\AuthController.java
--------------------------------------------------------------------
package com.smartretail.backend.controller;

import com.smartretail.backend.dto.LoginRequest;
import com.smartretail.backend.dto.LoginResponse;
import com.smartretail.backend.dto.SignupRequest;
import com.smartretail.backend.models.User;
import com.smartretail.backend.service.AuthService;
import jakarta.validation.Valid;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

import java.util.HashMap;
import java.util.Map;

@RestController
@RequestMapping("/api/auth")
public class AuthController {
    private final AuthService authService;

    public AuthController(AuthService authService) {
        this.authService = authService;
    }

    @PostMapping("/signup")
    public ResponseEntity<?> signup(@Valid @RequestBody SignupRequest request) {
        User user = authService.signup(request);
        Map<String, Object> response = new HashMap<>();
        response.put("message", "User registered successfully");
        response.put("userId", user.getId());
        response.put("email", user.getEmail());
        return ResponseEntity.status(201).body(response);
    }

    @PostMapping("/login")
    public ResponseEntity<?> login(@Valid @RequestBody LoginRequest request) {
        LoginResponse loginResponse = authService.login(request);
        return ResponseEntity.ok(loginResponse);
    }

    @PostMapping("/refresh")
    public ResponseEntity<?> refreshToken(@RequestBody String refreshToken) {
        String newAccessToken = authService.refreshToken(refreshToken);
        Map<String, String> response = new HashMap<>();
        response.put("accessToken", newAccessToken);
        return ResponseEntity.ok(response);
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\controller\BillController.java
--------------------------------------------------------------------
package com.smartretail.backend.controller;

import com.fasterxml.jackson.core.type.TypeReference;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.opencsv.bean.CsvToBeanBuilder;
import com.smartretail.backend.models.Bill;
import com.smartretail.backend.service.BillService;
import com.smartretail.backend.service.PdfService;
import lombok.Getter;
import lombok.Setter;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.context.MessageSource;
import org.springframework.context.i18n.LocaleContextHolder;
import org.springframework.http.*;
import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.web.bind.annotation.*;
import org.springframework.web.multipart.MultipartFile;

import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.text.SimpleDateFormat;
import java.util.*;

@RestController
@RequestMapping("/api/bills")
@PreAuthorize("permitAll()")
@CrossOrigin(origins = "*")
public class BillController {

    private static final Logger logger = LoggerFactory.getLogger(BillController.class);
    private final BillService billService;
    private final PdfService pdfService;
    private final MessageSource messageSource;
    private final ObjectMapper objectMapper;

    public BillController(BillService billService, PdfService pdfService, MessageSource messageSource) {
        this.billService = billService;
        this.pdfService = pdfService;
        this.messageSource = messageSource;
        this.objectMapper = new ObjectMapper();
    }

    // ✅ Create a new bill
    @PostMapping
    public ResponseEntity<Map<String, Object>> createBill(@RequestBody Bill bill) {
        Locale locale = LocaleContextHolder.getLocale();
        logger.info("[BILL CONTROLLER] Creating bill request received: {}", bill.getBillId());

        // Defensive validation
        if (bill.getItems() == null || bill.getItems().isEmpty()) {
            return ResponseEntity.badRequest()
                    .body(Map.of("error", "Bill items cannot be empty"));
        }

        // ✅ Ensure total is recalculated even if frontend didn't send it
        bill.setTotalAmount(bill.calculateTotal());

        // Save using service
        Bill createdBill = billService.createBill(bill, locale);

        // ✅ Generate PDF access token for immediate download
        String pdfToken = billService.generatePdfAccessToken(createdBill.getBillId());

        logger.info("[BILL CONTROLLER] Bill {} created successfully. Total = ₹{}",
                createdBill.getBillId(), createdBill.getTotalAmount());

        // Return bill along with PDF token
        Map<String, Object> response = new HashMap<>();
        response.put("bill", createdBill);
        response.put("pdfAccessToken", pdfToken);
        response.put("pdfDownloadUrl", "/api/bills/" + createdBill.getBillId() + "/pdf?token=" + pdfToken);

        return new ResponseEntity<>(response, HttpStatus.CREATED);
    }

    // ✅ Get bill by ID
    @GetMapping("/{billId}")
    public ResponseEntity<Bill> getBillById(@PathVariable String billId) {
        Locale locale = LocaleContextHolder.getLocale();
        logger.debug("[BILL CONTROLLER] Fetching bill: {}", billId);
        Bill bill = billService.getBillById(billId, locale);
        return ResponseEntity.ok(bill);
    }

    // ✅ Get all bills
    @GetMapping
    public ResponseEntity<List<Bill>> getAllBills() {
        logger.debug("[BILL CONTROLLER] Fetching all bills");
        List<Bill> bills = billService.getAllBills();
        return ResponseEntity.ok(bills);
    }

    // ✅ Generate PDF access token for existing bill
    @PostMapping("/{billId}/generate-token")
    public ResponseEntity<Map<String, String>> generatePdfToken(@PathVariable String billId) {
        Locale locale = LocaleContextHolder.getLocale();
        logger.info("[BILL CONTROLLER] Generating PDF token for bill: {}", billId);

        // Verify bill exists
        billService.getBillById(billId, locale);

        String pdfToken = billService.generatePdfAccessToken(billId);

        Map<String, String> response = new HashMap<>();
        response.put("billId", billId);
        response.put("pdfAccessToken", pdfToken);
        response.put("pdfDownloadUrl", "/api/bills/" + billId + "/pdf?token=" + pdfToken);

        return ResponseEntity.ok(response);
    }

    // ✅ Generate Bill PDF (Optimized version)
    @GetMapping(value = "/{billId}/pdf", produces = MediaType.APPLICATION_PDF_VALUE)
    public ResponseEntity<byte[]> downloadBillPdf(@PathVariable String billId,
                                                  @RequestParam(required = false) String token) {
        Locale locale = LocaleContextHolder.getLocale();
        logger.info("[BILL CONTROLLER] Generating PDF for Bill ID: {}", billId);

        // Token validation – allow download only with a valid token
        if (token == null || !billService.validatePdfAccessToken(billId, token)) {
            logger.warn("[BILL CONTROLLER] Invalid or missing token for Bill {}", billId);
            return ResponseEntity.status(HttpStatus.FORBIDDEN)
                    .body(null);
        }

        try {
            Bill bill = billService.getBillById(billId, locale);
            byte[] pdfBytes = pdfService.generateBillPdf(bill, locale);

            HttpHeaders headers = new HttpHeaders();
            headers.setContentType(MediaType.APPLICATION_PDF);
            headers.setContentDispositionFormData("attachment", "Bill_" + billId + ".pdf");
            headers.setCacheControl("no-cache, no-store, must-revalidate");
            headers.add(HttpHeaders.ACCESS_CONTROL_EXPOSE_HEADERS, "Content-Disposition");

            logger.info("[BILL CONTROLLER] PDF generated successfully for Bill ID: {}", billId);
            return new ResponseEntity<>(pdfBytes, headers, HttpStatus.OK);
        } catch (Exception e) {
            logger.error("[BILL CONTROLLER] Error generating PDF for Bill {}: {}", billId, e.getMessage());
            return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).build();
        }
    }

    // ✅ Resend Bill Email
    @PostMapping("/resend-email/{billId}")
    public ResponseEntity<?> resendBillEmail(@PathVariable String billId) {
        Locale locale = LocaleContextHolder.getLocale();
        try {
            logger.info("[BILL CONTROLLER] Resend request received for bill: {}", billId);
            Bill bill = billService.getBillById(billId, locale);

            if (bill == null) {
                logger.warn("[BILL CONTROLLER] Bill not found: {}", billId);
                return ResponseEntity.status(404)
                        .body(Map.of("error", "Bill not found: " + billId));
            }

            billService.resendBillEmail(bill, locale);
            logger.info("[BILL CONTROLLER] Bill email resent successfully for: {}", billId);

            // Generate new token for the resent email
            String newToken = billService.generatePdfAccessToken(billId);

            return ResponseEntity.ok(Map.of(
                    "message", "Bill email resent successfully",
                    "pdfAccessToken", newToken
            ));

        } catch (RuntimeException e) {
            logger.error("[BILL CONTROLLER] Failed to resend bill email: {}", e.getMessage());
            return ResponseEntity.badRequest()
                    .body(Map.of("error", "Failed to resend bill email"));
        }
    }

    // ✅ Bulk upload (CSV)
    @PostMapping("/bulk")
    public ResponseEntity<Map<String, Object>> bulkUploadBills(
            @RequestPart("file") MultipartFile file) {
        Locale locale = LocaleContextHolder.getLocale();
        logger.info("[BILL CONTROLLER] Starting bulk upload");

        if (file == null || file.isEmpty()) {
            throw new IllegalArgumentException(messageSource.getMessage("file.missing", null, locale));
        }

        String filename = file.getOriginalFilename();
        if (filename == null || !filename.toLowerCase().endsWith(".csv")) {
            throw new IllegalArgumentException(messageSource.getMessage("file.invalid.format", null, locale));
        }

        Map<String, Object> result = new HashMap<>();
        List<Map<String, Object>> successfulBills = new ArrayList<>();
        List<String> skippedBills = new ArrayList<>();
        List<String> errorMessages = new ArrayList<>();

        // DateFormat for 'createdAt' field
        SimpleDateFormat df = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss.SSS'Z'");
        df.setTimeZone(TimeZone.getTimeZone("UTC"));

        try (BufferedReader reader = new BufferedReader(new InputStreamReader(file.getInputStream()))) {
            List<BillCsvBean> csvBeans = new CsvToBeanBuilder<BillCsvBean>(reader)
                    .withType(BillCsvBean.class)
                    .withIgnoreLeadingWhiteSpace(true)
                    .withIgnoreEmptyLine(true)
                    .build()
                    .parse();

            for (int i = 0; i < csvBeans.size(); i++) {
                BillCsvBean csvBean = csvBeans.get(i);
                int row = i + 2;

                try {
                    if (csvBean.getBillId() == null || csvBean.getBillId().trim().isEmpty()) {
                        errorMessages.add("Row " + row + ": Missing billId");
                        continue;
                    }

                    if (billService.existsByBillId(csvBean.getBillId())) {
                        skippedBills.add("Row " + row + ": Duplicate bill ID " + csvBean.getBillId());
                        continue;
                    }

                    // Parse JSON items
                    List<Bill.BillItem> items = objectMapper.readValue(
                            csvBean.getItems(),
                            new TypeReference<List<Bill.BillItem>>() {}
                    );

                    Bill bill = new Bill();
                    bill.setBillId(csvBean.getBillId());
                    bill.setAddedBy(csvBean.getAddedBy());
                    Bill.CustomerInfo info = new Bill.CustomerInfo();
                    info.setMobile(csvBean.getCustomerMobile());
                    bill.setCustomer(info);
                    bill.setItems(items);

                    // Parse and set createdAt from CSV
                    try {
                        if (csvBean.getCreatedAt() != null && !csvBean.getCreatedAt().trim().isEmpty()) {
                            bill.setCreatedAt(df.parse(csvBean.getCreatedAt()));
                        } else {
                            bill.setCreatedAt(new Date()); // Fallback to now
                        }
                    } catch (Exception e) {
                        logger.warn("Row " + row + ": Invalid date format for " + csvBean.getCreatedAt() + ". Defaulting to now.");
                        bill.setCreatedAt(new Date());
                    }

                    bill.setTotalAmount(bill.calculateTotal());

                    Bill saved = billService.createBill(bill, locale, true); // Use sync mode for bulk upload

                    // Generate token for each successful bill
                    String pdfToken = billService.generatePdfAccessToken(saved.getBillId());

                    Map<String, Object> billResponse = new HashMap<>();
                    billResponse.put("bill", saved);
                    billResponse.put("pdfAccessToken", pdfToken);
                    successfulBills.add(billResponse);

                } catch (Exception e) {
                    errorMessages.add("Row " + row + ": " + e.getMessage());
                }
            }

        } catch (Exception e) {
            errorMessages.add("File processing failed: " + e.getMessage());
        }

        result.put("successful", successfulBills.size());
        result.put("skipped", skippedBills.size());
        result.put("errors", errorMessages.size());
        result.put("successfulBills", successfulBills);
        result.put("skippedDetails", skippedBills);
        result.put("errorDetails", errorMessages);

        return new ResponseEntity<>(result, HttpStatus.CREATED);
    }

    @Getter
    @Setter
    public static class BillCsvBean {
        private String billId;
        private String customerMobile;
        private String items;
        private String createdAt;
        private String addedBy;
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\controller\CustomerController.java
--------------------------------------------------------------------
package com.smartretail.backend.controller;

import com.smartretail.backend.dto.CustomEmailRequest; // <-- ADDED IMPORT
import com.smartretail.backend.models.Bill;
import com.smartretail.backend.models.Customer;
import com.smartretail.backend.service.CustomerService;
import com.smartretail.backend.service.ReminderService;
import jakarta.validation.Valid;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.format.annotation.DateTimeFormat;
import org.springframework.http.ResponseEntity;
import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.web.bind.annotation.*;

import java.util.Date;
import java.util.List;
import java.util.Locale;
import java.util.Map;

@RestController
@RequestMapping("/api/customers")
public class CustomerController {

    private static final Logger logger = LoggerFactory.getLogger(CustomerController.class);

    private final CustomerService customerService;
    private final ReminderService reminderService;

    public CustomerController(CustomerService customerService, ReminderService reminderService) {
        this.customerService = customerService;
        this.reminderService = reminderService;
    }

    @PostMapping
    @PreAuthorize("hasAnyRole('OWNER', 'MANAGER', 'CASHIER')")
    public ResponseEntity<Customer> createCustomer(
            @Valid @RequestBody Customer customer,
            @RequestHeader(value = "Accept-Language", defaultValue = "en", required = false) String language) {
        Locale locale = parseLocale(language);
        logger.debug("Creating customer with mobile: {}", customer.getMobile());
        Customer savedCustomer = customerService.createCustomer(customer, locale);
        return ResponseEntity.status(201).body(savedCustomer);
    }

    @GetMapping("/{id}")
    @PreAuthorize("hasAnyRole('OWNER', 'MANAGER', 'CASHIER')")
    public ResponseEntity<Customer> getCustomerById(
            @PathVariable String id,
            @RequestHeader(value = "Accept-Language", defaultValue = "en", required = false) String language) {
        Locale locale = parseLocale(language);
        logger.debug("Fetching customer with ID: {}", id);
        Customer customer = customerService.getCustomerById(id, locale);
        return ResponseEntity.ok(customer);
    }

    @GetMapping
    @PreAuthorize("hasAnyRole('OWNER', 'MANAGER', 'CASHIER')")
    public ResponseEntity<List<Customer>> getAllCustomers(
            @RequestHeader(value = "Accept-Language", defaultValue = "en", required = false) String language) {
        Locale locale = parseLocale(language);
        logger.debug("Fetching all customers");
        List<Customer> customers = customerService.getAllCustomers();
        return ResponseEntity.ok(customers);
    }

    @PutMapping("/{id}")
    @PreAuthorize("hasAnyRole('OWNER', 'MANAGER')")
    public ResponseEntity<Customer> updateCustomer(
            @PathVariable String id,
            @Valid @RequestBody Customer customer,
            @RequestHeader(value = "Accept-Language", defaultValue = "en", required = false) String language) {
        Locale locale = parseLocale(language);
        logger.debug("Updating customer with ID: {}", id);
        Customer updatedCustomer = customerService.updateCustomer(id, customer, locale);
        return ResponseEntity.ok(updatedCustomer);
    }

    @DeleteMapping("/{id}")
    @PreAuthorize("hasAnyRole('OWNER', 'MANAGER')")
    public ResponseEntity<Void> deleteCustomer(
            @PathVariable String id,
            @RequestHeader(value = "Accept-Language", defaultValue = "en", required = false) String language) {
        Locale locale = parseLocale(language);
        logger.debug("Deleting customer with ID: {}", id);
        customerService.deleteCustomer(id, locale);
        return ResponseEntity.noContent().build();
    }

    @GetMapping("/{id}/purchase-history")
    @PreAuthorize("hasAnyRole('OWNER', 'MANAGER', 'CASHIER')")
    public ResponseEntity<List<Bill>> getCustomerPurchaseHistory(
            @PathVariable String id,
            @RequestParam(required = false) @DateTimeFormat(iso = DateTimeFormat.ISO.DATE) Date startDate,
            @RequestParam(required = false) @DateTimeFormat(iso = DateTimeFormat.ISO.DATE) Date endDate,
            @RequestHeader(value = "Accept-Language", defaultValue = "en", required = false) String language) {
        Locale locale = parseLocale(language);
        logger.debug("Fetching purchase history for customer ID: {}, startDate: {}, endDate: {}", id, startDate, endDate);
        List<Bill> purchaseHistory = customerService.getCustomerPurchaseHistory(id, startDate, endDate, locale);
        return ResponseEntity.ok(purchaseHistory);
    }

    // --- NEW ENDPOINT: Send Custom Email ---
    @PostMapping("/send-email")
    @PreAuthorize("hasAnyRole('OWNER', 'MANAGER')")
    public ResponseEntity<Map<String, String>> sendCustomEmail(
            @Valid @RequestBody CustomEmailRequest request,
            @RequestHeader(value = "Accept-Language", defaultValue = "en", required = false) String language) {

        Locale locale = parseLocale(language);
        logger.info("[CUSTOMER CONTROLLER] Received request to send custom email to {} customers", request.getCustomerIds().size());

        // Fire-and-forget async execution (non-blocking)
        new Thread(() -> {
            try {
                customerService.sendCustomEmail(request, locale);
            } catch (Exception e) {
                logger.error("[CUSTOMER CONTROLLER] Error in async email sending", e);
            }
        }).start();

        return ResponseEntity.ok(
                Map.of("message", "Email sending process initiated for " + request.getCustomerIds().size() + " customers.")
        );
    }

    @PostMapping("/reminders")
    @PreAuthorize("hasAnyRole('OWNER', 'MANAGER')")
    public ResponseEntity<Map<String, String>> triggerMonthlyPurchaseReminders(
            @RequestHeader(value = "Accept-Language", defaultValue = "en", required = false) String language) {
        Locale locale = parseLocale(language);
        logger.debug("Triggering monthly purchase reminders manually");
        reminderService.sendMonthlyPurchaseReminders();
        return ResponseEntity.ok(Map.of("message", "Monthly purchase reminders triggered successfully"));
    }

    private Locale parseLocale(String acceptLanguage) {
        if (acceptLanguage == null || acceptLanguage.isEmpty()) {
            return Locale.ENGLISH;
        }
        String primaryLang = acceptLanguage.split(",")[0].split(";")[0].trim();
        String[] parts = primaryLang.split("-");
        if (parts.length == 2) {
            return new Locale(parts[0], parts[1]);
        }
        return new Locale(parts[0]);
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\controller\NotificationController.java
--------------------------------------------------------------------
package com.smartretail.backend.controller;

import com.smartretail.backend.models.Notification;
import com.smartretail.backend.service.NotificationService;
import jakarta.validation.Valid;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@RestController
@RequestMapping("/api/notifications")
public class NotificationController {
    private final NotificationService notificationService;

    public NotificationController(NotificationService notificationService) {
        this.notificationService = notificationService;
    }

    @PostMapping
    public ResponseEntity<Notification> createNotification(@Valid @RequestBody Notification notification) {
        Notification savedNotification = notificationService.createNotification(notification);
        return ResponseEntity.status(201).body(savedNotification);
    }

    @GetMapping
    public ResponseEntity<List<Notification>> getAllNotifications() {
        List<Notification> notifications = notificationService.getAllNotifications();
        return ResponseEntity.ok(notifications);
    }

    @PostMapping("/test")
    @PreAuthorize("hasRole('MANAGER')")
    public ResponseEntity<String> testNotification(
            @RequestParam String email,
            @RequestParam String message
    ) {
        try {
            notificationService.sendEmail(email, "SmartRetail Test Notification", message);
            return new ResponseEntity<>("Test email sent", HttpStatus.OK);
        } catch (Exception e) {
            return new ResponseEntity<>("Failed to send test email: " + e.getMessage(), HttpStatus.INTERNAL_SERVER_ERROR);
        }
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\controller\PaymentController.java
--------------------------------------------------------------------
package com.smartretail.backend.controller;

import com.smartretail.backend.models.Payment;
import com.smartretail.backend.service.PaymentService;
import jakarta.validation.Valid;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@RestController
@RequestMapping("/api/payments")
public class PaymentController {
    private final PaymentService paymentService;

    public PaymentController(PaymentService paymentService) {
        this.paymentService = paymentService;
    }

    @PostMapping
    public ResponseEntity<Payment> createPayment(@Valid @RequestBody Payment payment) {
        Payment savedPayment = paymentService.createPayment(payment);
        return ResponseEntity.status(201).body(savedPayment);
    }

    @GetMapping("/{paymentId}")
    public ResponseEntity<Payment> getPaymentById(@PathVariable String paymentId) {
        Payment payment = paymentService.getPaymentById(paymentId);
        if (payment == null) {
            return ResponseEntity.notFound().build();
        }
        return ResponseEntity.ok(payment);
    }

    @GetMapping
    public ResponseEntity<List<Payment>> getAllPayments() {
        List<Payment> payments = paymentService.getAllPayments();
        return ResponseEntity.ok(payments);
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\controller\ProductController.java
--------------------------------------------------------------------
package com.smartretail.backend.controller;

import com.fasterxml.jackson.databind.ObjectMapper;
import com.opencsv.bean.CsvBindByName;
import com.opencsv.bean.CsvToBeanBuilder;
import com.smartretail.backend.dto.ProductRequest;
import com.smartretail.backend.models.Product;
import com.smartretail.backend.service.FileService;
import com.smartretail.backend.service.ProductService;
import jakarta.validation.Valid;
import lombok.Getter;
import lombok.Setter;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.MessageSource;
import org.springframework.http.HttpStatus;
import org.springframework.http.MediaType;
import org.springframework.http.ResponseEntity;
import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.web.bind.annotation.*;
import org.springframework.web.multipart.MultipartFile;
import org.springframework.http.HttpHeaders;
import org.springframework.core.io.ByteArrayResource;
import org.springframework.core.io.Resource;
import java.util.*;
import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.*;
import java.util.stream.Collectors;

@RestController
@RequestMapping("/api/products")
public class ProductController {

    private static final Logger logger = LoggerFactory.getLogger(ProductController.class);
    private static final SimpleDateFormat DATE_FMT = new SimpleDateFormat("yyyy-MM-dd");
    static { DATE_FMT.setLenient(false); }

    private final ProductService productService;
    private final FileService fileService;
    private final MessageSource messageSource;
    private final ObjectMapper objectMapper = new ObjectMapper();

    @Autowired
    public ProductController(ProductService productService,
                             FileService fileService,
                             MessageSource messageSource) {
        this.productService = productService;
        this.fileService = fileService;
        this.messageSource = messageSource;
    }

    /* -------------------- CREATE -------------------- */
    @PostMapping(consumes = MediaType.APPLICATION_JSON_VALUE)
    @PreAuthorize("hasRole('MANAGER')")
    public ResponseEntity<Map<String, String>> createJson(
            @Valid @RequestBody ProductRequest request,
            @RequestHeader(value = "Accept-Language", defaultValue = "en") String lang) {

        Product product = toEntity(request);
        Product saved = productService.createProduct(product, parseLocale(lang));
        return buildCreatedResponse(saved);
    }

    @PostMapping(consumes = MediaType.MULTIPART_FORM_DATA_VALUE)
    @PreAuthorize("hasRole('MANAGER')")
    public ResponseEntity<Map<String, String>> createMultipart(
            @RequestParam("product") String productJson,
            @RequestPart(value = "imageFile", required = false) MultipartFile imageFile,
            @RequestHeader(value = "Accept-Language", defaultValue = "en") String lang) throws Exception {

        ProductRequest req = objectMapper.readValue(productJson, ProductRequest.class);
        Product product = toEntity(req);
        Product saved = productService.createProduct(product, imageFile, parseLocale(lang));
        return buildCreatedResponse(saved);
    }

    /* -------------------- IMAGE -------------------- */
    @GetMapping("/image/{imageId}")
    public ResponseEntity<Resource> getImage(@PathVariable String imageId) {
        try {
            Map<String, Object> imageData = fileService.getImage(imageId);
            byte[] bytes = (byte[]) imageData.get("bytes");
            String contentType = (String) imageData.get("contentType");

            ByteArrayResource resource = new ByteArrayResource(bytes);

            return ResponseEntity.ok()
                    .header(HttpHeaders.CONTENT_TYPE, contentType)
                    .contentLength(bytes.length)
                    .body(resource);
        } catch (Exception e) {
            logger.error("Failed to retrieve image: {}", imageId, e);
            return ResponseEntity.notFound().build();
        }
    }

    private ResponseEntity<Map<String, String>> buildCreatedResponse(Product p) {
        return ResponseEntity
                .status(HttpStatus.CREATED)
                .body(Map.of("message", "Product added successfully", "productId", p.getProductId()));
    }

    /* -------------------- READ -------------------- */
    @GetMapping("/{productId}")
    public ResponseEntity<Product> get(@PathVariable String productId,
                                       @RequestHeader(value = "Accept-Language", defaultValue = "en") String lang) {
        return ResponseEntity.ok(productService.getProductById(productId, parseLocale(lang)));
    }

    @GetMapping
    public ResponseEntity<List<Product>> list() {
        return ResponseEntity.ok(productService.getAllProducts());
    }

    /* -------------------- UPDATE -------------------- */
    @PutMapping(value = "/{productId}", consumes = MediaType.APPLICATION_JSON_VALUE)
    @PreAuthorize("hasRole('MANAGER')")
    public ResponseEntity<Map<String, String>> patch(
            @PathVariable String productId,
            @RequestBody Map<String, Object> updates,
            @RequestHeader(value = "Accept-Language", defaultValue = "en") String lang) {

        Locale locale = parseLocale(lang);
        Product patch = new Product();

        updates.forEach((k, v) -> {
            try {
                switch (k) {
                    case "name" -> patch.setName(safeString(v));
                    case "category" -> patch.setCategory(safeString(v));
                    case "price" -> patch.setPrice(safeDouble(v));
                    case "quantity" -> patch.setQuantity(safeInt(v));
                    case "minQuantity" -> patch.setMinQuantity(safeInt(v));
                    case "reorderLevel" -> patch.setReorderLevel(safeInt(v));
                    case "expiryDate" -> patch.setExpiryDate(parseDate(safeString(v)));
                    case "imageUrl" -> patch.setImageUrl(safeString(v));
                }
            } catch (Exception ex) {
                throw new IllegalArgumentException("Invalid value for field '" + k + "': " + v);
            }
        });

        Product updated = productService.updateProduct(productId, patch, locale);
        return ResponseEntity.ok(Map.of(
                "message", "Product updated successfully",
                "productId", updated.getProductId()));
    }

    @PutMapping(value = "/{productId}", consumes = MediaType.MULTIPART_FORM_DATA_VALUE)
    @PreAuthorize("hasRole('MANAGER')")
    public ResponseEntity<Map<String, String>> updateMultipart(
            @PathVariable String productId,
            @RequestParam("product") String productJson,
            @RequestPart(value = "imageFile", required = false) MultipartFile imageFile,
            @RequestHeader(value = "Accept-Language", defaultValue = "en") String lang) throws Exception {

        Locale locale = parseLocale(lang);

        // 1. Deserialize the JSON string into a Product object
        ProductRequest req = objectMapper.readValue(productJson, ProductRequest.class);
        Product productPatch = toEntity(req);

        // 2. Call the service method that handles file uploads
        Product updated = productService.updateProduct(productId, productPatch, imageFile, locale);

        // 3. Return the same response as your other methods
        return ResponseEntity.ok(Map.of(
                "message", "Product updated successfully",
                "productId", updated.getProductId()));
    }

    /* -------------------- DELETE -------------------- */
    @DeleteMapping("/{productId}")
    @PreAuthorize("hasRole('MANAGER') or hasRole('OWNER')")
    public ResponseEntity<Map<String, String>> delete(
            @PathVariable String productId,
            @RequestHeader(value = "Accept-Language", defaultValue = "en") String lang) {

        productService.deleteProduct(productId, parseLocale(lang));

        return ResponseEntity.ok(Map.of(
                "message", "Product deleted successfully",
                "productId", productId));
    }

    /* -------------------- BULK CSV -------------------- */
    @PostMapping("/bulk")
    @PreAuthorize("hasRole('MANAGER')")
    public ResponseEntity<Map<String, Object>> bulkUpload(
            @RequestPart("file") MultipartFile file,
            @RequestHeader(value = "Accept-Language", defaultValue = "en") String lang) throws Exception {

        Locale locale = parseLocale(lang);
        validateCsvFile(file, locale);

        List<Product> success = new ArrayList<>();
        List<String> skipped = new ArrayList<>();
        List<String> errors = new ArrayList<>();

        try (BufferedReader r = new BufferedReader(new InputStreamReader(file.getInputStream()))) {
            List<ProductCsvBean> beans = new CsvToBeanBuilder<ProductCsvBean>(r)
                    .withType(ProductCsvBean.class)
                    .withIgnoreLeadingWhiteSpace(true)
                    .build()
                    .parse();

            for (int i = 0; i < beans.size(); i++) {
                ProductCsvBean b = beans.get(i);
                int row = i + 2;
                try {
                    validateCsvRow(b, row, errors);
                    if (productService.existsByProductId(b.getProductId())) {
                        skipped.add("Row " + row + ": Product already exists");
                        continue;
                    }
                    Product p = fromCsvBean(b);
                    success.add(productService.createProduct(p, locale));
                } catch (Exception ex) {
                    errors.add("Row " + row + ": " + ex.getMessage());
                }
            }
        }

        Map<String, Object> result = new LinkedHashMap<>();
        result.put("successful", success.size());
        result.put("skipped", skipped.size());
        result.put("errors", errors.size());
        result.put("successfulProductIds", success.stream().map(Product::getProductId).collect(Collectors.toList()));
        result.put("skippedDetails", skipped);
        result.put("errorDetails", errors);
        return ResponseEntity.status(HttpStatus.CREATED).body(result);
    }

    /* -------------------- HELPERS -------------------- */
    private Locale parseLocale(String header) {
        if (header == null || header.isBlank()) return Locale.ENGLISH;
        String primary = header.split(",")[0].split(";")[0].trim();
        String[] parts = primary.split("-");
        return parts.length == 2 ? new Locale(parts[0], parts[1]) : new Locale(parts[0]);
    }

    private void validateCsvFile(MultipartFile file, Locale locale) {
        if (file == null || file.isEmpty()) {
            throw new IllegalArgumentException(messageSource.getMessage("file.missing", null, locale));
        }
        if (!file.getOriginalFilename().toLowerCase().endsWith(".csv")) {
            throw new IllegalArgumentException(messageSource.getMessage("file.invalid.format", null, locale));
        }
    }

    private void validateCsvRow(ProductCsvBean b, int row, List<String> errors) {
        if (b.getProductId() == null || b.getProductId().isBlank()) {
            errors.add("Row " + row + ": Product ID missing");
        }
        if (b.getName() == null || b.getName().isBlank()) {
            errors.add("Row " + row + ": Product name missing");
        }
    }

    private Product toEntity(ProductRequest r) {
        Product p = new Product();
        p.setProductId(r.getProductId());
        p.setName(r.getName());
        p.setCategory(r.getCategory());
        p.setPrice(r.getPrice());
        p.setQuantity(r.getQuantity());
        p.setMinQuantity(r.getMinQuantity() > 0 ? r.getMinQuantity() : 5);
        p.setReorderLevel(r.getReorderLevel() > 0 ? r.getReorderLevel() : 10);
        p.setSupplierEmail(Optional.ofNullable(r.getSupplierEmail()).orElse("default@supplier.com"));
        p.setAddedBy("system");
        p.setImageUrl(r.getImageUrl());

        if (r.getExpiryDate() != null && !r.getExpiryDate().isBlank()) {
            p.setExpiryDate(parseDate(r.getExpiryDate()));
        }
        return p;
    }

    private Product fromCsvBean(ProductCsvBean b) {
        Product p = new Product();
        p.setProductId(b.getProductId());
        p.setName(b.getName());
        p.setCategory(b.getCategory());
        p.setPrice(b.getPrice());
        p.setQuantity(b.getQuantity());
        p.setMinQuantity(b.getMinQuantity());
        p.setReorderLevel(b.getReorderLevel());
        p.setAddedBy(Optional.ofNullable(b.getAddedBy()).orElse("system"));
        p.setSupplierEmail("default@supplier.com");

        if (b.getExpiryDate() != null && !b.getExpiryDate().isBlank()) {
            p.setExpiryDate(parseDate(b.getExpiryDate()));
        }
        p.setCreatedAt(new Date());
        p.setLastUpdated(new Date());
        return p;
    }

    private Date parseDate(String s) {
        if (s == null || s.isBlank()) return null;
        try {
            return DATE_FMT.parse(s);
        } catch (ParseException e) {
            throw new IllegalArgumentException("Invalid date format, expected yyyy-MM-dd: " + s);
        }
    }

    private String safeString(Object o) { return o == null ? null : o.toString(); }
    private double safeDouble(Object o) { return o == null ? 0.0 : Double.parseDouble(o.toString()); }
    private int safeInt(Object o) { return o == null ? 0 : Integer.parseInt(o.toString()); }

    /* -------------------- CSV BEAN -------------------- */
    @Getter @Setter
    public static class ProductCsvBean {
        @CsvBindByName(required = true) private String productId;
        @CsvBindByName(required = true) private String name;
        @CsvBindByName private String category;
        @CsvBindByName private double price;
        @CsvBindByName private int quantity;
        @CsvBindByName private int minQuantity;
        @CsvBindByName private int reorderLevel;
        @CsvBindByName private String expiryDate;
        @CsvBindByName private String addedBy;
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\controller\PushNotificationController.java
--------------------------------------------------------------------
package com.smartretail.backend.controller;

import com.smartretail.backend.models.PushSubscription;
import com.smartretail.backend.service.PushNotificationService;
import org.springframework.http.ResponseEntity;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.web.bind.annotation.*;

@RestController
@RequestMapping("/api/notifications")
public class PushNotificationController {

    private final PushNotificationService pushNotificationService;

    public PushNotificationController(PushNotificationService pushNotificationService) {
        this.pushNotificationService = pushNotificationService;
    }

    @PostMapping("/subscribe")
    public ResponseEntity<String> subscribe(@RequestBody PushSubscription subscription) {
        Authentication auth = SecurityContextHolder.getContext().getAuthentication();
        String userId = auth.getName(); // Email or userId from JWT
        pushNotificationService.saveSubscription(userId, subscription);
        return ResponseEntity.ok("Subscription saved");
    }

    @GetMapping("/vapid-public-key")
    public ResponseEntity<String> getVapidPublicKey() {
        return ResponseEntity.ok(pushNotificationService.getVapidPublicKey());
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\controller\ReportController.java
--------------------------------------------------------------------
package com.smartretail.backend.controller;

import com.smartretail.backend.dto.FullReportResponse;
import com.smartretail.backend.service.AnalyticsService;
import com.smartretail.backend.service.ReportPdfService;
import com.smartretail.backend.service.ReportService;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.context.MessageSource;
import org.springframework.http.HttpHeaders;
import org.springframework.http.MediaType;
import org.springframework.http.ResponseEntity;
import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.web.bind.annotation.*;

import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.Locale;
import java.util.Map;
import java.util.TimeZone;

@RestController
@RequestMapping("/api/reports")
public class ReportController {
    private static final Logger logger = LoggerFactory.getLogger(ReportController.class);
    private final ReportService reportService;
    private final MessageSource messageSource;
    private final AnalyticsService analyticsService;
    private final ReportPdfService reportPdfService;

    public ReportController(ReportService reportService,
                            MessageSource messageSource,
                            AnalyticsService analyticsService,
                            ReportPdfService reportPdfService) {
        this.reportService = reportService;
        this.messageSource = messageSource;
        this.analyticsService = analyticsService;
        this.reportPdfService = reportPdfService;
    }

    @GetMapping("/sales")
    public ResponseEntity<Map<String, Object>> getSalesReport(
            @RequestParam String startDate,
            @RequestParam String endDate,
            Locale locale) {
        logger.debug("Fetching sales report: startDate={}, endDate={}", startDate, endDate);
        SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd");
        dateFormat.setTimeZone(TimeZone.getTimeZone("UTC")); // Parse dates in UTC
        dateFormat.setLenient(false);
        try {
            Date start = dateFormat.parse(startDate);
            Date end = dateFormat.parse(endDate);
            // Adjust endDate to include the full day
            end = new Date(end.getTime() + 24 * 60 * 60 * 1000 - 1); // End of day
            Map<String, Object> report = reportService.getSalesReport(start, end, locale);
            return ResponseEntity.ok(report);
        } catch (Exception e) {
            logger.error("Invalid date format: startDate={} or endDate={}", startDate, endDate, e);
            throw new IllegalArgumentException(
                    messageSource.getMessage("report.date.invalid", new Object[]{startDate + " or " + endDate}, locale));
        }
    }

    @GetMapping("/inventory")
    public ResponseEntity<Map<String, Object>> getInventoryReport(
            @RequestParam(defaultValue = "10") int lowStockThreshold,
            @RequestParam(defaultValue = "30") int expiryDays,
            Locale locale) {
        logger.debug("Fetching inventory report: lowStockThreshold={}, expiryDays={}", lowStockThreshold, expiryDays);
        Map<String, Object> report = reportService.getInventoryReport(lowStockThreshold, expiryDays, locale);
        return ResponseEntity.ok(report);
    }

    @GetMapping("/full")
    @PreAuthorize("hasAnyRole('OWNER','MANAGER')")
    public ResponseEntity<FullReportResponse> getFullReport(
            @RequestParam String startDate,
            @RequestParam String endDate,
            @RequestParam(defaultValue = "10") int lowStockThreshold,
            @RequestParam(defaultValue = "30") int expiryDays,
            Locale locale) {

        logger.debug("Generating full report: {} to {}", startDate, endDate);
        // Delegate all logic to the service
        FullReportResponse fullReport = reportService.getFullReportData(startDate, endDate, lowStockThreshold, expiryDays, locale);
        return ResponseEntity.ok(fullReport);
    }

    @GetMapping("/full/pdf")
    @PreAuthorize("hasAnyRole('OWNER','MANAGER')")
    public ResponseEntity<byte[]> downloadFullReportPdf(
            @RequestParam String startDate,
            @RequestParam String endDate,
            @RequestParam(defaultValue = "10") int lowStockThreshold,
            @RequestParam(defaultValue = "30") int expiryDays,
            Locale locale) {

        logger.debug("Generating PDF report: {} to {}", startDate, endDate);

        // 1. Get the same data DTO
        FullReportResponse fullReport = reportService.getFullReportData(startDate, endDate, lowStockThreshold, expiryDays, locale);

        // 2. Pass DTO to PDF service
        byte[] pdfBytes = reportPdfService.generateFullReportPdf(fullReport, startDate, endDate, locale);

        // 3. Prepare headers for file download
        HttpHeaders headers = new HttpHeaders();
        headers.setContentType(MediaType.APPLICATION_PDF);
        String filename = String.format("SmartRetail_Report_%s_to_%s.pdf", startDate, endDate);
        headers.setContentDispositionFormData("attachment", filename);
        headers.setCacheControl("must-revalidate, post-check=0, pre-check=0");

        return ResponseEntity.ok()
                .headers(headers)
                .body(pdfBytes);
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\controller\SyncController.java
--------------------------------------------------------------------
package com.smartretail.backend.controller;

import com.smartretail.backend.models.Bill;
import com.smartretail.backend.models.Product;
import com.smartretail.backend.service.BillService;
import com.smartretail.backend.service.ProductService;
import lombok.Setter;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.http.ResponseEntity;
import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.web.bind.annotation.*;

import java.util.ArrayList;
import java.util.List;
import java.util.Locale;
import java.util.Map;

@RestController
@RequestMapping("/api/sync")
public class SyncController {
    private static final Logger logger = LoggerFactory.getLogger(SyncController.class);
    private final BillService billService;
    private final ProductService productService;

    public SyncController(BillService billService, ProductService productService) {
        this.billService = billService;
        this.productService = productService;
    }

    @PostMapping("/pending")
    @PreAuthorize("hasAnyRole('OWNER', 'MANAGER', 'CASHIER')")
    public ResponseEntity<Map<String, Object>> syncPendingData(
            @RequestBody SyncRequest syncRequest,
            @RequestHeader(value = "Accept-Language", defaultValue = "en") Locale locale) {
        logger.debug("[SYNC CONTROLLER] Processing sync request with {} bills and {} inventory updates",
                syncRequest.getBills().size(), syncRequest.getInventoryUpdates().size());

        List<String> processedBillIds = new ArrayList<>();
        List<String> processedProductIds = new ArrayList<>();
        List<String> errors = new ArrayList<>();

        // Process bills
        for (Bill bill : syncRequest.getBills()) {
            try {
                Bill savedBill = billService.createBill(bill, locale, true); // true = sync mode
                processedBillIds.add(savedBill.getBillId());
                logger.info("[SYNC CONTROLLER] Successfully synced bill: {}", savedBill.getBillId());
            } catch (Exception e) {
                logger.error("[SYNC CONTROLLER] Failed to sync bill {}: {}", bill.getBillId(), e.getMessage());
                errors.add("Bill " + bill.getBillId() + ": " + e.getMessage());
            }
        }

        // Process inventory updates
        for (Product product : syncRequest.getInventoryUpdates()) {
            try {
                // Use productId instead of id
                productService.updateProduct(product.getProductId(), product, locale, true); // true = sync mode
                processedProductIds.add(product.getProductId());
                logger.info("[SYNC CONTROLLER] Successfully synced product: {}", product.getProductId());
            } catch (Exception e) {
                logger.error("[SYNC CONTROLLER] Failed to sync product {}: {}", product.getProductId(), e.getMessage());
                errors.add("Product " + product.getProductId() + ": " + e.getMessage());
            }
        }

        Map<String, Object> response = Map.of(
                "processedBills", processedBillIds,
                "processedProducts", processedProductIds,
                "errors", errors,
                "message", errors.isEmpty() ? "Sync completed successfully" : "Sync completed with errors"
        );

        return ResponseEntity.ok(response);
    }

    // DTO for sync request
    @Setter
    public static class SyncRequest {
        private List<Bill> bills;
        private List<Product> inventoryUpdates;

        public List<Bill> getBills() {
            return bills != null ? bills : new ArrayList<>();
        }

        public List<Product> getInventoryUpdates() {
            return inventoryUpdates != null ? inventoryUpdates : new ArrayList<>();
        }
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\controller\UserController.java
--------------------------------------------------------------------
package com.smartretail.backend.controller;

import com.smartretail.backend.dto.SignupRequest;
import com.smartretail.backend.models.User;
import com.smartretail.backend.service.FileService;
import com.smartretail.backend.service.UserService;
import org.springframework.http.ResponseEntity;
import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@RestController
@RequestMapping("/api/users")
public class UserController {

    private final UserService userService;
    private final FileService fileService;

    public UserController(UserService userService, FileService fileService) {
        this.userService = userService;
        this.fileService = fileService;
    }

    @PostMapping
    @PreAuthorize("hasRole('OWNER')")
    public ResponseEntity<User> createUser(@RequestBody SignupRequest request) {
        User createdUser = userService.createUser(request);
        return ResponseEntity.ok(createdUser);
    }

    @GetMapping
    @PreAuthorize("hasRole('OWNER')")
    public ResponseEntity<List<User>> getAllUsers() {
        List<User> users = userService.getAllUsers();
        return ResponseEntity.ok(users);
    }

    @GetMapping("/{id}")
    @PreAuthorize("hasRole('OWNER')")
    public ResponseEntity<User> getUserById(@PathVariable String id) {
        User user = userService.getUserById(id);
        return ResponseEntity.ok(user);
    }

    @DeleteMapping("/{id}")
    @PreAuthorize("hasRole('OWNER')")
    public ResponseEntity<?> deleteUser(@PathVariable String id) {
        userService.deleteUser(id);
        return ResponseEntity.ok().build();
    }
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\dto
--------------------------------------------------------------------
Contents:
CustomEmailRequest.java
FullReportRequest.java
FullReportResponse.java
LoginRequest.java
LoginResponse.java
ProductRequest.java
SignupRequest.java

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\dto\CustomEmailRequest.java
--------------------------------------------------------------------
package com.smartretail.backend.dto;

import jakarta.validation.constraints.NotBlank;
import jakarta.validation.constraints.NotEmpty;
import lombok.Data;

import java.util.List;

@Data
public class CustomEmailRequest {

    @NotEmpty(message = "Customer ID list cannot be empty")
    private List<String> customerIds;

    @NotBlank(message = "Subject cannot be empty")
    private String subject;

    @NotBlank(message = "Body cannot be empty")
    private String body;
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\dto\FullReportRequest.java
--------------------------------------------------------------------
package com.smartretail.backend.dto;

import lombok.Getter;
import lombok.Setter;

@Getter
@Setter
public class FullReportRequest {
    private String startDate;
    private String endDate;
    private int lowStockThreshold = 10;
    private int expiryDays = 30;

    // Default constructor
    public FullReportRequest() {}

    // Getters and setters
    public String getStartDate() {
        return startDate;
    }

    public void setStartDate(String startDate) {
        this.startDate = startDate;
    }

    public String getEndDate() {
        return endDate;
    }

    public void setEndDate(String endDate) {
        this.endDate = endDate;
    }

    public int getLowStockThreshold() {
        return lowStockThreshold;
    }

    public void setLowStockThreshold(int lowStockThreshold) {
        this.lowStockThreshold = lowStockThreshold;
    }

    public int getExpiryDays() {
        return expiryDays;
    }

    public void setExpiryDays(int expiryDays) {
        this.expiryDays = expiryDays;
    }

    @Override
    public String toString() {
        return "FullReportRequest{" +
                "startDate='" + startDate + '\'' +
                ", endDate='" + endDate + '\'' +
                ", lowStockThreshold=" + lowStockThreshold +
                ", expiryDays=" + expiryDays +
                '}';
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\dto\FullReportResponse.java
--------------------------------------------------------------------
package com.smartretail.backend.dto;

import java.util.Map;

public class FullReportResponse {
    private Object salesReport;  // Changed from Map<String, Object> to Object
    private Object textSummary;  // This is what you're using in builder
    private Map<String, Object> inventoryReport;

    // Default constructor
    public FullReportResponse() {}

    // Constructor with all fields
    public FullReportResponse(Object salesReport, Object textSummary, Map<String, Object> inventoryReport) {
        this.salesReport = salesReport;
        this.textSummary = textSummary;
        this.inventoryReport = inventoryReport;
    }

    // Getters and setters
    public Object getSalesReport() {
        return salesReport;
    }

    public void setSalesReport(Object salesReport) {
        this.salesReport = salesReport;
    }

    public Object getTextSummary() {
        return textSummary;
    }

    public void setTextSummary(Object textSummary) {
        this.textSummary = textSummary;
    }

    public Map<String, Object> getInventoryReport() {
        return inventoryReport;
    }

    public void setInventoryReport(Map<String, Object> inventoryReport) {
        this.inventoryReport = inventoryReport;
    }

    // Builder pattern methods
    public static FullReportResponseBuilder builder() {
        return new FullReportResponseBuilder();
    }

    public static class FullReportResponseBuilder {
        private Object salesReport;
        private Object textSummary;
        private Map<String, Object> inventoryReport;

        public FullReportResponseBuilder salesReport(Object salesReport) {
            this.salesReport = salesReport;
            return this;
        }

        public FullReportResponseBuilder textSummary(Object textSummary) {
            this.textSummary = textSummary;
            return this;
        }

        public FullReportResponseBuilder inventoryReport(Map<String, Object> inventoryReport) {
            this.inventoryReport = inventoryReport;
            return this;
        }

        public FullReportResponse build() {
            return new FullReportResponse(salesReport, textSummary, inventoryReport);
        }
    }

    @Override
    public String toString() {
        return "FullReportResponse{" +
                "salesReport=" + salesReport +
                ", textSummary=" + textSummary +
                ", inventoryReport=" + inventoryReport +
                '}';
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\dto\LoginRequest.java
--------------------------------------------------------------------
package com.smartretail.backend.dto;

import jakarta.validation.constraints.Email;
import jakarta.validation.constraints.NotBlank;
import lombok.Getter;
import lombok.Setter;

@Setter
@Getter
public class LoginRequest {
    // Getters and Setters
    @NotBlank
    @Email
    private String email;

    @NotBlank
    private String password;

}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\dto\LoginResponse.java
--------------------------------------------------------------------
package com.smartretail.backend.dto;

import lombok.Getter;
import lombok.Setter;

@Setter
@Getter
public class LoginResponse {
    // Getters and Setters
    private String accessToken;
    private String refreshToken;

    public LoginResponse(String accessToken, String refreshToken) {
        this.accessToken = accessToken;
        this.refreshToken = refreshToken;
    }

}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\dto\ProductRequest.java
--------------------------------------------------------------------
package com.smartretail.backend.dto;

import jakarta.validation.constraints.NotBlank;
import jakarta.validation.constraints.Positive;
import jakarta.validation.constraints.Size;
import lombok.Data;
import lombok.NoArgsConstructor;
import lombok.AllArgsConstructor;

@Data
@NoArgsConstructor
@AllArgsConstructor
public class ProductRequest {
    private String productId;

    @NotBlank(message = "Name is required")
    private String name;

    private String category;

    @Positive(message = "Price must be positive")
    private double price;

    @Positive(message = "Quantity must be positive")
    private int quantity;

    private String expiryDate;
    private String imageUrl;
    private String supplierEmail;

    // Optional fields with defaults
    private int minQuantity = 5;
    private int reorderLevel = 10;
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\dto\SignupRequest.java
--------------------------------------------------------------------
package com.smartretail.backend.dto;

import jakarta.validation.constraints.Email;
import jakarta.validation.constraints.NotBlank;
import lombok.Getter;
import lombok.Setter;

@Setter
@Getter
public class SignupRequest {
    // Getters and Setters
    @NotBlank
    private String name;

    @NotBlank
    @Email
    private String email;

    @NotBlank
    private String password;

    @NotBlank
    private String role;

}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\exception
--------------------------------------------------------------------
Contents:
DuplicateMobileException.java
DuplicateResourceException.java
ProductNotFoundException.java
ResourceNotFoundException.java

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\exception\DuplicateMobileException.java
--------------------------------------------------------------------
package com.smartretail.backend.exception;

import lombok.Getter;

@Getter
public class DuplicateMobileException extends RuntimeException {
    private final String mobile;

    public DuplicateMobileException(String mobile) {
        super("Mobile already exists: " + mobile); // parent message bhi set ho gaya
        this.mobile = mobile;
    }

}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\exception\DuplicateResourceException.java
--------------------------------------------------------------------
package com.smartretail.backend.exception;

public class DuplicateResourceException extends RuntimeException {
    private final String messageKey;
    private final String resourceId;

    public DuplicateResourceException(String messageKey, String resourceId) {
        super("Duplicate resource: " + resourceId);
        this.messageKey = messageKey;
        this.resourceId = resourceId;
    }

    public String getMessageKey() { return messageKey; }
    public String getResourceId() { return resourceId; }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\exception\ProductNotFoundException.java
--------------------------------------------------------------------
package com.smartretail.backend.exception;

public class ProductNotFoundException extends RuntimeException {
    private final String productId;

    public ProductNotFoundException(String productId) {
        super(productId);
        this.productId = productId;
    }

    public String getProductId() {
        return productId;
    }
}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\exception\ResourceNotFoundException.java
--------------------------------------------------------------------
package com.smartretail.backend.exception;

public class ResourceNotFoundException extends RuntimeException {
    private final String messageKey;
    private final String resourceId;

    public ResourceNotFoundException(String messageKey, String resourceId) {
        super("Resource not found: " + resourceId);
        this.messageKey = messageKey;
        this.resourceId = resourceId;
    }

    public String getMessageKey() { return messageKey; }
    public String getResourceId() { return resourceId; }
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\models
--------------------------------------------------------------------
Contents:
AuditLog.java
Bill.java
Customer.java
Notification.java
Payment.java
Product.java
PushSubscription.java
RefreshToken.java
User.java

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\models\AuditLog.java
--------------------------------------------------------------------
package com.smartretail.backend.models;

import lombok.Getter;
import lombok.Setter;
import org.springframework.data.annotation.Id;
import org.springframework.data.mongodb.core.mapping.Document;

import java.util.Date;
import java.util.Map;

@Setter
@Getter
@Document(collection = "auditLogs")
public class AuditLog {
    // Getters and Setters
    @Id
    private String id;
    private String actionType;
    private String entityId;
    private String userEmail;
    private Date timestamp;
    private Map<String, Object> details;

    // Constructors
    public AuditLog() {}

    public AuditLog(String actionType, String entityId, String userEmail, Date timestamp, Map<String, Object> details) {
        this.actionType = actionType;
        this.entityId = entityId;
        this.userEmail = userEmail;
        this.timestamp = timestamp;
        this.details = details;
    }

}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\models\Bill.java
--------------------------------------------------------------------
package com.smartretail.backend.models;

import lombok.Getter;
import lombok.Setter;
import org.springframework.data.annotation.Id;
import org.springframework.data.mongodb.core.mapping.Document;

import java.util.Date;
import java.util.List;
import java.util.UUID;

@Setter
@Getter
@Document(collection = "bills")
public class Bill {

    @Id
    private String billId;
    private CustomerInfo customer;
    private List<BillItem> items;
    private double totalAmount;
    private Date createdAt;
    private String pdfAccessToken;
    private String addedBy;

    public Bill() {
        ensureDefaults();
    }

    public Bill(String billId, List<BillItem> items, String addedBy) {
        ensureDefaults();
        this.billId = billId;
        this.items = items;
        this.addedBy = addedBy;
        this.totalAmount = calculateTotal();
    }

    public Bill(String billId, CustomerInfo customer, List<BillItem> items,
                double totalAmount, String addedBy) {
        this(billId, items, addedBy);
        this.customer = customer;
        this.totalAmount = totalAmount;
    }

    // ✅ Ensure defaults are set every time (constructor OR deserialization)
    private void ensureDefaults() {
        if (this.createdAt == null)
            this.createdAt = new Date();
        if (this.pdfAccessToken == null || this.pdfAccessToken.isEmpty())
            this.pdfAccessToken = UUID.randomUUID().toString();
    }

    @Setter
    @Getter
    public static class BillItem {
        private String productId;
        private String productName;
        private int qty;
        private double price;

        public BillItem() {}

        public BillItem(String productId, String productName, int qty, double price) {
            this.productId = productId;
            this.productName = productName;
            this.qty = qty;
            this.price = price;
        }

        public double getItemTotal() {
            return this.qty * this.price;
        }
    }

    @Setter
    @Getter
    public static class CustomerInfo {
        private String name;
        private String email;
        private String mobile;

        public CustomerInfo() {}

        public CustomerInfo(String name, String email, String mobile) {
            this.name = name;
            this.email = email;
            this.mobile = mobile;
        }

        public boolean isValid() {
            return this.mobile != null && !this.mobile.trim().isEmpty();
        }
    }

    public boolean isValid() {
        return this.billId != null &&
                !this.billId.trim().isEmpty() &&
                this.items != null &&
                !this.items.isEmpty() &&
                this.addedBy != null &&
                !this.addedBy.trim().isEmpty();
    }

    public double calculateTotal() {
        if (this.items == null || this.items.isEmpty()) {
            return 0.0;
        }
        return this.items.stream()
                .mapToDouble(BillItem::getItemTotal)
                .sum();
    }

    // ✅ Automatically recalculate when items are updated
    public void setItems(List<BillItem> items) {
        this.items = items;
        this.totalAmount = calculateTotal();
    }
}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\models\Customer.java
--------------------------------------------------------------------
package com.smartretail.backend.models;

import lombok.Getter;
import lombok.Setter;
import org.springframework.data.annotation.Id;
import org.springframework.data.mongodb.core.mapping.Document;

import java.util.ArrayList;
import java.util.Date;
import java.util.List;

@Setter
@Getter
@Document(collection = "customers")
public class Customer {
    // Getters and Setters
    @Id
    private String id;
    private String name;
    private String email;
    private String mobile;
    private Date createdAt;
    private List<String> purchaseHistory;
    private int totalPurchaseCount;
    private Date lastPurchaseDate;

    public Customer() {
        this.purchaseHistory = new ArrayList<>();
        this.createdAt = new Date();
        this.totalPurchaseCount = 0;
        this.lastPurchaseDate = null;
    }

    public Customer(String name, String email, String mobile) {
        this.name = name;
        this.email = email;
        this.mobile = mobile;
        this.createdAt = new Date();
        this.purchaseHistory = new ArrayList<>();
        this.totalPurchaseCount = 0;
        this.lastPurchaseDate = null;
    }

    public void addBillId(String billId) {
        if (this.purchaseHistory == null) {
            this.purchaseHistory = new ArrayList<>();
        }
        this.purchaseHistory.add(billId);
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\models\Notification.java
--------------------------------------------------------------------
package com.smartretail.backend.models;

import lombok.Getter;
import lombok.Setter;
import org.springframework.data.annotation.Id;
import org.springframework.data.mongodb.core.mapping.Document;

import java.util.Date;

@Setter
@Getter
@Document(collection = "notifications")
public class Notification {
    @Id
    private String id;
    private String to;
    private String subject;
    private String message;
    private Date sentAt;

    public Notification() {
    }

    public Notification(String to, String subject, String message, Date sentAt) {
        this.to = to;
        this.subject = subject;
        this.message = message;
        this.sentAt = sentAt;
    }

}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\models\Payment.java
--------------------------------------------------------------------
package com.smartretail.backend.models;

import lombok.Data;
import org.springframework.data.annotation.Id;
import org.springframework.data.mongodb.core.index.Indexed;
import org.springframework.data.mongodb.core.mapping.Document;
import org.springframework.data.mongodb.core.mapping.Field;

import java.util.Date;

@Data
@Document(collection = "payments")
public class Payment {
    @Id
    private String id; // Maps to _id
    @Indexed(unique = true)
    private String paymentId; // e.g., "pay_2508171011"
    @Field("billId")
    private String billId; // References bills._id
    private double amount;
    private String paymentMode; // "CASH", "UPI"
    private String status; // "INITIATED", "SUCCESS", "FAILED"
    private String upiTransactionId; // Nullable
    private Date createdAt;
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\models\Product.java
--------------------------------------------------------------------
package com.smartretail.backend.models;

import jakarta.validation.constraints.NotBlank;
import lombok.Getter;
import lombok.Setter;
import org.springframework.data.annotation.Id;
import org.springframework.data.mongodb.core.index.Indexed;
import org.springframework.data.mongodb.core.mapping.Document;

import java.util.Date;

@Getter
@Setter
@Document(collection = "products")
public class Product {

    @Id
    private String id;                         // MongoDB _id

    @NotBlank(message = "Product ID is required")
    @Indexed(unique = true)
    private String productId;                  // custom business ID

    @NotBlank(message = "Product name is required")
    private String name;

    private String category;
    private double price;
    private int quantity;
    private int minQuantity;                   // minimum stock before alert
    private int reorderLevel;
    private Date expiryDate;
    private String imageId;                    // GridFS file id
    private String imageUrl;                   // public URL
    private String supplierEmail;
    private String addedBy;
    private Date lastUpdated;
    private Date createdAt;

    public Product() {
        this.createdAt = new Date();
        this.lastUpdated = new Date();
    }

    public Product(String productId, String name, String category, double price, int quantity,
                   int minQuantity, int reorderLevel, Date expiryDate, String imageId,
                   String imageUrl, String supplierEmail, String addedBy) {
        this.productId = productId;
        this.name = name;
        this.category = category;
        this.price = price;
        this.quantity = quantity;
        this.minQuantity = minQuantity;
        this.reorderLevel = reorderLevel;
        this.expiryDate = expiryDate;
        this.imageId = imageId;
        this.imageUrl = imageUrl;
        this.supplierEmail = supplierEmail;
        this.addedBy = addedBy;
        this.createdAt = new Date();
        this.lastUpdated = new Date();
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\models\PushSubscription.java
--------------------------------------------------------------------
package com.smartretail.backend.models;

import lombok.Getter;
import lombok.Setter;
import org.springframework.data.annotation.Id;
import org.springframework.data.mongodb.core.mapping.Document;

@Setter
@Getter
@Document(collection = "push_subscriptions")
public class PushSubscription {
    // Getters and Setters
    @Id
    private String id;
    private String userId; // Linked to User
    private String endpoint;
    private String p256dh;
    private String auth;

    // Constructors
    public PushSubscription() {}

    public PushSubscription(String userId, String endpoint, String p256dh, String auth) {
        this.userId = userId;
        this.endpoint = endpoint;
        this.p256dh = p256dh;
        this.auth = auth;
    }

}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\models\RefreshToken.java
--------------------------------------------------------------------
package com.smartretail.backend.models;

import lombok.Getter;
import lombok.Setter;
import org.springframework.data.annotation.Id;
import org.springframework.data.mongodb.core.mapping.Document;

import java.util.Date;

@Setter
@Getter
@Document(collection = "refresh_tokens")
public class RefreshToken {
    // Getters and Setters
    @Id
    private String id;
    private String userId;
    private String token;
    private Date expiryDate;

    // Constructors
    public RefreshToken() {}

    public RefreshToken(String userId, String token, Date expiryDate) {
        this.userId = userId;
        this.token = token;
        this.expiryDate = expiryDate;
    }

}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\models\User.java
--------------------------------------------------------------------
package com.smartretail.backend.models;

import lombok.Data;
import org.springframework.data.annotation.Id;
import org.springframework.data.mongodb.core.index.Indexed;
import org.springframework.data.mongodb.core.mapping.Document;

import java.util.Date;

@Data
@Document(collection = "users")
public class User {
    @Id
    private String id; // Maps to _id (MongoDB-generated ObjectId stored as String)
    private String userId; // Custom unique ID (e.g., "u101")
    @Indexed(unique = true)
    private String email; // Unique email
    private String name;
    private String password; // Hashed password
    private String role; // "OWNER", "MANAGER", "CASHIER"
    private Date createdAt;
    private Date lastLogin;

    public User(String userId, String email, String password, String name, String role) {
        this.userId = userId;
        this.email = email;
        this.password = password;
        this.name = name;
        this.role = role;
        this.createdAt = new Date();
        this.lastLogin = null;
    }

    public User() {

    }
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\repository
--------------------------------------------------------------------
Contents:
AuditLogRepository.java
BillRepository.java
CustomerRepository.java
NotificationRepository.java
PaymentRepository.java
ProductRepository.java
PushSubscriptionRepository.java
RefreshTokenRepository.java
UserRepository.java

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\repository\AuditLogRepository.java
--------------------------------------------------------------------
package com.smartretail.backend.repository;

import com.smartretail.backend.models.AuditLog;
import org.springframework.data.mongodb.repository.MongoRepository;

public interface AuditLogRepository extends MongoRepository<AuditLog, String> {
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\repository\BillRepository.java
--------------------------------------------------------------------
package com.smartretail.backend.repository;

import com.smartretail.backend.models.Bill;
import org.springframework.data.mongodb.repository.MongoRepository;

import java.util.Date;
import java.util.List;
import java.util.Optional;

public interface BillRepository extends MongoRepository<Bill, String> {
    Optional<Bill> findByBillId(String billId);
    boolean existsByBillId(String billId);
    List<Bill> findByCreatedAtBetween(Date startDate, Date endDate); // Added missing method
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\repository\CustomerRepository.java
--------------------------------------------------------------------
package com.smartretail.backend.repository;

import com.smartretail.backend.models.Customer;
import org.springframework.data.mongodb.repository.MongoRepository;
import java.util.Date; // **<-- ADD IMPORT**
import java.util.List; // **<-- ADD IMPORT**
import java.util.Optional;

public interface CustomerRepository extends MongoRepository<Customer, String> {
    Optional<Customer> findByMobile(String mobile);
    boolean existsByMobile(String mobile);

    // **--- ADD THIS NEW METHOD ---**
    List<Customer> findByLastPurchaseDateBeforeOrLastPurchaseDateIsNull(Date thresholdDate);
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\repository\NotificationRepository.java
--------------------------------------------------------------------
package com.smartretail.backend.repository;

import com.smartretail.backend.models.Notification;
import org.springframework.data.mongodb.repository.MongoRepository;

public interface NotificationRepository extends MongoRepository<Notification, String> {
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\repository\PaymentRepository.java
--------------------------------------------------------------------
package com.smartretail.backend.repository;

import com.smartretail.backend.models.Payment;
import org.springframework.data.mongodb.repository.MongoRepository;
import java.util.Optional;

public interface PaymentRepository extends MongoRepository<Payment, String> {
    Optional<Payment> findByPaymentId(String paymentId);
    boolean existsByPaymentId(String paymentId);
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\repository\ProductRepository.java
--------------------------------------------------------------------
package com.smartretail.backend.repository;

import com.smartretail.backend.models.Product;
import org.springframework.data.mongodb.repository.MongoRepository;
import org.springframework.data.mongodb.repository.Query;

import java.util.Date;
import java.util.List;
import java.util.Optional;

public interface ProductRepository extends MongoRepository<Product, String> {
    Optional<Product> findByProductId(String productId);
    boolean existsByProductId(String productId);
    List<Product> findByExpiryDateBefore(Date threshold);
    @Query("{ $expr: { $lt: ['$quantity', '$reorderLevel'] } }")
    List<Product> findLowStockProducts();
    @Query(value = "{ 'productId' : ?0 }", delete = true)
    void deleteByProductId(String productId);
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\repository\PushSubscriptionRepository.java
--------------------------------------------------------------------
package com.smartretail.backend.repository;

import com.smartretail.backend.models.PushSubscription;
import org.springframework.data.mongodb.repository.MongoRepository;

import java.util.Optional;

public interface PushSubscriptionRepository extends MongoRepository<PushSubscription, String> {
    Optional<PushSubscription> findByUserId(String userId);
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\repository\RefreshTokenRepository.java
--------------------------------------------------------------------
package com.smartretail.backend.repository;

import com.smartretail.backend.models.RefreshToken;
import org.springframework.data.mongodb.repository.MongoRepository;

import java.util.Optional;

public interface RefreshTokenRepository extends MongoRepository<RefreshToken, String> {
    Optional<RefreshToken> findByToken(String token);
    void deleteByUserId(String userId);
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\repository\UserRepository.java
--------------------------------------------------------------------
package com.smartretail.backend.repository;

import com.smartretail.backend.models.User;
import org.springframework.data.mongodb.repository.MongoRepository;
import java.util.Optional;

public interface UserRepository extends MongoRepository<User, String> {
    Optional<User> findByEmail(String email);
    boolean existsByEmail(String email);
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\security
--------------------------------------------------------------------
Contents:
CustomAccessDeniedHandler.java
CustomOAuth2AuthenticationSuccessHandler.java
JwtAuthenticationFilter.java
JwtUtil.java

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\security\CustomAccessDeniedHandler.java
--------------------------------------------------------------------
package com.smartretail.backend.security;

import com.fasterxml.jackson.databind.ObjectMapper;
import org.springframework.security.access.AccessDeniedException;
import org.springframework.security.web.access.AccessDeniedHandler;
import org.springframework.stereotype.Component;

import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import java.io.IOException;
import java.util.HashMap;
import java.util.Map;

@Component
public class CustomAccessDeniedHandler implements AccessDeniedHandler {

    @Override
    public void handle(HttpServletRequest request,
                       HttpServletResponse response,
                       AccessDeniedException accessDeniedException) throws IOException {

        response.setContentType("application/json");
        response.setStatus(HttpServletResponse.SC_FORBIDDEN);

        Map<String, Object> body = new HashMap<>();
        body.put("error", "Access Denied");
        body.put("message", accessDeniedException.getMessage());
        body.put("path", request.getRequestURI());

        new ObjectMapper().writeValue(response.getOutputStream(), body);
    }
}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\security\CustomOAuth2AuthenticationSuccessHandler.java
--------------------------------------------------------------------
package com.smartretail.backend.security;

import com.smartretail.backend.dto.LoginResponse;
import com.smartretail.backend.service.AuthService;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.security.core.Authentication;
import org.springframework.security.oauth2.core.user.DefaultOAuth2User;
import org.springframework.security.web.authentication.AuthenticationSuccessHandler;
import org.springframework.stereotype.Component;
import org.springframework.web.util.UriComponentsBuilder;

import java.io.IOException;

@Component
public class CustomOAuth2AuthenticationSuccessHandler implements AuthenticationSuccessHandler {

    @Autowired
    private AuthService authService;

    @Value("${frontend.base.url:http://localhost:5173}")
    private String frontendBaseUrl;

    @Override
    public void onAuthenticationSuccess(HttpServletRequest request,
                                          HttpServletResponse response,
                                          Authentication authentication) throws IOException {

        DefaultOAuth2User oauthUser = (DefaultOAuth2User) authentication.getPrincipal();
        String email = oauthUser.getAttribute("email");
        String name = oauthUser.getAttribute("name");

        // Use AuthService to find/create user and generate our custom JWTs
        LoginResponse loginResponse = authService.processOAuth2Login(email, name);

        // Redirect to frontend with tokens in URL parameters
        String redirectUrl = UriComponentsBuilder.fromUriString(frontendBaseUrl + "/login/success")
                .queryParam("token", loginResponse.getAccessToken())
                .queryParam("refreshToken", loginResponse.getRefreshToken())
                .build().toUriString();
        
        response.sendRedirect(redirectUrl);
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\security\JwtAuthenticationFilter.java
--------------------------------------------------------------------
package com.smartretail.backend.security;

import com.smartretail.backend.models.User;
import com.smartretail.backend.service.AuthService;
import io.jsonwebtoken.Claims;
import jakarta.servlet.FilterChain;
import jakarta.servlet.ServletException;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;
import org.springframework.security.core.authority.SimpleGrantedAuthority;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.security.web.authentication.WebAuthenticationDetailsSource;
import org.springframework.stereotype.Component;
import org.springframework.web.filter.OncePerRequestFilter;

import java.io.IOException;
import java.util.Collections;
import java.util.Optional;

@Component
public class JwtAuthenticationFilter extends OncePerRequestFilter {

    private static final Logger logger = LoggerFactory.getLogger(JwtAuthenticationFilter.class);
    private final JwtUtil jwtUtil;
    private final AuthService authService;

    public JwtAuthenticationFilter(JwtUtil jwtUtil, AuthService authService) {
        this.jwtUtil = jwtUtil;
        this.authService = authService;
    }

    @Override
    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain)
            throws ServletException, IOException {
        String authHeader = request.getHeader("Authorization");
        String jwt = null;
        String email = null;

        if (authHeader != null && authHeader.startsWith("Bearer ")) {
            jwt = authHeader.substring(7);
            try {
                Claims claims = jwtUtil.validateToken(jwt);
                email = claims.getSubject();
                logger.debug("[JWT] Extracted email from token: {}", email);
            } catch (Exception e) {
                logger.error("[JWT] Token validation failed: {}", e.getMessage());
            }
        } else {
            logger.debug("[JWT] No Bearer token found in Authorization header");
        }

        if (email != null && SecurityContextHolder.getContext().getAuthentication() == null) {
            Optional<User> optionalUser = Optional.ofNullable(authService.getUserByEmail(email));
            if (optionalUser.isPresent()) {
                User user = optionalUser.get();

                // FIX: Use getRole() instead of getRoles()
                String role = user.getRole();
                String springRole = "ROLE_" + role;

                var authorities = Collections.singletonList(
                        new SimpleGrantedAuthority(springRole)
                );

                UsernamePasswordAuthenticationToken authToken = new UsernamePasswordAuthenticationToken(
                        user, // Pass the full User object as principal
                        null,
                        authorities
                );
                authToken.setDetails(new WebAuthenticationDetailsSource().buildDetails(request));
                SecurityContextHolder.getContext().setAuthentication(authToken);
                logger.info("[JWT] Authentication set for user: {} with role: {}", email, springRole);
            } else {
                logger.warn("[JWT] User not found for email: {}", email);
            }
        }

        filterChain.doFilter(request, response);
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\security\JwtUtil.java
--------------------------------------------------------------------
package com.smartretail.backend.security;

import io.jsonwebtoken.Claims;
import io.jsonwebtoken.Jwts;
import io.jsonwebtoken.SignatureAlgorithm;
import io.jsonwebtoken.security.Keys;
import lombok.Getter;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Component;

import java.nio.charset.StandardCharsets;
import java.security.Key;
import java.util.Base64;
import java.util.Date;

@Component
public class JwtUtil {

    @Value("${jwt.secret}")
    private String secret;

    // 👉 Add this getter
    @Getter
    @Value("${jwt.expiration}")
    private long expiration;

    private Key getSigningKey() {
        // secret ko direct UTF-8 bytes lo (Base64 mat use karo)
        byte[] keyBytes = secret.getBytes(StandardCharsets.UTF_8);
        return Keys.hmacShaKeyFor(keyBytes);
    }

    public String generateToken(String email, String role) {
        return Jwts.builder()
                .setSubject(email)
                .claim("role", role)
                .setIssuedAt(new Date())
                .setExpiration(new Date(System.currentTimeMillis() + expiration))
                .signWith(getSigningKey(), SignatureAlgorithm.HS512)
                .compact();
    }

    public String generateRefreshToken(String email) {
        return Jwts.builder()
                .setSubject(email)
                .setIssuedAt(new Date())
                .setExpiration(new Date(System.currentTimeMillis() + expiration * 2)) // 2x expiry
                .signWith(getSigningKey(), SignatureAlgorithm.HS512)
                .compact();
    }

    public Claims validateToken(String token) {
        return Jwts.parserBuilder()
                .setSigningKey(getSigningKey())
                .build()
                .parseClaimsJws(token)
                .getBody();
    }

    public boolean isTokenExpired(Claims claims) {
        return claims.getExpiration().before(new Date());
    }

}

--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service
--------------------------------------------------------------------
Contents:
AnalyticsProxyService.java
AnalyticsService.java
AuditLogService.java
AuditLogServiceImpl.java
AuthService.java
AuthServiceImpl.java
BillService.java
BillServiceImpl.java
CustomerService.java
CustomerServiceImpl.java
FileService.java
FileServiceImpl.java
NotificationService.java
NotificationServiceImpl.java
PaymentService.java
PaymentServiceImpl.java
PdfService.java
PdfServiceImpl.java
ProductService.java
ProductServiceImpl.java
PushNotificationService.java
ReminderService.java
ReportPdfService.java
ReportPdfServiceImpl.java
ReportService.java
ReportServiceImpl.java
SyncService.java
UserService.java
UserServiceImpl.java

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\AnalyticsProxyService.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.http.ResponseEntity;
import org.springframework.stereotype.Service;
import org.springframework.web.client.RestTemplate;

@Service
public class AnalyticsProxyService {

    private final RestTemplate restTemplate;
    @Value("${flask.base.url}")
    private String flaskBaseUrl;

    public AnalyticsProxyService(RestTemplate restTemplate) {
        this.restTemplate = restTemplate;
    }

    public Object getFromFlask(String path) {
        String url = flaskBaseUrl + path;
        return restTemplate.getForObject(url, Object.class);
    }

    public byte[] getPdfFromFlask(String path) {
        String url = flaskBaseUrl + path;
        ResponseEntity<byte[]> response = restTemplate.getForEntity(url, byte[].class);
        return response.getBody();
    }
}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\AnalyticsService.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Service;
import org.springframework.web.client.RestTemplate;
import org.springframework.web.util.UriComponentsBuilder;

// --- NEW IMPORTS ---
import org.springframework.context.i18n.LocaleContextHolder;
import java.util.Locale;
import org.springframework.http.HttpHeaders;
import org.springframework.http.HttpEntity;
import org.springframework.http.HttpMethod;
import org.springframework.http.ResponseEntity;
// --- END NEW IMPORTS ---

@Service
public class AnalyticsService {
    private final RestTemplate restTemplate;

    @Value("${flask.base.url:http://localhost:5001}")
    private String flaskBaseUrl;

    public AnalyticsService(RestTemplate restTemplate) {
        this.restTemplate = restTemplate;
    }

    // --- MODIFIED METHOD ---
    public Object getReport(String startDate, String endDate) {
        String url = flaskBaseUrl + "/analytics/report";
        return getFromFlask(url, startDate, endDate);
    }

    // --- MODIFIED METHOD ---
    public Object getTextReport(String startDate, String endDate) {
        String url = flaskBaseUrl + "/analytics/report/text";
        return getFromFlask(url, startDate, endDate);
    }

    // --- NEW HELPER METHOD ---
    private Object getFromFlask(String url, String startDate, String endDate) {
        // 1. Get the locale from the current request
        Locale locale = LocaleContextHolder.getLocale();

        // 2. Build the URL with query params
        UriComponentsBuilder builder = UriComponentsBuilder.fromHttpUrl(url);
        if (startDate != null) builder.queryParam("startDate", startDate);
        if (endDate != null) builder.queryParam("endDate", endDate);

        // 3. Create headers and set the language
        HttpHeaders headers = new HttpHeaders();
        headers.set("Accept-Language", locale.toLanguageTag());

        // 4. Create an HttpEntity with the headers
        HttpEntity<String> entity = new HttpEntity<>(headers);

        // 5. Use restTemplate.exchange to send the request with headers
        ResponseEntity<Object> response = restTemplate.exchange(
                builder.toUriString(),
                HttpMethod.GET,
                entity,
                Object.class
        );

        return response.getBody();
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\AuditLogService.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.models.AuditLog;
import org.springframework.data.domain.Page;
import org.springframework.data.domain.Pageable;

import java.util.Date;
import java.util.Map;

public interface AuditLogService {
    void logAction(String actionType, String entityId, String userEmail, Map<String, Object> details);
    Page<AuditLog> getAuditLogs(String actionType, Date startDate, Date endDate, Pageable pageable);
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\AuditLogServiceImpl.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.models.AuditLog;
import com.smartretail.backend.repository.AuditLogRepository;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.data.domain.Page;
import org.springframework.data.domain.Pageable;
import org.springframework.data.mongodb.core.MongoTemplate;
import org.springframework.data.mongodb.core.query.Criteria;
import org.springframework.data.mongodb.core.query.Query;
import org.springframework.data.support.PageableExecutionUtils;
import org.springframework.stereotype.Service;

import java.util.Date;
import java.util.Map;

@Service
public class AuditLogServiceImpl implements AuditLogService {
    private static final Logger logger = LoggerFactory.getLogger(AuditLogServiceImpl.class);
    private final AuditLogRepository auditLogRepository;
    private final MongoTemplate mongoTemplate;

    public AuditLogServiceImpl(AuditLogRepository auditLogRepository, MongoTemplate mongoTemplate) {
        this.auditLogRepository = auditLogRepository;
        this.mongoTemplate = mongoTemplate;
    }

    @Override
    public void logAction(String actionType, String entityId, String userEmail, Map<String, Object> details) {
        logger.debug("[SERVICE] Logging action: type={}, entityId={}, userEmail={}", actionType, entityId, userEmail);
        AuditLog auditLog = new AuditLog(actionType, entityId, userEmail, new Date(), details);
        auditLogRepository.save(auditLog);
        logger.info("[SERVICE] Audit log saved: type={}, entityId={}", actionType, entityId);
    }

    @Override
    public Page<AuditLog> getAuditLogs(String actionType, Date startDate, Date endDate, Pageable pageable) {
        logger.debug("[SERVICE] Fetching audit logs: actionType={}, startDate={}, endDate={}, page={}, size={}",
                actionType, startDate, endDate, pageable.getPageNumber(), pageable.getPageSize());

        Query query = new Query();
        if (actionType != null && !actionType.isEmpty()) {
            query.addCriteria(Criteria.where("actionType").is(actionType));
        }
        if (startDate != null && endDate != null) {
            query.addCriteria(Criteria.where("timestamp").gte(startDate).lte(endDate));
        }
        query.with(pageable);

        long total = mongoTemplate.count(Query.of(query).limit(-1).skip(-1), AuditLog.class);
        return PageableExecutionUtils.getPage(mongoTemplate.find(query, AuditLog.class), pageable, () -> total);
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\AuthService.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.dto.LoginRequest;
import com.smartretail.backend.dto.LoginResponse;
import com.smartretail.backend.dto.SignupRequest;
import com.smartretail.backend.models.User;

public interface AuthService {
    User signup(SignupRequest request);
    LoginResponse login(LoginRequest request);
    User getUserByEmail(String email);
    String refreshToken(String refreshToken);

    // --- ADD THIS NEW METHOD ---
    LoginResponse processOAuth2Login(String email, String name);
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\AuthServiceImpl.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.dto.LoginRequest;
import com.smartretail.backend.dto.LoginResponse;
import com.smartretail.backend.dto.SignupRequest;
import com.smartretail.backend.models.RefreshToken;
import com.smartretail.backend.models.User;
import com.smartretail.backend.repository.RefreshTokenRepository;
import com.smartretail.backend.repository.UserRepository;
import com.smartretail.backend.security.JwtUtil;
// --- IMPORT THE INTERFACE ---
import org.springframework.security.crypto.password.PasswordEncoder; 
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import java.util.Optional;

import java.util.Date;

@Service
public class AuthServiceImpl implements AuthService {

    private final UserRepository userRepository;
    private final RefreshTokenRepository refreshTokenRepository;
    private final JwtUtil jwtUtil;
    // --- USE THE INTERFACE ---
    private final PasswordEncoder passwordEncoder; 
    private static final Logger logger = LoggerFactory.getLogger(AuthServiceImpl.class);

    // --- UPDATE THE CONSTRUCTOR ---
    public AuthServiceImpl(UserRepository userRepository,
                           RefreshTokenRepository refreshTokenRepository,
                           JwtUtil jwtUtil,
                           PasswordEncoder passwordEncoder) { // <-- INJECT IT HERE
        this.userRepository = userRepository;
        this.refreshTokenRepository = refreshTokenRepository;
        this.jwtUtil = jwtUtil;
        this.passwordEncoder = passwordEncoder; // <-- ASSIGN THE INJECTED BEAN
    }

    @Override
    public User signup(SignupRequest request) {
        if (userRepository.findByEmail(request.getEmail()).isPresent()) {
            throw new RuntimeException("User already exists: " + request.getEmail());
        }
        User user = new User();
        user.setEmail(request.getEmail());
        user.setName(request.getName());
        user.setRole(request.getRole());
        user.setPassword(passwordEncoder.encode(request.getPassword())); // Now uses the correct bean
        return userRepository.save(user);
    }

    @Override
    public LoginResponse login(LoginRequest request) {
        User user = userRepository.findByEmail(request.getEmail())
                .orElseThrow(() -> new RuntimeException("User not found: " + request.getEmail()));

        // This check will now work
        if (!passwordEncoder.matches(request.getPassword(), user.getPassword())) {
            throw new RuntimeException("Invalid password");
        }

        String accessToken = jwtUtil.generateToken(user.getEmail(), user.getRole());
        String refreshToken = jwtUtil.generateRefreshToken(user.getEmail());

        refreshTokenRepository.save(
                new RefreshToken(user.getId(), refreshToken,
                        new Date(System.currentTimeMillis() + jwtUtil.getExpiration() * 2))
        );

        return new LoginResponse(accessToken, refreshToken);
    }
    
    @Transactional
    @Override
    public LoginResponse processOAuth2Login(String email, String name) {
        Optional<User> userOptional = userRepository.findByEmail(email);

        User user;
        if (userOptional.isPresent()) {
            // User exists
            user = userOptional.get();
            if (name != null && !name.equals(user.getName())) {
                user.setName(name);
            }
            user.setLastLogin(new Date());
            user = userRepository.save(user);
            logger.info("[OAuth] Existing user logged in: {}", email);
        } else {
            // New user, create them
            logger.info("[OAuth] Creating new user: {}", email);
            user = new User();
            user.setEmail(email);
            user.setName(name);
            user.setRole("CASHIER"); // Default role
            user.setPassword(null); // No password for OAuth-only users
            user.setCreatedAt(new Date());
            user.setLastLogin(new Date());
            user.setUserId("u" + (System.currentTimeMillis() % 10000));
            user = userRepository.save(user);
        }

        // Generate tokens
        String accessToken = jwtUtil.generateToken(user.getEmail(), user.getRole());
        String refreshToken = jwtUtil.generateRefreshToken(user.getEmail());

        // Save refresh token
        refreshTokenRepository.deleteByUserId(user.getId());
        refreshTokenRepository.save(
            new RefreshToken(user.getId(), refreshToken,
                    new Date(System.currentTimeMillis() + jwtUtil.getExpiration() * 2))
        );

        return new LoginResponse(accessToken, refreshToken);
    }

    @Override
    public User getUserByEmail(String email) {
        return userRepository.findByEmail(email)
                .orElseThrow(() -> new RuntimeException("User not found: " + email));
    }

    @Override
    public String refreshToken(String refreshToken) {
        RefreshToken storedToken = refreshTokenRepository.findByToken(refreshToken)
                .orElseThrow(() -> new RuntimeException("Invalid refresh token"));

        if (storedToken.getExpiryDate().before(new Date())) {
            refreshTokenRepository.deleteById(storedToken.getId());
            throw new RuntimeException("Refresh token expired");
        }

        User user = userRepository.findById(storedToken.getUserId())
                .orElseThrow(() -> new RuntimeException("User not found: " + storedToken.getUserId()));

        return jwtUtil.generateToken(user.getEmail(), user.getRole());
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\BillService.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.models.Bill;
import java.util.Date;
import java.util.List;
import java.util.Locale;

public interface BillService {
    Bill createBill(Bill bill, Locale locale);
    Bill createBill(Bill bill, Locale locale, boolean isSyncMode);
    Bill getBillById(String billId, Locale locale);
    List<Bill> getAllBills();
    List<Bill> getBillsByDateRange(Date startDate, Date endDate, Locale locale);
    boolean validatePdfAccessToken(String billId, String token);
    String generatePdfAccessToken(String billId); // Added method
    boolean existsByBillId(String billId);
    void resendBillEmail(Bill bill, Locale locale);
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\BillServiceImpl.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.models.Bill;
import com.smartretail.backend.models.Customer;
import com.smartretail.backend.models.Product;
import com.smartretail.backend.repository.BillRepository;
import com.smartretail.backend.repository.CustomerRepository;
import com.smartretail.backend.repository.ProductRepository;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.context.MessageSource;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import java.util.*;

@Service
public class BillServiceImpl implements BillService {

    private static final Logger logger = LoggerFactory.getLogger(BillServiceImpl.class);
    private final BillRepository billRepository;
    private final CustomerRepository customerRepository;
    private final ProductRepository productRepository;
    private final ProductService productService;
    private final NotificationService notificationService;
    private final PdfService pdfService;
    private final MessageSource messageSource;
    private final AuditLogService auditLogService;

    public BillServiceImpl(BillRepository billRepository,
                           CustomerRepository customerRepository,
                           ProductRepository productRepository,
                           ProductService productService,
                           NotificationService notificationService,
                           PdfService pdfService,
                           MessageSource messageSource,
                           AuditLogService auditLogService) {
        this.billRepository = billRepository;
        this.customerRepository = customerRepository;
        this.productRepository = productRepository;
        this.productService = productService;
        this.notificationService = notificationService;
        this.pdfService = pdfService;
        this.messageSource = messageSource;
        this.auditLogService = auditLogService;
    }

    @Override
    @Transactional
    public Bill createBill(Bill bill, Locale locale) {
        return createBill(bill, locale, false);
    }

    @Override
    @Transactional
    public Bill createBill(Bill bill, Locale locale, boolean isSyncMode) {
        logger.debug("[BILL SERVICE] Creating bill with ID: {}", bill.getBillId());

        String userEmail = SecurityContextHolder.getContext().getAuthentication().getName();

        // ✅ Auto-generate Bill ID if missing
        if (bill.getBillId() == null || bill.getBillId().trim().isEmpty()) {
            bill.setBillId("B" + System.currentTimeMillis());
            logger.debug("[BILL SERVICE] Auto-generated bill ID: {}", bill.getBillId());
        }

        // ✅ AddedBy fallback
        if (bill.getAddedBy() == null || bill.getAddedBy().trim().isEmpty()) {
            bill.setAddedBy(userEmail != null ? userEmail : "system");
        }

        // ✅ Prevent duplicates
        if (!isSyncMode && billRepository.existsByBillId(bill.getBillId())) {
            throw new RuntimeException("Bill already exists: " + bill.getBillId());
        }

        // ✅ Validate customer
        if (bill.getCustomer() == null || bill.getCustomer().getMobile() == null) {
            throw new IllegalArgumentException("Customer details are required");
        }

        // ✅ Recalculate totalAmount based on product prices from DB
        double total = 0.0;
        if (bill.getItems() == null || bill.getItems().isEmpty()) {
            logger.warn("[BILL SERVICE] Bill {} has no items!", bill.getBillId());
        } else {
            for (Bill.BillItem item : bill.getItems()) {
                if (item.getProductId() == null || item.getProductId().trim().isEmpty()) {
                    logger.warn("[BILL SERVICE] Skipping invalid item without productId");
                    continue;
                }

                Product product = productService.getProductById(item.getProductId(), locale);
                if (product == null) {
                    logger.error("[BILL SERVICE] Product not found for ID: {}", item.getProductId());
                    continue;
                }

                item.setProductName(product.getName());
                item.setPrice(product.getPrice());

                double itemTotal = item.getItemTotal();
                total += itemTotal;

                logger.debug("[BILL SERVICE] {} × {} = {}", product.getName(), item.getQty(), itemTotal);

                // ✅ Update stock after sale
                productService.updateProductQuantity(item.getProductId(), item.getQty(), locale);
            }
        }

        // ✅ Calculate total again using built-in method (redundancy check)
        double computedTotal = bill.calculateTotal();
        if (computedTotal > 0) total = computedTotal;

        bill.setTotalAmount(total);
        bill.setCreatedAt(new Date());

        // ✅ Generate PDF access token using the new method
        if (bill.getPdfAccessToken() == null || bill.getPdfAccessToken().trim().isEmpty()) {
            bill.setPdfAccessToken(generatePdfAccessToken(bill.getBillId()));
            logger.debug("[BILL SERVICE] Generated new PDF access token for {}", bill.getBillId());
        }

        logger.debug("[BILL SERVICE] Final total for bill {} = ₹{}", bill.getBillId(), total);

        // ✅ Customer management
        Customer customer = customerRepository.findByMobile(bill.getCustomer().getMobile())
                .orElseGet(() -> {
                    return new Customer(
                            bill.getCustomer().getName(),
                            bill.getCustomer().getEmail(),
                            bill.getCustomer().getMobile());
                });

        // ✅ Update customer stats
        customer.setTotalPurchaseCount(customer.getTotalPurchaseCount() + 1);
        customer.setLastPurchaseDate(new Date());
        if (customer.getPurchaseHistory() == null) {
            customer.setPurchaseHistory(new ArrayList<>());
        }
        if (!customer.getPurchaseHistory().contains(bill.getBillId())) {
            customer.getPurchaseHistory().add(bill.getBillId());
        }

        customerRepository.save(customer);

        // ✅ Save Bill
        Bill savedBill = billRepository.save(bill);

        // ✅ Recalculate and persist totalAmount again
        savedBill.setTotalAmount(savedBill.calculateTotal());
        savedBill = billRepository.save(savedBill);

        logger.info("[BILL SERVICE] Bill {} saved successfully with total ₹{}", savedBill.getBillId(), savedBill.getTotalAmount());

        // ✅ Log action
        auditLogService.logAction("BILL_CREATED", savedBill.getBillId(), userEmail, Map.of(
                "totalAmount", savedBill.getTotalAmount(),
                "customerEmail", customer.getEmail()
        ));

        // ✅ Optional: Send PDF + Email
        try {
            if (bill.getCustomer().getEmail() != null && !bill.getCustomer().getEmail().isBlank()) {
                byte[] pdfContent = pdfService.generateBillPdf(savedBill, locale);
                notificationService.sendBillNotification(
                        bill.getCustomer().getEmail(),
                        savedBill.getBillId(),
                        savedBill.getTotalAmount(),
                        pdfContent,
                        locale
                );
                logger.info("[BILL SERVICE] Email sent for bill {}", savedBill.getBillId());
            }
        } catch (Exception e) {
            logger.error("[BILL SERVICE] Failed to send email for bill {}: {}", savedBill.getBillId(), e.getMessage());
        }

        return savedBill;
    }

    @Override
    public Bill getBillById(String billId, Locale locale) {
        return billRepository.findByBillId(billId)
                .orElseThrow(() -> new RuntimeException("Bill not found: " + billId));
    }

    @Override
    public List<Bill> getAllBills() {
        return billRepository.findAll();
    }

    @Override
    public List<Bill> getBillsByDateRange(Date startDate, Date endDate, Locale locale) {
        return billRepository.findByCreatedAtBetween(startDate, endDate);
    }

    @Override
    public boolean validatePdfAccessToken(String billId, String token) {
        try {
            // Token format: billId|randomUuid|exp (e.g. "B123|uuid|1734000000")
            String[] parts = token.split("\\|");
            if (parts.length != 3) return false;
            if (!parts[0].equals(billId)) return false;

            long exp = Long.parseLong(parts[2]);
            if (System.currentTimeMillis() > exp * 1000) {
                logger.warn("[BILL SERVICE] PDF token expired for bill: {}", billId);
                return false;
            }

            // Optional: You could add signature verification here if needed
            return true;
        } catch (Exception e) {
            logger.error("[BILL SERVICE] Invalid PDF token format for bill {}: {}", billId, e.getMessage());
            return false;
        }
    }

    /**
     * Generate a short-lived PDF access token
     * Format: billId|randomUuid|expirationTimestamp
     */
    public String generatePdfAccessToken(String billId) {
        String uuid = UUID.randomUUID().toString();
        long exp = System.currentTimeMillis() / 1000 + 3600; // 1 hour expiration
        return billId + "|" + uuid + "|" + exp;
    }

    @Override
    public boolean existsByBillId(String billId) {
        return billRepository.existsByBillId(billId);
    }

    @Override
    public void resendBillEmail(Bill bill, Locale locale) {
        try {
            byte[] pdfContent = pdfService.generateBillPdf(bill, locale);
            notificationService.sendBillNotification(
                    bill.getCustomer().getEmail(),
                    bill.getBillId(),
                    bill.getTotalAmount(),
                    pdfContent,
                    locale
            );
            logger.info("[BILL SERVICE] Bill email resent to {}", bill.getCustomer().getEmail());
        } catch (Exception e) {
            logger.error("[BILL SERVICE] Failed to resend email for bill {}: {}", bill.getBillId(), e.getMessage());
        }
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\CustomerService.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.models.Bill;
import com.smartretail.backend.models.Customer;
import com.smartretail.backend.dto.CustomEmailRequest;

import java.util.Date;
import java.util.List;
import java.util.Locale;

public interface CustomerService {

    Customer findOrCreateCustomer(Bill.CustomerInfo customerInfo, Locale locale);

    void addBillId(String mobile, String billId);

    Customer createCustomer(Customer customer, Locale locale);

    Customer getCustomerById(String id, Locale locale);

    List<Customer> getAllCustomers();

    Customer updateCustomer(String id, Customer customer, Locale locale);

    void deleteCustomer(String id, Locale locale);

    List<Bill> getCustomerPurchaseHistory(String customerId, Date startDate, Date endDate, Locale locale);

    void sendCustomEmail(CustomEmailRequest request, Locale locale);

    // --- NEW METHOD: Find customers with no purchases after threshold date ---
    /**
     * Finds customers who have not made any purchase after the given threshold date.
     * Useful for re-engagement campaigns (e.g., "We miss you!" emails).
     *
     * @param thresholdDate Customers with last purchase before this date are considered inactive
     * @return List of inactive customers
     */
    List<Customer> findInactiveCustomers(Date thresholdDate);
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\CustomerServiceImpl.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.dto.CustomEmailRequest;
import com.smartretail.backend.models.Bill;
import com.smartretail.backend.models.Customer;
import com.smartretail.backend.repository.BillRepository;
import com.smartretail.backend.repository.CustomerRepository;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.context.MessageSource;
import org.springframework.stereotype.Service;

import java.util.*;
import java.util.stream.Collectors;

@Service
public class CustomerServiceImpl implements CustomerService {

    private static final Logger logger = LoggerFactory.getLogger(CustomerServiceImpl.class);

    private final CustomerRepository customerRepository;
    private final BillRepository billRepository;
    private final MessageSource messageSource;
    private final NotificationService notificationService;

    public CustomerServiceImpl(CustomerRepository customerRepository,
                               BillRepository billRepository,
                               MessageSource messageSource,
                               NotificationService notificationService) {
        this.customerRepository = customerRepository;
        this.billRepository = billRepository;
        this.messageSource = messageSource;
        this.notificationService = notificationService;
    }

    @Override
    public Customer findOrCreateCustomer(Bill.CustomerInfo customerInfo, Locale locale) {
        logger.debug("[CUSTOMER SERVICE] Finding or creating customer with mobile: {}", customerInfo.getMobile());
        if (customerInfo.getMobile() == null || customerInfo.getMobile().trim().isEmpty()) {
            logger.error("[CUSTOMER SERVICE] Customer mobile is required");
            throw new IllegalArgumentException(messageSource.getMessage("customer.mobile.required", null, locale));
        }
        Optional<Customer> existingCustomer = customerRepository.findByMobile(customerInfo.getMobile());
        if (existingCustomer.isPresent()) {
            Customer customer = existingCustomer.get();
            logger.debug("[CUSTOMER SERVICE] Found existing customer: {}", customer.getMobile());
            logger.debug("[CUSTOMER SERVICE] Existing customer email: {}", customer.getEmail());
            if (customerInfo.getName() != null && !customerInfo.getName().isEmpty()) {
                customer.setName(customerInfo.getName());
                logger.debug("[CUSTOMER SERVICE] Updated customer name to: {}", customerInfo.getName());
            }
            if (customerInfo.getEmail() != null && !customerInfo.getEmail().isEmpty()) {
                customer.setEmail(customerInfo.getEmail());
                logger.debug("[CUSTOMER SERVICE] Updated customer email to: {}", customerInfo.getEmail());
            }
            Customer savedCustomer = customerRepository.save(customer);
            logger.debug("[CUSTOMER SERVICE] Customer saved with email: {}", savedCustomer.getEmail());
            return savedCustomer;
        } else {
            Customer newCustomer = new Customer();
            newCustomer.setMobile(customerInfo.getMobile());
            newCustomer.setName(customerInfo.getName() != null ? customerInfo.getName() : "Customer");
            newCustomer.setEmail(customerInfo.getEmail());
            newCustomer.setCreatedAt(new Date());
            newCustomer.setPurchaseHistory(new ArrayList<>());
            logger.debug("[CUSTOMER SERVICE] Creating new customer: {}", newCustomer.getMobile());
            logger.debug("[CUSTOMER SERVICE] New customer email: {}", newCustomer.getEmail());
            Customer savedCustomer = customerRepository.save(newCustomer);
            logger.debug("[CUSTOMER SERVICE] New customer created with email: {}", savedCustomer.getEmail());
            return savedCustomer;
        }
    }

    @Override
    public void addBillId(String mobile, String billId) {
        logger.debug("[CUSTOMER SERVICE] Adding bill ID {} to customer with mobile: {}", billId, mobile);
        Customer customer = customerRepository.findByMobile(mobile)
                .orElseThrow(() -> new IllegalArgumentException(
                        messageSource.getMessage("customer.not.found", new Object[]{mobile}, Locale.getDefault())));

        if (customer.getPurchaseHistory() == null) {
            customer.setPurchaseHistory(new ArrayList<>());
        }
        if (!customer.getPurchaseHistory().contains(billId)) {
            customer.getPurchaseHistory().add(billId);
            customerRepository.save(customer);
            logger.info("[CUSTOMER SERVICE] Bill ID {} added to customer: {}", billId, mobile);
        }
    }

    @Override
    public Customer createCustomer(Customer customer, Locale locale) {
        logger.debug("[CUSTOMER SERVICE] Creating customer with mobile: {}", customer.getMobile());
        if (customerRepository.findByMobile(customer.getMobile()).isPresent()) {
            logger.error("[CUSTOMER SERVICE] Customer already exists: {}", customer.getMobile());
            throw new IllegalArgumentException(
                    messageSource.getMessage("customer.exists", new Object[]{customer.getMobile()}, locale));
        }
        customer.setCreatedAt(new Date());
        Customer savedCustomer = customerRepository.save(customer);
        logger.info("[CUSTOMER SERVICE] Customer created: {}", savedCustomer.getMobile());
        return savedCustomer;
    }

    @Override
    public Customer getCustomerById(String id, Locale locale) {
        logger.debug("[CUSTOMER SERVICE] Fetching customer with ID: {}", id);
        Customer customer = customerRepository.findById(id)
                .orElseThrow(() -> new IllegalArgumentException(
                        messageSource.getMessage("customer.not.found", new Object[]{id}, locale)));
        logger.info("[CUSTOMER SERVICE] Found customer: {}", customer.getMobile());
        return customer;
    }

    @Override
    public List<Customer> getAllCustomers() {
        logger.debug("[CUSTOMER SERVICE] Fetching all customers");
        List<Customer> customers = customerRepository.findAll();
        logger.info("[CUSTOMER SERVICE] Found {} customers", customers.size());
        return customers;
    }

    @Override
    public Customer updateCustomer(String id, Customer customer, Locale locale) {
        logger.debug("[CUSTOMER SERVICE] Updating customer with ID: {}", id);
        Customer existing = customerRepository.findById(id)
                .orElseThrow(() -> new IllegalArgumentException(
                        messageSource.getMessage("customer.not.found", new Object[]{id}, locale)));
        existing.setName(customer.getName());
        existing.setEmail(customer.getEmail());
        existing.setMobile(customer.getMobile());
        Customer updatedCustomer = customerRepository.save(existing);
        logger.info("[CUSTOMER SERVICE] Customer updated: {}", updatedCustomer.getMobile());
        return updatedCustomer;
    }

    @Override
    public void deleteCustomer(String id, Locale locale) {
        logger.debug("[CUSTOMER SERVICE] Deleting customer with ID: {}", id);
        if (!customerRepository.existsById(id)) {
            logger.error("[CUSTOMER SERVICE] Customer not found: {}", id);
            throw new IllegalArgumentException(
                    messageSource.getMessage("customer.not.found", new Object[]{id}, locale));
        }
        customerRepository.deleteById(id);
        logger.info("[CUSTOMER SERVICE] Customer deleted: {}", id);
    }

    private Date getEndOfDay(Date date) {
        if (date == null) {
            return null;
        }
        Calendar c = Calendar.getInstance();
        c.setTime(date);
        c.set(Calendar.HOUR_OF_DAY, 23);
        c.set(Calendar.MINUTE, 59);
        c.set(Calendar.SECOND, 59);
        c.set(Calendar.MILLISECOND, 999);
        return c.getTime();
    }

    @Override
    public List<Bill> getCustomerPurchaseHistory(String customerId, Date startDate, Date endDate, Locale locale) {
        logger.debug("[CUSTOMER SERVICE] Fetching purchase history for customer ID: {}, startDate: {}, endDate: {}",
                customerId, startDate, endDate);
        if (customerId == null || customerId.isEmpty()) {
            logger.error("[CUSTOMER SERVICE] Customer ID is required");
            throw new IllegalArgumentException(messageSource.getMessage("customer.id.required", null, locale));
        }
        if (startDate != null && endDate != null && startDate.after(endDate)) {
            logger.error("[CUSTOMER SERVICE] Invalid date range: startDate={} is after endDate={}", startDate, endDate);
            throw new IllegalArgumentException(
                    messageSource.getMessage("report.date.range.invalid", new Object[]{startDate, endDate}, locale));
        }
        Customer customer = customerRepository.findById(customerId)
                .orElseThrow(() -> new IllegalArgumentException(
                        messageSource.getMessage("customer.not.found", new Object[]{customerId}, locale)));
        List<String> billIds = customer.getPurchaseHistory();
        if (billIds == null || billIds.isEmpty()) {
            logger.info("[CUSTOMER SERVICE] No purchase history found for customer: {}", customerId);
            return new ArrayList<>();
        }

        final Date finalEndDate = getEndOfDay(endDate);
        List<Bill> bills = billRepository.findAllById(billIds).stream()
                .filter(bill -> bill.getCreatedAt() != null)
                .filter(bill -> startDate == null || !bill.getCreatedAt().before(startDate))
                .filter(bill -> finalEndDate == null || !bill.getCreatedAt().after(finalEndDate))
                .collect(Collectors.toList());

        if (bills.size() < billIds.size()) {
            List<String> foundBillIds = bills.stream().map(Bill::getBillId).collect(Collectors.toList());
            List<String> missingBillIds = new ArrayList<>(billIds);
            missingBillIds.removeAll(foundBillIds);
            logger.warn("[CUSTOMER SERVICE] Some bill IDs not found: missing IDs {}, expected {}, found {}",
                    missingBillIds, billIds.size(), bills.size());
        }
        logger.info("[CUSTOMER SERVICE] Found {} bills in purchase history for customer: {}", bills.size(), customerId);
        return bills;
    }

    @Override
    public void sendCustomEmail(CustomEmailRequest request, Locale locale) {
        logger.info("[CUSTOMER SERVICE] Received request to send custom email to {} customers", request.getCustomerIds().size());

        List<Customer> customers = customerRepository.findAllById(request.getCustomerIds());
        int successCount = 0;

        for (Customer customer : customers) {
            if (customer.getEmail() == null || customer.getEmail().isBlank()) {
                logger.warn("[CUSTOMER SERVICE] Skipping customer {}: no email address", customer.getId());
                continue;
            }

            try {
                String personalizedBody = request.getBody()
                        .replace("{{customerName}}", Optional.ofNullable(customer.getName()).orElse("Customer"))
                        .replace("{{customerNameCase}}", Optional.ofNullable(customer.getName()).orElse("Customer"));

                notificationService.sendEmail(
                        customer.getEmail(),
                        request.getSubject(),
                        personalizedBody
                );
                successCount++;
            } catch (Exception e) {
                logger.error("[CUSTOMER SERVICE] Failed to send email to {}: {}", customer.getEmail(), e.getMessage());
            }
        }

        logger.info("[CUSTOMER SERVICE] Successfully sent {} out of {} emails", successCount, customers.size());
    }

    // --- NEW METHOD: Find Inactive Customers ---
    @Override
    public List<Customer> findInactiveCustomers(Date thresholdDate) {
        logger.debug("[CUSTOMER SERVICE] Finding customers inactive since: {}", thresholdDate);

        if (thresholdDate == null) {
            logger.warn("[CUSTOMER SERVICE] Threshold date is null, returning empty list");
            return Collections.emptyList();
        }

        return customerRepository.findByLastPurchaseDateBeforeOrLastPurchaseDateIsNull(thresholdDate);
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\FileService.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import org.springframework.web.multipart.MultipartFile;
import java.io.IOException;
import java.util.Map;

public interface FileService {
    String uploadImage(MultipartFile file, String fileName) throws IOException;
    Map<String, Object> getImage(String imageId);
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\FileServiceImpl.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.mongodb.client.gridfs.GridFSBucket;
import com.mongodb.client.gridfs.model.GridFSFile;
import com.mongodb.client.gridfs.model.GridFSUploadOptions;
import org.bson.Document;
import org.bson.types.ObjectId;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.data.mongodb.core.query.Criteria;
import org.springframework.data.mongodb.core.query.Query;
import org.springframework.data.mongodb.gridfs.GridFsTemplate;
import org.springframework.stereotype.Service;
import org.springframework.web.multipart.MultipartFile;

import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.util.HashMap;
import java.util.Map;

@Service
public class FileServiceImpl implements FileService {

    private final GridFsTemplate gridFsTemplate;
    private final GridFSBucket gridFSBucket;

    @Autowired
    public FileServiceImpl(GridFsTemplate gridFsTemplate, GridFSBucket gridFSBucket) {
        this.gridFsTemplate = gridFsTemplate;
        this.gridFSBucket = gridFSBucket;
    }

    @Override
    public String uploadImage(MultipartFile file, String filename) throws IOException {
        GridFSUploadOptions opts = new GridFSUploadOptions()
                .metadata(new Document("filename", filename)
                        .append("contentType", file.getContentType()));

        ObjectId id = gridFsTemplate.store(file.getInputStream(), filename,
                file.getContentType(), opts.getMetadata());
        return id.toHexString();
    }

    @Override
    public Map<String, Object> getImage(String imageId) {
        GridFSFile file = gridFsTemplate.findOne(
                Query.query(Criteria.where("_id").is(new ObjectId(imageId))));

        if (file == null || file.getMetadata() == null) {
            throw new RuntimeException("Image not found: " + imageId);
        }

        try (ByteArrayOutputStream out = new ByteArrayOutputStream()) {
            gridFSBucket.downloadToStream(file.getObjectId(), out);
            Map<String, Object> result = new HashMap<>();
            result.put("bytes", out.toByteArray());
            result.put("contentType", file.getMetadata().getString("contentType"));
            return result;
        } catch (IOException e) {
            throw new RuntimeException("Failed to download image", e);
        }
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\NotificationService.java
--------------------------------------------------------------------

package com.smartretail.backend.service;

import com.smartretail.backend.models.Notification;

import java.util.List;
import java.util.Locale;

public interface NotificationService {
    Notification createNotification(Notification notification);
    List<Notification> getAllNotifications();
    void sendEmail(String to, String subject, String text);
    void sendBillNotification(String customerEmail, String billId, double total, byte[] pdfContent, Locale locale);
    void sendLowStockNotification(String managerEmail, String productName, int quantity, int reorderLevel);
}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\NotificationServiceImpl.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.models.Notification;
import com.smartretail.backend.repository.NotificationRepository;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.context.MessageSource;
import org.springframework.core.io.ByteArrayResource;
import org.springframework.mail.javamail.JavaMailSender;
import org.springframework.mail.javamail.MimeMessageHelper;
import org.springframework.stereotype.Service;

import jakarta.mail.MessagingException;
import jakarta.mail.internet.MimeMessage;
import java.util.Date;
import java.util.List;
import java.util.Locale;

@Service
public class NotificationServiceImpl implements NotificationService {
    private final NotificationRepository notificationRepository;
    private final JavaMailSender mailSender;
    private final MessageSource messageSource;

    @Value("${spring.mail.username}")
    private String fromEmail;

    public NotificationServiceImpl(NotificationRepository notificationRepository,
                                   JavaMailSender mailSender,
                                   MessageSource messageSource) {
        this.notificationRepository = notificationRepository;
        this.mailSender = mailSender;
        this.messageSource = messageSource;
    }

    @Override
    public Notification createNotification(Notification notification) {
        System.out.println("[SERVICE] Creating notification for: " + notification.getTo());
        notification.setSentAt(new Date());

        // Save notification first
        Notification savedNotification = notificationRepository.save(notification);

        // Send email without saving again
        sendEmailDirect(notification.getTo(), notification.getSubject(), notification.getMessage());

        return savedNotification;
    }

    @Override
    public List<Notification> getAllNotifications() {
        System.out.println("[SERVICE] Fetching all notifications.");
        return notificationRepository.findAll();
    }

    @Override
    public void sendEmail(String to, String subject, String text) {
        Notification notification = new Notification(to, subject, text, new Date());
        notificationRepository.save(notification);
        sendEmailDirect(to, subject, text);
    }

    private void sendEmailDirect(String to, String subject, String text) {
        try {
            MimeMessage message = mailSender.createMimeMessage();
            MimeMessageHelper helper = new MimeMessageHelper(message, true, "UTF-8");
            helper.setFrom(fromEmail);
            helper.setTo(to);
            helper.setSubject(subject);
            helper.setText(text, false);
            mailSender.send(message);
            System.out.println("[NOTIFICATION] Email sent to: " + to);
        } catch (MessagingException e) {
            System.err.println("[NOTIFICATION] Failed to send email to " + to + ": " + e.getMessage());
            throw new RuntimeException("Email send failed. Check SMTP authentication or app password.", e);
        }
    }

    @Override
    public void sendBillNotification(String customerEmail, String billId, double total, byte[] pdfContent, Locale locale) {
        if (customerEmail == null || customerEmail.trim().isEmpty()) {
            System.err.println("[NOTIFICATION] Customer email is null or empty for bill: " + billId);
            return;
        }

        try {
            String subject;
            String text;

            try {
                subject = messageSource.getMessage("bill.notification.subject", new Object[]{billId}, locale);
                text = messageSource.getMessage("bill.email.body", new Object[]{billId, String.format("%.2f", total)}, locale);
            } catch (Exception e) {
                subject = "Your Bill Receipt - " + billId;
                text = String.format(
                        "Dear Customer,\n\nThank you for your purchase!\n\nBill ID: %s\nTotal Amount: ₹%.2f\n\nPlease find your bill attached.\n\nThank you for shopping with us!\n\nSmartRetail Team",
                        billId, total
                );
                System.out.println("[NOTIFICATION] Using fallback email message for bill: " + billId);
            }

            System.out.println("[NOTIFICATION] Attempting to send email to: " + customerEmail);
            System.out.println("[NOTIFICATION] Subject: " + subject);

            Notification notification = new Notification(customerEmail, subject, text, new Date());
            notificationRepository.save(notification);

            MimeMessage message = mailSender.createMimeMessage();
            MimeMessageHelper helper = new MimeMessageHelper(message, true, "UTF-8");
            helper.setFrom(fromEmail);
            helper.setTo(customerEmail);
            helper.setSubject(subject);
            helper.setText(text, false);

            if (pdfContent != null && pdfContent.length > 0) {
                helper.addAttachment("Bill_" + billId + ".pdf", new ByteArrayResource(pdfContent));
                System.out.println("[NOTIFICATION] PDF attachment added, size: " + pdfContent.length + " bytes");
            }

            mailSender.send(message);
            System.out.println("[NOTIFICATION] Bill notification sent successfully to: " + customerEmail + " for bill: " + billId);

        } catch (MessagingException e) {
            System.err.println("[NOTIFICATION] Failed to send bill notification to " + customerEmail + ": " + e.getMessage());
            e.printStackTrace();
            throw new RuntimeException("Failed to send bill notification", e);
        }
    }

    @Override
    public void sendLowStockNotification(String managerEmail, String productName, int quantity, int reorderLevel) {
        String emailSubject = "SmartRetail: Low Stock Alert for " + productName;
        String emailText = String.format(
                "Alert: Product '%s' is low on stock.\nCurrent Quantity: %d\nReorder Level: %d\nPlease restock soon.",
                productName, quantity, reorderLevel
        );
        sendEmail(managerEmail, emailSubject, emailText);
    }
}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\PaymentService.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.models.Payment;
import java.util.List;

public interface PaymentService {
    Payment createPayment(Payment payment);
    Payment getPaymentById(String paymentId);
    List<Payment> getAllPayments();
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\PaymentServiceImpl.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.models.Payment;
import com.smartretail.backend.repository.PaymentRepository;
import org.springframework.stereotype.Service;

import java.util.Date;
import java.util.List;
import java.util.UUID;

@Service
public class PaymentServiceImpl implements PaymentService {
    private final PaymentRepository paymentRepository;

    public PaymentServiceImpl(PaymentRepository paymentRepository) {
        this.paymentRepository = paymentRepository;
    }

    @Override
    public Payment createPayment(Payment payment) {
        System.out.println("[SERVICE] Creating payment: " + payment.getPaymentId());
        String paymentId = "pay_" + UUID.randomUUID().toString().substring(0, 8);
        payment.setPaymentId(paymentId);
        if (paymentRepository.existsByPaymentId(paymentId)) {
            System.out.println("[SERVICE] Create failed: Payment ID already exists: " + paymentId);
            throw new RuntimeException("Payment ID already exists");
        }
        payment.setCreatedAt(new Date());
        Payment savedPayment = paymentRepository.save(payment);
        System.out.println("[SERVICE] Payment created successfully: " + savedPayment.getPaymentId());
        return savedPayment;
    }

    @Override
    public Payment getPaymentById(String paymentId) {
        System.out.println("[SERVICE] Fetching payment with ID: " + paymentId);
        return paymentRepository.findByPaymentId(paymentId).orElse(null);
    }

    @Override
    public List<Payment> getAllPayments() {
        System.out.println("[SERVICE] Fetching all payments.");
        return paymentRepository.findAll();
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\PdfService.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.models.Bill;
import java.util.Locale;

public interface PdfService {
    byte[] generateBillPdf(Bill bill, Locale locale);
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\PdfServiceImpl.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.itextpdf.kernel.colors.ColorConstants;
import com.itextpdf.kernel.font.PdfFont;
import com.itextpdf.kernel.font.PdfFontFactory;
import com.itextpdf.kernel.pdf.PdfDocument;
import com.itextpdf.kernel.pdf.PdfWriter;
import com.itextpdf.layout.Document;
import com.itextpdf.layout.borders.Border;
import com.itextpdf.layout.element.Cell;
import com.itextpdf.layout.element.Paragraph;
import com.itextpdf.layout.element.Table;
import com.itextpdf.layout.properties.TextAlignment;
import com.itextpdf.layout.properties.UnitValue;
import com.smartretail.backend.models.Bill;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.stereotype.Service;
import org.springframework.http.HttpHeaders;
import org.springframework.http.MediaType;

import java.io.ByteArrayOutputStream;
import java.util.Locale;

// --- NEW IMPORT ---
import org.springframework.context.MessageSource;
// --- END NEW IMPORT ---

@Service
public class PdfServiceImpl implements PdfService {
    private static final Logger logger = LoggerFactory.getLogger(PdfServiceImpl.class);

    // --- NEW FIELD ---
    private final MessageSource messageSource;

    // --- MODIFIED CONSTRUCTOR ---
    public PdfServiceImpl(MessageSource messageSource) {
        this.messageSource = messageSource;
    }

    // --- Helper method for translation ---
    private String t(String key, Locale locale) {
        // Fallback to the key itself if not found, to avoid errors
        return messageSource.getMessage(key, null, key, locale);
    }

    @Override
    public byte[] generateBillPdf(Bill bill, Locale locale) {
        if (bill == null) {
            throw new IllegalArgumentException("Bill cannot be null");
        }

       // ... (logging remains the same) [cite: 174]

        try (ByteArrayOutputStream outputStream = new ByteArrayOutputStream()) {
            PdfWriter writer = new PdfWriter(outputStream);
            PdfDocument pdf = new PdfDocument(writer);
            Document document = new Document(pdf);

            PdfFont font = PdfFontFactory.createFont("Helvetica");
            PdfFont boldFont = PdfFontFactory.createFont("Helvetica-Bold");

            // Header - MODIFIED
            addHeader(document, boldFont, font, locale);

            // Bill details - MODIFIED
            addBillDetails(document, bill, boldFont, font, locale);

            // Items table - MODIFIED
            addItemsTable(document, bill, boldFont, font, locale);

            // Total - MODIFIED
            addTotal(document, bill, boldFont, locale);

            document.close();
           // ... (logging remains the same) [cite: 175]
            return outputStream.toByteArray();

        } catch (Exception e) {
            // ... (error logging remains the same) [cite: 175]
            throw new RuntimeException("Failed to generate PDF", e);
        }
    }

    // --- MODIFIED METHOD ---
    private void addHeader(Document document, PdfFont boldFont, PdfFont font, Locale locale) {
        document.add(new Paragraph("SmartRetail")
                .setFont(boldFont).setFontSize(24).setTextAlignment(TextAlignment.CENTER));
        document.add(new Paragraph(t("pdf.bill.receiptTitle", locale)) // "Official Receipt"
                .setFont(font).setFontSize(14).setTextAlignment(TextAlignment.CENTER).setMarginBottom(20));
    }

    // --- MODIFIED METHOD ---
    private void addBillDetails(Document document, Bill bill, PdfFont boldFont, PdfFont font, Locale locale) {
        Table detailsTable = new Table(new float[]{1, 2});
        detailsTable.setWidth(UnitValue.createPercentValue(50));

        detailsTable.addCell(createCell(boldFont, t("pdf.bill.billId", locale) + ":", false)); // "Bill ID:"
        detailsTable.addCell(createCell(font, bill.getBillId(), false));

        if (bill.getCustomer() != null) {
            detailsTable.addCell(createCell(boldFont, t("pdf.bill.customer", locale) + ":", false)); // "Customer:"
            detailsTable.addCell(createCell(font,
                    bill.getCustomer().getName() != null ? bill.getCustomer().getName() : "N/A", false));

            detailsTable.addCell(createCell(boldFont, t("pdf.bill.mobile", locale) + ":", false)); // "Mobile:"
            detailsTable.addCell(createCell(font,
                    bill.getCustomer().getMobile() != null ? bill.getCustomer().getMobile() : "N/A", false));
        }

        document.add(detailsTable.setMarginBottom(20));
    }

    // --- MODIFIED METHOD ---
    private void addItemsTable(Document document, Bill bill, PdfFont boldFont, PdfFont font, Locale locale) {
        Table itemsTable = new Table(new float[]{3, 1, 1, 1});
        itemsTable.setWidth(UnitValue.createPercentValue(100));

        // Headers
        itemsTable.addHeaderCell(createCell(boldFont, t("pdf.bill.product", locale), true)); // "Product"
        itemsTable.addHeaderCell(createCell(boldFont, t("pdf.bill.qty", locale), true)); // "Qty"
        itemsTable.addHeaderCell(createCell(boldFont, t("pdf.bill.price", locale), true)); // "Price"
        itemsTable.addHeaderCell(createCell(boldFont, t("pdf.bill.subtotal", locale), true)); // "Subtotal"

        // ... (items loop remains the same) [cite: 177, 178]
        if (bill.getItems() != null) {
            for (Bill.BillItem item : bill.getItems()) {
                String productName = item.getProductName() != null ?
                        item.getProductName() : "Product " + item.getProductId();
                double itemPrice = item.getPrice();
                double subtotal = item.getQty() * itemPrice;
                itemsTable.addCell(createCell(font, productName, false));
                itemsTable.addCell(createCell(font, String.valueOf(item.getQty()), false));
                itemsTable.addCell(createCell(font, String.format("₹%.2f", itemPrice), false));
                itemsTable.addCell(createCell(font, String.format("₹%.2f", subtotal), false));
            }
        }
        document.add(itemsTable);
    }

    // --- MODIFIED METHOD ---
    private void addTotal(Document document, Bill bill, PdfFont boldFont, Locale locale) {
        String totalText = String.format("%s: ₹%.2f", t("pdf.bill.total", locale), bill.getTotalAmount()); // "Total:"
        document.add(new Paragraph(totalText)
                .setFont(boldFont).setFontSize(12)
                .setTextAlignment(TextAlignment.RIGHT).setMarginTop(10));
    }

   // ... (createCell method remains the same) [cite: 179]
    private Cell createCell(PdfFont font, String text, boolean isHeader) {
        Cell cell = new Cell().setFont(font).add(new Paragraph(text));
        if (isHeader) {
            cell.setBackgroundColor(ColorConstants.LIGHT_GRAY);
        } else {
            cell.setBorder(Border.NO_BORDER);
        }
        return cell;
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\ProductService.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.models.Product;
import org.springframework.web.multipart.MultipartFile;

import java.io.IOException;
import java.util.Date;
import java.util.List;
import java.util.Locale;

public interface ProductService {

    boolean existsByProductId(String productId);

    Product createProduct(Product product, MultipartFile imageFile, Locale locale) throws IOException;
    Product createProduct(Product product, Locale locale);                     // no image

    Product getProductById(String productId, Locale locale);
    List<Product> getAllProducts();

    Product updateProduct(String productId, Product product, MultipartFile imageFile, Locale locale) throws IOException;
    Product updateProduct(String productId, Product product, Locale locale);   // no image
    Product updateProduct(String productId, Product product, Locale locale, boolean isSyncMode);

    void deleteProduct(String productId, Locale locale);

    List<Product> getLowStockProducts();
    List<Product> getExpiringProducts(Date threshold);

    Product restockProduct(String productId, int restockQty, Locale locale);
    Product updateProductQuantity(String productId, int quantity, Locale locale);
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\ProductServiceImpl.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.exception.DuplicateResourceException;
import com.smartretail.backend.exception.ProductNotFoundException;
import com.smartretail.backend.models.Product;
import com.smartretail.backend.repository.ProductRepository;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.MessageSource;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;
import org.springframework.web.multipart.MultipartFile;

import java.io.IOException;
import java.util.*;
import java.util.function.Consumer;
import java.util.function.Supplier;
import java.util.stream.Collectors;

@Service
public class ProductServiceImpl implements ProductService {

    private static final Logger logger = LoggerFactory.getLogger(ProductServiceImpl.class);

    private final ProductRepository productRepository;
    private final NotificationService notificationService;
    private final FileService fileService;
    private final MessageSource messageSource;
    private final AuditLogService auditLogService;

    @Autowired
    public ProductServiceImpl(ProductRepository productRepository,
                              NotificationService notificationService,
                              FileService fileService,
                              MessageSource messageSource,
                              AuditLogService auditLogService) {
        this.productRepository = productRepository;
        this.notificationService = notificationService;
        this.fileService = fileService;
        this.messageSource = messageSource;
        this.auditLogService = auditLogService;
    }

    private String currentUser() {
        return Optional.ofNullable(SecurityContextHolder.getContext().getAuthentication())
                .map(auth -> auth.getName())
                .orElse("system");
    }

    private void audit(String action, String entityId, Map<String, Object> details) {
        auditLogService.logAction(action, entityId, currentUser(), details);
    }

    /* ------------------- EXISTS ------------------- */
    @Override
    public boolean existsByProductId(String productId) {
        audit("PRODUCT_EXISTENCE_CHECKED", productId, Map.of("productId", productId));
        return productRepository.existsByProductId(productId);
    }

    /* ------------------- CREATE ------------------- */
    @Override
    @Transactional
    public Product createProduct(Product product, MultipartFile imageFile, Locale locale) throws IOException {
        logger.debug("[SERVICE] Creating product (image={}) – {}", imageFile != null, product.getName());

        if (productRepository.existsByProductId(product.getProductId())) {
            audit("PRODUCT_CREATION_FAILED", product.getProductId(),
                    Map.of("productId", product.getProductId(), "reason", "DUPLICATE_PRODUCT_ID"));
            throw new DuplicateResourceException("product.exists", product.getProductId());
        }

        String imageId = null;
        if (imageFile != null && !imageFile.isEmpty()) {
            imageId = fileService.uploadImage(imageFile, "product_" + product.getProductId());
            product.setImageId(imageId);
            product.setImageUrl("/api/products/image/" + imageId);
        }

        product.setCreatedAt(new Date());
        product.setLastUpdated(new Date());
        Product saved = productRepository.save(product);

        audit("PRODUCT_CREATED", saved.getProductId(), Map.of(
                "name", saved.getName(),
                "category", saved.getCategory(),
                "price", saved.getPrice(),
                "quantity", saved.getQuantity(),
                "minQuantity", saved.getMinQuantity(),
                "reorderLevel", saved.getReorderLevel(),
                "hasImage", imageId != null));

        logger.info("[SERVICE] Product created – {}", saved.getProductId());
        return saved;
    }

    @Override
    @Transactional
    public Product createProduct(Product product, Locale locale) {
        try {
            return createProduct(product, null, locale);
        } catch (IOException e) {
            throw new RuntimeException("Unexpected IO error", e);
        }
    }

    /* ------------------- READ ------------------- */
    @Override
    public Product getProductById(String productId, Locale locale) {
        return productRepository.findByProductId(productId)
                .map(p -> {
                    audit("PRODUCT_ACCESSED", productId, Map.of("name", p.getName()));
                    return p;
                })
                .orElseThrow(() -> {
                    audit("PRODUCT_ACCESS_FAILED", productId, Map.of("reason", "PRODUCT_NOT_FOUND"));
                    return new ProductNotFoundException(
                            messageSource.getMessage("product.not.found", new Object[]{productId}, locale));
                });
    }

    @Override
    public List<Product> getAllProducts() {
        audit("PRODUCTS_BULK_ACCESSED", "ALL", Map.of("action", "FETCH_ALL"));
        return productRepository.findAll();
    }

    /* ------------------- UPDATE (multipart) ------------------- */
    @Override
    @Transactional
    public Product updateProduct(String productId, Product patch, MultipartFile imageFile, Locale locale) throws IOException {
        Product existing = productRepository.findByProductId(productId)
                .orElseThrow(() -> {
                    audit("PRODUCT_UPDATE_FAILED", productId, Map.of("reason", "PRODUCT_NOT_FOUND"));
                    return new ProductNotFoundException(
                            messageSource.getMessage("product.not.found", new Object[]{productId}, locale));
                });

        Map<String, Object> oldVals = new HashMap<>();
        Map<String, Object> newVals = new HashMap<>();

        // ----- fields -----
        // Use all fields from the 'patch' object, not just a few
        updateIfChanged(existing::getName, existing::setName, patch.getName(), "name", oldVals, newVals);
        updateIfChanged(existing::getCategory, existing::setCategory, patch.getCategory(), "category", oldVals, newVals);

        // --- FIX: Use patch.getPrice() and patch.getQuantity() ---
        if (patch.getPrice() > 0) { // Check for valid price
            updateIfChanged(() -> existing.getPrice(), v -> existing.setPrice(v), patch.getPrice(), "price", oldVals, newVals);
        }
        if (patch.getQuantity() >= 0) { // Check for valid quantity
            updateIfChanged(existing::getQuantity, existing::setQuantity, patch.getQuantity(), "quantity", oldVals, newVals);
        }
        if (patch.getMinQuantity() > 0) {
            updateIfChanged(existing::getMinQuantity, existing::setMinQuantity, patch.getMinQuantity(), "minQuantity", oldVals, newVals);
        }
        if (patch.getReorderLevel() > 0) {
            updateIfChanged(existing::getReorderLevel, existing::setReorderLevel, patch.getReorderLevel(), "reorderLevel", oldVals, newVals);
        }
        // --- END FIX ---

        updateIfChanged(existing::getExpiryDate, existing::setExpiryDate, patch.getExpiryDate(), "expiryDate", oldVals, newVals);
        updateIfChanged(existing::getSupplierEmail, existing::setSupplierEmail, patch.getSupplierEmail(), "supplierEmail", oldVals, newVals);
        updateIfChanged(existing::getAddedBy, existing::setAddedBy, patch.getAddedBy(), "addedBy", oldVals, newVals);

        // Don't update imageUrl from JSON patch, only from imageFile
        // updateIfChanged(existing::getImageUrl, existing::setImageUrl, patch.getImageUrl(), "imageUrl", oldVals, newVals);

        // ----- image -----
        if (imageFile != null && !imageFile.isEmpty()) {
            String newId = fileService.uploadImage(imageFile, "product_" + productId);
            String newUrl = "/api/products/image/" + newId; // Use the correct URL structure
            oldVals.put("imageId", existing.getImageId());
            newVals.put("imageId", newId);
            newVals.put("imageUrl", newUrl);
            existing.setImageId(newId);
            existing.setImageUrl(newUrl); // Set the URL
        }

        existing.setLastUpdated(new Date());
        Product updated = productRepository.save(existing);

        boolean lowStock = sendLowStockIfNeeded(updated);
        audit("PRODUCT_UPDATED", productId, Map.of(
                "oldValues", oldVals,
                "newValues", newVals,
                "lowStockNotificationSent", lowStock));

        return updated;
    }

    @Override
    @Transactional
    public Product updateProduct(String productId, Product patch, Locale locale) {
        try {
            return updateProduct(productId, patch, null, locale);
        } catch (IOException e) {
            throw new RuntimeException("Unexpected IO error", e);
        }
    }

    /* ------------------- SYNC-MODE UPDATE ------------------- */
    @Override
    @Transactional
    public Product updateProduct(String productId, Product patch, Locale locale, boolean isSyncMode) {
        Product existing = productRepository.findByProductId(productId)
                .orElseThrow(() -> new ProductNotFoundException(
                        messageSource.getMessage("product.not.found", new Object[]{productId}, locale)));

        if (isSyncMode && noChanges(existing, patch)) {
            logger.info("[SERVICE] Sync-mode: no changes for {}", productId);
            return existing;
        }

        Map<String, Object> oldVals = new HashMap<>();
        Map<String, Object> newVals = new HashMap<>();

        updateIfChanged(existing::getName, existing::setName, patch.getName(), "name", oldVals, newVals);
        updateIfChanged(existing::getCategory, existing::setCategory, patch.getCategory(), "category", oldVals, newVals);
        updateIfChanged(() -> existing.getPrice(), v -> existing.setPrice(v), patch.getPrice(), "price", oldVals, newVals);
        updateIfChanged(existing::getQuantity, existing::setQuantity, patch.getQuantity(), "quantity", oldVals, newVals);
        updateIfChanged(existing::getMinQuantity, existing::setMinQuantity, patch.getMinQuantity(), "minQuantity", oldVals, newVals);
        updateIfChanged(existing::getReorderLevel, existing::setReorderLevel, patch.getReorderLevel(), "reorderLevel", oldVals, newVals);
        updateIfChanged(existing::getExpiryDate, existing::setExpiryDate, patch.getExpiryDate(), "expiryDate", oldVals, newVals);
        updateIfChanged(existing::getSupplierEmail, existing::setSupplierEmail, patch.getSupplierEmail(), "supplierEmail", oldVals, newVals);
        updateIfChanged(existing::getAddedBy, existing::setAddedBy, patch.getAddedBy(), "addedBy", oldVals, newVals);
        updateIfChanged(existing::getImageUrl, existing::setImageUrl, patch.getImageUrl(), "imageUrl", oldVals, newVals);

        existing.setLastUpdated(new Date());
        Product updated = productRepository.save(existing);

        boolean lowStock = !isSyncMode && sendLowStockIfNeeded(updated);
        audit("PRODUCT_UPDATED", productId, Map.of(
                "oldValues", oldVals,
                "newValues", newVals,
                "syncMode", isSyncMode,
                "lowStockNotificationSent", lowStock));

        return updated;
    }

    private boolean noChanges(Product existing, Product incoming) {
        return Objects.equals(existing.getQuantity(), incoming.getQuantity())
                && Objects.equals(existing.getName(), incoming.getName())
                && existing.getPrice() == incoming.getPrice()
                && Objects.equals(existing.getCategory(), incoming.getCategory())
                && existing.getMinQuantity() == incoming.getMinQuantity()
                && existing.getReorderLevel() == incoming.getReorderLevel();
    }

    private boolean sendLowStockIfNeeded(Product p) {
        if (p.getQuantity() < p.getReorderLevel()) {
            notificationService.sendLowStockNotification(
                    "manager@shop.com", p.getName(), p.getQuantity(), p.getReorderLevel());
            return true;
        }
        return false;
    }

    /* ------------------- DELETE ------------------- */
    @Override
    @Transactional
    public void deleteProduct(String productId, Locale locale) {
        Product p = productRepository.findByProductId(productId)
                .orElseThrow(() -> {
                    audit("PRODUCT_DELETION_FAILED", productId, Map.of("reason", "PRODUCT_NOT_FOUND"));
                    return new ProductNotFoundException(
                            messageSource.getMessage("product.not.found", new Object[]{productId}, locale));
                });

        audit("PRODUCT_DELETED", productId, Map.of(
                "name", p.getName(),
                "category", p.getCategory(),
                "quantity", p.getQuantity(),
                "price", p.getPrice(),
                "minQuantity", p.getMinQuantity()));

        productRepository.deleteByProductId(productId);
    }

    /* ------------------- LOW STOCK / EXPIRY ------------------- */
    @Override
    public List<Product> getLowStockProducts() {
        audit("LOW_STOCK_PRODUCTS_ACCESSED", "LOW_STOCK", Map.of());
        return productRepository.findLowStockProducts();
    }

    @Override
    public List<Product> getExpiringProducts(Date threshold) {
        audit("EXPIRING_PRODUCTS_ACCESSED", "EXPIRING", Map.of("threshold", threshold));
        return productRepository.findByExpiryDateBefore(threshold).stream()
                .filter(p -> p.getExpiryDate() != null)
                .collect(Collectors.toList());
    }

    /* ------------------- RESTOCK ------------------- */
    @Override
    @Transactional
    public Product restockProduct(String productId, int restockQty, Locale locale) {
        if (restockQty <= 0) {
            audit("PRODUCT_RESTOCK_FAILED", productId, Map.of("reason", "INVALID_QUANTITY"));
            throw new IllegalArgumentException(
                    messageSource.getMessage("product.restock.invalid.quantity", new Object[]{restockQty}, locale));
        }

        Product p = productRepository.findByProductId(productId)
                .orElseThrow(() -> {
                    audit("PRODUCT_RESTOCK_FAILED", productId, Map.of("reason", "PRODUCT_NOT_FOUND"));
                    return new ProductNotFoundException(
                            messageSource.getMessage("product.not.found", new Object[]{productId}, locale));
                });

        int oldQty = p.getQuantity();
        p.setQuantity(oldQty + restockQty);
        p.setLastUpdated(new Date());
        Product saved = productRepository.save(p);

        boolean low = sendLowStockIfNeeded(saved);
        audit("PRODUCT_RESTOCKED", productId, Map.of(
                "oldQuantity", oldQty,
                "restockQty", restockQty,
                "newQuantity", saved.getQuantity(),
                "lowStockNotificationSent", low));

        return saved;
    }

    /* ------------------- QUANTITY UPDATE ------------------- */
    @Override
    @Transactional
    public Product updateProductQuantity(String productId, int quantity, Locale locale) {
        Product p = productRepository.findByProductId(productId)
                .orElseThrow(() -> {
                    audit("PRODUCT_QUANTITY_UPDATE_FAILED", productId, Map.of("reason", "PRODUCT_NOT_FOUND"));
                    return new ProductNotFoundException(
                            messageSource.getMessage("product.not.found", new Object[]{productId}, locale));
                });

        int oldQty = p.getQuantity();
        int newQty = oldQty - quantity;
        if (newQty < 0) {
            audit("PRODUCT_QUANTITY_UPDATE_FAILED", productId, Map.of(
                    "oldQuantity", oldQty,
                    "quantityChange", quantity,
                    "reason", "INSUFFICIENT_STOCK"));
            throw new IllegalArgumentException(
                    messageSource.getMessage("product.insufficient.stock", new Object[]{productId}, locale));
        }

        p.setQuantity(newQty);
        p.setLastUpdated(new Date());
        Product saved = productRepository.save(p);

        boolean low = sendLowStockIfNeeded(saved);
        audit("PRODUCT_QUANTITY_UPDATED", productId, Map.of(
                "oldQuantity", oldQty,
                "quantityChange", quantity,
                "newQuantity", newQty,
                "lowStockNotificationSent", low));

        return saved;
    }

    /* ------------------- FIELD PATCH HELPER ------------------- */
    private <T> void updateIfChanged(Supplier<T> getter, Consumer<T> setter,
                                     T incoming, String field,
                                     Map<String, Object> oldMap,
                                     Map<String, Object> newMap) {
        T current = getter.get();
        if (incoming != null && !Objects.equals(incoming, current)) {
            oldMap.put(field, current);
            newMap.put(field, incoming);
            setter.accept(incoming);
        }
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\PushNotificationService.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.models.PushSubscription;
import com.smartretail.backend.repository.PushSubscriptionRepository;
import lombok.Getter;
import nl.martijndwars.webpush.Notification;
import nl.martijndwars.webpush.PushService;
import nl.martijndwars.webpush.Subscription;
import org.bouncycastle.jce.provider.BouncyCastleProvider;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Service;

import java.security.GeneralSecurityException;
import java.security.Security;
import java.util.Optional;

@Service
public class PushNotificationService {

    private final PushSubscriptionRepository subscriptionRepository;
    private final PushService pushService;

    @Getter
    private final String vapidPublicKey;
    private final String vapidPrivateKey;
    public PushNotificationService(
            PushSubscriptionRepository subscriptionRepository,
            @Value("${vapid.public.key}") String vapidPublicKey,
            @Value("${vapid.private.key}") String vapidPrivateKey
    ) throws GeneralSecurityException {
        this.subscriptionRepository = subscriptionRepository;
        this.vapidPublicKey = vapidPublicKey;
        this.vapidPrivateKey = vapidPrivateKey;

        Security.addProvider(new BouncyCastleProvider());

        this.pushService = new PushService(vapidPublicKey, vapidPrivateKey);
    }

    public void saveSubscription(String userId, PushSubscription subscription) {
        subscription.setUserId(userId);
        subscriptionRepository.save(subscription);
        System.out.println("[PUSH] Subscription saved for user: " + userId);
    }

    public void sendPushNotification(String userId, String title, String message) {
        Optional<PushSubscription> subscriptionOpt = subscriptionRepository.findByUserId(userId);
        if (subscriptionOpt.isPresent()) {
            PushSubscription subscriptionEntity = subscriptionOpt.get();

            try {
                // Convert your entity to web-push library's Subscription object
                Subscription subscription = new Subscription(
                        subscriptionEntity.getEndpoint(),
                        new Subscription.Keys(
                                subscriptionEntity.getP256dh(),
                                subscriptionEntity.getAuth()
                        )
                );

                // Create notification payload (you can use JSON for more complex messages)
                String payload = "{\"title\":\"" + title + "\",\"body\":\"" + message + "\"}";

                // Create and send notification
                Notification notification = new Notification(subscription, payload);
                pushService.send(notification);

                System.out.println("[PUSH] Notification sent to user: " + userId);
            } catch (Exception e) {
                System.err.println("[PUSH] Failed to send notification to user: " + userId + ", error: " + e.getMessage());
                e.printStackTrace();
            }
        }
    }

}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\ReminderService.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.models.Bill;
import com.smartretail.backend.models.Customer;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.context.MessageSource;
import org.springframework.scheduling.annotation.Scheduled;
import org.springframework.stereotype.Service;

import java.util.*;
import java.util.stream.Collectors;

@Service
public class ReminderService {

    private static final Logger logger = LoggerFactory.getLogger(ReminderService.class);

    private final CustomerService customerService;
    private final NotificationService notificationService;
    private final MessageSource messageSource;

    public ReminderService(CustomerService customerService,
                           NotificationService notificationService,
                           MessageSource messageSource) {
        this.customerService = customerService;
        this.notificationService = notificationService;
        this.messageSource = messageSource;
    }

    /**
     * Sends monthly purchase reminders to customers with frequently bought items.
     * Runs on the 1st of every month at 9:00 AM.
     */
    @Scheduled(cron = "0 0 9 1 * ?")
    public void sendMonthlyPurchaseReminders() {
        logger.info("[REMINDER SERVICE] Starting monthly purchase reminders");

        List<Customer> customers = customerService.getAllCustomers();
        int processedCount = 0;

        for (Customer customer : customers) {
            if (customer.getEmail() == null || customer.getEmail().isBlank()) {
                logger.debug("[REMINDER SERVICE] Skipping {}: no email", customer.getMobile());
                continue;
            }

            List<Bill> purchaseHistory = customerService.getCustomerPurchaseHistory(
                    customer.getId(), null, null, Locale.ENGLISH);

            if (purchaseHistory.isEmpty()) {
                logger.debug("[REMINDER SERVICE] Skipping {}: no purchase history", customer.getMobile());
                continue;
            }

            // Count product frequency
            Map<String, Long> productFrequency = purchaseHistory.stream()
                    .flatMap(bill -> bill.getItems().stream())
                    .collect(Collectors.groupingBy(
                            Bill.BillItem::getProductName,
                            Collectors.counting()
                    ));

            List<String> frequentItems = productFrequency.entrySet().stream()
                    .filter(entry -> entry.getValue() >= 2)
                    .map(Map.Entry::getKey)
                    .collect(Collectors.toList());

            if (frequentItems.isEmpty()) {
                logger.debug("[REMINDER SERVICE] Skipping {}: no frequent items", customer.getMobile());
                continue;
            }

            try {
                String subject = messageSource.getMessage("reminder.subject", null, Locale.ENGLISH);
                String body = messageSource.getMessage(
                        "reminder.body",
                        new Object[]{customer.getName(), String.join("\n", frequentItems)},
                        Locale.ENGLISH
                );

                notificationService.sendEmail(customer.getEmail(), subject, body);
                logger.info("[REMINDER SERVICE] Sent reminder to {} for items: {}", customer.getMobile(), frequentItems);
                processedCount++;
            } catch (Exception e) {
                logger.error("[REMINDER SERVICE] Failed to send reminder to {}: {}", customer.getEmail(), e.getMessage());
            }
        }

        logger.info("[REMINDER SERVICE] Monthly reminders complete. Processed {} customers.", processedCount);
    }

    /**
     * Sends re-engagement emails to customers inactive for 30+ days.
     * Runs daily at 10:00 AM.
     */
    @Scheduled(cron = "0 0 10 * * ?")
    public void sendReEngagementReminders() {
        logger.info("[REMINDER SERVICE] Starting daily re-engagement email task...");

        // Calculate threshold: 30 days ago
        Calendar cal = Calendar.getInstance();
        cal.add(Calendar.DAY_OF_MONTH, -30);
        Date thirtyDaysAgo = cal.getTime();

        // Find inactive customers
        List<Customer> inactiveCustomers = customerService.findInactiveCustomers(thirtyDaysAgo);

        if (inactiveCustomers.isEmpty()) {
            logger.info("[REMINDER SERVICE] No inactive customers found. Task complete.");
            return;
        }

        logger.info("[REMINDER SERVICE] Found {} inactive customers to re-engage.", inactiveCustomers.size());

        String subject = messageSource.getMessage("re_engagement.subject", null, Locale.ENGLISH);
        int successCount = 0;

        for (Customer customer : inactiveCustomers) {
            if (customer.getEmail() == null || customer.getEmail().isBlank()) {
                logger.debug("[REMINDER SERVICE] Skipping inactive customer {}: no email", customer.getId());
                continue;
            }

            try {
                String body = messageSource.getMessage(
                        "re_engagement.body",
                        new Object[]{Optional.ofNullable(customer.getName()).orElse("Valued Customer")},
                        Locale.ENGLISH
                );

                notificationService.sendEmail(customer.getEmail(), subject, body);
                successCount++;
                logger.debug("[REMINDER SERVICE] Re-engagement email sent to: {}", customer.getEmail());
            } catch (Exception e) {
                logger.error("[REMINDER SERVICE] Failed to send re-engagement email to {}: {}", customer.getEmail(), e.getMessage());
            }
        }

        logger.info("[REMINDER SERVICE] Re-engagement task complete. Successfully sent {} emails.", successCount);
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\ReportPdfService.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.dto.FullReportResponse;
import java.util.Locale;

public interface ReportPdfService {
    /**
     * Generates a full executive report as a PDF byte array.
     * @param reportData The combined report data DTO
     * @param locale The locale for any I18n strings (if needed)
     * @return A byte[] containing the PDF data
     */
    byte[] generateFullReportPdf(FullReportResponse reportData, String startDate, String endDate, Locale locale);
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\ReportPdfServiceImpl.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.itextpdf.kernel.colors.DeviceRgb;
import com.itextpdf.kernel.colors.ColorConstants;
import com.itextpdf.kernel.font.PdfFont;
import com.itextpdf.kernel.font.PdfFontFactory;
import com.itextpdf.kernel.geom.PageSize;
import com.itextpdf.kernel.pdf.PdfDocument;
import com.itextpdf.kernel.pdf.PdfWriter;
import com.itextpdf.layout.Document;
import com.itextpdf.layout.borders.SolidBorder;
import com.itextpdf.layout.element.Cell;
import com.itextpdf.layout.element.Paragraph;
import com.itextpdf.layout.element.Table;
import com.itextpdf.layout.properties.TextAlignment;
import com.itextpdf.layout.properties.UnitValue;
import com.smartretail.backend.dto.FullReportResponse;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.stereotype.Service;

import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.text.NumberFormat;
import java.util.List;
import java.util.Locale;
import java.util.*;

// --- NEW IMPORT ---
import org.springframework.context.MessageSource;
// --- END NEW IMPORT ---

@Service
public class ReportPdfServiceImpl implements ReportPdfService {

    private static final Logger logger = LoggerFactory.getLogger(ReportPdfServiceImpl.class);

    // --- NEW FIELD ---
    private final MessageSource messageSource;

    // --- NEW CONSTRUCTOR ---
    public ReportPdfServiceImpl(MessageSource messageSource) {
        this.messageSource = messageSource;
    }

    // --- NEW HELPER METHOD ---
    private String t(String key, Locale locale) {
        return messageSource.getMessage(key, null, key, locale);
    }

    @Override
    public byte[] generateFullReportPdf(FullReportResponse reportData, String startDate, String endDate, Locale locale) {
        try (ByteArrayOutputStream outputStream = new ByteArrayOutputStream()) {
            PdfWriter writer = new PdfWriter(outputStream);
            PdfDocument pdf = new PdfDocument(writer);
            Document document = new Document(pdf, PageSize.A4);
            document.setMargins(40, 40, 40, 40);

            PdfFont font;
            PdfFont boldFont;
            PdfFont titleFont;
            try {
                font = PdfFontFactory.createFont("Helvetica");
                boldFont = PdfFontFactory.createFont("Helvetica-Bold");
                titleFont = PdfFontFactory.createFont("Helvetica-Bold");
            } catch (IOException e) {
                font = PdfFontFactory.createFont();
                boldFont = PdfFontFactory.createFont();
                titleFont = PdfFontFactory.createFont();
            }

            // Build PDF sections WITHOUT Low Stock Details
            addHeader(document, startDate, endDate, titleFont, font, locale); // <-- Pass locale
            addAISummary(document, reportData, boldFont, font, locale); // <-- Pass locale
            addKeyMetrics(document, reportData, boldFont, font, locale); // <-- Pass locale
            addInventoryAlerts(document, reportData, boldFont, font, locale); // <-- Pass locale
            addTopProducts(document, reportData, boldFont, font, locale); // <-- Pass locale
            // REMOVED: addLowStockDetails(document, reportData, boldFont, font, locale);

            document.close();
            logger.info("Successfully generated PDF report");
            return outputStream.toByteArray();

        } catch (Exception e) {
            logger.error("Failed to generate PDF report: {}", e.getMessage(), e);
            throw new RuntimeException("PDF generation failed", e);
        }
    }

    // --- MODIFIED METHOD ---
    private void addHeader(Document document, String startDate, String endDate, PdfFont titleFont, PdfFont font, Locale locale) {
        // Main title matching website
        Paragraph title = new Paragraph(t("pdf.report.title", locale)) // "Executive Report"
                .setFont(titleFont)
                .setFontSize(24)
                .setTextAlignment(TextAlignment.CENTER)
                .setFontColor(ColorConstants.BLACK)
                .setMarginBottom(5);
        document.add(title);

        // Date range matching website format
        Paragraph dateRange = new Paragraph(startDate + " " + t("pdf.report.to", locale) + " " + endDate) // "to"
                .setFont(font)
                .setFontSize(14)
                .setTextAlignment(TextAlignment.CENTER)
                .setFontColor(ColorConstants.DARK_GRAY)
                .setMarginBottom(30);
        document.add(dateRange);

        // Add a subtle separator line
        Paragraph separator = new Paragraph("")
                .setBorder(new SolidBorder(ColorConstants.LIGHT_GRAY, 0.5f))
                .setMarginBottom(30);
        document.add(separator);
    }

    // --- MODIFIED METHOD ---
    private void addAISummary(Document document, FullReportResponse reportData, PdfFont boldFont, PdfFont font, Locale locale) {
        try {
            // Extract AI summary from the correct location in response
            String summary = extractAISummary(reportData);
            if (summary != null && !summary.trim().isEmpty()) {
                Paragraph sectionTitle = new Paragraph(t("pdf.report.aiSummary", locale)) // "AI Generated Summary"
                        .setFont(boldFont)
                        .setFontSize(18)
                        .setFontColor(ColorConstants.BLACK)
                        .setMarginBottom(10);
                document.add(sectionTitle);

                Paragraph summaryParagraph = new Paragraph(summary)
                        .setFont(font)
                        .setFontSize(11)
                        .setFontColor(ColorConstants.DARK_GRAY)
                        .setItalic()
                        .setPadding(15)
                        .setBorder(new SolidBorder(getColorFromHex("#0ea5e9"), 2f)) // Cyan border
                        .setBorderLeft(new SolidBorder(getColorFromHex("#0ea5e9"), 4f))
                        .setBackgroundColor(getColorFromHex("#f8fafc")) // Light gray background
                        .setMarginBottom(25);
                document.add(summaryParagraph);
            }
        } catch (Exception e) {
            logger.warn("Could not parse AI summary for PDF: {}", e.getMessage());
        }
    }

    private String extractAISummary(FullReportResponse reportData) {
        // Try multiple possible locations for AI summary
        if (reportData.getTextSummary() != null) {
            if (reportData.getTextSummary() instanceof Map) {
                Map<?, ?> textSummaryMap = (Map<?, ?>) reportData.getTextSummary();
                Object summary = textSummaryMap.get("report");
                if (summary instanceof String) {
                    return (String) summary;
                }
            } else if (reportData.getTextSummary() instanceof String) {
                return (String) reportData.getTextSummary();
            }
        }

        // Check if summary is in sales report
        if (reportData.getSalesReport() != null && reportData.getSalesReport() instanceof Map) {
            Map<?, ?> salesReport = (Map<?, ?>) reportData.getSalesReport();
            Object summary = salesReport.get("aiSummary");
            if (summary instanceof String) {
                return (String) summary;
            }
        }

        return "AI summary not available for this report period.";
    }

    // --- MODIFIED METHOD ---
    private void addKeyMetrics(Document document, FullReportResponse reportData, PdfFont boldFont, PdfFont font, Locale locale) {
        try {
            Map<String, Object> salesSummary = extractSalesSummary(reportData);
            if (salesSummary != null && !salesSummary.isEmpty()) {
                NumberFormat currencyFormat = NumberFormat.getCurrencyInstance(new Locale("en", "IN"));

                Paragraph sectionTitle = new Paragraph(t("pdf.report.keyMetrics", locale)) // "Key Metrics"
                        .setFont(boldFont)
                        .setFontSize(18)
                        .setFontColor(ColorConstants.BLACK)
                        .setMarginBottom(15);
                document.add(sectionTitle);

                // Extract metrics with fallbacks
                double totalRevenue = getDoubleValue(salesSummary.get("total_revenue"));
                int totalOrders = getIntValue(salesSummary.get("total_orders"));
                int productsSold = getIntValue(salesSummary.get("total_products_sold"));

                // If direct values not found, try alternative keys
                if (totalRevenue == 0) {
                    totalRevenue = getDoubleValue(salesSummary.get("totalRevenue"));
                }
                if (totalOrders == 0) {
                    totalOrders = getIntValue(salesSummary.get("totalOrders"));
                }
                if (productsSold == 0) {
                    productsSold = getIntValue(salesSummary.get("totalProductsSold"));
                }

                Table table = new Table(UnitValue.createPercentArray(3)).useAllAvailableWidth();

                // Revenue metric (green color from website)
                table.addCell(createMetricCell(t("pdf.report.totalRevenue", locale), currencyFormat.format(totalRevenue), // "Total Revenue"
                        boldFont, font, ColorConstants.DARK_GRAY, getColorFromHex("#10b981")));

                // Orders metric (blue color from website)
                table.addCell(createMetricCell(t("pdf.report.totalOrders", locale), String.valueOf(totalOrders), // "Total Orders"
                        boldFont, font, ColorConstants.DARK_GRAY, getColorFromHex("#3b82f6")));

                // Products sold metric (cyan color from website)
                table.addCell(createMetricCell(t("pdf.report.productsSold", locale), String.valueOf(productsSold), // "Products Sold"
                        boldFont, font, ColorConstants.DARK_GRAY, getColorFromHex("#06b6d4")));

                document.add(table.setMarginBottom(30));
            }
        } catch (Exception e) {
            logger.warn("Could not parse key metrics for PDF: {}", e.getMessage());
        }
    }

    private Map<String, Object> extractSalesSummary(FullReportResponse reportData) {
        if (reportData.getSalesReport() instanceof Map) {
            Map<?, ?> salesReport = (Map<?, ?>) reportData.getSalesReport();
            Object summaryObj = salesReport.get("summary");
            if (summaryObj instanceof Map) {
                return (Map<String, Object>) summaryObj;
            }
            // If no summary object, use the sales report itself
            return (Map<String, Object>) salesReport;
        }
        return null;
    }

    // --- MODIFIED METHOD ---
    private void addInventoryAlerts(Document document, FullReportResponse reportData, PdfFont boldFont, PdfFont font, Locale locale) {
        try {
            Map<String, Object> inventoryReport = reportData.getInventoryReport();
            if (inventoryReport != null) {
                Paragraph sectionTitle = new Paragraph(t("pdf.report.inventoryAlerts", locale)) // "Inventory Alerts"
                        .setFont(boldFont)
                        .setFontSize(18)
                        .setFontColor(ColorConstants.BLACK)
                        .setMarginBottom(15);
                document.add(sectionTitle);

                // Extract counts with multiple fallback keys
                int lowStockCount = getIntValue(inventoryReport.get("lowStockCount"));
                if (lowStockCount == 0) {
                    lowStockCount = getIntValue(inventoryReport.get("low_stock_count"));
                }

                int expiringCount = getIntValue(inventoryReport.get("expiringCount"));
                if (expiringCount == 0) {
                    expiringCount = getIntValue(inventoryReport.get("expiring_count"));
                }

                Table table = new Table(UnitValue.createPercentArray(2)).useAllAvailableWidth();

                // Low stock (orange color from website)
                table.addCell(createMetricCell(t("pdf.report.lowStock", locale), String.valueOf(lowStockCount), // "Low Stock Items"
                        boldFont, font, ColorConstants.DARK_GRAY, getColorFromHex("#f59e0b")));

                // Expiring soon (red color from website)
                table.addCell(createMetricCell(t("pdf.report.expiring", locale), String.valueOf(expiringCount), // "Expiring Soon Items"
                        boldFont, font, ColorConstants.DARK_GRAY, getColorFromHex("#ef4444")));

                document.add(table.setMarginBottom(30));
            }
        } catch (Exception e) {
            logger.warn("Could not parse inventory alerts for PDF: {}", e.getMessage());
        }
    }

    // --- MODIFIED METHOD ---
    private void addTopProducts(Document document, FullReportResponse reportData, PdfFont boldFont, PdfFont font, Locale locale) {
        try {
            List<Map<String, Object>> topProducts = extractTopProducts(reportData);
            if (topProducts != null && !topProducts.isEmpty()) {
                Paragraph sectionTitle = new Paragraph(t("pdf.report.topProducts", locale)) // "Top Selling Products"
                        .setFont(boldFont)
                        .setFontSize(18)
                        .setFontColor(ColorConstants.BLACK)
                        .setMarginBottom(10);
                document.add(sectionTitle);

                Table table = new Table(UnitValue.createPercentArray(new float[]{3, 2, 2, 2})).useAllAvailableWidth();

                // Header row
                table.addHeaderCell(createHeaderCell(t("pdf.report.productName", locale), boldFont)); // "Product Name"
                table.addHeaderCell(createHeaderCell(t("pdf.report.category", locale), boldFont)); // "Category"
                table.addHeaderCell(createHeaderCell(t("pdf.report.unitsSold", locale), boldFont)); // "Units Sold"
                table.addHeaderCell(createHeaderCell(t("pdf.report.totalRevenue", locale), boldFont)); // "Total Revenue"

                NumberFormat currencyFormat = NumberFormat.getCurrencyInstance(new Locale("en", "IN"));

                for (Map<String, Object> product : topProducts) {
                    String name = getStringValue(product.get("name"));
                    String category = getStringValue(product.get("category"));
                    int qty = getIntValue(product.get("qty"));
                    double revenue = getDoubleValue(product.get("revenue"));

                    table.addCell(createBodyCell(name, font));
                    table.addCell(createBodyCell(category, font));
                    table.addCell(createBodyCell(String.valueOf(qty), font));
                    table.addCell(createBodyCell(currencyFormat.format(revenue), font));
                }
                document.add(table.setMarginBottom(25));
            } else {
                // Add message when no top products
                Paragraph noData = new Paragraph(t("pdf.report.noTopProducts", locale)) // "No top selling products data available for this period."
                        .setFont(font)
                        .setFontSize(11)
                        .setFontColor(ColorConstants.DARK_GRAY)
                        .setItalic()
                        .setMarginBottom(25);
                document.add(noData);
            }
        } catch (Exception e) {
            logger.warn("Could not parse top products for PDF: {}", e.getMessage());
        }
    }

    private List<Map<String, Object>> extractTopProducts(FullReportResponse reportData) {
        if (reportData.getSalesReport() instanceof Map) {
            Map<?, ?> salesReport = (Map<?, ?>) reportData.getSalesReport();
            Object topProductsObj = salesReport.get("top_products");
            if (topProductsObj instanceof List) {
                return (List<Map<String, Object>>) topProductsObj;
            }
        }
        return null;
    }

    // --- MODIFIED METHOD (if you decide to re-enable low stock details) ---
    private void addLowStockDetails(Document document, FullReportResponse reportData, PdfFont boldFont, PdfFont font, Locale locale) {
        try {
            document.add(new Paragraph(t("pdf.report.lowStockDetails", locale)) // "Low Stock Details"
                    .setFont(boldFont)
                    .setFontSize(18)
                    .setFontColor(ColorConstants.BLACK)
                    .setMarginBottom(10));

            List<Map<String, Object>> lowStockProducts = extractLowStockProducts(reportData);

            if (lowStockProducts != null && !lowStockProducts.isEmpty()) {
                logger.debug("Displaying {} low stock products in PDF", lowStockProducts.size());

                Table table = new Table(UnitValue.createPercentArray(new float[]{3, 2, 2, 2}))
                        .useAllAvailableWidth()
                        .setMarginBottom(20);

                // Header row
                table.addHeaderCell(createHeaderCell(t("pdf.report.productName", locale), boldFont)); // "Product Name"
                table.addHeaderCell(createHeaderCell(t("pdf.report.category", locale), boldFont)); // "Category"
                table.addHeaderCell(createHeaderCell(t("pdf.report.remainingQty", locale), boldFont)); // "Remaining Qty"
                table.addHeaderCell(createHeaderCell(t("pdf.report.reorderLevel", locale), boldFont)); // "Re-order Level"

                for (Map<String, Object> product : lowStockProducts) {
                    // Extract data with multiple fallback keys
                    String name = getStringValue(product.get("name"));
                    if (name.equals("N/A")) name = getStringValue(product.get("productName"));

                    String category = getStringValue(product.get("category"));
                    if (category.equals("N/A")) category = getStringValue(product.get("productCategory"));

                    int quantity = getIntValue(product.get("quantity"));
                    if (quantity == 0) quantity = getIntValue(product.get("stock"));
                    if (quantity == 0) quantity = getIntValue(product.get("remainingQuantity"));

                    int reorderLevel = getIntValue(product.get("reorderLevel"));
                    if (reorderLevel == 0) reorderLevel = getIntValue(product.get("reorderLevel"));
                    if (reorderLevel == 0) reorderLevel = getIntValue(product.get("reorder_level"));

                    table.addCell(createBodyCell(name, font));
                    table.addCell(createBodyCell(category, font));
                    table.addCell(createBodyCell(String.valueOf(quantity), font));
                    table.addCell(createBodyCell(String.valueOf(reorderLevel), font));
                }
                document.add(table);
            } else {
                logger.debug("No low stock products to display");
                Paragraph noData = new Paragraph(t("pdf.report.noLowStock", locale)) // "No low stock items to display"
                        .setFont(font)
                        .setFontSize(11)
                        .setFontColor(ColorConstants.DARK_GRAY)
                        .setItalic()
                        .setMarginBottom(20);
                document.add(noData);
            }
        } catch (Exception e) {
            logger.error("Error in addLowStockDetails: {}", e.getMessage(), e);

            Paragraph errorMsg = new Paragraph(t("pdf.report.lowStockError", locale) + e.getMessage()) // "Error loading low stock details: "
                    .setFont(font)
                    .setFontSize(10)
                    .setFontColor(ColorConstants.RED)
                    .setItalic()
                    .setMarginBottom(20);
            document.add(errorMsg);
        }
    }

    private List<Map<String, Object>> extractLowStockProducts(FullReportResponse reportData) {
        try {
            if (reportData == null) {
                logger.debug("Report data is null");
                return null;
            }

            logger.debug("=== DEEP INVENTORY REPORT ANALYSIS ===");

            // Method 1: Direct extraction from inventory report
            if (reportData.getInventoryReport() != null) {
                Map<String, Object> inventoryReport = reportData.getInventoryReport();
                logger.debug("Inventory Report Type: {}", inventoryReport.getClass().getSimpleName());
                logger.debug("All Inventory Report Keys: {}", inventoryReport.keySet());

                // Print ALL keys and their types
                for (Map.Entry<String, Object> entry : inventoryReport.entrySet()) {
                    logger.debug("Key: '{}', Type: {}, Value: {}",
                            entry.getKey(),
                            entry.getValue() != null ? entry.getValue().getClass().getSimpleName() : "null",
                            entry.getValue() instanceof List ? "List with " + ((List<?>) entry.getValue()).size() + " items" : entry.getValue());
                }

                // Try EVERY possible key pattern
                String[] allPossibleKeys = {
                        "lowStockProducts", "lowStockItems", "low_stock_products",
                        "lowStockList", "lowStockDetails", "low_stock_items",
                        "lowStock", "low_stock", "lowStockProductsList",
                        "products", "items", "inventoryItems", "stockItems",
                        "lowStockData", "low_stock_data", "lowInventory"
                };

                for (String key : allPossibleKeys) {
                    if (inventoryReport.containsKey(key)) {
                        Object obj = inventoryReport.get(key);
                        logger.debug("Found potential data with key '{}': {}", key, obj);

                        if (obj instanceof List) {
                            List<?> list = (List<?>) obj;
                            logger.debug("List with key '{}' has {} items", key, list.size());
                            if (!list.isEmpty()) {
                                logger.debug("First item in list: {}", list.get(0));
                                if (list.get(0) instanceof Map) {
                                    Map<?, ?> firstItem = (Map<?, ?>) list.get(0);
                                    logger.debug("First item keys: {}", firstItem.keySet());
                                }
                            }

                            List<Map<String, Object>> result = convertToListOfMaps(list);
                            if (!result.isEmpty()) {
                                logger.debug("SUCCESS: Found low stock data with key '{}', {} items", key, result.size());
                                return result;
                            }
                        }
                    }
                }

                // Method 2: Look for ANY list that contains product-like objects
                logger.debug("=== SEARCHING FOR ANY PRODUCT-LIKE LISTS ===");
                for (Map.Entry<String, Object> entry : inventoryReport.entrySet()) {
                    if (entry.getValue() instanceof List) {
                        List<?> list = (List<?>) entry.getValue();
                        if (!list.isEmpty() && list.get(0) instanceof Map) {
                            Map<?, ?> firstItem = (Map<?, ?>) list.get(0);
                            logger.debug("Found list with key '{}', first item keys: {}", entry.getKey(), firstItem.keySet());

                            // Check if this looks like product data
                            if (hasProductFields(firstItem)) {
                                List<Map<String, Object>> result = convertToListOfMaps(list);
                                logger.debug("SUCCESS: Found product data with key '{}', {} items", entry.getKey(), result.size());
                                return result;
                            }
                        }
                    }
                }
            }

            // Method 3: Check if low stock data is at the root level
            logger.debug("=== CHECKING ROOT LEVEL ===");
            if (reportData instanceof Map) {
                Map<?, ?> rootMap = (Map<?, ?>) reportData;
                logger.debug("Root level keys: {}", rootMap.keySet());

                for (String key : new String[]{"lowStockProducts", "lowStockItems"}) {
                    if (rootMap.containsKey(key)) {
                        Object obj = rootMap.get(key);
                        if (obj instanceof List) {
                            List<Map<String, Object>> result = convertToListOfMaps((List<?>) obj);
                            logger.debug("SUCCESS: Found low stock data at root level with key '{}', {} items", key, result.size());
                            return result;
                        }
                    }
                }
            }

            logger.debug("FAILED: No low stock products found after exhaustive search");
            return null;

        } catch (Exception e) {
            logger.error("Error extracting low stock products: {}", e.getMessage(), e);
            return null;
        }
    }

    // Helper method to convert any list to List<Map<String, Object>>
    private List<Map<String, Object>> convertToListOfMaps(List<?> rawList) {
        List<Map<String, Object>> result = new ArrayList<>();
        if (rawList != null) {
            for (Object item : rawList) {
                if (item instanceof Map) {
                    result.add((Map<String, Object>) item);
                }
            }
        }
        return result;
    }

    // Helper method to check if a map has product-like fields
    private boolean hasProductFields(Map<?, ?> item) {
        Set<?> keys = item.keySet();
        return keys.contains("name") || keys.contains("productName") ||
                keys.contains("quantity") || keys.contains("stock") ||
                keys.contains("reorderLevel") || keys.contains("category");
    }

    private String determineStockStatus(int quantity, int reorderLevel) {
        if (quantity <= 0) return "Out of Stock";
        if (quantity <= 2) return "Critical";
        if (reorderLevel > 0 && quantity <= reorderLevel) return "Below Reorder Level";
        return "Low Stock";
    }

    private Cell createMetricCell(String title, String value, PdfFont boldFont, PdfFont font,
                                  com.itextpdf.kernel.colors.Color titleColor, com.itextpdf.kernel.colors.Color valueColor) {
        Cell cell = new Cell();
        cell.setBorder(new SolidBorder(ColorConstants.LIGHT_GRAY, 1f))
                .setPadding(15)
                .setBackgroundColor(ColorConstants.WHITE)
                .add(new Paragraph(title)
                        .setFont(font).setFontSize(11)
                        .setFontColor(titleColor)
                        .setTextAlignment(TextAlignment.CENTER))
                .add(new Paragraph(value)
                        .setFont(boldFont).setFontSize(20)
                        .setFontColor(valueColor)
                        .setTextAlignment(TextAlignment.CENTER)
                        .setMarginTop(5));
        return cell;
    }

    private Cell createHeaderCell(String text, PdfFont font) {
        Cell cell = new Cell();
        cell.add(new Paragraph(text))
                .setFont(font).setFontSize(11)
                .setFontColor(ColorConstants.WHITE)
                .setBackgroundColor(ColorConstants.DARK_GRAY)
                .setPadding(8)
                .setTextAlignment(TextAlignment.LEFT);
        return cell;
    }

    private Cell createBodyCell(String text, PdfFont font) {
        Cell cell = new Cell();
        cell.add(new Paragraph(text))
                .setFont(font).setFontSize(10)
                .setFontColor(ColorConstants.BLACK)
                .setPadding(8)
                .setTextAlignment(TextAlignment.LEFT);
        return cell;
    }

    // Helper method to convert hex color to iText Color
    private com.itextpdf.kernel.colors.Color getColorFromHex(String hexColor) {
        try {
            if (hexColor.startsWith("#")) {
                hexColor = hexColor.substring(1);
            }
            int r = Integer.parseInt(hexColor.substring(0, 2), 16);
            int g = Integer.parseInt(hexColor.substring(2, 4), 16);
            int b = Integer.parseInt(hexColor.substring(4, 6), 16);
            return new com.itextpdf.kernel.colors.DeviceRgb(r, g, b);
        } catch (Exception e) {
            return ColorConstants.BLACK;
        }
    }

    // Helper methods for safe type conversion
    private double getDoubleValue(Object value) {
        if (value instanceof Number) {
            return ((Number) value).doubleValue();
        }
        return 0.0;
    }

    private int getIntValue(Object value) {
        if (value instanceof Number) {
            return ((Number) value).intValue();
        }
        return 0;
    }

    private String getStringValue(Object value) {
        if (value instanceof String) {
            return (String) value;
        }
        return value != null ? value.toString() : "N/A";
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\ReportService.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.dto.FullReportResponse;
import java.util.Date;
import java.util.Locale;
import java.util.Map;

public interface ReportService {
    Map<String, Object> getSalesReport(Date startDate, Date endDate, Locale locale);
    Map<String, Object> getInventoryReport(int lowStockThreshold, int expiryDays, Locale locale);

    // --- ADDED NEW METHOD ---
    FullReportResponse getFullReportData(String startDate, String endDate, int lowStockThreshold, int expiryDays, Locale locale);
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\ReportServiceImpl.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.dto.FullReportResponse;
import com.smartretail.backend.models.Bill;
import com.smartretail.backend.models.Product;
import com.smartretail.backend.repository.BillRepository;
import com.smartretail.backend.repository.ProductRepository;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.context.MessageSource;
import org.springframework.data.mongodb.core.MongoTemplate;
import org.springframework.data.mongodb.core.aggregation.Aggregation;
import org.springframework.data.mongodb.core.aggregation.AggregationResults;
import org.springframework.data.mongodb.core.query.Criteria;
import org.springframework.stereotype.Service;

import java.util.*;
import java.util.stream.Collectors;

@Service
public class ReportServiceImpl implements ReportService {
    private static final Logger logger = LoggerFactory.getLogger(ReportServiceImpl.class);
    private final BillRepository billRepository;
    private final ProductRepository productRepository;
    private final MongoTemplate mongoTemplate;
    private final MessageSource messageSource;
    private final AnalyticsService analyticsService;

    public ReportServiceImpl(BillRepository billRepository, ProductRepository productRepository,
                             MongoTemplate mongoTemplate, MessageSource messageSource,
                             AnalyticsService analyticsService) {
        this.billRepository = billRepository;
        this.productRepository = productRepository;
        this.mongoTemplate = mongoTemplate;
        this.messageSource = messageSource;
        this.analyticsService = analyticsService;
    }

    @Override
    public Map<String, Object> getSalesReport(Date startDate, Date endDate, Locale locale) {
        logger.debug("[SERVICE] Generating sales report for range: {} to {}", startDate, endDate);
        if (startDate.after(endDate)) {
            logger.error("[SERVICE] Invalid date range: startDate={} is after endDate={}", startDate, endDate);
            throw new IllegalArgumentException(
                    messageSource.getMessage("report.date.range.invalid", new Object[]{startDate, endDate}, locale));
        }

        // Simplified aggregation without complex SpEL expressions
        Aggregation aggregation = Aggregation.newAggregation(
                Aggregation.match(Criteria.where("createdAt").gte(startDate).lte(endDate)),
                Aggregation.group()
                        .count().as("billCount")
                        .sum("totalAmount").as("totalSales")
        );

        AggregationResults<Map> results = mongoTemplate.aggregate(aggregation, "bills", Map.class);
        Map<String, Object> report = results.getUniqueMappedResult();

        Map<String, Object> result = new HashMap<>();
        if (report == null || report.isEmpty()) {
            logger.info("[SERVICE] No bills found for range: {} to {}", startDate, endDate);
            result.put("totalSales", 0.0);
            result.put("billCount", 0);
            result.put("averageBillAmount", 0.0);
            result.put("bills", Collections.emptyList());
        } else {
            // Get bills with null safety for createdAt field
            List<Bill> bills = billRepository.findAll().stream()
                    .filter(bill -> bill.getCreatedAt() != null) // Filter out bills with null createdAt
                    .filter(bill -> !bill.getCreatedAt().before(startDate) && !bill.getCreatedAt().after(endDate))
                    .limit(100)
                    .collect(Collectors.toList());

            // Extract values from aggregation result with proper type casting
            int billCount = 0;
            double totalSales = 0.0;
            double averageBillAmount = 0.0;

            // Handle different possible number types from MongoDB
            Object billCountObj = report.get("billCount");
            Object totalSalesObj = report.get("totalSales");

            if (billCountObj instanceof Integer) {
                billCount = (Integer) billCountObj;
            } else if (billCountObj instanceof Long) {
                billCount = ((Long) billCountObj).intValue();
            } else if (billCountObj instanceof Double) {
                billCount = ((Double) billCountObj).intValue();
            }

            if (totalSalesObj instanceof Double) {
                totalSales = (Double) totalSalesObj;
            } else if (totalSalesObj instanceof Integer) {
                totalSales = ((Integer) totalSalesObj).doubleValue();
            } else if (totalSalesObj instanceof Long) {
                totalSales = ((Long) totalSalesObj).doubleValue();
            }

            // Calculate average in Java
            averageBillAmount = billCount > 0 ? totalSales / billCount : 0.0;

            result.put("totalSales", totalSales);
            result.put("billCount", billCount);
            result.put("averageBillAmount", Math.round(averageBillAmount * 100.0) / 100.0); // Round to 2 decimal places
            result.put("bills", bills);
        }

        logger.info("[SERVICE] Sales report generated: totalSales={}, billCount={}, averageBillAmount={}",
                result.get("totalSales"), result.get("billCount"), result.get("averageBillAmount"));
        return result;
    }

    @Override
    public Map<String, Object> getInventoryReport(int lowStockThreshold, int expiryDays, Locale locale) {
        logger.debug("[SERVICE] Generating inventory report: lowStockThreshold={}, expiryDays={}", lowStockThreshold, expiryDays);
        if (lowStockThreshold < 0) {
            logger.error("[SERVICE] Invalid low stock threshold: {}", lowStockThreshold);
            throw new IllegalArgumentException(
                    messageSource.getMessage("report.lowStockThreshold.invalid", null, locale));
        }
        if (expiryDays < 0) {
            logger.error("[SERVICE] Invalid expiry days: {}", expiryDays);
            throw new IllegalArgumentException(
                    messageSource.getMessage("report.expiryDays.invalid", null, locale));
        }

        // Calculate expiry date
        Calendar calendar = Calendar.getInstance(TimeZone.getTimeZone("UTC"));
        calendar.add(Calendar.DAY_OF_MONTH, expiryDays);
        Date expiryDate = calendar.getTime();

        // Fetch all products
        List<Product> allProducts = productRepository.findAll();
        if (allProducts.isEmpty()) {
            logger.warn("[SERVICE] No products found");
            throw new IllegalArgumentException(
                    messageSource.getMessage("report.no.products.found", null, locale));
        }

        // Filter low-stock and expiring products
        List<Product> lowStockProducts = allProducts.stream()
                .filter(p -> p.getQuantity() <= lowStockThreshold)
                .collect(Collectors.toList());
        List<Product> expiringProducts = allProducts.stream()
                .filter(p -> p.getExpiryDate() != null && !p.getExpiryDate().after(expiryDate))
                .collect(Collectors.toList());

        Map<String, Object> result = new HashMap<>();
        result.put("totalProducts", allProducts.size());
        result.put("lowStockProducts", lowStockProducts);
        result.put("expiringProducts", expiringProducts);
        result.put("lowStockCount", lowStockProducts.size());
        result.put("expiringCount", expiringProducts.size());

        logger.info("[SERVICE] Inventory report generated: totalProducts={}, lowStockCount={}, expiringCount={}",
                allProducts.size(), lowStockProducts.size(), expiringProducts.size());
        return result;
    }

    @Override
    public FullReportResponse getFullReportData(String startDate, String endDate, int lowStockThreshold, int expiryDays, Locale locale) {
        logger.debug("Gathering full report data for: {} to {}", startDate, endDate);

        // 1. Get Sales Report from Flask
        Object salesReport = analyticsService.getReport(startDate, endDate);

        // 2. Get Text Summary from Flask
        Object textSummary = analyticsService.getTextReport(startDate, endDate);

        // 3. Get Inventory Report from Spring (this same service)
        Map<String, Object> inventoryReport = this.getInventoryReport(lowStockThreshold, expiryDays, locale);

        // 4. Combine into one response
        return FullReportResponse.builder()
                .salesReport(salesReport)
                .textSummary(textSummary)
                .inventoryReport(inventoryReport)
                .build();
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\SyncService.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.models.Bill;
import com.smartretail.backend.repository.BillRepository;
import org.springframework.stereotype.Service;

import java.util.Locale;
import java.util.Optional;

@Service
public class SyncService {

    private final BillRepository billRepository;
    private final BillService billService;

    public SyncService(BillRepository billRepository, BillService billService) {
        this.billRepository = billRepository;
        this.billService = billService;
    }

    public String syncBill(Bill bill, Locale locale) {
        // Check if bill exists (idempotency)
        Optional<Bill> existingBill = billRepository.findByBillId(bill.getBillId());
        if (existingBill.isPresent()) {
            System.out.println("[SYNC] Bill already exists: " + bill.getBillId());
            return bill.getBillId();
        }
        // Create new bill
        Bill savedBill = billService.createBill(bill, locale);
        System.out.println("[SYNC] Bill synced: " + savedBill.getBillId());
        return savedBill.getBillId();
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\UserService.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.dto.SignupRequest;
import com.smartretail.backend.models.User;
import org.springframework.security.core.userdetails.UserDetailsService;

import java.util.List;

public interface UserService extends UserDetailsService {
    User getUserById(String id);
    User createUser(SignupRequest request);
    List<User> getAllUsers();
    void deleteUser(String id);
    User getUserByEmail(String email);
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\java\com\smartretail\backend\service\UserServiceImpl.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.dto.SignupRequest;
import com.smartretail.backend.models.User;
import com.smartretail.backend.repository.UserRepository;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.security.core.userdetails.UsernameNotFoundException;
import org.springframework.security.crypto.password.PasswordEncoder;
import org.springframework.stereotype.Service;

import java.util.List;

@Service
public class UserServiceImpl implements UserService {

    private final UserRepository userRepository;
    private final PasswordEncoder passwordEncoder;

    public UserServiceImpl(UserRepository userRepository, PasswordEncoder passwordEncoder) {
        this.userRepository = userRepository;
        this.passwordEncoder = passwordEncoder;
    }

    @Override
    public User getUserById(String id) {
        return userRepository.findById(id)
                .orElseThrow(() -> new RuntimeException("User not found: " + id));
    }

    @Override
    public User createUser(SignupRequest request) {
        // Check if user already exists
        if (userRepository.findByEmail(request.getEmail()).isPresent()) {
            throw new RuntimeException("User with this email already exists");
        }

        // Validate that role is provided
        if (request.getRole() == null || request.getRole().trim().isEmpty()) {
            throw new RuntimeException("Role is required");
        }

        // Generate userId
        String userId = "u" + (System.currentTimeMillis() % 10000);

        User user = new User(
                userId,
                request.getEmail(),
                passwordEncoder.encode(request.getPassword()),
                request.getName(),
                request.getRole().toUpperCase() // Convert to uppercase
        );

        return userRepository.save(user);
    }

    @Override
    public List<User> getAllUsers() {
        return userRepository.findAll();
    }

    @Override
    public void deleteUser(String id) {
        if (!userRepository.existsById(id)) {
            throw new RuntimeException("User not found");
        }
        userRepository.deleteById(id);
    }

    @Override
    public User getUserByEmail(String email) {
        return userRepository.findByEmail(email)
                .orElseThrow(() -> new RuntimeException("User not found: " + email));
    }

    @Override
    public UserDetails loadUserByUsername(String email) throws UsernameNotFoundException {
        User user = userRepository.findByEmail(email)
                .orElseThrow(() -> new UsernameNotFoundException("User not found: " + email));
        return org.springframework.security.core.userdetails.User
                .withUsername(user.getEmail())
                .password(user.getPassword())
                .roles(user.getRole())
                .build();
    }
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\backend\src\main\resources
--------------------------------------------------------------------
Contents:
application.properties
messages.properties
messages_hi.properties
messages_mr.properties
messages_te.properties

====================================================================
📄 File: G:\FINALCODE\backend\src\main\resources\application.properties
--------------------------------------------------------------------
spring.application.name=backend
spring.data.mongodb.uri=mongodb+srv://admin:SuperS3cr3tPassword@cluster0.xo5fnfx.mongodb.net/smartretail?retryWrites=true&w=majority&appName=Cluster0

# JWT Config
jwt.secret=7a3f8b2c5d9e1f4a6b8c0d2e5f7a3b9c1d4e6f8a2b5c7d9e0f1a3b5c7d9e1f2a4b6c8d0e2f4a7b9c1d3e5f7a9b1c3d5e7f9a2b4c6d8e0f2a4b6c8d0e2f4a6b8c0d2e4
jwt.expiration=3600000
jwt.refresh.expiration=604800000

# Mongo + Logs
logging.level.org.springframework.data.mongodb=DEBUG
logging.level.com.smartretail.backend=TRACE

# Email Config (Gmail SMTP)
spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.username=billybat1123@gmail.com
spring.mail.password=mpzfvvazknmdtijm
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true

# Flask
flask.base.url=http://localhost:5001

# Logging
logging.level.org.springframework.web=DEBUG
logging.level.org.springframework.security=DEBUG

# Internationalization
spring.messages.basename=messages
spring.messages.encoding=UTF-8

# VAPID Keys
vapid.public.key=BKpuFUFV1MHiCQvfAp4BkS0MNpH4vKkGVfbx2W6oltrICM2VJlsWyNQnnBlt2pHNM4lP215Wjbee4QBEZ-VBMuk
vapid.private.key=lKNZtclJ29wiW9qObJBNZSVvh0XULEiQGA0nMLR_OnU

spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB
spring.servlet.multipart.enabled=true

# Add these new properties at the end of the file


frontend.base.url=http://localhost:5173

# ... (all your other properties)

# --- REPLACE THESE LINES ---
spring.security.oauth2.client.registration.google.client-id=650352159939-qq7ed3sh35lg74gvb7j8gmv3jvjqqukj.apps.googleusercontent.com
spring.security.oauth2.client.registration.google.client-secret=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
spring.security.oauth2.client.registration.google.scope=openid,email,profile

# This tells Spring where to send the user after the backend is done

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\resources\messages.properties
--------------------------------------------------------------------
# Default English messages
customer.not.found=Customer not found: {0}
customer.exists=Customer already exists: {0}
bill.exists=Bill already exists: {0}
bill.not.found=Bill not found: {0}
product.not.found=Product not found: {0}
product.exists=Product already exists: {0}
product.insufficient.stock=Insufficient stock for product: {0}
product.update.failed=Failed to update product: {0}
product.restock.invalid.quantity=Restock quantity must be positive
product.image.upload.failed=Failed to upload image for product: {0}
success.product.deleted=Product deleted successfully: {0}
error.generic=An unexpected error occurred
bill.created.notification=Thank you for shopping at SmartRetail!\nBill ID: {0}\nTotal: ₹{1}\nView your bill at: {2}
bill.notification.subject=SmartRetail: Bill {0} Confirmation

# Error messages
error.product.not_found=Product not found: {0}
error.bill.not_found=Bill not found: {0}
error.customer.not_found=Customer not found: {0}
error.user.not_found=User not found: {0}
error.invalid_request=Invalid request: {0}
error.email.failed=Failed to send email: {0}
error.product.exists=Product ID already exists: {0}
error.bill.exists=Bill ID already exists: {0}
error.insufficient_stock=Insufficient stock for product: {0}
error.unauthorized=Unauthorized access
error.forbidden=Access forbidden
error.validation=Validation failed: {0}
error.database=Database error: {0}
error.file.upload=File upload failed: {0}
error.payment.failed=Payment failed: {0}
error.customer.exists=Mobile number already exists: {0}

# Add these missing message keys
file.missing=File is missing
file.invalid.format=Invalid file format. Only CSV files are allowed.
product.id.missing=Product ID is missing at row {0}
product.name.missing=Product name is missing at row {0}
product.category.missing=Product category is missing at row {0}
product.price.invalid=Invalid price at row {0}
product.addedBy.missing=Added by field is missing at row {0}
product.date.invalid=Invalid date format for product {0} at row {1}
product.add.failed=Failed to add product {0} at row {1}

bill.items.empty=Items list is empty at row {0} for bill {1}
bill.item.product.missing=Product ID missing in item at row {0} for bill {1}

# Bulk upload messages
file.parse.error=Error parsing CSV file. Please check the file format.
file.empty=CSV file is empty
file.processing.error=Error processing CSV file

bill.id.missing=Bill ID is missing at row {0}
bill.customer.missing=Customer mobile is missing at row {0}
bill.items.missing=Items are missing at row {0}
bill.total.invalid=Invalid total amount at row {0} for bill {1}
bill.addedBy.missing=Added by field is missing at row {0}
bill.items.invalid=Invalid items format at row {0} for bill {1}
bill.date.invalid=Invalid date format at row {0} for bill {1}
bill.skipped=Row {0}: Bill {1} already exists and was skipped
bill.add.failed=Failed to add bill {0} at row {1}
# Service validation messages
bill.addedBy.missing.service=Added by field is required for bill {0}
bill.items.invalid.quantity=Invalid quantity for items in bill {0}
bill.items.invalid.price=Invalid price for items in bill {0}
bill.total.invalid.service=Total amount mismatch for bill {0}

report.date.invalid=Invalid date format: {0}
report.date.range.invalid=Start date {0} must be before end date {1}
report.lowStockThreshold.invalid=Low stock threshold must be positive
report.expiryDays.invalid=Expiry days must be positive
report.no.bills.found=No bills found for the given date range
report.no.products.found=No products found

bill.email.body=Dear Customer,\n\nThank you for your purchase!\n\nBill ID: {0}\nTotal Amount: ₹{1}\n\nPlease find your bill attached.\n\nThank you for shopping with us!\n\nSmartRetail Team

audit.page.invalid=Page must be non-negative
audit.size.invalid=Page size must be positive
audit.no.logs.found=No audit logs found for the given criteria

# Existing messages
customer.mobile.required=Mobile number is required
customer.id.required=Customer ID is required
# New messages for reminders
reminder.no.email=Customer {0} has no email address
reminder.no.purchase.history=Customer {0} has no purchase history
reminder.no.frequent.items=Customer {0} has no frequently purchased items
reminder.subject=Monthly Purchase Reminder from Smart Retail
reminder.body=Dear {0},\n\nWe noticed you frequently purchase the following items:\n{1}\nVisit us to restock your favorites!\n\nBest regards,\nSmart Retail Team

# Existing messages
bill.customer.required=Customer information is required
product.out.of.stock=Product {0} is out of stock

# New messages for sync
sync.bill.duplicate=Bill {0} already exists
sync.product.unchanged=Product {0} has no changes
sync.error.bill=Failed to sync bill {0}: {1}
sync.error.product=Failed to sync product {0}: {1}

# **--- ADD THESE NEW KEYS ---**
# Re-engagement Email Template
re_engagement.subject=We've Missed You at Smart Retail!
re_engagement.body=Dear {0},\n\nIt's been a while since your last purchase, and we miss you!\n\nCome back and check out our latest products and offers.\n\nBest regards,\nThe Smart Retail Team

# PDF Bill Translations
pdf.bill.receiptTitle=Official Receipt
pdf.bill.billId=Bill ID
pdf.bill.customer=Customer
pdf.bill.mobile=Mobile
pdf.bill.product=Product
pdf.bill.qty=Qty
pdf.bill.price=Price
pdf.bill.subtotal=Subtotal
pdf.bill.total=Total

# PDF Report Translations
pdf.report.title=Executive Report
pdf.report.to=to
pdf.report.aiSummary=AI Generated Summary
pdf.report.keyMetrics=Key Metrics
pdf.report.totalRevenue=Total Revenue
pdf.report.totalOrders=Total Orders
pdf.report.productsSold=Products Sold
pdf.report.inventoryAlerts=Inventory Alerts
pdf.report.lowStock=Low Stock Items
pdf.report.expiring=Expiring Soon Items
pdf.report.topProducts=Top Selling Products
pdf.report.productName=Product Name
pdf.report.category=Category
pdf.report.unitsSold=Units Sold
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\resources\messages_hi.properties
--------------------------------------------------------------------
# Default Hindi messages
customer.not.found=ग्राहक नहीं मिला: {0}
customer.exists=ग्राहक पहले से मौजूद है: {0}
bill.exists=बिल पहले से मौजूद है: {0}
bill.not.found=बिल नहीं मिला: {0}
product.not.found=उत्पाद नहीं मिला: {0}
product.exists=उत्पाद पहले से मौजूद है: {0}
product.insufficient.stock=उत्पाद के लिए पर्याप्त स्टॉक नहीं है: {0}
product.update.failed=उत्पाद अपडेट करने में विफल: {0}
product.restock.invalid.quantity=रिस्टॉक मात्रा सकारात्मक होनी चाहिए
product.image.upload.failed=उत्पाद की छवि अपलोड करने में विफल: {0}
success.product.deleted=उत्पाद सफलतापूर्वक हटाया गया: {0}
error.generic=एक अप्रत्याशित त्रुटि हुई
bill.created.notification=SmartRetail पर खरीदारी करने के लिए धन्यवाद!\nबिल आईडी: {0}\nकुल: ₹{1}\nअपना बिल देखें: {2}
bill.notification.subject=SmartRetail: बिल {0} पुष्टिकरण

# Error messages
error.product.not_found=उत्पाद नहीं मिला: {0}
error.bill.not_found=बिल नहीं मिला: {0}
error.customer.not_found=ग्राहक नहीं मिला: {0}
error.user.not_found=उपयोगकर्ता नहीं मिला: {0}
error.invalid_request=अमान्य अनुरोध: {0}
error.email.failed=ईमेल भेजने में विफल: {0}
error.product.exists=उत्पाद आईडी पहले से मौजूद है: {0}
error.bill.exists=बिल आईडी पहले से मौजूद है: {0}
error.insufficient_stock=उत्पाद के लिए पर्याप्त स्टॉक नहीं है: {0}
error.unauthorized=अनधिकृत पहुंच
error.forbidden=पहुंच वर्जित
error.validation=सत्यापन विफल: {0}
error.database=डेटाबेस त्रुटि: {0}
error.file.upload=फ़ाइल अपलोड विफल: {0}
error.payment.failed=भुगतान विफल: {0}
error.customer.exists=मोबाइल नंबर पहले से मौजूद है: {0}

# Add these missing message keys
file.missing=फ़ाइल गुम है
file.invalid.format=अमान्य फ़ाइल प्रारूप। केवल CSV फ़ाइलों की अनुमति है।
product.id.missing=पंक्ति {0} पर उत्पाद आईडी गुम है
product.name.missing=पंक्ति {0} पर उत्पाद नाम गुम है
product.category.missing=पंक्ति {0} पर उत्पाद श्रेणी गुम है
product.price.invalid=पंक्ति {0} पर अमान्य मूल्य
product.addedBy.missing=पंक्ति {0} पर जोड़ने वाला फ़ील्ड गुम है
product.date.invalid=पंक्ति {1} पर उत्पाद {0} के लिए अमान्य तिथि प्रारूप
product.add.failed=पंक्ति {1} पर उत्पाद {0} जोड़ने में विफल

bill.items.empty=बिल {1} के लिए पंक्ति {0} पर आइटम सूची खाली है
bill.item.product.missing=बिल {1} के लिए पंक्ति {0} पर आइटम में उत्पाद आईडी गुम है

# Bulk upload messages
file.parse.error=CSV फ़ाइल पार्स करने में त्रुटि। कृपया फ़ाइल प्रारूप जांचें।
file.empty=CSV फ़ाइल खाली है
file.processing.error=CSV फ़ाइल प्रोसेस करने में त्रुटि

bill.id.missing=पंक्ति {0} पर बिल आईडी गुम है
bill.customer.missing=पंक्ति {0} पर ग्राहक मोबाइल गुम है
bill.items.missing=पंक्ति {0} पर आइटम गुम हैं
bill.total.invalid=बिल {1} के लिए पंक्ति {0} पर अमान्य कुल राशि
bill.addedBy.missing=पंक्ति {0} पर जोड़ने वाला फ़ील्ड गुम है
bill.items.invalid=बिल {1} के लिए पंक्ति {0} पर अमान्य आइटम प्रारूप
bill.date.invalid=बिल {1} के लिए पंक्ति {0} पर अमान्य तिथि प्रारूप
bill.skipped=पंक्ति {0}: बिल {1} पहले से मौजूद है और छोड़ दिया गया
bill.add.failed=पंक्ति {1} पर बिल {0} जोड़ने में विफल
# Service validation messages
bill.addedBy.missing.service=बिल {0} के लिए जोड़ने वाला फ़ील्ड आवश्यक है
bill.items.invalid.quantity=बिल {0} के लिए आइटम की अमान्य मात्रा
bill.items.invalid.price=बिल {0} के लिए आइटम की अमान्य कीमत
bill.total.invalid.service=बिल {0} के लिए कुल राशि असंगत

report.date.invalid=अमान्य तिथि प्रारूप: {0}
report.date.range.invalid=प्रारंभ तिथि {0} अंत तिथि {1} से पहले होनी चाहिए
report.lowStockThreshold.invalid=कम स्टॉक सीमा सकारात्मक होनी चाहिए
report.expiryDays.invalid=समाप्ति दिन सकारात्मक होने चाहिए
report.no.bills.found=दिए गए तिथि सीमा के लिए कोई बिल नहीं मिला
report.no.products.found=कोई उत्पाद नहीं मिला

bill.email.body=प्रिय ग्राहक,\n\nआपकी खरीदारी के लिए धन्यवाद!\n\nबिल आईडी: {0}\nकुल राशि: ₹{1}\n\nकृपया अपना बिल संलग्न पाएं।\n\nहमारे साथ खरीदारी करने के लिए धन्यवाद!\n\nSmartRetail टीम

audit.page.invalid=पृष्ठ गैर-नकारात्मक होना चाहिए
audit.size.invalid=पृष्ठ आकार सकारात्मक होना चाहिए
audit.no.logs.found=दिए गए मानदंडों के लिए कोई ऑडिट लॉग नहीं मिला

# Existing messages
customer.mobile.required=मोबाइल नंबर आवश्यक है
customer.id.required=ग्राहक आईडी आवश्यक है
# New messages for reminders
reminder.no.email=ग्राहक {0} का कोई ईमेल पता नहीं है
reminder.no.purchase.history=ग्राहक {0} का कोई खरीद इतिहास नहीं है
reminder.no.frequent.items=ग्राहक {0} के पास कोई अक्सर खरीदे जाने वाले आइटम नहीं हैं
reminder.subject=Smart Retail से मासिक खरीद अनुस्मारक
reminder.body=प्रिय {0},\n\nहमने देखा कि आप निम्नलिखित आइटम अक्सर खरीदते हैं:\n{1}\nअपने पसंदीदा आइटम फिर से खरीदने के लिए हमें देखें!\n\nसादर,\nSmart Retail टीम

# Existing messages
bill.customer.required=ग्राहक जानकारी आवश्यक है
product.out.of.stock=उत्पाद {0} स्टॉक में नहीं है

# New messages for sync
sync.bill.duplicate=बिल {0} पहले से मौजूद है
sync.product.unchanged=उत्पाद {0} में कोई बदलाव नहीं है
sync.error.bill=बिल {0} सिंक करने में विफल: {1}
sync.error.product=उत्पाद {0} सिंक करने में विफल: {1}

# ... (existing keys)
# Re-engagement Email Template
# ... (existing keys)
# Re-engagement Email Template
re_engagement.subject=Smart Retail ?? ???? ??? ? ??? ??!
re_engagement.body=????? {0},\n\n???? ????? ??????? ?? ??? ??? ??? ?? ??? ??, ?? ???? ???? ??? ? ??? ??!\n\n???? ??? ?? ????? ?? ???????? ?? ?????????? ?? ??????\n\n?????,\n??????? ????? ???
# PDF Bill Translations
pdf.bill.receiptTitle=???????? ????
pdf.bill.billId=??? ????
pdf.bill.customer=??????
pdf.bill.mobile=??????
pdf.bill.product=??????
pdf.bill.qty=??????
pdf.bill.price=?????
pdf.bill.subtotal=??-???
pdf.bill.total=???

# PDF Report Translations
pdf.report.title=????????? ???????
pdf.report.to=??
pdf.report.aiSummary=??? ??????
pdf.report.keyMetrics=?????? ?????????
pdf.report.totalRevenue=??? ??????
pdf.report.totalOrders=??? ?????
pdf.report.productsSold=???? ??????
pdf.report.inventoryAlerts=????????? ?????
pdf.report.lowStock=?? ????? ???? ????
pdf.report.expiring=???? ?? ?????? ???? ???? ????
pdf.report.topProducts=????? ????? ???? ??????
pdf.report.productName=?????? ?? ???
pdf.report.category=??????
pdf.report.unitsSold=???? ?? ???????
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\resources\messages_mr.properties
--------------------------------------------------------------------
# Default Marathi messages
customer.not.found=ग्राहक सापडला नाही: {0}
customer.exists=ग्राहक आधीच अस्तित्वात आहे: {0}
bill.exists=बिल आधीच अस्तित्वात आहे: {0}
bill.not.found=बिल सापडले नाही: {0}
product.not.found=उत्पादन सापडले नाही: {0}
product.exists=उत्पादन आधीच अस्तित्वात आहे: {0}
product.insufficient.stock=उत्पादनासाठी पुरेसा स्टॉक नाही: {0}
product.update.failed=उत्पादन अद्ययावत करण्यात अयशस्वी: {0}
product.restock.invalid.quantity=पुनर्स्टॉक प्रमाण सकारात्मक असणे आवश्यक आहे
product.image.upload.failed=उत्पादनाची प्रतिमा अपलोड करण्यात अयशस्वी: {0}
success.product.deleted=उत्पादन यशस्वीरित्या हटवले: {0}
error.generic=एक अनपेक्षित त्रुटी आली
bill.created.notification=SmartRetail वर खरेदी केल्याबद्दल धन्यवाद!\nबिल आयडी: {0}\nएकूण: ₹{1}\nआपले बिल पहा: {2}
bill.notification.subject=SmartRetail: बिल {0} पुष्टीकरण

# Error messages
error.product.not_found=उत्पादन सापडले नाही: {0}
error.bill.not_found=बिल सापडले नाही: {0}
error.customer.not_found=ग्राहक सापडला नाही: {0}
error.user.not_found=वापरकर्ता सापडला नाही: {0}
error.invalid_request=अवैध विनंती: {0}
error.email.failed=ईमेल पाठविण्यात अयशस्वी: {0}
error.product.exists=उत्पादन आयडी आधीच अस्तित्वात आहे: {0}
error.bill.exists=बिल आयडी आधीच अस्तित्वात आहे: {0}
error.insufficient_stock=उत्पादनासाठी पुरेसा स्टॉक नाही: {0}
error.unauthorized=अनधिकृत प्रवेश
error.forbidden=प्रवेश निषिद्ध
error.validation=सत्यापन अयशस्वी: {0}
error.database=डेटाबेस त्रुटी: {0}
error.file.upload=फाइल अपलोड अयशस्वी: {0}
error.payment.failed=पेमेंट अयशस्वी: {0}
error.customer.exists=मोबाइल नंबर आधीच अस्तित्वात आहे: {0}

# Add these missing message keys
file.missing=फाइल गहाळ आहे
file.invalid.format=अवैध फाइल स्वरूप. केवळ CSV फाइल्स परवानगी आहेत.
product.id.missing=ओळ {0} वर उत्पादन आयडी गहाळ आहे
product.name.missing=ओळ {0} वर उत्पादन नाव गहाळ आहे
product.category.missing=ओळ {0} वर उत्पादन श्रेणी गहाळ आहे
product.price.invalid=ओळ {0} वर अवैध किंमत
product.addedBy.missing=ओळ {0} वर जोडणारा फील्ड गहाळ आहे
product.date.invalid=ओळ {1} वर उत्पादन {0} साठी अवैध तारीख स्वरूप
product.add.failed=ओळ {1} वर उत्पादन {0} जोडण्यात अयशस्वी

bill.items.empty=बिल {1} साठी ओळ {0} वर आयटम यादी रिकामी आहे
bill.item.product.missing=बिल {1} साठी ओळ {0} वर आयटममध्ये उत्पादन आयडी गहाळ आहे

# Bulk upload messages
file.parse.error=CSV फाइल पार्स करताना त्रुटी. कृपया फाइल स्वरूप तपासा.
file.empty=CSV फाइल रिकामी आहे
file.processing.error=CSV फाइल प्रक्रिया करताना त्रुटी

bill.id.missing=ओळ {0} वर बिल आयडी गहाळ आहे
bill.customer.missing=ओळ {0} वर ग्राहक मोबाइल गहाळ आहे
bill.items.missing=ओळ {0} वर आयटम गहाळ आहेत
bill.total.invalid=बिल {1} साठी ओळ {0} वर अवैध एकूण रक्कम
bill.addedBy.missing=ओळ {0} वर जोडणारा फील्ड गहाळ आहे
bill.items.invalid=बिल {1} साठी ओळ {0} वर अवैध आयटम स्वरूप
bill.date.invalid=बिल {1} साठी ओळ {0} वर अवैध तारीख स्वरूप
bill.skipped=ओळ {0}: बिल {1} आधीच अस्तित्वात आहे आणि वगळण्यात आला
bill.add.failed=ओळ {1} वर बिल {0} जोडण्यात अयशस्वी
# Service validation messages
bill.addedBy.missing.service=बिल {0} साठी जोडणारा फील्ड आवश्यक आहे
bill.items.invalid.quantity=बिल {0} साठी आयटमचे अवैध प्रमाण
bill.items.invalid.price=बिल {0} साठी आयटमची अवैध किंमत
bill.total.invalid.service=बिल {0} साठी एकूण रक्कम जुळत नाही

report.date.invalid=अवैध तारीख स्वरूप: {0}
report.date.range.invalid=प्रारंभ तारीख {0} समाप्ती तारीख {1} पूर्वी असणे आवश्यक आहे
report.lowStockThreshold.invalid=कमी स्टॉक उंबरठा सकारात्मक असणे आवश्यक आहे
report.expiryDays.invalid=कालबाह्यता दिवस सकारात्मक असणे आवश्यक आहे
report.no.bills.found=दिलेल्या तारीख श्रेणीसाठी कोणतीही बिले सापडली नाहीत
report.no.products.found=कोणतीही उत्पादने सापडली नाहीत

bill.email.body=प्रिय ग्राहक,\n\nआपल्या खरेदीबद्दल धन्यवाद!\n\nबिल आयडी: {0}\nएकूण रक्कम: ₹{1}\n\nकृपया आपले बिल संलग्न शोधा.\n\nआमच्यासोबत खरेदी केल्याबद्दल धन्यवाद!\n\nSmartRetail संघ

audit.page.invalid=पृष्ठ नकारात्मक नसावे
audit.size.invalid=पृष्ठ आकार सकारात्मक असावा
audit.no.logs.found=दिलेल्या निकषांसाठी कोणेही ऑडिट लॉग सापडले नाहीत

# Existing messages
customer.mobile.required=मोबाइल नंबर आवश्यक आहे
customer.id.required=ग्राहक आयडी आवश्यक आहे
# New messages for reminders
reminder.no.email=ग्राहक {0} कडे ईमेल पत्ता नाही
reminder.no.purchase.history=ग्राहक {0} कडे कोणताही खरेदी इतिहास नाही
reminder.no.frequent.items=ग्राहक {0} कडे वारंवार खरेदी केलेले आयटम नाहीत
reminder.subject=Smart Retail कडून मासिक खरेदी रिमाइंडर
reminder.body=प्रिय {0},\n\nआम्ही पाहिले की आपण खालील आयटम वारंवार खरेदी करता:\n{1}\nआपले आवडते आयटम पुन्हा स्टॉक करण्यासाठी आम्हाला भेट द्या!\n\nशुभेच्छा,\nSmart Retail संघ

# Existing messages
bill.customer.required=ग्राहक माहिती आवश्यक आहे
product.out.of.stock=उत्पादन {0} स्टॉकमध्ये नाही

# New messages for sync
sync.bill.duplicate=बिल {0} आधीच अस्तित्वात आहे
sync.product.unchanged=उत्पादन {0} मध्ये कोणतेही बदल नाहीत
sync.error.bill=बिल {0} सिंक करण्यात अयशस्वी: {1}
sync.error.product=उत्पादन {0} सिंक करण्यात अयशस्वी: {1}

# ... (existing keys)
# Re-engagement Email Template
# ... (existing keys)
# Re-engagement Email Template
re_engagement.subject=Smart Retail ?? ????? ???? ??? ???!
re_engagement.body=????? {0},\n\n??????? ???????? ??????? ???? ??? ???? ???, ??? ??????? ????? ???? ??? ???!\n\n??? ?? ??? ???? ???? ???????? ??? ????? ???.\n\n???????,\n??????? ????? ???
# PDF Bill Translations
pdf.bill.receiptTitle=?????? ?????
pdf.bill.billId=??? ????
pdf.bill.customer=??????
pdf.bill.mobile=??????
pdf.bill.product=???????
pdf.bill.qty=??????
pdf.bill.price=?????
pdf.bill.subtotal=??-????
pdf.bill.total=????

# PDF Report Translations
pdf.report.title=????????? ?????
pdf.report.to=??
pdf.report.aiSummary=AI ?????????? ??????
pdf.report.keyMetrics=?????? ?????????
pdf.report.totalRevenue=???? ?????
pdf.report.totalOrders=???? ???????
pdf.report.productsSold=??????? ????????
pdf.report.inventoryAlerts=??????????? ?????
pdf.report.lowStock=??? ????? ???????? ?????
pdf.report.expiring=????? ???????? ???????? ?????
pdf.report.topProducts=???????? ????? ?????? ????????
pdf.report.productName=?????????? ???
pdf.report.category=??????
pdf.report.unitsSold=??????? ???????
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\main\resources\messages_te.properties
--------------------------------------------------------------------
# Default Telugu messages
customer.not.found=కస్టమర్ కనుగొనబడలేదు: {0}
customer.exists=కస్టమర్ ఇప్పటికే ఉన్నారు: {0}
bill.exists=బిల్ ఇప్పటికే ఉంది: {0}
bill.not.found=బిల్ కనుగొనబడలేదు: {0}
product.not.found=ఉత్పత్తి కనుగొనబడలేదు: {0}
product.exists=ఉత్పత్తి ఇప్పటికే ఉంది: {0}
product.insufficient.stock=ఉత్పత్తికి తగినంత స్టాక్ లేదు: {0}
product.update.failed=ఉత్పత్తి నవీకరించడం విఫలమైంది: {0}
product.restock.invalid.quantity=రీస్టాక్ పరిమాణం సానుకూలంగా ఉండాలి
product.image.upload.failed=ఉత్పత్తి యొక్క చిత్రం అప్లోడ్ చేయడం విఫలమైంది: {0}
success.product.deleted=ఉత్పత్తి విజయవంతంగా తొలగించబడింది: {0}
error.generic=ఊహించని లోపం సంభవించింది
bill.created.notification=SmartRetail వద్ద షాపింగ్ చేసినందుకు ధన్యవాదాలు!\nబిల్ ID: {0}\nమొత్తం: ₹{1}\nమీ బిల్ ఇక్కడ వీక్షించండి: {2}
bill.notification.subject=SmartRetail: బిల్ {0} ధృవీకరణ

# Error messages
error.product.not_found=ఉత్పత్తి కనుగొనబడలేదు: {0}
error.bill.not_found=బిల్ కనుగొనబడలేదు: {0}
error.customer.not_found=కస్టమర్ కనుగొనబడలేదు: {0}
error.user.not_found=వినియోగదారు కనుగొనబడలేదు: {0}
error.invalid_request=చెల్లని అభ్యర్థన: {0}
error.email.failed=ఇమెయిల్ పంపడం విఫలమైంది: {0}
error.product.exists=ఉత్పత్తి ID ఇప్పటికే ఉంది: {0}
error.bill.exists=బిల్ ID ఇప్పటికే ఉంది: {0}
error.insufficient_stock=ఉత్పత్తికి తగినంత స్టాక్ లేదు: {0}
error.unauthorized=అనధికార ప్రవేశం
error.forbidden=ప్రవేశం నిషేధించబడింది
error.validation=ధృవీకరణ విఫలమైంది: {0}
error.database=డేటాబేస్ లోపం: {0}
error.file.upload=ఫైల్ అప్లోడ్ విఫలమైంది: {0}
error.payment.failed=చెల్లింపు విఫలమైంది: {0}
error.customer.exists=మొబైల్ నంబర్ ఇప్పటికే ఉంది: {0}

# Add these missing message keys
file.missing=ఫైల్ లేదు
file.invalid.format=చెల్లని ఫైల్ ఫార్మాట్. CSV ఫైళ్ళు మాత్రమే అనుమతించబడతాయి.
product.id.missing=వరుస {0} వద్ద ఉత్పత్తి ID లేదు
product.name.missing=వరుస {0} వద్ద ఉత్పత్తి పేరు లేదు
product.category.missing=వరుస {0} వద్ద ఉత్పత్తి వర్గం లేదు
product.price.invalid=వరుస {0} వద్ద చెల్లని ధర
product.addedBy.missing=వరుస {0} వద్ద జోడించినవారి ఫీల్డ్ లేదు
product.date.invalid=వరుస {1} వద్ద ఉత్పత్తి {0} కోసం చెల్లని తేదీ ఫార్మాట్
product.add.failed=వరుస {1} వద్ద ఉత్పత్తి {0} జోడించడం విఫలమైంది

bill.items.empty=బిల్ {1} కోసం వరుస {0} వద్ద ఐటమ్ల జాబితా ఖాళీగా ఉంది
bill.item.product.missing=బిల్ {1} కోసం వరుస {0} వద్ద ఐటమ్లో ఉత్పత్తి ID లేదు

# Bulk upload messages
file.parse.error=CSV ఫైల్ పార్స్ చేయడంలో లోపం. దయచేసి ఫైల్ ఫార్మాట్ తనిఖీ చేయండి.
file.empty=CSV ఫైల్ ఖాళీగా ఉంది
file.processing.error=CSV ఫైల్ ప్రాసెస్ చేయడంలో లోపం

bill.id.missing=వరుస {0} వద్ద బిల్ ID లేదు
bill.customer.missing=వరుస {0} వద్ద కస్టమర్ మొబైల్ లేదు
bill.items.missing=వరుస {0} వద్ద ఐటమ్లు లేవు
bill.total.invalid=బిల్ {1} కోసం వరుస {0} వద్ద చెల్లని మొత్తం అమౌంట్
bill.addedBy.missing=వరుస {0} వద్ద జోడించినవారి ఫీల్డ్ లేదు
bill.items.invalid=బిల్ {1} కోసం వరుస {0} వద్ద చెల్లని ఐటమ్ల ఫార్మాట్
bill.date.invalid=బిల్ {1} కోసం వరుస {0} వద్ద చెల్లని తేదీ ఫార్మాట్
bill.skipped=వరుస {0}: బిల్ {1} ఇప్పటికే ఉంది మరియు దాటవేయబడింది
bill.add.failed=వరుస {1} వద్ద బిల్ {0} జోడించడం విఫలమైంది
# Service validation messages
bill.addedBy.missing.service=బిల్ {0} కోసం జోడించినవారి ఫీల్డ్ అవసరం
bill.items.invalid.quantity=బిల్ {0} కోసం ఐటమ్లలో చెల్లని పరిమాణం
bill.items.invalid.price=బిల్ {0} కోసం ఐటమ్లలో చెల్లని ధర
bill.total.invalid.service=బిల్ {0} కోసం మొత్తం అమౌంట్ సరిపోలడం లేదు

report.date.invalid=చెల్లని తేదీ ఫార్మాట్: {0}
report.date.range.invalid=ప్రారంభ తేదీ {0} ముగింపు తేదీ {1} కంటే ముందు ఉండాలి
report.lowStockThreshold.invalid=తక్కువ స్టాక్ థ్రెషోల్డ్ సానుకూలంగా ఉండాలి
report.expiryDays.invalid=కాలబడ్డ రోజులు సానుకూలంగా ఉండాలి
report.no.bills.found=ఇచ్చిన తేదీ పరిధికి బిల్లులు లేవు
report.no.products.found=ఉత్పత్తులు ఏవీ లేవు

bill.email.body=ప్రియ కస్టమర్,\n\nమీ కొనుగోలుకు ధన్యవాదాలు!\n\nబిల్ ID: {0}\nమొత్తం అమౌంట్: ₹{1}\n\nదయచేసి మీ బిల్ అటాచ్ చేయబడినది.\n\nమాతో షాపింగ్ చేసినందుకు ధన్యవాదాలు!\n\nSmartRetail టీం

audit.page.invalid=పేజీ నాన్-నెగటివ్గా ఉండాలి
audit.size.invalid=పేజీ సైజు పాజిటివ్గా ఉండాలి
audit.no.logs.found=ఇచ్చిన ప్రమాణాలకు ఆడిట్ లాగ్లు ఏవీ లేవు

# Existing messages
customer.mobile.required=మొబైల్ నంబర్ అవసరం
customer.id.required=కస్టమర్ ID అవసరం
# New messages for reminders
reminder.no.email=కస్టమర్ {0}కి ఇమెయిల్ చిరునామా లేదు
reminder.no.purchase.history=కస్టమర్ {0}కి కొనుగోలు చరిత్ర లేదు
reminder.no.frequent.items=కస్టమర్ {0}కి తరచుగా కొనుగోలు చేసిన వస్తువులు లేవు
reminder.subject=Smart Retail నుండి నెలవారీ కొనుగోలు రిమైండర్
reminder.body=ప్రియ {0},\n\nమీరు తరచుగా క్రింది వస్తువులను కొనుగోలు చేస్తున్నట్లు మేము గమనించాము:\n{1}\nమీ ఇష్టమైన వస్తువులను రీస్టాక్ చేయడానికి మాకు సందర్శించండి!\n\nఅభినందనలు,\nSmart Retail టీం

# Existing messages
bill.customer.required=కస్టమర్ సమాచారం అవసరం
product.out.of.stock=ఉత్పత్తి {0} స్టాక్లో లేదు

# New messages for sync
sync.bill.duplicate=బిల్ {0} ఇప్పటికే ఉంది
sync.product.unchanged=ఉత్పత్తి {0}లో మార్పులు లేవు
sync.error.bill=బిల్ {0} సింక్ చేయడం విఫలమైంది: {1}
sync.error.product=ఉత్పత్తి {0} సింక్ చేయడం విఫలమైంది: {1}

# ... (existing keys)
# Re-engagement Email Template
# ... (existing keys)
# Re-engagement Email Template
re_engagement.subject=Smart Retail ????????? ???? ????????!
re_engagement.body=???????? {0},\n\n???? ????????? ???????? ???? ???? ???? ????????, ????? ???? ????????? ???? ???????????!\n\n?????? ????? ?? ???? ?????????? ????? ???????? ??????.\n\n??????????,\n???????? ?????? ?????
# PDF Bill Translations
pdf.bill.receiptTitle=???????? ?????
pdf.bill.billId=???? ID
pdf.bill.customer=???????
pdf.bill.mobile=??????
pdf.bill.product=????????
pdf.bill.qty=???????
pdf.bill.price=??
pdf.bill.subtotal=??-??????
pdf.bill.total=??????

# PDF Report Translations
pdf.report.title=????????????? ???????
pdf.report.to=?????
pdf.report.aiSummary=AI ??????????? ???????
pdf.report.keyMetrics=???? ?????????
pdf.report.totalRevenue=?????? ?????
pdf.report.totalOrders=?????? ????????
pdf.report.productsSold=?????? ??????????
pdf.report.inventoryAlerts=????????? ??????????
pdf.report.lowStock=?????? ?????? ???? ?????????
pdf.report.expiring=?????? ????? ?????? ?????????
pdf.report.topProducts=?????????? ???????? ??????????
pdf.report.productName=???????? ????
pdf.report.category=?????
pdf.report.unitsSold=?????? ????????
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\backend\src\test
--------------------------------------------------------------------
Contents:
java

====================================================================
📁 Directory: G:\FINALCODE\backend\src\test\java
--------------------------------------------------------------------
Contents:
com

====================================================================
📁 Directory: G:\FINALCODE\backend\src\test\java\com
--------------------------------------------------------------------
Contents:
smartretail

====================================================================
📁 Directory: G:\FINALCODE\backend\src\test\java\com\smartretail
--------------------------------------------------------------------
Contents:
backend

====================================================================
📁 Directory: G:\FINALCODE\backend\src\test\java\com\smartretail\backend
--------------------------------------------------------------------
Contents:
BackendApplicationTests.java
controller
service

====================================================================
📄 File: G:\FINALCODE\backend\src\test\java\com\smartretail\backend\BackendApplicationTests.java
--------------------------------------------------------------------
package com.smartretail.backend;

import org.junit.jupiter.api.Test;
import org.springframework.boot.test.context.SpringBootTest;

@SpringBootTest
class BackendApplicationTests {

	@Test
	void contextLoads() {
	}

}

--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\backend\src\test\java\com\smartretail\backend\controller
--------------------------------------------------------------------
Contents:
CustomerControllerTest.java
ProductControllerTest.java
ReportControllerTest.java
SyncControllerTest.java

====================================================================
📄 File: G:\FINALCODE\backend\src\test\java\com\smartretail\backend\controller\CustomerControllerTest.java
--------------------------------------------------------------------
package com.smartretail.backend.controller;

import com.smartretail.backend.models.Bill;
import com.smartretail.backend.models.Customer;
import com.smartretail.backend.service.CustomerService;
import com.smartretail.backend.service.ReminderService;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.junit.jupiter.MockitoExtension;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;

import java.util.Arrays;
import java.util.Date;
import java.util.List;
import java.util.Locale; // --- FIX: Import Locale ---
import java.util.Map;

import static org.junit.jupiter.api.Assertions.*;
import static org.mockito.ArgumentMatchers.*;
import static org.mockito.Mockito.*;

@ExtendWith(MockitoExtension.class)
class CustomerControllerTest {

    @Mock
    private CustomerService customerService;

    @Mock
    private ReminderService reminderService;

    @InjectMocks
    private CustomerController customerController;

    @Test
    void testCreateCustomer_Success() {
        Customer customer = new Customer();
        customer.setId("68d7eb12a2d18777fbd48685");
        customer.setMobile("5554447788");
        customer.setName("Sita");

        // --- FIX: Mock expects a Locale object, not a String "en" ---
        when(customerService.createCustomer(any(Customer.class), eq(new Locale("en")))).thenReturn(customer);
        // --- End Fix ---

        ResponseEntity<Customer> response = customerController.createCustomer(customer, "en");

        assertEquals(HttpStatus.CREATED, response.getStatusCode());
        assertEquals("68d7eb12a2d18777fbd48685", response.getBody().getId());
        
        // --- FIX: Verify with Locale object ---
        verify(customerService).createCustomer(customer, eq(new Locale("en")));
        // --- End Fix ---
    }

    @Test
    void testGetCustomerById_Success() {
        Customer customer = new Customer();
        customer.setId("68d7eb12a2d18777fbd48685");
        customer.setMobile("5554447788");

        // --- FIX: Mock expects a Locale object ---
        when(customerService.getCustomerById("68d7eb12a2d18777fbd48685", eq(new Locale("en")))).thenReturn(customer);
        // --- End Fix ---

        ResponseEntity<Customer> response = customerController.getCustomerById("68d7eb12a2d18777fbd48685", "en");

        assertEquals(HttpStatus.OK, response.getStatusCode());
        assertEquals("68d7eb12a2d18777fbd48685", response.getBody().getId());
        
        // --- FIX: Verify with Locale object ---
        verify(customerService).getCustomerById("68d7eb12a2d18777fbd48685", eq(new Locale("en")));
        // --- End Fix ---
    }

    @Test
    void testGetAllCustomers_Success() {
        Customer customer = new Customer();
        customer.setId("68d7eb12a2d18777fbd48685");
        when(customerService.getAllCustomers()).thenReturn(Arrays.asList(customer));

        ResponseEntity<List<Customer>> response = customerController.getAllCustomers("en");

        assertEquals(HttpStatus.OK, response.getStatusCode());
        assertEquals(1, response.getBody().size());
        verify(customerService).getAllCustomers();
    }

    @Test
    void testUpdateCustomer_Success() {
        Customer customer = new Customer();
        customer.setId("68d7eb12a2d18777fbd48685");
        customer.setMobile("5554447788");

        // --- FIX: Mock expects a Locale object ---
        when(customerService.updateCustomer(eq("68d7eb12a2d18777fbd48685"), any(Customer.class), eq(new Locale("en"))))
                .thenReturn(customer);
        // --- End Fix ---

        ResponseEntity<Customer> response = customerController.updateCustomer("68d7eb12a2d18777fbd48685", customer, "en");

        assertEquals(HttpStatus.OK, response.getStatusCode());
        assertEquals("68d7eb12a2d18777fbd48685", response.getBody().getId());
        
        // --- FIX: Verify with Locale object ---
        verify(customerService).updateCustomer("68d7eb12a2d18777fbd48685", customer, eq(new Locale("en")));
        // --- End Fix ---
    }

    @Test
    void testDeleteCustomer_Success() {
        // --- FIX: Mock expects a Locale object ---
        doNothing().when(customerService).deleteCustomer("68d7eb12a2d18777fbd48685", eq(new Locale("en")));
        // --- End Fix ---

        ResponseEntity<Void> response = customerController.deleteCustomer("68d7eb12a2d18777fbd48685", "en");

        assertEquals(HttpStatus.NO_CONTENT, response.getStatusCode());
        
        // --- FIX: Verify with Locale object ---
        verify(customerService).deleteCustomer("68d7eb12a2d18777fbd48685", eq(new Locale("en")));
        // --- End Fix ---
    }

    @Test
    void testGetCustomerPurchaseHistory_Success() {
        Bill bill1 = new Bill();
        bill1.setBillId("bill001");
        bill1.setTotalAmount(500.0);
        bill1.setCreatedAt(new Date(2025 - 1900, 8, 27, 10, 0, 0));
        Bill.CustomerInfo ci1 = new Bill.CustomerInfo();
        ci1.setMobile("5554447788");
        bill1.setCustomer(ci1);

        Bill bill2 = new Bill();
        bill2.setBillId("bill002");
        bill2.setTotalAmount(300.0);
        bill2.setCreatedAt(new Date(2025 - 1900, 8, 27, 12, 0, 0));
        Bill.CustomerInfo ci2 = new Bill.CustomerInfo();
        ci2.setMobile("5554447788");
        bill2.setCustomer(ci2);

        Bill bill3 = new Bill();
        bill3.setBillId("bill003");
        bill3.setTotalAmount(200.0);
        bill3.setCreatedAt(new Date(2025 - 1900, 8, 27, 15, 0, 0));
        Bill.CustomerInfo ci3 = new Bill.CustomerInfo();
        ci3.setMobile("5554447788");
        bill3.setCustomer(ci3);

        // --- FIX: Mock expects a Locale object ---
        when(customerService.getCustomerPurchaseHistory("68d7eb12a2d18777fbd48685", null, null, eq(new Locale("en"))))
                .thenReturn(Arrays.asList(bill1, bill2, bill3));
        // --- End Fix ---

        ResponseEntity<List<Bill>> response = customerController
                .getCustomerPurchaseHistory("68d7eb12a2d18777fbd48685", null, null, "en");

        assertEquals(HttpStatus.OK, response.getStatusCode());
        assertEquals(3, response.getBody().size());
        assertEquals("bill001", response.getBody().get(0).getBillId());
        
        // --- FIX: Verify with Locale object ---
        verify(customerService).getCustomerPurchaseHistory("68d7eb12a2d18777fbd48685", null, null, eq(new Locale("en")));
        // --- End Fix ---
    }

    @Test
    void testTriggerMonthlyPurchaseReminders_Success() {
        doNothing().when(reminderService).sendMonthlyPurchaseReminders();

        ResponseEntity<Map<String, String>> response = customerController.triggerMonthlyPurchaseReminders("en");

        assertEquals(HttpStatus.OK, response.getStatusCode());
        assertEquals("Monthly purchase reminders triggered successfully", response.getBody().get("message"));
        verify(reminderService).sendMonthlyPurchaseReminders();
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\test\java\com\smartretail\backend\controller\ProductControllerTest.java
--------------------------------------------------------------------
package com.smartretail.backend.controller;

import com.smartretail.backend.models.Product;
import com.smartretail.backend.service.ProductService;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.junit.jupiter.MockitoExtension;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.mock.web.MockMultipartFile;
import org.springframework.web.multipart.MultipartFile;

import java.io.IOException;
import java.util.Locale; // --- FIX: Import Locale ---
import java.util.Map;

import static org.junit.jupiter.api.Assertions.*;
import static org.mockito.ArgumentMatchers.*;
import static org.mockito.Mockito.*;

@ExtendWith(MockitoExtension.class)
class ProductControllerTest {

    @Mock
    private ProductService productService;

    @InjectMocks
    private ProductController productController;

    // --- FIX: Renamed test method to match controller ---
    @Test
    void testCreateProductMultipart_Success() throws Exception {
        String productJson = """
                {
                    "productId": "p123",
                    "name": "Product A",
                    "category": "Electronics",
                    "price": 299.99,
                    "quantity": 10
                }
                """;

        MultipartFile imageFile = new MockMultipartFile("imageFile", "test.jpg", "image/jpeg", "test".getBytes());

        Product mockProduct = new Product();
        mockProduct.setProductId("p123");
        mockProduct.setName("Product A");
        mockProduct.setPrice(299.99);
        mockProduct.setQuantity(10);

        // --- FIX: Mock expects a Locale object, not a String "en" ---
        when(productService.createProduct(any(Product.class), any(MultipartFile.class), eq(new Locale("en"))))
                .thenReturn(mockProduct);
        // --- End Fix ---

        // --- FIX: Call the correct controller method ---
        ResponseEntity<Map<String, String>> response = productController.createMultipart(productJson, imageFile, "en");
        // --- End Fix ---

        assertEquals(HttpStatus.CREATED, response.getStatusCode());
        assertEquals("Product added successfully", response.getBody().get("message"));
        assertEquals("p123", response.getBody().get("productId"));
        
        // --- FIX: Verify with Locale object ---
        verify(productService, times(1))
                .createProduct(any(Product.class), any(MultipartFile.class), eq(new Locale("en")));
        // --- End Fix ---
    }

    // --- FIX: Renamed test method to match controller ---
    @Test
    void testCreateProductMultipart_NoImage_Success() throws Exception {
        String productJson = """
                {
                    "productId": "p123",
                    "name": "Product A",
                    "category": "Electronics",
                    "price": 299.99,
                    "quantity": 10
                }
                """;

        Product mockProduct = new Product();
        mockProduct.setProductId("p123");
        mockProduct.setName("Product A");
        mockProduct.setPrice(299.99);
        mockProduct.setQuantity(10);

        // --- FIX: Mock expects a Locale object ---
        when(productService.createProduct(any(Product.class), isNull(), eq(new Locale("en"))))
                .thenReturn(mockProduct);
        // --- End Fix ---

        // --- FIX: Call the correct controller method ---
        ResponseEntity<Map<String, String>> response = productController.createMultipart(productJson, null, "en");
        // --- End Fix ---

        assertEquals(HttpStatus.CREATED, response.getStatusCode());
        assertEquals("Product added successfully", response.getBody().get("message"));
        assertEquals("p123", response.getBody().get("productId"));
        
        // --- FIX: Verify with Locale object ---
        verify(productService, times(1))
                .createProduct(any(Product.class), isNull(), eq(new Locale("en")));
        // --- End Fix ---
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\test\java\com\smartretail\backend\controller\ReportControllerTest.java
--------------------------------------------------------------------

package com.smartretail.backend.controller;

import com.smartretail.backend.models.Bill;
import com.smartretail.backend.models.Product;
import com.smartretail.backend.service.ReportService;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.junit.jupiter.MockitoExtension;
import org.springframework.context.MessageSource;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;

import java.text.SimpleDateFormat;
import java.util.*;

import static org.junit.jupiter.api.Assertions.*;
import static org.mockito.ArgumentMatchers.*;
import static org.mockito.Mockito.*;

@ExtendWith(MockitoExtension.class)
class ReportControllerTest {

    @Mock
    private ReportService reportService;

    @Mock
    private MessageSource messageSource;

    @InjectMocks
    private ReportController reportController;

    private final SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd");

    @Test
    void testGetSalesReport_Success() throws Exception {
        // Arrange
        String startDateStr = "2025-09-01";
        String endDateStr = "2025-09-30";
        Date startDate = dateFormat.parse(startDateStr);
        Date endDate = new Date(dateFormat.parse(endDateStr).getTime() + 24 * 60 * 60 * 1000 - 1);

        Map<String, Object> report = new HashMap<>();
        report.put("totalSales", 10000.0);
        report.put("billCount", 50);
        report.put("averageBillAmount", 200.0);
        Bill bill = new Bill();
        bill.setBillId("b123");
        bill.setTotalAmount(200.0);
        bill.setCreatedAt(new Date());
        report.put("bills", List.of(bill));

        when(reportService.getSalesReport(startDate, endDate, Locale.ENGLISH)).thenReturn(report);

        // Act
        ResponseEntity<Map<String, Object>> response = reportController.getSalesReport(startDateStr, endDateStr, Locale.ENGLISH);

        // Assert
        assertEquals(HttpStatus.OK, response.getStatusCode());
        assertEquals(report, response.getBody());
        assertEquals(10000.0, response.getBody().get("totalSales"));
        assertEquals(50, response.getBody().get("billCount"));
        assertEquals(200.0, response.getBody().get("averageBillAmount"));
        assertEquals(1, ((List<?>) response.getBody().get("bills")).size());
        verify(reportService, times(1)).getSalesReport(startDate, endDate, Locale.ENGLISH);
    }

    @Test
    void testGetSalesReport_InvalidDateFormat() {
        // Arrange
        String startDateStr = "2025-13-01"; // Invalid month
        String endDateStr = "2025-09-30";
        when(messageSource.getMessage(eq("report.date.invalid"), any(), eq(Locale.ENGLISH)))
                .thenReturn("Invalid date format: 2025-13-01 or 2025-09-30");

        // Act & Assert
        Exception exception = assertThrows(IllegalArgumentException.class,
                () -> reportController.getSalesReport(startDateStr, endDateStr, Locale.ENGLISH));
        assertEquals("Invalid date format: 2025-13-01 or 2025-09-30", exception.getMessage());
        verify(reportService, never()).getSalesReport(any(), any(), any());
    }

    @Test
    void testGetSalesReport_StartDateAfterEndDate() throws Exception {
        // Arrange
        String startDateStr = "2025-09-30";
        String endDateStr = "2025-09-01";
        Date startDate = dateFormat.parse(startDateStr);
        Date endDate = new Date(dateFormat.parse(endDateStr).getTime() + 24 * 60 * 60 * 1000 - 1);
        when(reportService.getSalesReport(startDate, endDate, Locale.ENGLISH))
                .thenThrow(new IllegalArgumentException("Start date 2025-09-30 must be before end date 2025-09-01"));
        when(messageSource.getMessage(eq("report.date.range.invalid"), any(), eq(Locale.ENGLISH)))
                .thenReturn("Start date 2025-09-30 must be before end date 2025-09-01");

        // Act & Assert
        Exception exception = assertThrows(IllegalArgumentException.class,
                () -> reportController.getSalesReport(startDateStr, endDateStr, Locale.ENGLISH));
        assertEquals("Start date 2025-09-30 must be before end date 2025-09-01", exception.getMessage());
        verify(reportService, times(1)).getSalesReport(startDate, endDate, Locale.ENGLISH);
    }

    @Test
    void testGetSalesReport_NoBillsFound() throws Exception {
        // Arrange
        String startDateStr = "2025-09-01";
        String endDateStr = "2025-09-30";
        Date startDate = dateFormat.parse(startDateStr);
        Date endDate = new Date(dateFormat.parse(endDateStr).getTime() + 24 * 60 * 60 * 1000 - 1);
        Map<String, Object> report = new HashMap<>();
        report.put("totalSales", 0.0);
        report.put("billCount", 0);
        report.put("averageBillAmount", 0.0);
        report.put("bills", Collections.emptyList());
        when(reportService.getSalesReport(startDate, endDate, Locale.ENGLISH)).thenReturn(report);

        // Act
        ResponseEntity<Map<String, Object>> response = reportController.getSalesReport(startDateStr, endDateStr, Locale.ENGLISH);

        // Assert
        assertEquals(HttpStatus.OK, response.getStatusCode());
        assertEquals(0.0, response.getBody().get("totalSales"));
        assertEquals(0, response.getBody().get("billCount"));
        assertEquals(0.0, response.getBody().get("averageBillAmount"));
        assertEquals(0, ((List<?>) response.getBody().get("bills")).size());
        verify(reportService, times(1)).getSalesReport(startDate, endDate, Locale.ENGLISH);
    }

    @Test
    void testGetInventoryReport_Success() {
        // Arrange
        int lowStockThreshold = 10;
        int expiryDays = 30;
        Product product = new Product();
        product.setProductId("p123");
        product.setName("Product A");
        product.setQuantity(5);
        product.setExpiryDate(new Date());
        Map<String, Object> report = new HashMap<>();
        report.put("totalProducts", 100);
        report.put("lowStockProducts", List.of(product));
        report.put("expiringProducts", List.of(product));
        report.put("lowStockCount", 1);
        report.put("expiringCount", 1);
        when(reportService.getInventoryReport(lowStockThreshold, expiryDays, Locale.ENGLISH)).thenReturn(report);

        // Act
        ResponseEntity<Map<String, Object>> response = reportController.getInventoryReport(lowStockThreshold, expiryDays, Locale.ENGLISH);

        // Assert
        assertEquals(HttpStatus.OK, response.getStatusCode());
        assertEquals(100, response.getBody().get("totalProducts"));
        assertEquals(1, response.getBody().get("lowStockCount"));
        assertEquals(1, response.getBody().get("expiringCount"));
        assertEquals(1, ((List<?>) response.getBody().get("lowStockProducts")).size());
        assertEquals(1, ((List<?>) response.getBody().get("expiringProducts")).size());
        verify(reportService, times(1)).getInventoryReport(lowStockThreshold, expiryDays, Locale.ENGLISH);
    }

    @Test
    void testGetInventoryReport_NegativeLowStockThreshold() {
        // Arrange
        int lowStockThreshold = -1;
        int expiryDays = 30;
        when(reportService.getInventoryReport(lowStockThreshold, expiryDays, Locale.ENGLISH))
                .thenThrow(new IllegalArgumentException("Low stock threshold must be positive"));
        when(messageSource.getMessage(eq("report.lowStockThreshold.invalid"), any(), eq(Locale.ENGLISH)))
                .thenReturn("Low stock threshold must be positive");

        // Act & Assert
        Exception exception = assertThrows(IllegalArgumentException.class,
                () -> reportController.getInventoryReport(lowStockThreshold, expiryDays, Locale.ENGLISH));
        assertEquals("Low stock threshold must be positive", exception.getMessage());
        verify(reportService, times(1)).getInventoryReport(lowStockThreshold, expiryDays, Locale.ENGLISH);
    }

    @Test
    void testGetInventoryReport_NegativeExpiryDays() {
        // Arrange
        int lowStockThreshold = 10;
        int expiryDays = -1;
        when(reportService.getInventoryReport(lowStockThreshold, expiryDays, Locale.ENGLISH))
                .thenThrow(new IllegalArgumentException("Expiry days must be positive"));
        when(messageSource.getMessage(eq("report.expiryDays.invalid"), any(), eq(Locale.ENGLISH)))
                .thenReturn("Expiry days must be positive");

        // Act & Assert
        Exception exception = assertThrows(IllegalArgumentException.class,
                () -> reportController.getInventoryReport(lowStockThreshold, expiryDays, Locale.ENGLISH));
        assertEquals("Expiry days must be positive", exception.getMessage());
        verify(reportService, times(1)).getInventoryReport(lowStockThreshold, expiryDays, Locale.ENGLISH);
    }

    @Test
    void testGetInventoryReport_NoProductsFound() {
        // Arrange
        int lowStockThreshold = 10;
        int expiryDays = 30;
        when(reportService.getInventoryReport(lowStockThreshold, expiryDays, Locale.ENGLISH))
                .thenThrow(new IllegalArgumentException("No products found"));
        when(messageSource.getMessage(eq("report.no.products.found"), any(), eq(Locale.ENGLISH)))
                .thenReturn("No products found");

        // Act & Assert
        Exception exception = assertThrows(IllegalArgumentException.class,
                () -> reportController.getInventoryReport(lowStockThreshold, expiryDays, Locale.ENGLISH));
        assertEquals("No products found", exception.getMessage());
        verify(reportService, times(1)).getInventoryReport(lowStockThreshold, expiryDays, Locale.ENGLISH);
    }
}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\test\java\com\smartretail\backend\controller\SyncControllerTest.java
--------------------------------------------------------------------
package com.smartretail.backend.controller;

import com.smartretail.backend.models.Bill;
import com.smartretail.backend.models.Product;
import com.smartretail.backend.service.BillService;
import com.smartretail.backend.service.ProductService;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.junit.jupiter.MockitoExtension;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;

import java.util.Arrays;
import java.util.Date;
import java.util.List;
import java.util.Locale;
import java.util.Map;

import static org.junit.jupiter.api.Assertions.*;
import static org.mockito.ArgumentMatchers.*;
import static org.mockito.Mockito.*;

@ExtendWith(MockitoExtension.class)
class SyncControllerTest {

    @Mock
    private BillService billService;

    @Mock
    private ProductService productService;

    @InjectMocks
    private SyncController syncController;

    private Bill bill;
    private Product product;
    private SyncController.SyncRequest syncRequest;

    @BeforeEach
    void setUp() {
        bill = new Bill();
        bill.setBillId("bill005");
        bill.setTotalAmount(600.0);
        bill.setCreatedAt(new Date());
        Bill.CustomerInfo customerInfo = new Bill.CustomerInfo();
        customerInfo.setMobile("5554447788");
        customerInfo.setEmail("sambhavkumath9753@gmail.com");
        customerInfo.setName("Sambhav");
        bill.setCustomer(customerInfo);
        Bill.BillItem item = new Bill.BillItem();
        item.setProductId("p123");
        item.setProductName("Laptop");
        item.setQty(1);
        item.setPrice(600.0);
        bill.setItems(Arrays.asList(item));

        product = new Product();
        product.setProductId("p123"); // FIXED: Use setProductId instead of setId
        product.setName("Laptop");
        product.setPrice(600.0);
        product.setQuantity(9);

        syncRequest = new SyncController.SyncRequest();
        syncRequest.setBills(Arrays.asList(bill));
        syncRequest.setInventoryUpdates(Arrays.asList(product));
    }

    @Test
    void testSyncPendingData_Success() {
        when(billService.createBill(any(Bill.class), eq(Locale.ENGLISH), eq(true))).thenReturn(bill);
        when(productService.updateProduct(eq("p123"), any(Product.class), eq(Locale.ENGLISH), eq(true))).thenReturn(product);

        ResponseEntity<Map<String, Object>> response = syncController.syncPendingData(syncRequest, Locale.ENGLISH);

        assertEquals(HttpStatus.OK, response.getStatusCode());
        Map<String, Object> body = response.getBody();
        assertEquals(Arrays.asList("bill005"), body.get("processedBills"));
        assertEquals(Arrays.asList("p123"), body.get("processedProducts"));
        assertTrue(((List<?>) body.get("errors")).isEmpty());
        assertEquals("Sync completed successfully", body.get("message"));
        verify(billService).createBill(bill, Locale.ENGLISH, true);
        verify(productService).updateProduct("p123", product, Locale.ENGLISH, true);
    }

    @Test
    void testSyncPendingData_BillDuplicate() {
        when(billService.createBill(any(Bill.class), eq(Locale.ENGLISH), eq(true)))
                .thenThrow(new IllegalArgumentException("Bill bill005 already exists"));
        when(productService.updateProduct(eq("p123"), any(Product.class), eq(Locale.ENGLISH), eq(true))).thenReturn(product);

        ResponseEntity<Map<String, Object>> response = syncController.syncPendingData(syncRequest, Locale.ENGLISH);

        assertEquals(HttpStatus.OK, response.getStatusCode());
        Map<String, Object> body = response.getBody();
        assertTrue(((List<?>) body.get("processedBills")).isEmpty());
        assertEquals(Arrays.asList("p123"), body.get("processedProducts"));
        assertEquals(Arrays.asList("Bill bill005: Bill bill005 already exists"), body.get("errors"));
        assertEquals("Sync completed with errors", body.get("message"));
        verify(billService).createBill(bill, Locale.ENGLISH, true);
        verify(productService).updateProduct("p123", product, Locale.ENGLISH, true);
    }

    @Test
    void testSyncPendingData_ProductError() {
        when(billService.createBill(any(Bill.class), eq(Locale.ENGLISH), eq(true))).thenReturn(bill);
        when(productService.updateProduct(eq("p123"), any(Product.class), eq(Locale.ENGLISH), eq(true)))
                .thenThrow(new IllegalArgumentException("Product p123 not found"));

        ResponseEntity<Map<String, Object>> response = syncController.syncPendingData(syncRequest, Locale.ENGLISH);

        assertEquals(HttpStatus.OK, response.getStatusCode());
        Map<String, Object> body = response.getBody();
        assertEquals(Arrays.asList("bill005"), body.get("processedBills"));
        assertTrue(((List<?>) body.get("processedProducts")).isEmpty());
        assertEquals(Arrays.asList("Product p123: Product p123 not found"), body.get("errors"));
        assertEquals("Sync completed with errors", body.get("message"));
        verify(billService).createBill(bill, Locale.ENGLISH, true);
        verify(productService).updateProduct("p123", product, Locale.ENGLISH, true);
    }

    @Test
    void testSyncPendingData_EmptyRequest() {
        syncRequest.setBills(List.of());
        syncRequest.setInventoryUpdates(List.of());

        ResponseEntity<Map<String, Object>> response = syncController.syncPendingData(syncRequest, Locale.ENGLISH);

        assertEquals(HttpStatus.OK, response.getStatusCode());
        Map<String, Object> body = response.getBody();
        assertTrue(((List<?>) body.get("processedBills")).isEmpty());
        assertTrue(((List<?>) body.get("processedProducts")).isEmpty());
        assertTrue(((List<?>) body.get("errors")).isEmpty());
        assertEquals("Sync completed successfully", body.get("message"));
        verify(billService, never()).createBill(any(), any(), anyBoolean());
        verify(productService, never()).updateProduct(any(), any(), any(), anyBoolean());
    }

    @Test
    void testSyncPendingData_NullLists() {
        syncRequest.setBills(null);
        syncRequest.setInventoryUpdates(null);

        ResponseEntity<Map<String, Object>> response = syncController.syncPendingData(syncRequest, Locale.ENGLISH);

        assertEquals(HttpStatus.OK, response.getStatusCode());
        Map<String, Object> body = response.getBody();
        assertTrue(((List<?>) body.get("processedBills")).isEmpty());
        assertTrue(((List<?>) body.get("processedProducts")).isEmpty());
        assertTrue(((List<?>) body.get("errors")).isEmpty());
        assertEquals("Sync completed successfully", body.get("message"));
        verify(billService, never()).createBill(any(), any(), anyBoolean());
        verify(productService, never()).updateProduct(any(), any(), any(), anyBoolean());
    }
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\backend\src\test\java\com\smartretail\backend\service
--------------------------------------------------------------------
Contents:
BillServiceTest.java
CustomerServiceTest.java
ProductServiceTest.java
ReminderServiceTest.java
ReportServiceTest.java

====================================================================
📄 File: G:\FINALCODE\backend\src\test\java\com\smartretail\backend\service\BillServiceTest.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.models.Bill;
import com.smartretail.backend.models.Customer;
import com.smartretail.backend.models.Product;
import com.smartretail.backend.repository.BillRepository;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.junit.jupiter.MockitoExtension;
import org.springframework.context.MessageSource;

import java.util.Arrays;
import java.util.Locale;

import static org.junit.jupiter.api.Assertions.*;
import static org.mockito.ArgumentMatchers.any;
import static org.mockito.ArgumentMatchers.anyString;
import static org.mockito.Mockito.*;

@ExtendWith(MockitoExtension.class)
class BillServiceTest {

    @Mock
    private BillRepository billRepository;
    @Mock
    private CustomerService customerService;
    @Mock
    private ProductService productService;
    @Mock
    private NotificationService notificationService;
    @Mock
    private MessageSource messageSource;

    @InjectMocks
    private BillServiceImpl billService;

    private Bill bill;
    private Bill.BillItem item1;
    private Bill.BillItem item2;
    private Product product1;
    private Product product2;
    private Customer customer;

    @BeforeEach
    void setUp() {
        // Setup test data
        bill = new Bill();
        bill.setBillId("b12345678");
        bill.setAddedBy("manager@shop.com");

        // Create customer info
        Bill.CustomerInfo customerInfo = new Bill.CustomerInfo();
        customerInfo.setMobile("1234567890");
        bill.setCustomer(customerInfo);

        // Create bill items
        item1 = new Bill.BillItem();
        item1.setProductId("p12345678");
        item1.setQty(2);

        item2 = new Bill.BillItem();
        item2.setProductId("p98765432");
        item2.setQty(1);

        bill.setItems(Arrays.asList(item1, item2));

        // Create products
        product1 = new Product();
        product1.setProductId("p12345678");
        product1.setPrice(999.99);
        product1.setQuantity(10);

        product2 = new Product();
        product2.setProductId("p98765432");
        product2.setPrice(49.99);
        product2.setQuantity(5);

        // Create customer
        customer = new Customer();
        customer.setMobile("1234567890");
        customer.setName("Test Customer");
        customer.setEmail("test@customer.com");
    }

    @Test
    void testCreateBill_DuplicateBillId_ThrowsException() {
        // Given
        when(billRepository.existsByBillId("b12345678")).thenReturn(true);
        when(messageSource.getMessage("bill.exists", new Object[]{"b12345678"}, Locale.ENGLISH))
                .thenReturn("Bill already exists: b12345678");

        // When & Then
        RuntimeException exception = assertThrows(RuntimeException.class, () -> {
            billService.createBill(bill, Locale.ENGLISH);
        });

        assertEquals("Bill already exists: b12345678", exception.getMessage());
        verify(billRepository, times(1)).existsByBillId("b12345678");
        verify(billRepository, never()).save(any(Bill.class));
    }

    @Test
    void testCreateBill_MissingAddedBy_ThrowsException() {
        // Given
        bill.setAddedBy(null);
        when(billRepository.existsByBillId("b12345678")).thenReturn(false);
        when(messageSource.getMessage("bill.addedBy.missing.service", new Object[]{"b12345678"}, Locale.ENGLISH))
                .thenReturn("Added by field is required for bill: b12345678");

        // When & Then
        RuntimeException exception = assertThrows(RuntimeException.class, () -> {
            billService.createBill(bill, Locale.ENGLISH);
        });

        assertEquals("Added by field is required for bill: b12345678", exception.getMessage());
        verify(billRepository, times(1)).existsByBillId("b12345678");
        verify(billRepository, never()).save(any(Bill.class));
    }

    @Test
    void testCreateBill_InvalidQuantity_ThrowsException() {
        // Given
        item1.setQty(0); // Invalid quantity
        when(billRepository.existsByBillId("b12345678")).thenReturn(false);
        when(productService.getProductById("p12345678", Locale.ENGLISH)).thenReturn(product1);
        when(messageSource.getMessage("bill.items.invalid.quantity", new Object[]{"b12345678"}, Locale.ENGLISH))
                .thenReturn("Invalid quantity for items in bill: b12345678");

        // When & Then
        RuntimeException exception = assertThrows(RuntimeException.class, () -> {
            billService.createBill(bill, Locale.ENGLISH);
        });

        assertEquals("Invalid quantity for items in bill: b12345678", exception.getMessage());
        verify(productService, times(1)).getProductById("p12345678", Locale.ENGLISH);
        verify(billRepository, never()).save(any(Bill.class));
    }

    @Test
    void testCreateBill_InvalidProductPrice_ThrowsException() {
        // Given
        product1.setPrice(0); // Invalid price
        when(billRepository.existsByBillId("b12345678")).thenReturn(false);
        when(productService.getProductById("p12345678", Locale.ENGLISH)).thenReturn(product1);
        when(messageSource.getMessage("bill.items.invalid.price", new Object[]{"b12345678"}, Locale.ENGLISH))
                .thenReturn("Invalid price for items in bill: b12345678");

        // When & Then
        RuntimeException exception = assertThrows(RuntimeException.class, () -> {
            billService.createBill(bill, Locale.ENGLISH);
        });

        assertEquals("Invalid price for items in bill: b12345678", exception.getMessage());
        verify(productService, times(1)).getProductById("p12345678", Locale.ENGLISH);
        verify(billRepository, never()).save(any(Bill.class));
    }

    @Test
    void testCreateBill_Success() {
        // Given
        when(billRepository.existsByBillId("b12345678")).thenReturn(false);
        when(productService.getProductById("p12345678", Locale.ENGLISH)).thenReturn(product1);
        when(productService.getProductById("p98765432", Locale.ENGLISH)).thenReturn(product2);
        when(customerService.findOrCreateCustomer(any(Bill.CustomerInfo.class), eq(Locale.ENGLISH))).thenReturn(customer);
        when(billRepository.save(any(Bill.class))).thenReturn(bill);

        // When
        Bill result = billService.createBill(bill, Locale.ENGLISH);

        // Then
        assertNotNull(result);
        assertEquals("b12345678", result.getBillId());

        // Verify total amount calculation: (999.99 * 2) + (49.99 * 1) = 1999.98 + 49.99 = 2049.97
        assertEquals(2049.97, result.getTotalAmount(), 0.01);

        verify(billRepository, times(1)).existsByBillId("b12345678");
        verify(productService, times(1)).getProductById("p12345678", Locale.ENGLISH);
        verify(productService, times(1)).getProductById("p98765432", Locale.ENGLISH);
        verify(productService, times(1)).updateProductQuantity("p12345678", 2, Locale.ENGLISH);
        verify(productService, times(1)).updateProductQuantity("p98765432", 1, Locale.ENGLISH);
        verify(customerService, times(1)).findOrCreateCustomer(any(Bill.CustomerInfo.class), eq(Locale.ENGLISH));
        verify(customerService, times(1)).addBillId("1234567890", "b12345678");
        verify(billRepository, times(1)).save(any(Bill.class));
    }

    @Test
    void testCreateBill_WithoutCustomer_Success() {
        // Given
        bill.setCustomer(null); // No customer
        when(billRepository.existsByBillId("b12345678")).thenReturn(false);
        when(productService.getProductById("p12345678", Locale.ENGLISH)).thenReturn(product1);
        when(productService.getProductById("p98765432", Locale.ENGLISH)).thenReturn(product2);
        when(billRepository.save(any(Bill.class))).thenReturn(bill);

        // When
        Bill result = billService.createBill(bill, Locale.ENGLISH);

        // Then
        assertNotNull(result);
        assertEquals("b12345678", result.getBillId());

        // Customer service should not be called when there's no customer
        verify(customerService, never()).findOrCreateCustomer(any(), any());
        verify(customerService, never()).addBillId(anyString(), anyString());

        verify(billRepository, times(1)).save(any(Bill.class));
    }

    @Test
    void testCreateBill_ProductNotFound_ThrowsException() {
        // Given
        when(billRepository.existsByBillId("b12345678")).thenReturn(false);
        when(productService.getProductById("p12345678", Locale.ENGLISH))
                .thenThrow(new RuntimeException("Product not found"));

        // When & Then
        RuntimeException exception = assertThrows(RuntimeException.class, () -> {
            billService.createBill(bill, Locale.ENGLISH);
        });

        assertEquals("Product not found", exception.getMessage());
        verify(productService, times(1)).getProductById("p12345678", Locale.ENGLISH);
        verify(billRepository, never()).save(any(Bill.class));
    }
    @Test
    void testGetBillById_NotFound_ThrowsException() {
        when(billRepository.findByBillId("nonexistent")).thenReturn(java.util.Optional.empty());
        when(messageSource.getMessage("bill.not.found", new Object[]{"nonexistent"}, Locale.ENGLISH))
                .thenReturn("Bill not found: nonexistent");

        RuntimeException exception = assertThrows(RuntimeException.class, () -> {
            billService.getBillById("nonexistent", Locale.ENGLISH);
        });

        assertEquals("Bill not found: nonexistent", exception.getMessage());
    }

    @Test
    void testExistsByBillId() {
        when(billRepository.existsByBillId("b12345678")).thenReturn(true);

        boolean exists = billService.existsByBillId("b12345678");

        assertTrue(exists);
        verify(billRepository, times(1)).existsByBillId("b12345678");
    }

    @Test
    void testValidatePdfAccessToken_ValidToken() {
        Bill bill = new Bill();
        bill.setPdfAccessToken("valid-token");

        when(billRepository.findByBillId("b12345678")).thenReturn(java.util.Optional.of(bill));

        boolean isValid = billService.validatePdfAccessToken("b12345678", "valid-token");

        assertTrue(isValid);
    }

    @Test
    void testValidatePdfAccessToken_InvalidToken() {
        Bill bill = new Bill();
        bill.setPdfAccessToken("valid-token");

        when(billRepository.findByBillId("b12345678")).thenReturn(java.util.Optional.of(bill));

        boolean isValid = billService.validatePdfAccessToken("b12345678", "invalid-token");

        assertFalse(isValid);
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\test\java\com\smartretail\backend\service\CustomerServiceTest.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.models.Bill;
import com.smartretail.backend.models.Customer;
import com.smartretail.backend.repository.BillRepository;
import com.smartretail.backend.repository.CustomerRepository;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.junit.jupiter.MockitoExtension;
import org.springframework.context.MessageSource;

import java.util.Arrays;
import java.util.Date;
import java.util.List;
import java.util.Locale;
import java.util.Optional;
import java.util.*;

import static org.junit.jupiter.api.Assertions.*;
import static org.mockito.ArgumentMatchers.*;
import static org.mockito.Mockito.*;

@ExtendWith(MockitoExtension.class)
class CustomerServiceTest {

    @Mock
    private CustomerRepository customerRepository;

    @Mock
    private BillRepository billRepository;

    @Mock
    private MessageSource messageSource;

    @InjectMocks
    private CustomerServiceImpl customerService;

    private Customer customer;
    private Bill.CustomerInfo customerInfo;
    private Locale locale;
    private Bill bill1;
    private Bill bill2;
    private Bill bill3;

    @BeforeEach
    void setUp() {
        locale = Locale.forLanguageTag("en");

        customer = new Customer();
        customer.setId("68d7eb12a2d18777fbd48685");
        customer.setName("Sita");
        customer.setEmail("sita@gmail.com");
        customer.setMobile("5554447788");
        customer.setCreatedAt(new Date());
        customer.setPurchaseHistory(Arrays.asList("bill001", "bill002", "bill003"));

        customerInfo = new Bill.CustomerInfo();
        customerInfo.setName("Sita");
        customerInfo.setEmail("sita@gmail.com");
        customerInfo.setMobile("5554447788");

        bill1 = new Bill();
        bill1.setBillId("bill001");
        bill1.setTotalAmount(500.0);
        bill1.setCreatedAt(new Date(2025 - 1900, 8, 27, 10, 0, 0));
        Bill.CustomerInfo billCustomerInfo1 = new Bill.CustomerInfo();
        billCustomerInfo1.setMobile("5554447788");
        bill1.setCustomer(billCustomerInfo1);

        bill2 = new Bill();
        bill2.setBillId("bill002");
        bill2.setTotalAmount(300.0);
        bill2.setCreatedAt(new Date(2025 - 1900, 8, 27, 12, 0, 0));
        Bill.CustomerInfo billCustomerInfo2 = new Bill.CustomerInfo();
        billCustomerInfo2.setMobile("5554447788");
        bill2.setCustomer(billCustomerInfo2);

        bill3 = new Bill();
        bill3.setBillId("bill003");
        bill3.setTotalAmount(200.0);
        bill3.setCreatedAt(new Date(2025 - 1900, 8, 27, 15, 0, 0));
        Bill.CustomerInfo billCustomerInfo3 = new Bill.CustomerInfo();
        billCustomerInfo3.setMobile("5554447788");
        bill3.setCustomer(billCustomerInfo3);

        when(messageSource.getMessage(eq("customer.exists"), any(), eq(locale)))
                .thenReturn("Customer already exists: 5554447788");
        when(messageSource.getMessage(eq("customer.not.found"), any(), eq(locale)))
                .thenReturn("Customer not found: {0}");
        when(messageSource.getMessage(eq("customer.id.required"), any(), eq(locale)))
                .thenReturn("Customer ID is required");
        when(messageSource.getMessage(eq("report.date.range.invalid"), any(), eq(locale)))
                .thenReturn("Start date {0} must be before end date {1}");
    }

    @Test
    void testCreateCustomerSuccess() {
        when(customerRepository.findByMobile("5554447788")).thenReturn(Optional.empty());
        when(customerRepository.save(any(Customer.class))).thenReturn(customer);

        Customer result = customerService.createCustomer(customer, locale);

        assertNotNull(result);
        assertEquals("Sita", result.getName());
        verify(customerRepository).save(any(Customer.class));
    }

    @Test
    void testCreateCustomerDuplicateMobile() {
        when(customerRepository.findByMobile("5554447788")).thenReturn(Optional.of(customer));

        IllegalArgumentException exception = assertThrows(IllegalArgumentException.class,
                () -> customerService.createCustomer(customer, locale));
        assertEquals("Customer already exists: 5554447788", exception.getMessage());
    }

    @Test
    void testFindOrCreateCustomerExisting() {
        when(customerRepository.findByMobile("5554447788")).thenReturn(Optional.of(customer));
        when(customerRepository.save(any(Customer.class))).thenReturn(customer);

        Customer result = customerService.findOrCreateCustomer(customerInfo, locale);

        assertNotNull(result);
        assertEquals("Sita", result.getName());
        verify(customerRepository).save(customer);
    }

    @Test
    void testFindOrCreateCustomerNew() {
        when(customerRepository.findByMobile("5554447788")).thenReturn(Optional.empty());
        when(customerRepository.save(any(Customer.class))).thenReturn(customer);

        Customer result = customerService.findOrCreateCustomer(customerInfo, locale);

        assertNotNull(result);
        assertEquals("Sita", result.getName());
        verify(customerRepository).save(any(Customer.class));
    }

    @Test
    void testAddBillId() {
        when(customerRepository.findByMobile("5554447788")).thenReturn(Optional.of(customer));
        when(customerRepository.save(any(Customer.class))).thenReturn(customer);

        customerService.addBillId("5554447788", "bill004");

        assertTrue(customer.getPurchaseHistory().contains("bill004"));
        verify(customerRepository).save(customer);
    }

    @Test
    void testAddBillIdCustomerNotFound() {
        when(customerRepository.findByMobile("5554447788")).thenReturn(Optional.empty());
        when(messageSource.getMessage(eq("customer.not.found"), any(), eq(Locale.ENGLISH)))
                .thenReturn("Customer not found: 5554447788");

        IllegalArgumentException exception = assertThrows(IllegalArgumentException.class,
                () -> customerService.addBillId("5554447788", "bill004"));
        assertEquals("Customer not found: 5554447788", exception.getMessage());
    }

    @Test
    void testGetCustomerByIdSuccess() {
        when(customerRepository.findById("68d7eb12a2d18777fbd48685")).thenReturn(Optional.of(customer));

        Customer result = customerService.getCustomerById("68d7eb12a2d18777fbd48685", locale);

        assertNotNull(result);
        assertEquals("Sita", result.getName());
    }

    @Test
    void testGetCustomerByIdNotFound() {
        when(customerRepository.findById("68d7eb12a2d18777fbd48685")).thenReturn(Optional.empty());

        IllegalArgumentException exception = assertThrows(IllegalArgumentException.class,
                () -> customerService.getCustomerById("68d7eb12a2d18777fbd48685", locale));
        assertEquals("Customer not found: 68d7eb12a2d18777fbd48685", exception.getMessage());
    }

    @Test
    void testGetAllCustomers() {
        when(customerRepository.findAll()).thenReturn(Arrays.asList(customer));

        List<Customer> customers = customerService.getAllCustomers();

        assertEquals(1, customers.size());
        assertEquals("Sita", customers.get(0).getName());
    }

    @Test
    void testUpdateCustomerSuccess() {
        Customer updatedData = new Customer();
        updatedData.setName("Sita Updated");
        updatedData.setEmail("sita.updated@gmail.com");
        updatedData.setMobile("5554447789");

        when(customerRepository.findById("68d7eb12a2d18777fbd48685")).thenReturn(Optional.of(customer));
        when(customerRepository.save(any(Customer.class))).thenReturn(customer);

        Customer result = customerService.updateCustomer("68d7eb12a2d18777fbd48685", updatedData, locale);

        assertEquals("Sita Updated", customer.getName());
        assertEquals("sita.updated@gmail.com", customer.getEmail());
        assertEquals("5554447789", customer.getMobile());
        verify(customerRepository).save(customer);
    }

    @Test
    void testUpdateCustomerNotFound() {
        when(customerRepository.findById("68d7eb12a2d18777fbd48685")).thenReturn(Optional.empty());

        IllegalArgumentException exception = assertThrows(IllegalArgumentException.class,
                () -> customerService.updateCustomer("68d7eb12a2d18777fbd48685", customer, locale));
        assertEquals("Customer not found: 68d7eb12a2d18777fbd48685", exception.getMessage());
    }

    @Test
    void testDeleteCustomerSuccess() {
        when(customerRepository.existsById("68d7eb12a2d18777fbd48685")).thenReturn(true);

        customerService.deleteCustomer("68d7eb12a2d18777fbd48685", locale);

        verify(customerRepository).deleteById("68d7eb12a2d18777fbd48685");
    }

    @Test
    void testDeleteCustomerNotFound() {
        when(customerRepository.existsById("68d7eb12a2d18777fbd48685")).thenReturn(false);

        IllegalArgumentException exception = assertThrows(IllegalArgumentException.class,
                () -> customerService.deleteCustomer("68d7eb12a2d18777fbd48685", locale));
        assertEquals("Customer not found: 68d7eb12a2d18777fbd48685", exception.getMessage());
    }

    @Test
    void testGetCustomerPurchaseHistory_Success() {
        when(customerRepository.findById("68d7eb12a2d18777fbd48685")).thenReturn(Optional.of(customer));
        when(billRepository.findAllById(Arrays.asList("bill001", "bill002", "bill003")))
                .thenReturn(Arrays.asList(bill1, bill2, bill3));

        List<Bill> purchaseHistory = customerService.getCustomerPurchaseHistory("68d7eb12a2d18777fbd48685", null, null, locale);

        assertEquals(3, purchaseHistory.size());
        assertEquals("bill001", purchaseHistory.get(0).getBillId());
        assertEquals("bill002", purchaseHistory.get(1).getBillId());
        assertEquals("bill003", purchaseHistory.get(2).getBillId());
        verify(billRepository).findAllById(Arrays.asList("bill001", "bill002", "bill003"));
    }

    @Test
    void testGetCustomerPurchaseHistory_BillNotFound() {
        customer.setPurchaseHistory(Arrays.asList("bill001", "bill002", "bill004"));
        when(customerRepository.findById("68d7eb12a2d18777fbd48685")).thenReturn(Optional.of(customer));
        when(billRepository.findAllById(Arrays.asList("bill001", "bill002", "bill004")))
                .thenReturn(Arrays.asList(bill1, bill2));

        List<Bill> purchaseHistory = customerService.getCustomerPurchaseHistory("68d7eb12a2d18777fbd48685", null, null, locale);

        assertEquals(2, purchaseHistory.size());
        assertEquals("bill001", purchaseHistory.get(0).getBillId());
        assertEquals("bill002", purchaseHistory.get(1).getBillId());
        verify(billRepository).findAllById(Arrays.asList("bill001", "bill002", "bill004"));
    }

    @Test
    void testGetCustomerPurchaseHistory_WithDateRange() {
        Date startDate = new Date(2025 - 1900, 8, 27, 0, 0, 0); // 2025-09-27 00:00:00
        Date endDate = new Date(2025 - 1900, 8, 27, 23, 59, 59); // 2025-09-27 23:59:59
        when(customerRepository.findById("68d7eb12a2d18777fbd48685")).thenReturn(Optional.of(customer));
        when(billRepository.findAllById(Arrays.asList("bill001", "bill002", "bill003")))
                .thenReturn(Arrays.asList(bill1, bill2, bill3));

        List<Bill> purchaseHistory = customerService.getCustomerPurchaseHistory("68d7eb12a2d18777fbd48685", startDate, endDate, locale);

        assertEquals(3, purchaseHistory.size());
        assertEquals("bill001", purchaseHistory.get(0).getBillId());
        assertEquals("bill002", purchaseHistory.get(1).getBillId());
        assertEquals("bill003", purchaseHistory.get(2).getBillId());
        verify(billRepository).findAllById(Arrays.asList("bill001", "bill002", "bill003"));
    }

    @Test
    void testGetCustomerPurchaseHistory_CustomerNotFound() {
        when(customerRepository.findById("68d7eb12a2d18777fbd48685")).thenReturn(Optional.empty());

        IllegalArgumentException exception = assertThrows(IllegalArgumentException.class,
                () -> customerService.getCustomerPurchaseHistory("68d7eb12a2d18777fbd48685", null, null, locale));
        assertEquals("Customer not found: 68d7eb12a2d18777fbd48685", exception.getMessage());
        verify(billRepository, never()).findAllById(any());
    }

    @Test
    void testGetCustomerPurchaseHistory_EmptyPurchaseHistory() {
        customer.setPurchaseHistory(new ArrayList<>());
        when(customerRepository.findById("68d7eb12a2d18777fbd48685")).thenReturn(Optional.of(customer));

        List<Bill> purchaseHistory = customerService.getCustomerPurchaseHistory("68d7eb12a2d18777fbd48685", null, null, locale);

        assertTrue(purchaseHistory.isEmpty());
        verify(billRepository, never()).findAllById(any());
    }

    @Test
    void testGetCustomerPurchaseHistory_InvalidCustomerId() {
        IllegalArgumentException exception = assertThrows(IllegalArgumentException.class,
                () -> customerService.getCustomerPurchaseHistory("", null, null, locale));
        assertEquals("Customer ID is required", exception.getMessage());
        verify(customerRepository, never()).findById(any());
        verify(billRepository, never()).findAllById(any());
    }

    @Test
    void testGetCustomerPurchaseHistory_InvalidDateRange() {
        Date startDate = new Date();
        Date endDate = new Date(startDate.getTime() - 86400000); // Yesterday
        when(customerRepository.findById("68d7eb12a2d18777fbd48685")).thenReturn(Optional.of(customer));

        IllegalArgumentException exception = assertThrows(IllegalArgumentException.class,
                () -> customerService.getCustomerPurchaseHistory("68d7eb12a2d18777fbd48685", startDate, endDate, locale));
        assertEquals("Start date " + startDate + " must be before end date " + endDate, exception.getMessage());
        verify(billRepository, never()).findAllById(any());
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\test\java\com\smartretail\backend\service\ProductServiceTest.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.exception.ProductNotFoundException;
import com.smartretail.backend.models.Product;
import com.smartretail.backend.repository.ProductRepository;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.junit.jupiter.MockitoExtension;
import org.springframework.context.MessageSource;

import java.util.Arrays;
import java.util.Date;
import java.util.List;
import java.util.Locale;
import java.util.Optional;

import static org.junit.jupiter.api.Assertions.*;
import static org.mockito.ArgumentMatchers.*;
import static org.mockito.Mockito.*;

@ExtendWith(MockitoExtension.class)
class ProductServiceTest {

    @Mock
    private ProductRepository productRepository;

    @Mock
    private NotificationService notificationService;

    @Mock
    private FileService fileService;

    @Mock
    private MessageSource messageSource;

    @Mock
    private AuditLogService auditLogService;

    @InjectMocks
    private ProductServiceImpl productService;

    private Product product;
    private Locale locale;

    @BeforeEach
    void setUp() {
        locale = Locale.forLanguageTag("en");

        product = new Product();
        product.setProductId("p12345678");
        product.setName("Laptop");
        product.setCategory("Electronics");
        product.setPrice(999.99);
        product.setQuantity(8);
        product.setReorderLevel(10);
        product.setExpiryDate(null);
        product.setAddedBy("ravi@shop.com");
        product.setLastUpdated(new Date());

        // Mock MessageSource for error messages
        when(messageSource.getMessage(eq("product.exists"), any(), eq(locale)))
                .thenReturn("Product already exists: p12345678");
        when(messageSource.getMessage(eq("product.not.found"), any(), eq(locale)))
                .thenReturn("Product not found: p12345678");
        when(messageSource.getMessage(eq("product.restock.invalid.quantity"), any(), eq(locale)))
                .thenReturn("Restock quantity must be positive");
        when(messageSource.getMessage(eq("product.update.failed"), any(), eq(locale)))
                .thenReturn("Product update failed: p12345678");
    }

    @Test
    void testAddProductSuccess() {
        when(productRepository.existsByProductId("p12345678")).thenReturn(false);
        when(productRepository.save(any(Product.class))).thenReturn(product);

        Product result = productService.createProduct(product, locale);

        assertNotNull(result);
        assertEquals("p12345678", result.getProductId());
        verify(productRepository).save(product);
    }

    @Test
    void testAddProductDuplicateId() {
        when(productRepository.existsByProductId("p12345678")).thenReturn(true);

        RuntimeException exception = assertThrows(RuntimeException.class,
                () -> productService.createProduct(product, locale));
        assertEquals("Product already exists: p12345678", exception.getMessage());
    }

    @Test
    void testGetLowStockProducts() {
        when(productRepository.findLowStockProducts()).thenReturn(Arrays.asList(product));

        List<Product> products = productService.getLowStockProducts();

        assertEquals(1, products.size());
        assertEquals("p12345678", products.get(0).getProductId());
    }

    @Test
    void testGetExpiringProducts() {
        product.setExpiryDate(new Date(System.currentTimeMillis() + 5 * 24 * 60 * 60 * 1000L));
        when(productRepository.findByExpiryDateBefore(any(Date.class))).thenReturn(Arrays.asList(product));

        List<Product> products = productService.getExpiringProducts(
                new Date(System.currentTimeMillis() + 7 * 24 * 60 * 60 * 1000L));

        assertEquals(1, products.size());
        assertEquals("p12345678", products.get(0).getProductId());
    }

    @Test
    void testRestockProductSuccess() {
        when(productRepository.findByProductId("p12345678")).thenReturn(Optional.of(product));
        when(productRepository.save(any(Product.class))).thenReturn(product);

        Product result = productService.restockProduct("p12345678", 5, locale);

        assertEquals(13, result.getQuantity());
        verify(productRepository).save(product);
    }

    @Test
    void testRestockProductInvalidQty() {
        when(productRepository.findByProductId("p12345678")).thenReturn(Optional.of(product));

        RuntimeException exception = assertThrows(RuntimeException.class,
                () -> productService.restockProduct("p12345678", 0, locale));
        assertEquals("Restock quantity must be positive", exception.getMessage());
    }

    @Test
    void testRestockProductNotFound() {
        when(productRepository.findByProductId("p12345678")).thenReturn(Optional.empty());

        ProductNotFoundException exception = assertThrows(ProductNotFoundException.class,
                () -> productService.restockProduct("p12345678", 5, locale));
        assertEquals("Product not found: p12345678", exception.getMessage());
    }

    @Test
    void testGetProductByIdSuccess() {
        when(productRepository.findByProductId("p12345678")).thenReturn(Optional.of(product));

        Product result = productService.getProductById("p12345678", locale);

        assertNotNull(result);
        assertEquals("p12345678", result.getProductId());
    }

    @Test
    void testGetProductByIdNotFound() {
        when(productRepository.findByProductId("p12345678")).thenReturn(Optional.empty());

        ProductNotFoundException exception = assertThrows(ProductNotFoundException.class,
                () -> productService.getProductById("p12345678", locale));
        assertEquals("Product not found: p12345678", exception.getMessage());
    }

    // NEW TESTS FOR SYNC MODE FUNCTIONALITY

    @Test
    void testUpdateProductSyncMode_Success() {
        Product updatedProduct = new Product();
        updatedProduct.setProductId("p12345678");
        updatedProduct.setName("Laptop Pro");
        updatedProduct.setCategory("Electronics");
        updatedProduct.setPrice(1099.99);
        updatedProduct.setQuantity(15);

        when(productRepository.findByProductId("p12345678")).thenReturn(Optional.of(product));
        when(productRepository.save(any(Product.class))).thenReturn(updatedProduct);

        Product result = productService.updateProduct("p12345678", updatedProduct, locale, true);

        assertNotNull(result);
        assertEquals("Laptop Pro", result.getName());
        assertEquals(1099.99, result.getPrice());
        assertEquals(15, result.getQuantity());
        verify(productRepository).save(any(Product.class));
    }

    @Test
    void testUpdateProductSyncMode_Unchanged_SkipsUpdate() {
        Product unchangedProduct = new Product();
        unchangedProduct.setProductId("p12345678");
        unchangedProduct.setName("Laptop");
        unchangedProduct.setCategory("Electronics");
        unchangedProduct.setPrice(999.99);
        unchangedProduct.setQuantity(8);

        when(productRepository.findByProductId("p12345678")).thenReturn(Optional.of(product));

        Product result = productService.updateProduct("p12345678", unchangedProduct, locale, true);

        assertNotNull(result);
        assertEquals("Laptop", result.getName());
        assertEquals(999.99, result.getPrice());
        assertEquals(8, result.getQuantity());
        // Should not save since no changes
        verify(productRepository, never()).save(any(Product.class));
    }

    @Test
    void testUpdateProductSyncMode_NullCategory_Success() {
        Product updatedProduct = new Product();
        updatedProduct.setProductId("p12345678");
        updatedProduct.setName("Laptop");
        updatedProduct.setCategory(null); // Null category
        updatedProduct.setPrice(999.99);
        updatedProduct.setQuantity(10); // Changed quantity

        when(productRepository.findByProductId("p12345678")).thenReturn(Optional.of(product));
        when(productRepository.save(any(Product.class))).thenReturn(updatedProduct);

        Product result = productService.updateProduct("p12345678", updatedProduct, locale, true);

        assertNotNull(result);
        assertEquals(10, result.getQuantity());
        verify(productRepository).save(any(Product.class));
    }

    @Test
    void testUpdateProductSyncMode_ProductNotFound() {
        Product updatedProduct = new Product();
        updatedProduct.setProductId("p12345678");
        updatedProduct.setName("Laptop Pro");

        when(productRepository.findByProductId("p12345678")).thenReturn(Optional.empty());

        assertThrows(RuntimeException.class,
                () -> productService.updateProduct("p12345678", updatedProduct, locale, true));
    }

    @Test
    void testUpdateProductQuantity_Success() {
        when(productRepository.findByProductId("p12345678")).thenReturn(Optional.of(product));
        when(productRepository.save(any(Product.class))).thenReturn(product);

        Product result = productService.updateProductQuantity("p12345678", 3, locale);

        assertEquals(5, result.getQuantity()); // 8 - 3 = 5
        verify(productRepository).save(product);
    }

    @Test
    void testUpdateProductQuantity_InsufficientStock() {
        when(productRepository.findByProductId("p12345678")).thenReturn(Optional.of(product));

        RuntimeException exception = assertThrows(RuntimeException.class,
                () -> productService.updateProductQuantity("p12345678", 10, locale));
        assertTrue(exception.getMessage().contains("p12345678"));
    }

    @Test
    void testUpdateProductQuantity_ProductNotFound() {
        when(productRepository.findByProductId("p12345678")).thenReturn(Optional.empty());

        ProductNotFoundException exception = assertThrows(ProductNotFoundException.class,
                () -> productService.updateProductQuantity("p12345678", 3, locale));
        assertEquals("Product not found: p12345678", exception.getMessage());
    }

    @Test
    void testExistsByProductId_True() {
        when(productRepository.existsByProductId("p12345678")).thenReturn(true);

        boolean exists = productService.existsByProductId("p12345678");

        assertTrue(exists);
        verify(productRepository).existsByProductId("p12345678");
    }

    @Test
    void testExistsByProductId_False() {
        when(productRepository.existsByProductId("p12345678")).thenReturn(false);

        boolean exists = productService.existsByProductId("p12345678");

        assertFalse(exists);
        verify(productRepository).existsByProductId("p12345678");
    }

    @Test
    void testGetAllProducts() {
        when(productRepository.findAll()).thenReturn(Arrays.asList(product));

        List<Product> products = productService.getAllProducts();

        assertEquals(1, products.size());
        assertEquals("p12345678", products.get(0).getProductId());
        verify(productRepository).findAll();
    }

    @Test
    void testDeleteProduct_Success() {
        when(productRepository.findByProductId("p12345678")).thenReturn(Optional.of(product));
        doNothing().when(productRepository).deleteByProductId("p12345678");

        productService.deleteProduct("p12345678", locale);

        verify(productRepository).deleteByProductId("p12345678");
    }

    @Test
    void testDeleteProduct_NotFound() {
        when(productRepository.findByProductId("p12345678")).thenReturn(Optional.empty());

        ProductNotFoundException exception = assertThrows(ProductNotFoundException.class,
                () -> productService.deleteProduct("p12345678", locale));
        assertEquals("Product not found: p12345678", exception.getMessage());
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\test\java\com\smartretail\backend\service\ReminderServiceTest.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.models.Bill;
import com.smartretail.backend.models.Customer;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.junit.jupiter.MockitoExtension;
import org.springframework.context.MessageSource;

import java.util.Arrays;
import java.util.Date;
import java.util.List;
import java.util.Locale;

import static org.mockito.ArgumentMatchers.*;
import static org.mockito.Mockito.*;

@ExtendWith(MockitoExtension.class)
class ReminderServiceTest {

    @Mock
    private CustomerService customerService;

    @Mock
    private NotificationService notificationService;

    @Mock
    private MessageSource messageSource;

    @InjectMocks
    private ReminderService reminderService;

    private Customer customer;
    private Bill bill1;
    private Bill bill2;

    @BeforeEach
    void setUp() {
        customer = new Customer();
        customer.setId("68d7eb12a2d18777fbd48685");
        customer.setName("Sita");
        customer.setEmail("sita@gmail.com");
        customer.setMobile("5554447788");
        customer.setPurchaseHistory(Arrays.asList("bill001", "bill002"));

        bill1 = new Bill();
        bill1.setBillId("bill001");
        bill1.setCreatedAt(new Date());
        Bill.CustomerInfo billCustomerInfo1 = new Bill.CustomerInfo();
        billCustomerInfo1.setMobile("5554447788");
        bill1.setCustomer(billCustomerInfo1);
        Bill.BillItem item1 = new Bill.BillItem();
        item1.setProductName("Laptop");
        item1.setProductId("p123");
        item1.setQty(1);
        item1.setPrice(500.0);
        bill1.setItems(Arrays.asList(item1));

        bill2 = new Bill();
        bill2.setBillId("bill002");
        bill2.setCreatedAt(new Date());
        Bill.CustomerInfo billCustomerInfo2 = new Bill.CustomerInfo();
        billCustomerInfo2.setMobile("5554447788");
        bill2.setCustomer(billCustomerInfo2);
        Bill.BillItem item2 = new Bill.BillItem();
        item2.setProductName("Laptop");
        item2.setProductId("p123");
        item2.setQty(1);
        item2.setPrice(500.0);
        bill2.setItems(Arrays.asList(item2));

        when(customerService.getAllCustomers()).thenReturn(Arrays.asList(customer));
        when(customerService.getCustomerPurchaseHistory(eq("68d7eb12a2d18777fbd48685"), any(), any(), eq(Locale.ENGLISH)))
                .thenReturn(Arrays.asList(bill1, bill2));
        when(messageSource.getMessage(eq("reminder.no.email"), any(), eq(Locale.ENGLISH)))
                .thenReturn("Customer 5554447788 has no email address");
        when(messageSource.getMessage(eq("reminder.no.purchase.history"), any(), eq(Locale.ENGLISH)))
                .thenReturn("Customer 5554447788 has no purchase history");
        when(messageSource.getMessage(eq("reminder.no.frequent.items"), any(), eq(Locale.ENGLISH)))
                .thenReturn("Customer 5554447788 has no frequently purchased items");
        when(messageSource.getMessage(eq("reminder.subject"), any(), eq(Locale.ENGLISH)))
                .thenReturn("Monthly Purchase Reminder from Smart Retail");
        when(messageSource.getMessage(eq("reminder.body"), any(), eq(Locale.ENGLISH)))
                .thenReturn("Dear Sita,\n\nWe noticed you frequently purchase the following items:\nLaptop\nVisit us to restock your favorites!\n\nBest regards,\nSmart Retail Team");
    }

    @Test
    void testSendMonthlyPurchaseReminders_Success() {
        reminderService.sendMonthlyPurchaseReminders();

        verify(customerService).getAllCustomers();
        verify(customerService).getCustomerPurchaseHistory("68d7eb12a2d18777fbd48685", null, null, Locale.ENGLISH);
        verify(notificationService).sendEmail(
                eq("sita@gmail.com"),
                eq("Monthly Purchase Reminder from Smart Retail"),
                contains("Dear Sita,\n\nWe noticed you frequently purchase the following items:\nLaptop\n")
        );
    }

    @Test
    void testSendMonthlyPurchaseReminders_NoEmail() {
        customer.setEmail(null);
        when(customerService.getAllCustomers()).thenReturn(Arrays.asList(customer));

        reminderService.sendMonthlyPurchaseReminders();

        verify(customerService).getAllCustomers();
        verify(customerService, never()).getCustomerPurchaseHistory(anyString(), any(), any(), any());
        verify(notificationService, never()).sendEmail(anyString(), anyString(), anyString());
    }

    @Test
    void testSendMonthlyPurchaseReminders_NoPurchaseHistory() {
        when(customerService.getCustomerPurchaseHistory(eq("68d7eb12a2d18777fbd48685"), any(), any(), eq(Locale.ENGLISH)))
                .thenReturn(List.of());

        reminderService.sendMonthlyPurchaseReminders();

        verify(customerService).getAllCustomers();
        verify(customerService).getCustomerPurchaseHistory("68d7eb12a2d18777fbd48685", null, null, Locale.ENGLISH);
        verify(notificationService, never()).sendEmail(anyString(), anyString(), anyString());
    }

    @Test
    void testSendMonthlyPurchaseReminders_NoFrequentItems() {
        bill2.getItems().get(0).setProductName("Mouse"); // Different product
        when(customerService.getCustomerPurchaseHistory(eq("68d7eb12a2d18777fbd48685"), any(), any(), eq(Locale.ENGLISH)))
                .thenReturn(Arrays.asList(bill1, bill2));

        reminderService.sendMonthlyPurchaseReminders();

        verify(customerService).getAllCustomers();
        verify(customerService).getCustomerPurchaseHistory("68d7eb12a2d18777fbd48685", null, null, Locale.ENGLISH);
        verify(notificationService, never()).sendEmail(anyString(), anyString(), anyString());
    }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\backend\src\test\java\com\smartretail\backend\service\ReportServiceTest.java
--------------------------------------------------------------------
package com.smartretail.backend.service;

import com.smartretail.backend.models.Bill;
import com.smartretail.backend.models.Product;
import com.smartretail.backend.repository.BillRepository;
import com.smartretail.backend.repository.ProductRepository;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.junit.jupiter.MockitoExtension;
import org.springframework.context.MessageSource;
import org.springframework.data.mongodb.core.MongoTemplate;
import org.springframework.data.mongodb.core.aggregation.AggregationResults;

import java.util.*;

import static org.junit.jupiter.api.Assertions.*;
import static org.mockito.ArgumentMatchers.any;
import static org.mockito.Mockito.*;

@ExtendWith(MockitoExtension.class)
class ReportServiceTest {

    @Mock
    private BillRepository billRepository;
    @Mock
    private ProductRepository productRepository;
    @Mock
    private MongoTemplate mongoTemplate;
    @Mock
    private MessageSource messageSource;

    @InjectMocks
    private ReportServiceImpl reportService;

    @Test
    void testGetSalesReport_ValidRange_ReturnsReport() {
        Date startDate = new Date(2025 - 1900, 8, 1);
        Date endDate = new Date(2025 - 1900, 8, 30);
        Map<String, Object> aggregationResult = new HashMap<>();
        aggregationResult.put("totalSales", 5000.0);
        aggregationResult.put("billCount", 10);
        aggregationResult.put("averageBillAmount", 500.0);

        when(mongoTemplate.aggregate(any(), eq("bills"), eq(Map.class)))
                .thenReturn(new AggregationResults<>(List.of(aggregationResult), null));
        when(billRepository.findAll()).thenReturn(List.of(new Bill()));

        Map<String, Object> result = reportService.getSalesReport(startDate, endDate, Locale.ENGLISH);

        assertEquals(5000.0, result.get("totalSales"));
        assertEquals(10, result.get("billCount"));
        assertEquals(500.0, result.get("averageBillAmount"));
        assertFalse(((List<?>) result.get("bills")).isEmpty());
    }

    @Test
    void testGetSalesReport_NoBills_ThrowsException() {
        Date startDate = new Date(2025 - 1900, 8, 1);
        Date endDate = new Date(2025 - 1900, 8, 30);
        when(mongoTemplate.aggregate(any(), eq("bills"), eq(Map.class)))
                .thenReturn(new AggregationResults<>(List.of(), null));
        when(messageSource.getMessage("report.no.bills.found", null, Locale.ENGLISH))
                .thenReturn("No bills found for the given date range");

        IllegalArgumentException exception = assertThrows(IllegalArgumentException.class, () -> {
            reportService.getSalesReport(startDate, endDate, Locale.ENGLISH);
        });

        assertEquals("No bills found for the given date range", exception.getMessage());
    }

    @Test
    void testGetInventoryReport_ValidParams_ReturnsReport() {
        Product product = new Product();
        product.setProductId("p123");
        product.setQuantity(5);
        product.setExpiryDate(new Date(System.currentTimeMillis() + 15 * 24 * 60 * 60 * 1000L)); // 15 days

        when(productRepository.findAll()).thenReturn(List.of(product));

        Map<String, Object> result = reportService.getInventoryReport(10, 30, Locale.ENGLISH);

        assertEquals(1, result.get("totalProducts"));
        assertEquals(1, ((List<?>) result.get("lowStockProducts")).size());
        assertEquals(1, ((List<?>) result.get("expiringProducts")).size());
    }
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend
--------------------------------------------------------------------
Contents:
.gitignore
index.html
node_modules
package.json
package-lock.json
postcss.config.cjs
README.md
src
tailwind.config.js
vite.config.mjs

====================================================================
📄 File: G:\FINALCODE\frontend\.gitignore
--------------------------------------------------------------------

node_modules/

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\index.html
--------------------------------------------------------------------
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Smart Retail - Frontend</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@600;700;800&display=swap" rel="stylesheet">
</head>
<body>
<div id="root"></div>

<script type="module" src="/src/main.jsx"></script>
</body>
</html>
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\package.json
--------------------------------------------------------------------
{
  "name": "smart-retail-frontend",
  "version": "1.0.0",
  "private": true,
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview"
  },
  "dependencies": {
    "axios": "^1.5.0",
    "framer-motion": "^12.23.24",
    "fuse.js": "^7.0.0",
    "i18next": "^25.6.0",
    "jwt-decode": "^3.1.2",
    "react": "^18.2.0",
    "react-countup": "^6.5.3",
    "react-datepicker": "^8.8.0",
    "react-dom": "^18.2.0",
    "react-i18next": "^16.2.4",
    "react-router-dom": "^6.21.3",
    "recharts": "^3.3.0"
  },
  "devDependencies": {
    "@tailwindcss/aspect-ratio": "^0.4.2",
    "@vitejs/plugin-react": "^4.0.0",
    "autoprefixer": "^10.4.14",
    "postcss": "^8.4.24",
    "tailwindcss": "^3.4.12",
    "vite": "^4.5.0"
  },
  "main": "tailwind.config.js",
  "keywords": [],
  "author": "",
  "license": "ISC",
  "description": ""
}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\package-lock.json
--------------------------------------------------------------------
{
  "name": "smart-retail-frontend",
  "version": "1.0.0",
  "lockfileVersion": 3,
  "requires": true,
  "packages": {
    "": {
      "name": "smart-retail-frontend",
      "version": "1.0.0",
      "license": "ISC",
      "dependencies": {
        "axios": "^1.5.0",
        "framer-motion": "^12.23.24",
        "fuse.js": "^7.0.0",
        "i18next": "^25.6.0",
        "jwt-decode": "^3.1.2",
        "react": "^18.2.0",
        "react-countup": "^6.5.3",
        "react-datepicker": "^8.8.0",
        "react-dom": "^18.2.0",
        "react-i18next": "^16.2.4",
        "react-router-dom": "^6.21.3",
        "recharts": "^3.3.0"
      },
      "devDependencies": {
        "@tailwindcss/aspect-ratio": "^0.4.2",
        "@vitejs/plugin-react": "^4.0.0",
        "autoprefixer": "^10.4.14",
        "postcss": "^8.4.24",
        "tailwindcss": "^3.4.12",
        "vite": "^4.5.0"
      }
    },
    "node_modules/@alloc/quick-lru": {
      "version": "5.2.0",
      "resolved": "https://registry.npmjs.org/@alloc/quick-lru/-/quick-lru-5.2.0.tgz",
      "integrity": "sha512-UrcABB+4bUrFABwbluTIBErXwvbsU/V7TZWfmbgJfbkwiBuziS9gxdODUyuiecfdGQ85jglMW6juS3+z5TsKLw==",
      "dev": true,
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/@babel/code-frame": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/code-frame/-/code-frame-7.27.1.tgz",
      "integrity": "sha512-cjQ7ZlQ0Mv3b47hABuTevyTuYN4i+loJKGeV9flcCgIK37cCXRh+L1bd3iBHlynerhQ7BhCkn2BPbQUL+rGqFg==",
      "dev": true,
      "dependencies": {
        "@babel/helper-validator-identifier": "^7.27.1",
        "js-tokens": "^4.0.0",
        "picocolors": "^1.1.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/compat-data": {
      "version": "7.28.5",
      "resolved": "https://registry.npmjs.org/@babel/compat-data/-/compat-data-7.28.5.tgz",
      "integrity": "sha512-6uFXyCayocRbqhZOB+6XcuZbkMNimwfVGFji8CTZnCzOHVGvDqzvitu1re2AU5LROliz7eQPhB8CpAMvnx9EjA==",
      "dev": true,
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/core": {
      "version": "7.28.5",
      "resolved": "https://registry.npmjs.org/@babel/core/-/core-7.28.5.tgz",
      "integrity": "sha512-e7jT4DxYvIDLk1ZHmU/m/mB19rex9sv0c2ftBtjSBv+kVM/902eh0fINUzD7UwLLNR+jU585GxUJ8/EBfAM5fw==",
      "dev": true,
      "dependencies": {
        "@babel/code-frame": "^7.27.1",
        "@babel/generator": "^7.28.5",
        "@babel/helper-compilation-targets": "^7.27.2",
        "@babel/helper-module-transforms": "^7.28.3",
        "@babel/helpers": "^7.28.4",
        "@babel/parser": "^7.28.5",
        "@babel/template": "^7.27.2",
        "@babel/traverse": "^7.28.5",
        "@babel/types": "^7.28.5",
        "@jridgewell/remapping": "^2.3.5",
        "convert-source-map": "^2.0.0",
        "debug": "^4.1.0",
        "gensync": "^1.0.0-beta.2",
        "json5": "^2.2.3",
        "semver": "^6.3.1"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/babel"
      }
    },
    "node_modules/@babel/generator": {
      "version": "7.28.5",
      "resolved": "https://registry.npmjs.org/@babel/generator/-/generator-7.28.5.tgz",
      "integrity": "sha512-3EwLFhZ38J4VyIP6WNtt2kUdW9dokXA9Cr4IVIFHuCpZ3H8/YFOl5JjZHisrn1fATPBmKKqXzDFvh9fUwHz6CQ==",
      "dev": true,
      "dependencies": {
        "@babel/parser": "^7.28.5",
        "@babel/types": "^7.28.5",
        "@jridgewell/gen-mapping": "^0.3.12",
        "@jridgewell/trace-mapping": "^0.3.28",
        "jsesc": "^3.0.2"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-compilation-targets": {
      "version": "7.27.2",
      "resolved": "https://registry.npmjs.org/@babel/helper-compilation-targets/-/helper-compilation-targets-7.27.2.tgz",
      "integrity": "sha512-2+1thGUUWWjLTYTHZWK1n8Yga0ijBz1XAhUXcKy81rd5g6yh7hGqMp45v7cadSbEHc9G3OTv45SyneRN3ps4DQ==",
      "dev": true,
      "dependencies": {
        "@babel/compat-data": "^7.27.2",
        "@babel/helper-validator-option": "^7.27.1",
        "browserslist": "^4.24.0",
        "lru-cache": "^5.1.1",
        "semver": "^6.3.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-compilation-targets/node_modules/lru-cache": {
      "version": "5.1.1",
      "resolved": "https://registry.npmjs.org/lru-cache/-/lru-cache-5.1.1.tgz",
      "integrity": "sha512-KpNARQA3Iwv+jTA0utUVVbrh+Jlrr1Fv0e56GGzAFOXN7dk/FviaDW8LHmK52DlcH4WP2n6gI8vN1aesBFgo9w==",
      "dev": true,
      "dependencies": {
        "yallist": "^3.0.2"
      }
    },
    "node_modules/@babel/helper-globals": {
      "version": "7.28.0",
      "resolved": "https://registry.npmjs.org/@babel/helper-globals/-/helper-globals-7.28.0.tgz",
      "integrity": "sha512-+W6cISkXFa1jXsDEdYA8HeevQT/FULhxzR99pxphltZcVaugps53THCeiWA8SguxxpSp3gKPiuYfSWopkLQ4hw==",
      "dev": true,
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-module-imports": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/helper-module-imports/-/helper-module-imports-7.27.1.tgz",
      "integrity": "sha512-0gSFWUPNXNopqtIPQvlD5WgXYI5GY2kP2cCvoT8kczjbfcfuIljTbcWrulD1CIPIX2gt1wghbDy08yE1p+/r3w==",
      "dev": true,
      "dependencies": {
        "@babel/traverse": "^7.27.1",
        "@babel/types": "^7.27.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-module-transforms": {
      "version": "7.28.3",
      "resolved": "https://registry.npmjs.org/@babel/helper-module-transforms/-/helper-module-transforms-7.28.3.tgz",
      "integrity": "sha512-gytXUbs8k2sXS9PnQptz5o0QnpLL51SwASIORY6XaBKF88nsOT0Zw9szLqlSGQDP/4TljBAD5y98p2U1fqkdsw==",
      "dev": true,
      "dependencies": {
        "@babel/helper-module-imports": "^7.27.1",
        "@babel/helper-validator-identifier": "^7.27.1",
        "@babel/traverse": "^7.28.3"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0"
      }
    },
    "node_modules/@babel/helper-plugin-utils": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/helper-plugin-utils/-/helper-plugin-utils-7.27.1.tgz",
      "integrity": "sha512-1gn1Up5YXka3YYAHGKpbideQ5Yjf1tDa9qYcgysz+cNCXukyLl6DjPXhD3VRwSb8c0J9tA4b2+rHEZtc6R0tlw==",
      "dev": true,
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-string-parser": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/helper-string-parser/-/helper-string-parser-7.27.1.tgz",
      "integrity": "sha512-qMlSxKbpRlAridDExk92nSobyDdpPijUq2DW6oDnUqd0iOGxmQjyqhMIihI9+zv4LPyZdRje2cavWPbCbWm3eA==",
      "dev": true,
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-validator-identifier": {
      "version": "7.28.5",
      "resolved": "https://registry.npmjs.org/@babel/helper-validator-identifier/-/helper-validator-identifier-7.28.5.tgz",
      "integrity": "sha512-qSs4ifwzKJSV39ucNjsvc6WVHs6b7S03sOh2OcHF9UHfVPqWWALUsNUVzhSBiItjRZoLHx7nIarVjqKVusUZ1Q==",
      "dev": true,
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-validator-option": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/helper-validator-option/-/helper-validator-option-7.27.1.tgz",
      "integrity": "sha512-YvjJow9FxbhFFKDSuFnVCe2WxXk1zWc22fFePVNEaWJEu8IrZVlda6N0uHwzZrUM1il7NC9Mlp4MaJYbYd9JSg==",
      "dev": true,
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helpers": {
      "version": "7.28.4",
      "resolved": "https://registry.npmjs.org/@babel/helpers/-/helpers-7.28.4.tgz",
      "integrity": "sha512-HFN59MmQXGHVyYadKLVumYsA9dBFun/ldYxipEjzA4196jpLZd8UjEEBLkbEkvfYreDqJhZxYAWFPtrfhNpj4w==",
      "dev": true,
      "dependencies": {
        "@babel/template": "^7.27.2",
        "@babel/types": "^7.28.4"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/parser": {
      "version": "7.28.5",
      "resolved": "https://registry.npmjs.org/@babel/parser/-/parser-7.28.5.tgz",
      "integrity": "sha512-KKBU1VGYR7ORr3At5HAtUQ+TV3SzRCXmA/8OdDZiLDBIZxVyzXuztPjfLd3BV1PRAQGCMWWSHYhL0F8d5uHBDQ==",
      "dev": true,
      "dependencies": {
        "@babel/types": "^7.28.5"
      },
      "bin": {
        "parser": "bin/babel-parser.js"
      },
      "engines": {
        "node": ">=6.0.0"
      }
    },
    "node_modules/@babel/plugin-transform-react-jsx-self": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/plugin-transform-react-jsx-self/-/plugin-transform-react-jsx-self-7.27.1.tgz",
      "integrity": "sha512-6UzkCs+ejGdZ5mFFC/OCUrv028ab2fp1znZmCZjAOBKiBK2jXD1O+BPSfX8X2qjJ75fZBMSnQn3Rq2mrBJK2mw==",
      "dev": true,
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.27.1"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-transform-react-jsx-source": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/plugin-transform-react-jsx-source/-/plugin-transform-react-jsx-source-7.27.1.tgz",
      "integrity": "sha512-zbwoTsBruTeKB9hSq73ha66iFeJHuaFkUbwvqElnygoNbj/jHRsSeokowZFN3CZ64IvEqcmmkVe89OPXc7ldAw==",
      "dev": true,
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.27.1"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/runtime": {
      "version": "7.28.4",
      "resolved": "https://registry.npmjs.org/@babel/runtime/-/runtime-7.28.4.tgz",
      "integrity": "sha512-Q/N6JNWvIvPnLDvjlE1OUBLPQHH6l3CltCEsHIujp45zQUSSh8K+gHnaEX45yAT1nyngnINhvWtzN+Nb9D8RAQ==",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/template": {
      "version": "7.27.2",
      "resolved": "https://registry.npmjs.org/@babel/template/-/template-7.27.2.tgz",
      "integrity": "sha512-LPDZ85aEJyYSd18/DkjNh4/y1ntkE5KwUHWTiqgRxruuZL2F1yuHligVHLvcHY2vMHXttKFpJn6LwfI7cw7ODw==",
      "dev": true,
      "dependencies": {
        "@babel/code-frame": "^7.27.1",
        "@babel/parser": "^7.27.2",
        "@babel/types": "^7.27.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/traverse": {
      "version": "7.28.5",
      "resolved": "https://registry.npmjs.org/@babel/traverse/-/traverse-7.28.5.tgz",
      "integrity": "sha512-TCCj4t55U90khlYkVV/0TfkJkAkUg3jZFA3Neb7unZT8CPok7iiRfaX0F+WnqWqt7OxhOn0uBKXCw4lbL8W0aQ==",
      "dev": true,
      "dependencies": {
        "@babel/code-frame": "^7.27.1",
        "@babel/generator": "^7.28.5",
        "@babel/helper-globals": "^7.28.0",
        "@babel/parser": "^7.28.5",
        "@babel/template": "^7.27.2",
        "@babel/types": "^7.28.5",
        "debug": "^4.3.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/types": {
      "version": "7.28.5",
      "resolved": "https://registry.npmjs.org/@babel/types/-/types-7.28.5.tgz",
      "integrity": "sha512-qQ5m48eI/MFLQ5PxQj4PFaprjyCTLI37ElWMmNs0K8Lk3dVeOdNpB3ks8jc7yM5CDmVC73eMVk/trk3fgmrUpA==",
      "dev": true,
      "dependencies": {
        "@babel/helper-string-parser": "^7.27.1",
        "@babel/helper-validator-identifier": "^7.28.5"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@esbuild/android-arm": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/android-arm/-/android-arm-0.18.20.tgz",
      "integrity": "sha512-fyi7TDI/ijKKNZTUJAQqiG5T7YjJXgnzkURqmGj13C6dCqckZBLdl4h7bkhHt/t0WP+zO9/zwroDvANaOqO5Sw==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/android-arm64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/android-arm64/-/android-arm64-0.18.20.tgz",
      "integrity": "sha512-Nz4rJcchGDtENV0eMKUNa6L12zz2zBDXuhj/Vjh18zGqB44Bi7MBMSXjgunJgjRhCmKOjnPuZp4Mb6OKqtMHLQ==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/android-x64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/android-x64/-/android-x64-0.18.20.tgz",
      "integrity": "sha512-8GDdlePJA8D6zlZYJV/jnrRAi6rOiNaCC/JclcXpB+KIuvfBN4owLtgzY2bsxnx666XjJx2kDPUmnTtR8qKQUg==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/darwin-arm64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/darwin-arm64/-/darwin-arm64-0.18.20.tgz",
      "integrity": "sha512-bxRHW5kHU38zS2lPTPOyuyTm+S+eobPUnTNkdJEfAddYgEcll4xkT8DB9d2008DtTbl7uJag2HuE5NZAZgnNEA==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/darwin-x64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/darwin-x64/-/darwin-x64-0.18.20.tgz",
      "integrity": "sha512-pc5gxlMDxzm513qPGbCbDukOdsGtKhfxD1zJKXjCCcU7ju50O7MeAZ8c4krSJcOIJGFR+qx21yMMVYwiQvyTyQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/freebsd-arm64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/freebsd-arm64/-/freebsd-arm64-0.18.20.tgz",
      "integrity": "sha512-yqDQHy4QHevpMAaxhhIwYPMv1NECwOvIpGCZkECn8w2WFHXjEwrBn3CeNIYsibZ/iZEUemj++M26W3cNR5h+Tw==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "freebsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/freebsd-x64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/freebsd-x64/-/freebsd-x64-0.18.20.tgz",
      "integrity": "sha512-tgWRPPuQsd3RmBZwarGVHZQvtzfEBOreNuxEMKFcd5DaDn2PbBxfwLcj4+aenoh7ctXcbXmOQIn8HI6mCSw5MQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "freebsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-arm": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-arm/-/linux-arm-0.18.20.tgz",
      "integrity": "sha512-/5bHkMWnq1EgKr1V+Ybz3s1hWXok7mDFUMQ4cG10AfW3wL02PSZi5kFpYKrptDsgb2WAJIvRcDm+qIvXf/apvg==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-arm64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-arm64/-/linux-arm64-0.18.20.tgz",
      "integrity": "sha512-2YbscF+UL7SQAVIpnWvYwM+3LskyDmPhe31pE7/aoTMFKKzIc9lLbyGUpmmb8a8AixOL61sQ/mFh3jEjHYFvdA==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-ia32": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-ia32/-/linux-ia32-0.18.20.tgz",
      "integrity": "sha512-P4etWwq6IsReT0E1KHU40bOnzMHoH73aXp96Fs8TIT6z9Hu8G6+0SHSw9i2isWrD2nbx2qo5yUqACgdfVGx7TA==",
      "cpu": [
        "ia32"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-loong64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-loong64/-/linux-loong64-0.18.20.tgz",
      "integrity": "sha512-nXW8nqBTrOpDLPgPY9uV+/1DjxoQ7DoB2N8eocyq8I9XuqJ7BiAMDMf9n1xZM9TgW0J8zrquIb/A7s3BJv7rjg==",
      "cpu": [
        "loong64"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-mips64el": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-mips64el/-/linux-mips64el-0.18.20.tgz",
      "integrity": "sha512-d5NeaXZcHp8PzYy5VnXV3VSd2D328Zb+9dEq5HE6bw6+N86JVPExrA6O68OPwobntbNJ0pzCpUFZTo3w0GyetQ==",
      "cpu": [
        "mips64el"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-ppc64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-ppc64/-/linux-ppc64-0.18.20.tgz",
      "integrity": "sha512-WHPyeScRNcmANnLQkq6AfyXRFr5D6N2sKgkFo2FqguP44Nw2eyDlbTdZwd9GYk98DZG9QItIiTlFLHJHjxP3FA==",
      "cpu": [
        "ppc64"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-riscv64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-riscv64/-/linux-riscv64-0.18.20.tgz",
      "integrity": "sha512-WSxo6h5ecI5XH34KC7w5veNnKkju3zBRLEQNY7mv5mtBmrP/MjNBCAlsM2u5hDBlS3NGcTQpoBvRzqBcRtpq1A==",
      "cpu": [
        "riscv64"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-s390x": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-s390x/-/linux-s390x-0.18.20.tgz",
      "integrity": "sha512-+8231GMs3mAEth6Ja1iK0a1sQ3ohfcpzpRLH8uuc5/KVDFneH6jtAJLFGafpzpMRO6DzJ6AvXKze9LfFMrIHVQ==",
      "cpu": [
        "s390x"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-x64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-x64/-/linux-x64-0.18.20.tgz",
      "integrity": "sha512-UYqiqemphJcNsFEskc73jQ7B9jgwjWrSayxawS6UVFZGWrAAtkzjxSqnoclCXxWtfwLdzU+vTpcNYhpn43uP1w==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/netbsd-x64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/netbsd-x64/-/netbsd-x64-0.18.20.tgz",
      "integrity": "sha512-iO1c++VP6xUBUmltHZoMtCUdPlnPGdBom6IrO4gyKPFFVBKioIImVooR5I83nTew5UOYrk3gIJhbZh8X44y06A==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "netbsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/openbsd-x64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/openbsd-x64/-/openbsd-x64-0.18.20.tgz",
      "integrity": "sha512-e5e4YSsuQfX4cxcygw/UCPIEP6wbIL+se3sxPdCiMbFLBWu0eiZOJ7WoD+ptCLrmjZBK1Wk7I6D/I3NglUGOxg==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "openbsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/sunos-x64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/sunos-x64/-/sunos-x64-0.18.20.tgz",
      "integrity": "sha512-kDbFRFp0YpTQVVrqUd5FTYmWo45zGaXe0X8E1G/LKFC0v8x0vWrhOWSLITcCn63lmZIxfOMXtCfti/RxN/0wnQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "sunos"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/win32-arm64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-arm64/-/win32-arm64-0.18.20.tgz",
      "integrity": "sha512-ddYFR6ItYgoaq4v4JmQQaAI5s7npztfV4Ag6NrhiaW0RrnOXqBkgwZLofVTlq1daVTQNhtI5oieTvkRPfZrePg==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/win32-ia32": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-ia32/-/win32-ia32-0.18.20.tgz",
      "integrity": "sha512-Wv7QBi3ID/rROT08SABTS7eV4hX26sVduqDOTe1MvGMjNd3EjOz4b7zeexIR62GTIEKrfJXKL9LFxTYgkyeu7g==",
      "cpu": [
        "ia32"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/win32-x64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-x64/-/win32-x64-0.18.20.tgz",
      "integrity": "sha512-kTdfRcSiDfQca/y9QIkng02avJ+NCaQvrMejlsB3RRv5sE9rRoeBPISaZpKxHELzRxZyLvNts1P27W3wV+8geQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@floating-ui/core": {
      "version": "1.7.3",
      "resolved": "https://registry.npmjs.org/@floating-ui/core/-/core-1.7.3.tgz",
      "integrity": "sha512-sGnvb5dmrJaKEZ+LDIpguvdX3bDlEllmv4/ClQ9awcmCZrlx5jQyyMWFM5kBI+EyNOCDDiKk8il0zeuX3Zlg/w==",
      "dependencies": {
        "@floating-ui/utils": "^0.2.10"
      }
    },
    "node_modules/@floating-ui/dom": {
      "version": "1.7.4",
      "resolved": "https://registry.npmjs.org/@floating-ui/dom/-/dom-1.7.4.tgz",
      "integrity": "sha512-OOchDgh4F2CchOX94cRVqhvy7b3AFb+/rQXyswmzmGakRfkMgoWVjfnLWkRirfLEfuD4ysVW16eXzwt3jHIzKA==",
      "dependencies": {
        "@floating-ui/core": "^1.7.3",
        "@floating-ui/utils": "^0.2.10"
      }
    },
    "node_modules/@floating-ui/react": {
      "version": "0.27.16",
      "resolved": "https://registry.npmjs.org/@floating-ui/react/-/react-0.27.16.tgz",
      "integrity": "sha512-9O8N4SeG2z++TSM8QA/KTeKFBVCNEz/AGS7gWPJf6KFRzmRWixFRnCnkPHRDwSVZW6QPDO6uT0P2SpWNKCc9/g==",
      "dependencies": {
        "@floating-ui/react-dom": "^2.1.6",
        "@floating-ui/utils": "^0.2.10",
        "tabbable": "^6.0.0"
      },
      "peerDependencies": {
        "react": ">=17.0.0",
        "react-dom": ">=17.0.0"
      }
    },
    "node_modules/@floating-ui/react-dom": {
      "version": "2.1.6",
      "resolved": "https://registry.npmjs.org/@floating-ui/react-dom/-/react-dom-2.1.6.tgz",
      "integrity": "sha512-4JX6rEatQEvlmgU80wZyq9RT96HZJa88q8hp0pBd+LrczeDI4o6uA2M+uvxngVHo4Ihr8uibXxH6+70zhAFrVw==",
      "dependencies": {
        "@floating-ui/dom": "^1.7.4"
      },
      "peerDependencies": {
        "react": ">=16.8.0",
        "react-dom": ">=16.8.0"
      }
    },
    "node_modules/@floating-ui/utils": {
      "version": "0.2.10",
      "resolved": "https://registry.npmjs.org/@floating-ui/utils/-/utils-0.2.10.tgz",
      "integrity": "sha512-aGTxbpbg8/b5JfU1HXSrbH3wXZuLPJcNEcZQFMxLs3oSzgtVu6nFPkbbGGUvBcUjKV2YyB9Wxxabo+HEH9tcRQ=="
    },
    "node_modules/@isaacs/cliui": {
      "version": "8.0.2",
      "resolved": "https://registry.npmjs.org/@isaacs/cliui/-/cliui-8.0.2.tgz",
      "integrity": "sha512-O8jcjabXaleOG9DQ0+ARXWZBTfnP4WNAqzuiJK7ll44AmxGKv/J2M4TPjxjY3znBCfvBXFzucm1twdyFybFqEA==",
      "dev": true,
      "dependencies": {
        "string-width": "^5.1.2",
        "string-width-cjs": "npm:string-width@^4.2.0",
        "strip-ansi": "^7.0.1",
        "strip-ansi-cjs": "npm:strip-ansi@^6.0.1",
        "wrap-ansi": "^8.1.0",
        "wrap-ansi-cjs": "npm:wrap-ansi@^7.0.0"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@jridgewell/gen-mapping": {
      "version": "0.3.13",
      "resolved": "https://registry.npmjs.org/@jridgewell/gen-mapping/-/gen-mapping-0.3.13.tgz",
      "integrity": "sha512-2kkt/7niJ6MgEPxF0bYdQ6etZaA+fQvDcLKckhy1yIQOzaoKjBBjSj63/aLVjYE3qhRt5dvM+uUyfCg6UKCBbA==",
      "dev": true,
      "dependencies": {
        "@jridgewell/sourcemap-codec": "^1.5.0",
        "@jridgewell/trace-mapping": "^0.3.24"
      }
    },
    "node_modules/@jridgewell/remapping": {
      "version": "2.3.5",
      "resolved": "https://registry.npmjs.org/@jridgewell/remapping/-/remapping-2.3.5.tgz",
      "integrity": "sha512-LI9u/+laYG4Ds1TDKSJW2YPrIlcVYOwi2fUC6xB43lueCjgxV4lffOCZCtYFiH6TNOX+tQKXx97T4IKHbhyHEQ==",
      "dev": true,
      "dependencies": {
        "@jridgewell/gen-mapping": "^0.3.5",
        "@jridgewell/trace-mapping": "^0.3.24"
      }
    },
    "node_modules/@jridgewell/resolve-uri": {
      "version": "3.1.2",
      "resolved": "https://registry.npmjs.org/@jridgewell/resolve-uri/-/resolve-uri-3.1.2.tgz",
      "integrity": "sha512-bRISgCIjP20/tbWSPWMEi54QVPRZExkuD9lJL+UIxUKtwVJA8wW1Trb1jMs1RFXo1CBTNZ/5hpC9QvmKWdopKw==",
      "dev": true,
      "engines": {
        "node": ">=6.0.0"
      }
    },
    "node_modules/@jridgewell/sourcemap-codec": {
      "version": "1.5.5",
      "resolved": "https://registry.npmjs.org/@jridgewell/sourcemap-codec/-/sourcemap-codec-1.5.5.tgz",
      "integrity": "sha512-cYQ9310grqxueWbl+WuIUIaiUaDcj7WOq5fVhEljNVgRfOUhY9fy2zTvfoqWsnebh8Sl70VScFbICvJnLKB0Og==",
      "dev": true
    },
    "node_modules/@jridgewell/trace-mapping": {
      "version": "0.3.31",
      "resolved": "https://registry.npmjs.org/@jridgewell/trace-mapping/-/trace-mapping-0.3.31.tgz",
      "integrity": "sha512-zzNR+SdQSDJzc8joaeP8QQoCQr8NuYx2dIIytl1QeBEZHJ9uW6hebsrYgbz8hJwUQao3TWCMtmfV8Nu1twOLAw==",
      "dev": true,
      "dependencies": {
        "@jridgewell/resolve-uri": "^3.1.0",
        "@jridgewell/sourcemap-codec": "^1.4.14"
      }
    },
    "node_modules/@nodelib/fs.scandir": {
      "version": "2.1.5",
      "resolved": "https://registry.npmjs.org/@nodelib/fs.scandir/-/fs.scandir-2.1.5.tgz",
      "integrity": "sha512-vq24Bq3ym5HEQm2NKCr3yXDwjc7vTsEThRDnkp2DK9p1uqLR+DHurm/NOTo0KG7HYHU7eppKZj3MyqYuMBf62g==",
      "dev": true,
      "dependencies": {
        "@nodelib/fs.stat": "2.0.5",
        "run-parallel": "^1.1.9"
      },
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/@nodelib/fs.stat": {
      "version": "2.0.5",
      "resolved": "https://registry.npmjs.org/@nodelib/fs.stat/-/fs.stat-2.0.5.tgz",
      "integrity": "sha512-RkhPPp2zrqDAQA/2jNhnztcPAlv64XdhIp7a7454A5ovI7Bukxgt7MX7udwAu3zg1DcpPU0rz3VV1SeaqvY4+A==",
      "dev": true,
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/@nodelib/fs.walk": {
      "version": "1.2.8",
      "resolved": "https://registry.npmjs.org/@nodelib/fs.walk/-/fs.walk-1.2.8.tgz",
      "integrity": "sha512-oGB+UxlgWcgQkgwo8GcEGwemoTFt3FIO9ababBmaGwXIoBKZ+GTy0pP185beGg7Llih/NSHSV2XAs1lnznocSg==",
      "dev": true,
      "dependencies": {
        "@nodelib/fs.scandir": "2.1.5",
        "fastq": "^1.6.0"
      },
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/@pkgjs/parseargs": {
      "version": "0.11.0",
      "resolved": "https://registry.npmjs.org/@pkgjs/parseargs/-/parseargs-0.11.0.tgz",
      "integrity": "sha512-+1VkjdD0QBLPodGrJUeqarH8VAIvQODIbwh9XpP5Syisf7YoQgsJKPNFoqqLQlu+VQ/tVSshMR6loPMn8U+dPg==",
      "dev": true,
      "optional": true,
      "engines": {
        "node": ">=14"
      }
    },
    "node_modules/@reduxjs/toolkit": {
      "version": "2.9.2",
      "resolved": "https://registry.npmjs.org/@reduxjs/toolkit/-/toolkit-2.9.2.tgz",
      "integrity": "sha512-ZAYu/NXkl/OhqTz7rfPaAhY0+e8Fr15jqNxte/2exKUxvHyQ/hcqmdekiN1f+Lcw3pE+34FCgX+26zcUE3duCg==",
      "dependencies": {
        "@standard-schema/spec": "^1.0.0",
        "@standard-schema/utils": "^0.3.0",
        "immer": "^10.0.3",
        "redux": "^5.0.1",
        "redux-thunk": "^3.1.0",
        "reselect": "^5.1.0"
      },
      "peerDependencies": {
        "react": "^16.9.0 || ^17.0.0 || ^18 || ^19",
        "react-redux": "^7.2.1 || ^8.1.3 || ^9.0.0"
      },
      "peerDependenciesMeta": {
        "react": {
          "optional": true
        },
        "react-redux": {
          "optional": true
        }
      }
    },
    "node_modules/@remix-run/router": {
      "version": "1.14.2",
      "resolved": "https://registry.npmjs.org/@remix-run/router/-/router-1.14.2.tgz",
      "integrity": "sha512-ACXpdMM9hmKZww21yEqWwiLws/UPLhNKvimN8RrYSqPSvB3ov7sLvAcfvaxePeLvccTQKGdkDIhLYApZVDFuKg==",
      "engines": {
        "node": ">=14.0.0"
      }
    },
    "node_modules/@standard-schema/spec": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/@standard-schema/spec/-/spec-1.0.0.tgz",
      "integrity": "sha512-m2bOd0f2RT9k8QJx1JN85cZYyH1RqFBdlwtkSlf4tBDYLCiiZnv1fIIwacK6cqwXavOydf0NPToMQgpKq+dVlA=="
    },
    "node_modules/@standard-schema/utils": {
      "version": "0.3.0",
      "resolved": "https://registry.npmjs.org/@standard-schema/utils/-/utils-0.3.0.tgz",
      "integrity": "sha512-e7Mew686owMaPJVNNLs55PUvgz371nKgwsc4vxE49zsODpJEnxgxRo2y/OKrqueavXgZNMDVj3DdHFlaSAeU8g=="
    },
    "node_modules/@tailwindcss/aspect-ratio": {
      "version": "0.4.2",
      "resolved": "https://registry.npmjs.org/@tailwindcss/aspect-ratio/-/aspect-ratio-0.4.2.tgz",
      "integrity": "sha512-8QPrypskfBa7QIMuKHg2TA7BqES6vhBrDLOv8Unb6FcFyd3TjKbc6lcmb9UPQHxfl24sXoJ41ux/H7qQQvfaSQ==",
      "dev": true,
      "peerDependencies": {
        "tailwindcss": ">=2.0.0 || >=3.0.0 || >=3.0.0-alpha.1"
      }
    },
    "node_modules/@types/d3-array": {
      "version": "3.2.2",
      "resolved": "https://registry.npmjs.org/@types/d3-array/-/d3-array-3.2.2.tgz",
      "integrity": "sha512-hOLWVbm7uRza0BYXpIIW5pxfrKe0W+D5lrFiAEYR+pb6w3N2SwSMaJbXdUfSEv+dT4MfHBLtn5js0LAWaO6otw=="
    },
    "node_modules/@types/d3-color": {
      "version": "3.1.3",
      "resolved": "https://registry.npmjs.org/@types/d3-color/-/d3-color-3.1.3.tgz",
      "integrity": "sha512-iO90scth9WAbmgv7ogoq57O9YpKmFBbmoEoCHDB2xMBY0+/KVrqAaCDyCE16dUspeOvIxFFRI+0sEtqDqy2b4A=="
    },
    "node_modules/@types/d3-ease": {
      "version": "3.0.2",
      "resolved": "https://registry.npmjs.org/@types/d3-ease/-/d3-ease-3.0.2.tgz",
      "integrity": "sha512-NcV1JjO5oDzoK26oMzbILE6HW7uVXOHLQvHshBUW4UMdZGfiY6v5BeQwh9a9tCzv+CeefZQHJt5SRgK154RtiA=="
    },
    "node_modules/@types/d3-interpolate": {
      "version": "3.0.4",
      "resolved": "https://registry.npmjs.org/@types/d3-interpolate/-/d3-interpolate-3.0.4.tgz",
      "integrity": "sha512-mgLPETlrpVV1YRJIglr4Ez47g7Yxjl1lj7YKsiMCb27VJH9W8NVM6Bb9d8kkpG/uAQS5AmbA48q2IAolKKo1MA==",
      "dependencies": {
        "@types/d3-color": "*"
      }
    },
    "node_modules/@types/d3-path": {
      "version": "3.1.1",
      "resolved": "https://registry.npmjs.org/@types/d3-path/-/d3-path-3.1.1.tgz",
      "integrity": "sha512-VMZBYyQvbGmWyWVea0EHs/BwLgxc+MKi1zLDCONksozI4YJMcTt8ZEuIR4Sb1MMTE8MMW49v0IwI5+b7RmfWlg=="
    },
    "node_modules/@types/d3-scale": {
      "version": "4.0.9",
      "resolved": "https://registry.npmjs.org/@types/d3-scale/-/d3-scale-4.0.9.tgz",
      "integrity": "sha512-dLmtwB8zkAeO/juAMfnV+sItKjlsw2lKdZVVy6LRr0cBmegxSABiLEpGVmSJJ8O08i4+sGR6qQtb6WtuwJdvVw==",
      "dependencies": {
        "@types/d3-time": "*"
      }
    },
    "node_modules/@types/d3-shape": {
      "version": "3.1.7",
      "resolved": "https://registry.npmjs.org/@types/d3-shape/-/d3-shape-3.1.7.tgz",
      "integrity": "sha512-VLvUQ33C+3J+8p+Daf+nYSOsjB4GXp19/S/aGo60m9h1v6XaxjiT82lKVWJCfzhtuZ3yD7i/TPeC/fuKLLOSmg==",
      "dependencies": {
        "@types/d3-path": "*"
      }
    },
    "node_modules/@types/d3-time": {
      "version": "3.0.4",
      "resolved": "https://registry.npmjs.org/@types/d3-time/-/d3-time-3.0.4.tgz",
      "integrity": "sha512-yuzZug1nkAAaBlBBikKZTgzCeA+k1uy4ZFwWANOfKw5z5LRhV0gNA7gNkKm7HoK+HRN0wX3EkxGk0fpbWhmB7g=="
    },
    "node_modules/@types/d3-timer": {
      "version": "3.0.2",
      "resolved": "https://registry.npmjs.org/@types/d3-timer/-/d3-timer-3.0.2.tgz",
      "integrity": "sha512-Ps3T8E8dZDam6fUyNiMkekK3XUsaUEik+idO9/YjPtfj2qruF8tFBXS7XhtE4iIXBLxhmLjP3SXpLhVf21I9Lw=="
    },
    "node_modules/@types/use-sync-external-store": {
      "version": "0.0.6",
      "resolved": "https://registry.npmjs.org/@types/use-sync-external-store/-/use-sync-external-store-0.0.6.tgz",
      "integrity": "sha512-zFDAD+tlpf2r4asuHEj0XH6pY6i0g5NeAHPn+15wk3BV6JA69eERFXC1gyGThDkVa1zCyKr5jox1+2LbV/AMLg=="
    },
    "node_modules/@vitejs/plugin-react": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/@vitejs/plugin-react/-/plugin-react-4.0.0.tgz",
      "integrity": "sha512-HX0XzMjL3hhOYm+0s95pb0Z7F8O81G7joUHgfDd/9J/ZZf5k4xX6QAMFkKsHFxaHlf6X7GD7+XuaZ66ULiJuhQ==",
      "dev": true,
      "dependencies": {
        "@babel/core": "^7.21.4",
        "@babel/plugin-transform-react-jsx-self": "^7.21.0",
        "@babel/plugin-transform-react-jsx-source": "^7.19.6",
        "react-refresh": "^0.14.0"
      },
      "engines": {
        "node": "^14.18.0 || >=16.0.0"
      },
      "peerDependencies": {
        "vite": "^4.2.0"
      }
    },
    "node_modules/ansi-regex": {
      "version": "6.2.2",
      "resolved": "https://registry.npmjs.org/ansi-regex/-/ansi-regex-6.2.2.tgz",
      "integrity": "sha512-Bq3SmSpyFHaWjPk8If9yc6svM8c56dB5BAtW4Qbw5jHTwwXXcTLoRMkpDJp6VL0XzlWaCHTXrkFURMYmD0sLqg==",
      "dev": true,
      "engines": {
        "node": ">=12"
      },
      "funding": {
        "url": "https://github.com/chalk/ansi-regex?sponsor=1"
      }
    },
    "node_modules/ansi-styles": {
      "version": "6.2.3",
      "resolved": "https://registry.npmjs.org/ansi-styles/-/ansi-styles-6.2.3.tgz",
      "integrity": "sha512-4Dj6M28JB+oAH8kFkTLUo+a2jwOFkuqb3yucU0CANcRRUbxS0cP0nZYCGjcc3BNXwRIsUVmDGgzawme7zvJHvg==",
      "dev": true,
      "engines": {
        "node": ">=12"
      },
      "funding": {
        "url": "https://github.com/chalk/ansi-styles?sponsor=1"
      }
    },
    "node_modules/any-promise": {
      "version": "1.3.0",
      "resolved": "https://registry.npmjs.org/any-promise/-/any-promise-1.3.0.tgz",
      "integrity": "sha512-7UvmKalWRt1wgjL1RrGxoSJW/0QZFIegpeGvZG9kjp8vrRu55XTHbwnqq2GpXm9uLbcuhxm3IqX9OB4MZR1b2A==",
      "dev": true
    },
    "node_modules/anymatch": {
      "version": "3.1.3",
      "resolved": "https://registry.npmjs.org/anymatch/-/anymatch-3.1.3.tgz",
      "integrity": "sha512-KMReFUr0B4t+D+OBkjR3KYqvocp2XaSzO55UcB6mgQMd3KbcE+mWTyvVV7D/zsdEbNnV6acZUutkiHQXvTr1Rw==",
      "dev": true,
      "dependencies": {
        "normalize-path": "^3.0.0",
        "picomatch": "^2.0.4"
      },
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/arg": {
      "version": "5.0.2",
      "resolved": "https://registry.npmjs.org/arg/-/arg-5.0.2.tgz",
      "integrity": "sha512-PYjyFOLKQ9y57JvQ6QLo8dAgNqswh8M1RMJYdQduT6xbWSgK36P/Z/v+p888pM69jMMfS8Xd8F6I1kQ/I9HUGg==",
      "dev": true
    },
    "node_modules/asynckit": {
      "version": "0.4.0",
      "resolved": "https://registry.npmjs.org/asynckit/-/asynckit-0.4.0.tgz",
      "integrity": "sha512-Oei9OH4tRh0YqU3GxhX79dM/mwVgvbZJaSNaRk+bshkj0S5cfHcgYakreBjrHwatXKbz+IoIdYLxrKim2MjW0Q=="
    },
    "node_modules/autoprefixer": {
      "version": "10.4.21",
      "resolved": "https://registry.npmjs.org/autoprefixer/-/autoprefixer-10.4.21.tgz",
      "integrity": "sha512-O+A6LWV5LDHSJD3LjHYoNi4VLsj/Whi7k6zG12xTYaU4cQ8oxQGckXNX8cRHK5yOZ/ppVHe0ZBXGzSV9jXdVbQ==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/postcss/"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/autoprefixer"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "dependencies": {
        "browserslist": "^4.24.4",
        "caniuse-lite": "^1.0.30001702",
        "fraction.js": "^4.3.7",
        "normalize-range": "^0.1.2",
        "picocolors": "^1.1.1",
        "postcss-value-parser": "^4.2.0"
      },
      "bin": {
        "autoprefixer": "bin/autoprefixer"
      },
      "engines": {
        "node": "^10 || ^12 || >=14"
      },
      "peerDependencies": {
        "postcss": "^8.1.0"
      }
    },
    "node_modules/axios": {
      "version": "1.13.0",
      "resolved": "https://registry.npmjs.org/axios/-/axios-1.13.0.tgz",
      "integrity": "sha512-zt40Pz4zcRXra9CVV31KeyofwiNvAbJ5B6YPz9pMJ+yOSLikvPT4Yi5LjfgjRa9CawVYBaD1JQzIVcIvBejKeA==",
      "dependencies": {
        "follow-redirects": "^1.15.6",
        "form-data": "^4.0.4",
        "proxy-from-env": "^1.1.0"
      }
    },
    "node_modules/balanced-match": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/balanced-match/-/balanced-match-1.0.2.tgz",
      "integrity": "sha512-3oSeUO0TMV67hN1AmbXsK4yaqU7tjiHlbxRDZOpH0KW9+CeX4bRAaX0Anxt0tx2MrpRpWwQaPwIlISEJhYU5Pw==",
      "dev": true
    },
    "node_modules/baseline-browser-mapping": {
      "version": "2.8.20",
      "resolved": "https://registry.npmjs.org/baseline-browser-mapping/-/baseline-browser-mapping-2.8.20.tgz",
      "integrity": "sha512-JMWsdF+O8Orq3EMukbUN1QfbLK9mX2CkUmQBcW2T0s8OmdAUL5LLM/6wFwSrqXzlXB13yhyK9gTKS1rIizOduQ==",
      "dev": true,
      "bin": {
        "baseline-browser-mapping": "dist/cli.js"
      }
    },
    "node_modules/binary-extensions": {
      "version": "2.3.0",
      "resolved": "https://registry.npmjs.org/binary-extensions/-/binary-extensions-2.3.0.tgz",
      "integrity": "sha512-Ceh+7ox5qe7LJuLHoY0feh3pHuUDHAcRUeyL2VYghZwfpkNIy/+8Ocg0a3UuSoYzavmylwuLWQOf3hl0jjMMIw==",
      "dev": true,
      "engines": {
        "node": ">=8"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/brace-expansion": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/brace-expansion/-/brace-expansion-2.0.2.tgz",
      "integrity": "sha512-Jt0vHyM+jmUBqojB7E1NIYadt0vI0Qxjxd2TErW94wDz+E2LAm5vKMXXwg6ZZBTHPuUlDgQHKXvjGBdfcF1ZDQ==",
      "dev": true,
      "dependencies": {
        "balanced-match": "^1.0.0"
      }
    },
    "node_modules/braces": {
      "version": "3.0.3",
      "resolved": "https://registry.npmjs.org/braces/-/braces-3.0.3.tgz",
      "integrity": "sha512-yQbXgO/OSZVD2IsiLlro+7Hf6Q18EJrKSEsdoMzKePKXct3gvD8oLcOQdIzGupr5Fj+EDe8gO/lxc1BzfMpxvA==",
      "dev": true,
      "dependencies": {
        "fill-range": "^7.1.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/browserslist": {
      "version": "4.27.0",
      "resolved": "https://registry.npmjs.org/browserslist/-/browserslist-4.27.0.tgz",
      "integrity": "sha512-AXVQwdhot1eqLihwasPElhX2tAZiBjWdJ9i/Zcj2S6QYIjkx62OKSfnobkriB81C3l4w0rVy3Nt4jaTBltYEpw==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/browserslist"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/browserslist"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "dependencies": {
        "baseline-browser-mapping": "^2.8.19",
        "caniuse-lite": "^1.0.30001751",
        "electron-to-chromium": "^1.5.238",
        "node-releases": "^2.0.26",
        "update-browserslist-db": "^1.1.4"
      },
      "bin": {
        "browserslist": "cli.js"
      },
      "engines": {
        "node": "^6 || ^7 || ^8 || ^9 || ^10 || ^11 || ^12 || >=13.7"
      }
    },
    "node_modules/call-bind-apply-helpers": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/call-bind-apply-helpers/-/call-bind-apply-helpers-1.0.2.tgz",
      "integrity": "sha512-Sp1ablJ0ivDkSzjcaJdxEunN5/XvksFJ2sMBFfq6x0ryhQV/2b/KwFe21cMpmHtPOSij8K99/wSfoEuTObmuMQ==",
      "dependencies": {
        "es-errors": "^1.3.0",
        "function-bind": "^1.1.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/camelcase-css": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/camelcase-css/-/camelcase-css-2.0.1.tgz",
      "integrity": "sha512-QOSvevhslijgYwRx6Rv7zKdMF8lbRmx+uQGx2+vDc+KI/eBnsy9kit5aj23AgGu3pa4t9AgwbnXWqS+iOY+2aA==",
      "dev": true,
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/caniuse-lite": {
      "version": "1.0.30001751",
      "resolved": "https://registry.npmjs.org/caniuse-lite/-/caniuse-lite-1.0.30001751.tgz",
      "integrity": "sha512-A0QJhug0Ly64Ii3eIqHu5X51ebln3k4yTUkY1j8drqpWHVreg/VLijN48cZ1bYPiqOQuqpkIKnzr/Ul8V+p6Cw==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/browserslist"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/caniuse-lite"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ]
    },
    "node_modules/chokidar": {
      "version": "3.6.0",
      "resolved": "https://registry.npmjs.org/chokidar/-/chokidar-3.6.0.tgz",
      "integrity": "sha512-7VT13fmjotKpGipCW9JEQAusEPE+Ei8nl6/g4FBAmIm0GOOLMua9NDDo/DWp0ZAxCr3cPq5ZpBqmPAQgDda2Pw==",
      "dev": true,
      "dependencies": {
        "anymatch": "~3.1.2",
        "braces": "~3.0.2",
        "glob-parent": "~5.1.2",
        "is-binary-path": "~2.1.0",
        "is-glob": "~4.0.1",
        "normalize-path": "~3.0.0",
        "readdirp": "~3.6.0"
      },
      "engines": {
        "node": ">= 8.10.0"
      },
      "funding": {
        "url": "https://paulmillr.com/funding/"
      },
      "optionalDependencies": {
        "fsevents": "~2.3.2"
      }
    },
    "node_modules/chokidar/node_modules/glob-parent": {
      "version": "5.1.2",
      "resolved": "https://registry.npmjs.org/glob-parent/-/glob-parent-5.1.2.tgz",
      "integrity": "sha512-AOIgSQCepiJYwP3ARnGx+5VnTu2HBYdzbGP45eLw1vr3zB3vZLeyed1sC9hnbcOc9/SrMyM5RPQrkGz4aS9Zow==",
      "dev": true,
      "dependencies": {
        "is-glob": "^4.0.1"
      },
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/clsx": {
      "version": "2.1.1",
      "resolved": "https://registry.npmjs.org/clsx/-/clsx-2.1.1.tgz",
      "integrity": "sha512-eYm0QWBtUrBWZWG0d386OGAw16Z995PiOVo2B7bjWSbHedGl5e0ZWaq65kOGgUSNesEIDkB9ISbTg/JK9dhCZA==",
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/color-convert": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/color-convert/-/color-convert-2.0.1.tgz",
      "integrity": "sha512-RRECPsj7iu/xb5oKYcsFHSppFNnsj/52OVTRKb4zP5onXwVF3zVmmToNcOfGC+CRDpfK/U584fMg38ZHCaElKQ==",
      "dev": true,
      "dependencies": {
        "color-name": "~1.1.4"
      },
      "engines": {
        "node": ">=7.0.0"
      }
    },
    "node_modules/color-name": {
      "version": "1.1.4",
      "resolved": "https://registry.npmjs.org/color-name/-/color-name-1.1.4.tgz",
      "integrity": "sha512-dOy+3AuW3a2wNbZHIuMZpTcgjGuLU/uBL/ubcZF9OXbDo8ff4O8yVp5Bf0efS8uEoYo5q4Fx7dY9OgQGXgAsQA==",
      "dev": true
    },
    "node_modules/combined-stream": {
      "version": "1.0.8",
      "resolved": "https://registry.npmjs.org/combined-stream/-/combined-stream-1.0.8.tgz",
      "integrity": "sha512-FQN4MRfuJeHf7cBbBMJFXhKSDq+2kAArBlmRBvcvFE5BB1HZKXtSFASDhdlz9zOYwxh8lDdnvmMOe/+5cdoEdg==",
      "dependencies": {
        "delayed-stream": "~1.0.0"
      },
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/commander": {
      "version": "4.1.1",
      "resolved": "https://registry.npmjs.org/commander/-/commander-4.1.1.tgz",
      "integrity": "sha512-NOKm8xhkzAjzFx8B2v5OAHT+u5pRQc2UCa2Vq9jYL/31o2wi9mxBA7LIFs3sV5VSC49z6pEhfbMULvShKj26WA==",
      "dev": true,
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/convert-source-map": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/convert-source-map/-/convert-source-map-2.0.0.tgz",
      "integrity": "sha512-Kvp459HrV2FEJ1CAsi1Ku+MY3kasH19TFykTz2xWmMeq6bk2NU3XXvfJ+Q61m0xktWwt+1HSYf3JZsTms3aRJg==",
      "dev": true
    },
    "node_modules/countup.js": {
      "version": "2.9.0",
      "resolved": "https://registry.npmjs.org/countup.js/-/countup.js-2.9.0.tgz",
      "integrity": "sha512-llqrvyXztRFPp6+i8jx25phHWcVWhrHO4Nlt0uAOSKHB8778zzQswa4MU3qKBvkXfJKftRYFJuVHez67lyKdHg=="
    },
    "node_modules/cross-spawn": {
      "version": "7.0.6",
      "resolved": "https://registry.npmjs.org/cross-spawn/-/cross-spawn-7.0.6.tgz",
      "integrity": "sha512-uV2QOWP2nWzsy2aMp8aRibhi9dlzF5Hgh5SHaB9OiTGEyDTiJJyx0uy51QXdyWbtAHNua4XJzUKca3OzKUd3vA==",
      "dev": true,
      "dependencies": {
        "path-key": "^3.1.0",
        "shebang-command": "^2.0.0",
        "which": "^2.0.1"
      },
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/cssesc": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/cssesc/-/cssesc-3.0.0.tgz",
      "integrity": "sha512-/Tb/JcjK111nNScGob5MNtsntNM1aCNUDipB/TkwZFhyDrrE47SOx/18wF2bbjgc3ZzCSKW1T5nt5EbFoAz/Vg==",
      "dev": true,
      "bin": {
        "cssesc": "bin/cssesc"
      },
      "engines": {
        "node": ">=4"
      }
    },
    "node_modules/d3-array": {
      "version": "3.2.4",
      "resolved": "https://registry.npmjs.org/d3-array/-/d3-array-3.2.4.tgz",
      "integrity": "sha512-tdQAmyA18i4J7wprpYq8ClcxZy3SC31QMeByyCFyRt7BVHdREQZ5lpzoe5mFEYZUWe+oq8HBvk9JjpibyEV4Jg==",
      "dependencies": {
        "internmap": "1 - 2"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-color": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/d3-color/-/d3-color-3.1.0.tgz",
      "integrity": "sha512-zg/chbXyeBtMQ1LbD/WSoW2DpC3I0mpmPdW+ynRTj/x2DAWYrIY7qeZIHidozwV24m4iavr15lNwIwLxRmOxhA==",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-ease": {
      "version": "3.0.1",
      "resolved": "https://registry.npmjs.org/d3-ease/-/d3-ease-3.0.1.tgz",
      "integrity": "sha512-wR/XK3D3XcLIZwpbvQwQ5fK+8Ykds1ip7A2Txe0yxncXSdq1L9skcG7blcedkOX+ZcgxGAmLX1FrRGbADwzi0w==",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-format": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/d3-format/-/d3-format-3.1.0.tgz",
      "integrity": "sha512-YyUI6AEuY/Wpt8KWLgZHsIU86atmikuoOmCfommt0LYHiQSPjvX2AcFc38PX0CBpr2RCyZhjex+NS/LPOv6YqA==",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-interpolate": {
      "version": "3.0.1",
      "resolved": "https://registry.npmjs.org/d3-interpolate/-/d3-interpolate-3.0.1.tgz",
      "integrity": "sha512-3bYs1rOD33uo8aqJfKP3JWPAibgw8Zm2+L9vBKEHJ2Rg+viTR7o5Mmv5mZcieN+FRYaAOWX5SJATX6k1PWz72g==",
      "dependencies": {
        "d3-color": "1 - 3"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-path": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/d3-path/-/d3-path-3.1.0.tgz",
      "integrity": "sha512-p3KP5HCf/bvjBSSKuXid6Zqijx7wIfNW+J/maPs+iwR35at5JCbLUT0LzF1cnjbCHWhqzQTIN2Jpe8pRebIEFQ==",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-scale": {
      "version": "4.0.2",
      "resolved": "https://registry.npmjs.org/d3-scale/-/d3-scale-4.0.2.tgz",
      "integrity": "sha512-GZW464g1SH7ag3Y7hXjf8RoUuAFIqklOAq3MRl4OaWabTFJY9PN/E1YklhXLh+OQ3fM9yS2nOkCoS+WLZ6kvxQ==",
      "dependencies": {
        "d3-array": "2.10.0 - 3",
        "d3-format": "1 - 3",
        "d3-interpolate": "1.2.0 - 3",
        "d3-time": "2.1.1 - 3",
        "d3-time-format": "2 - 4"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-shape": {
      "version": "3.2.0",
      "resolved": "https://registry.npmjs.org/d3-shape/-/d3-shape-3.2.0.tgz",
      "integrity": "sha512-SaLBuwGm3MOViRq2ABk3eLoxwZELpH6zhl3FbAoJ7Vm1gofKx6El1Ib5z23NUEhF9AsGl7y+dzLe5Cw2AArGTA==",
      "dependencies": {
        "d3-path": "^3.1.0"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-time": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/d3-time/-/d3-time-3.1.0.tgz",
      "integrity": "sha512-VqKjzBLejbSMT4IgbmVgDjpkYrNWUYJnbCGo874u7MMKIWsILRX+OpX/gTk8MqjpT1A/c6HY2dCA77ZN0lkQ2Q==",
      "dependencies": {
        "d3-array": "2 - 3"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-time-format": {
      "version": "4.1.0",
      "resolved": "https://registry.npmjs.org/d3-time-format/-/d3-time-format-4.1.0.tgz",
      "integrity": "sha512-dJxPBlzC7NugB2PDLwo9Q8JiTR3M3e4/XANkreKSUxF8vvXKqm1Yfq4Q5dl8budlunRVlUUaDUgFt7eA8D6NLg==",
      "dependencies": {
        "d3-time": "1 - 3"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-timer": {
      "version": "3.0.1",
      "resolved": "https://registry.npmjs.org/d3-timer/-/d3-timer-3.0.1.tgz",
      "integrity": "sha512-ndfJ/JxxMd3nw31uyKoY2naivF+r29V+Lc0svZxe1JvvIRmi8hUsrMvdOwgS1o6uBHmiz91geQ0ylPP0aj1VUA==",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/date-fns": {
      "version": "4.1.0",
      "resolved": "https://registry.npmjs.org/date-fns/-/date-fns-4.1.0.tgz",
      "integrity": "sha512-Ukq0owbQXxa/U3EGtsdVBkR1w7KOQ5gIBqdH2hkvknzZPYvBxb/aa6E8L7tmjFtkwZBu3UXBbjIgPo/Ez4xaNg==",
      "funding": {
        "type": "github",
        "url": "https://github.com/sponsors/kossnocorp"
      }
    },
    "node_modules/debug": {
      "version": "4.4.3",
      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
      "dev": true,
      "dependencies": {
        "ms": "^2.1.3"
      },
      "engines": {
        "node": ">=6.0"
      },
      "peerDependenciesMeta": {
        "supports-color": {
          "optional": true
        }
      }
    },
    "node_modules/decimal.js-light": {
      "version": "2.5.1",
      "resolved": "https://registry.npmjs.org/decimal.js-light/-/decimal.js-light-2.5.1.tgz",
      "integrity": "sha512-qIMFpTMZmny+MMIitAB6D7iVPEorVw6YQRWkvarTkT4tBeSLLiHzcwj6q0MmYSFCiVpiqPJTJEYIrpcPzVEIvg=="
    },
    "node_modules/delayed-stream": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/delayed-stream/-/delayed-stream-1.0.0.tgz",
      "integrity": "sha512-ZySD7Nf91aLB0RxL4KGrKHBXl7Eds1DAmEdcoVawXnLD7SDhpNgtuII2aAkg7a7QS41jxPSZ17p4VdGnMHk3MQ==",
      "engines": {
        "node": ">=0.4.0"
      }
    },
    "node_modules/didyoumean": {
      "version": "1.2.2",
      "resolved": "https://registry.npmjs.org/didyoumean/-/didyoumean-1.2.2.tgz",
      "integrity": "sha512-gxtyfqMg7GKyhQmb056K7M3xszy/myH8w+B4RT+QXBQsvAOdc3XymqDDPHx1BgPgsdAA5SIifona89YtRATDzw==",
      "dev": true
    },
    "node_modules/dlv": {
      "version": "1.1.3",
      "resolved": "https://registry.npmjs.org/dlv/-/dlv-1.1.3.tgz",
      "integrity": "sha512-+HlytyjlPKnIG8XuRG8WvmBP8xs8P71y+SKKS6ZXWoEgLuePxtDoUEiH7WkdePWrQ5JBpE6aoVqfZfJUQkjXwA==",
      "dev": true
    },
    "node_modules/dunder-proto": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/dunder-proto/-/dunder-proto-1.0.1.tgz",
      "integrity": "sha512-KIN/nDJBQRcXw0MLVhZE9iQHmG68qAVIBg9CqmUYjmQIhgij9U5MFvrqkUL5FbtyyzZuOeOt0zdeRe4UY7ct+A==",
      "dependencies": {
        "call-bind-apply-helpers": "^1.0.1",
        "es-errors": "^1.3.0",
        "gopd": "^1.2.0"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/eastasianwidth": {
      "version": "0.2.0",
      "resolved": "https://registry.npmjs.org/eastasianwidth/-/eastasianwidth-0.2.0.tgz",
      "integrity": "sha512-I88TYZWc9XiYHRQ4/3c5rjjfgkjhLyW2luGIheGERbNQ6OY7yTybanSpDXZa8y7VUP9YmDcYa+eyq4ca7iLqWA==",
      "dev": true
    },
    "node_modules/electron-to-chromium": {
      "version": "1.5.241",
      "resolved": "https://registry.npmjs.org/electron-to-chromium/-/electron-to-chromium-1.5.241.tgz",
      "integrity": "sha512-ILMvKX/ZV5WIJzzdtuHg8xquk2y0BOGlFOxBVwTpbiXqWIH0hamG45ddU4R3PQ0gYu+xgo0vdHXHli9sHIGb4w==",
      "dev": true
    },
    "node_modules/emoji-regex": {
      "version": "9.2.2",
      "resolved": "https://registry.npmjs.org/emoji-regex/-/emoji-regex-9.2.2.tgz",
      "integrity": "sha512-L18DaJsXSUk2+42pv8mLs5jJT2hqFkFE4j21wOmgbUqsZ2hL72NsUU785g9RXgo3s0ZNgVl42TiHp3ZtOv/Vyg==",
      "dev": true
    },
    "node_modules/es-define-property": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/es-define-property/-/es-define-property-1.0.1.tgz",
      "integrity": "sha512-e3nRfgfUZ4rNGL232gUgX06QNyyez04KdjFrF+LTRoOXmrOgFKDg4BCdsjW8EnT69eqdYGmRpJwiPVYNrCaW3g==",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-errors": {
      "version": "1.3.0",
      "resolved": "https://registry.npmjs.org/es-errors/-/es-errors-1.3.0.tgz",
      "integrity": "sha512-Zf5H2Kxt2xjTvbJvP2ZWLEICxA6j+hAmMzIlypy4xcBg1vKVnx89Wy0GbS+kf5cwCVFFzdCFh2XSCFNULS6csw==",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-object-atoms": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/es-object-atoms/-/es-object-atoms-1.1.1.tgz",
      "integrity": "sha512-FGgH2h8zKNim9ljj7dankFPcICIK9Cp5bm+c2gQSYePhpaG5+esrLODihIorn+Pe6FGJzWhXQotPv73jTaldXA==",
      "dependencies": {
        "es-errors": "^1.3.0"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-set-tostringtag": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/es-set-tostringtag/-/es-set-tostringtag-2.1.0.tgz",
      "integrity": "sha512-j6vWzfrGVfyXxge+O0x5sh6cvxAog0a/4Rdd2K36zCMV5eJ+/+tOAngRO8cODMNWbVRdVlmGZQL2YS3yR8bIUA==",
      "dependencies": {
        "es-errors": "^1.3.0",
        "get-intrinsic": "^1.2.6",
        "has-tostringtag": "^1.0.2",
        "hasown": "^2.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-toolkit": {
      "version": "1.41.0",
      "resolved": "https://registry.npmjs.org/es-toolkit/-/es-toolkit-1.41.0.tgz",
      "integrity": "sha512-bDd3oRmbVgqZCJS6WmeQieOrzpl3URcWBUVDXxOELlUW2FuW+0glPOz1n0KnRie+PdyvUZcXz2sOn00c6pPRIA==",
      "workspaces": [
        "docs",
        "benchmarks"
      ]
    },
    "node_modules/esbuild": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/esbuild/-/esbuild-0.18.20.tgz",
      "integrity": "sha512-ceqxoedUrcayh7Y7ZX6NdbbDzGROiyVBgC4PriJThBKSVPWnnFHZAkfI1lJT8QFkOwH4qOS2SJkS4wvpGl8BpA==",
      "dev": true,
      "hasInstallScript": true,
      "bin": {
        "esbuild": "bin/esbuild"
      },
      "engines": {
        "node": ">=12"
      },
      "optionalDependencies": {
        "@esbuild/android-arm": "0.18.20",
        "@esbuild/android-arm64": "0.18.20",
        "@esbuild/android-x64": "0.18.20",
        "@esbuild/darwin-arm64": "0.18.20",
        "@esbuild/darwin-x64": "0.18.20",
        "@esbuild/freebsd-arm64": "0.18.20",
        "@esbuild/freebsd-x64": "0.18.20",
        "@esbuild/linux-arm": "0.18.20",
        "@esbuild/linux-arm64": "0.18.20",
        "@esbuild/linux-ia32": "0.18.20",
        "@esbuild/linux-loong64": "0.18.20",
        "@esbuild/linux-mips64el": "0.18.20",
        "@esbuild/linux-ppc64": "0.18.20",
        "@esbuild/linux-riscv64": "0.18.20",
        "@esbuild/linux-s390x": "0.18.20",
        "@esbuild/linux-x64": "0.18.20",
        "@esbuild/netbsd-x64": "0.18.20",
        "@esbuild/openbsd-x64": "0.18.20",
        "@esbuild/sunos-x64": "0.18.20",
        "@esbuild/win32-arm64": "0.18.20",
        "@esbuild/win32-ia32": "0.18.20",
        "@esbuild/win32-x64": "0.18.20"
      }
    },
    "node_modules/escalade": {
      "version": "3.2.0",
      "resolved": "https://registry.npmjs.org/escalade/-/escalade-3.2.0.tgz",
      "integrity": "sha512-WUj2qlxaQtO4g6Pq5c29GTcWGDyd8itL8zTlipgECz3JesAiiOKotd8JU6otB3PACgG6xkJUyVhboMS+bje/jA==",
      "dev": true,
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/eventemitter3": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/eventemitter3/-/eventemitter3-5.0.1.tgz",
      "integrity": "sha512-GWkBvjiSZK87ELrYOSESUYeVIc9mvLLf/nXalMOS5dYrgZq9o5OVkbZAVM06CVxYsCwH9BDZFPlQTlPA1j4ahA=="
    },
    "node_modules/fast-glob": {
      "version": "3.3.3",
      "resolved": "https://registry.npmjs.org/fast-glob/-/fast-glob-3.3.3.tgz",
      "integrity": "sha512-7MptL8U0cqcFdzIzwOTHoilX9x5BrNqye7Z/LuC7kCMRio1EMSyqRK3BEAUD7sXRq4iT4AzTVuZdhgQ2TCvYLg==",
      "dev": true,
      "dependencies": {
        "@nodelib/fs.stat": "^2.0.2",
        "@nodelib/fs.walk": "^1.2.3",
        "glob-parent": "^5.1.2",
        "merge2": "^1.3.0",
        "micromatch": "^4.0.8"
      },
      "engines": {
        "node": ">=8.6.0"
      }
    },
    "node_modules/fast-glob/node_modules/glob-parent": {
      "version": "5.1.2",
      "resolved": "https://registry.npmjs.org/glob-parent/-/glob-parent-5.1.2.tgz",
      "integrity": "sha512-AOIgSQCepiJYwP3ARnGx+5VnTu2HBYdzbGP45eLw1vr3zB3vZLeyed1sC9hnbcOc9/SrMyM5RPQrkGz4aS9Zow==",
      "dev": true,
      "dependencies": {
        "is-glob": "^4.0.1"
      },
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/fastq": {
      "version": "1.19.1",
      "resolved": "https://registry.npmjs.org/fastq/-/fastq-1.19.1.tgz",
      "integrity": "sha512-GwLTyxkCXjXbxqIhTsMI2Nui8huMPtnxg7krajPJAjnEG/iiOS7i+zCtWGZR9G0NBKbXKh6X9m9UIsYX/N6vvQ==",
      "dev": true,
      "dependencies": {
        "reusify": "^1.0.4"
      }
    },
    "node_modules/fill-range": {
      "version": "7.1.1",
      "resolved": "https://registry.npmjs.org/fill-range/-/fill-range-7.1.1.tgz",
      "integrity": "sha512-YsGpe3WHLK8ZYi4tWDg2Jy3ebRz2rXowDxnld4bkQB00cc/1Zw9AWnC0i9ztDJitivtQvaI9KaLyKrc+hBW0yg==",
      "dev": true,
      "dependencies": {
        "to-regex-range": "^5.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/follow-redirects": {
      "version": "1.15.11",
      "resolved": "https://registry.npmjs.org/follow-redirects/-/follow-redirects-1.15.11.tgz",
      "integrity": "sha512-deG2P0JfjrTxl50XGCDyfI97ZGVCxIpfKYmfyrQ54n5FO/0gfIES8C/Psl6kWVDolizcaaxZJnTS0QSMxvnsBQ==",
      "funding": [
        {
          "type": "individual",
          "url": "https://github.com/sponsors/RubenVerborgh"
        }
      ],
      "engines": {
        "node": ">=4.0"
      },
      "peerDependenciesMeta": {
        "debug": {
          "optional": true
        }
      }
    },
    "node_modules/foreground-child": {
      "version": "3.3.1",
      "resolved": "https://registry.npmjs.org/foreground-child/-/foreground-child-3.3.1.tgz",
      "integrity": "sha512-gIXjKqtFuWEgzFRJA9WCQeSJLZDjgJUOMCMzxtvFq/37KojM1BFGufqsCy0r4qSQmYLsZYMeyRqzIWOMup03sw==",
      "dev": true,
      "dependencies": {
        "cross-spawn": "^7.0.6",
        "signal-exit": "^4.0.1"
      },
      "engines": {
        "node": ">=14"
      },
      "funding": {
        "url": "https://github.com/sponsors/isaacs"
      }
    },
    "node_modules/form-data": {
      "version": "4.0.4",
      "resolved": "https://registry.npmjs.org/form-data/-/form-data-4.0.4.tgz",
      "integrity": "sha512-KrGhL9Q4zjj0kiUt5OO4Mr/A/jlI2jDYs5eHBpYHPcBEVSiipAvn2Ko2HnPe20rmcuuvMHNdZFp+4IlGTMF0Ow==",
      "dependencies": {
        "asynckit": "^0.4.0",
        "combined-stream": "^1.0.8",
        "es-set-tostringtag": "^2.1.0",
        "hasown": "^2.0.2",
        "mime-types": "^2.1.12"
      },
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/fraction.js": {
      "version": "4.3.7",
      "resolved": "https://registry.npmjs.org/fraction.js/-/fraction.js-4.3.7.tgz",
      "integrity": "sha512-ZsDfxO51wGAXREY55a7la9LScWpwv9RxIrYABrlvOFBlH/ShPnrtsXeuUIfXKKOVicNxQ+o8JTbJvjS4M89yew==",
      "dev": true,
      "engines": {
        "node": "*"
      },
      "funding": {
        "type": "patreon",
        "url": "https://github.com/sponsors/rawify"
      }
    },
    "node_modules/framer-motion": {
      "version": "12.23.24",
      "resolved": "https://registry.npmjs.org/framer-motion/-/framer-motion-12.23.24.tgz",
      "integrity": "sha512-HMi5HRoRCTou+3fb3h9oTLyJGBxHfW+HnNE25tAXOvVx/IvwMHK0cx7IR4a2ZU6sh3IX1Z+4ts32PcYBOqka8w==",
      "dependencies": {
        "motion-dom": "^12.23.23",
        "motion-utils": "^12.23.6",
        "tslib": "^2.4.0"
      },
      "peerDependencies": {
        "@emotion/is-prop-valid": "*",
        "react": "^18.0.0 || ^19.0.0",
        "react-dom": "^18.0.0 || ^19.0.0"
      },
      "peerDependenciesMeta": {
        "@emotion/is-prop-valid": {
          "optional": true
        },
        "react": {
          "optional": true
        },
        "react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/fsevents": {
      "version": "2.3.3",
      "resolved": "https://registry.npmjs.org/fsevents/-/fsevents-2.3.3.tgz",
      "integrity": "sha512-5xoDfX+fL7faATnagmWPpbFtwh/R77WmMMqqHGS65C3vvB0YHrgF+B1YmZ3441tMj5n63k0212XNoJwzlhffQw==",
      "dev": true,
      "hasInstallScript": true,
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": "^8.16.0 || ^10.6.0 || >=11.0.0"
      }
    },
    "node_modules/function-bind": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/function-bind/-/function-bind-1.1.2.tgz",
      "integrity": "sha512-7XHNxH7qX9xG5mIwxkhumTox/MIRNcOgDrxWsMt2pAr23WHp6MrRlN7FBSFpCpr+oVO0F744iUgR82nJMfG2SA==",
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/fuse.js": {
      "version": "7.1.0",
      "resolved": "https://registry.npmjs.org/fuse.js/-/fuse.js-7.1.0.tgz",
      "integrity": "sha512-trLf4SzuuUxfusZADLINj+dE8clK1frKdmqiJNb1Es75fmI5oY6X2mxLVUciLLjxqw/xr72Dhy+lER6dGd02FQ==",
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/gensync": {
      "version": "1.0.0-beta.2",
      "resolved": "https://registry.npmjs.org/gensync/-/gensync-1.0.0-beta.2.tgz",
      "integrity": "sha512-3hN7NaskYvMDLQY55gnW3NQ+mesEAepTqlg+VEbj7zzqEMBVNhzcGYYeqFo/TlYz6eQiFcp1HcsCZO+nGgS8zg==",
      "dev": true,
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/get-intrinsic": {
      "version": "1.3.0",
      "resolved": "https://registry.npmjs.org/get-intrinsic/-/get-intrinsic-1.3.0.tgz",
      "integrity": "sha512-9fSjSaos/fRIVIp+xSJlE6lfwhES7LNtKaCBIamHsjr2na1BiABJPo0mOjjz8GJDURarmCPGqaiVg5mfjb98CQ==",
      "dependencies": {
        "call-bind-apply-helpers": "^1.0.2",
        "es-define-property": "^1.0.1",
        "es-errors": "^1.3.0",
        "es-object-atoms": "^1.1.1",
        "function-bind": "^1.1.2",
        "get-proto": "^1.0.1",
        "gopd": "^1.2.0",
        "has-symbols": "^1.1.0",
        "hasown": "^2.0.2",
        "math-intrinsics": "^1.1.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/get-proto": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/get-proto/-/get-proto-1.0.1.tgz",
      "integrity": "sha512-sTSfBjoXBp89JvIKIefqw7U2CCebsc74kiY6awiGogKtoSGbgjYE/G/+l9sF3MWFPNc9IcoOC4ODfKHfxFmp0g==",
      "dependencies": {
        "dunder-proto": "^1.0.1",
        "es-object-atoms": "^1.0.0"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/glob": {
      "version": "10.4.5",
      "resolved": "https://registry.npmjs.org/glob/-/glob-10.4.5.tgz",
      "integrity": "sha512-7Bv8RF0k6xjo7d4A/PxYLbUCfb6c+Vpd2/mB2yRDlew7Jb5hEXiCD9ibfO7wpk8i4sevK6DFny9h7EYbM3/sHg==",
      "dev": true,
      "dependencies": {
        "foreground-child": "^3.1.0",
        "jackspeak": "^3.1.2",
        "minimatch": "^9.0.4",
        "minipass": "^7.1.2",
        "package-json-from-dist": "^1.0.0",
        "path-scurry": "^1.11.1"
      },
      "bin": {
        "glob": "dist/esm/bin.mjs"
      },
      "funding": {
        "url": "https://github.com/sponsors/isaacs"
      }
    },
    "node_modules/glob-parent": {
      "version": "6.0.2",
      "resolved": "https://registry.npmjs.org/glob-parent/-/glob-parent-6.0.2.tgz",
      "integrity": "sha512-XxwI8EOhVQgWp6iDL+3b0r86f4d6AX6zSU55HfB4ydCEuXLXc5FcYeOu+nnGftS4TEju/11rt4KJPTMgbfmv4A==",
      "dev": true,
      "dependencies": {
        "is-glob": "^4.0.3"
      },
      "engines": {
        "node": ">=10.13.0"
      }
    },
    "node_modules/gopd": {
      "version": "1.2.0",
      "resolved": "https://registry.npmjs.org/gopd/-/gopd-1.2.0.tgz",
      "integrity": "sha512-ZUKRh6/kUFoAiTAtTYPZJ3hw9wNxx+BIBOijnlG9PnrJsCcSjs1wyyD6vJpaYtgnzDrKYRSqf3OO6Rfa93xsRg==",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/has-symbols": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/has-symbols/-/has-symbols-1.1.0.tgz",
      "integrity": "sha512-1cDNdwJ2Jaohmb3sg4OmKaMBwuC48sYni5HUw2DvsC8LjGTLK9h+eb1X6RyuOHe4hT0ULCW68iomhjUoKUqlPQ==",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/has-tostringtag": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/has-tostringtag/-/has-tostringtag-1.0.2.tgz",
      "integrity": "sha512-NqADB8VjPFLM2V0VvHUewwwsw0ZWBaIdgo+ieHtK3hasLz4qeCRjYcqfB6AQrBggRKppKF8L52/VqdVsO47Dlw==",
      "dependencies": {
        "has-symbols": "^1.0.3"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/hasown": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/hasown/-/hasown-2.0.2.tgz",
      "integrity": "sha512-0hJU9SCPvmMzIBdZFqNPXWa6dqh7WdH0cII9y+CyS8rG3nL48Bclra9HmKhVVUHyPWNH5Y7xDwAB7bfgSjkUMQ==",
      "dependencies": {
        "function-bind": "^1.1.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/html-parse-stringify": {
      "version": "3.0.1",
      "resolved": "https://registry.npmjs.org/html-parse-stringify/-/html-parse-stringify-3.0.1.tgz",
      "integrity": "sha512-KknJ50kTInJ7qIScF3jeaFRpMpE8/lfiTdzf/twXyPBLAGrLRTmkz3AdTnKeh40X8k9L2fdYwEp/42WGXIRGcg==",
      "dependencies": {
        "void-elements": "3.1.0"
      }
    },
    "node_modules/i18next": {
      "version": "25.6.0",
      "resolved": "https://registry.npmjs.org/i18next/-/i18next-25.6.0.tgz",
      "integrity": "sha512-tTn8fLrwBYtnclpL5aPXK/tAYBLWVvoHM1zdfXoRNLcI+RvtMsoZRV98ePlaW3khHYKuNh/Q65W/+NVFUeIwVw==",
      "funding": [
        {
          "type": "individual",
          "url": "https://locize.com"
        },
        {
          "type": "individual",
          "url": "https://locize.com/i18next.html"
        },
        {
          "type": "individual",
          "url": "https://www.i18next.com/how-to/faq#i18next-is-awesome.-how-can-i-support-the-project"
        }
      ],
      "dependencies": {
        "@babel/runtime": "^7.27.6"
      },
      "peerDependencies": {
        "typescript": "^5"
      },
      "peerDependenciesMeta": {
        "typescript": {
          "optional": true
        }
      }
    },
    "node_modules/immer": {
      "version": "10.2.0",
      "resolved": "https://registry.npmjs.org/immer/-/immer-10.2.0.tgz",
      "integrity": "sha512-d/+XTN3zfODyjr89gM3mPq1WNX2B8pYsu7eORitdwyA2sBubnTl3laYlBk4sXY5FUa5qTZGBDPJICVbvqzjlbw==",
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/immer"
      }
    },
    "node_modules/internmap": {
      "version": "2.0.3",
      "resolved": "https://registry.npmjs.org/internmap/-/internmap-2.0.3.tgz",
      "integrity": "sha512-5Hh7Y1wQbvY5ooGgPbDaL5iYLAPzMTUrjMulskHLH6wnv/A+1q5rgEaiuqEjB+oxGXIVZs1FF+R/KPN3ZSQYYg==",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/is-binary-path": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/is-binary-path/-/is-binary-path-2.1.0.tgz",
      "integrity": "sha512-ZMERYes6pDydyuGidse7OsHxtbI7WVeUEozgR/g7rd0xUimYNlvZRE/K2MgZTjWy725IfelLeVcEM97mmtRGXw==",
      "dev": true,
      "dependencies": {
        "binary-extensions": "^2.0.0"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/is-core-module": {
      "version": "2.16.1",
      "resolved": "https://registry.npmjs.org/is-core-module/-/is-core-module-2.16.1.tgz",
      "integrity": "sha512-UfoeMA6fIJ8wTYFEUjelnaGI67v6+N7qXJEvQuIGa99l4xsCruSYOVSQ0uPANn4dAzm8lkYPaKLrrijLq7x23w==",
      "dev": true,
      "dependencies": {
        "hasown": "^2.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/is-extglob": {
      "version": "2.1.1",
      "resolved": "https://registry.npmjs.org/is-extglob/-/is-extglob-2.1.1.tgz",
      "integrity": "sha512-SbKbANkN603Vi4jEZv49LeVJMn4yGwsbzZworEoyEiutsN3nJYdbO36zfhGJ6QEDpOZIFkDtnq5JRxmvl3jsoQ==",
      "dev": true,
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/is-fullwidth-code-point": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/is-fullwidth-code-point/-/is-fullwidth-code-point-3.0.0.tgz",
      "integrity": "sha512-zymm5+u+sCsSWyD9qNaejV3DFvhCKclKdizYaJUuHA83RLjb7nSuGnddCHGv0hk+KY7BMAlsWeK4Ueg6EV6XQg==",
      "dev": true,
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/is-glob": {
      "version": "4.0.3",
      "resolved": "https://registry.npmjs.org/is-glob/-/is-glob-4.0.3.tgz",
      "integrity": "sha512-xelSayHH36ZgE7ZWhli7pW34hNbNl8Ojv5KVmkJD4hBdD3th8Tfk9vYasLM+mXWOZhFkgZfxhLSnrwRr4elSSg==",
      "dev": true,
      "dependencies": {
        "is-extglob": "^2.1.1"
      },
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/is-number": {
      "version": "7.0.0",
      "resolved": "https://registry.npmjs.org/is-number/-/is-number-7.0.0.tgz",
      "integrity": "sha512-41Cifkg6e8TylSpdtTpeLVMqvSBEVzTttHvERD741+pnZ8ANv0004MRL43QKPDlK9cGvNp6NZWZUBlbGXYxxng==",
      "dev": true,
      "engines": {
        "node": ">=0.12.0"
      }
    },
    "node_modules/isexe": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/isexe/-/isexe-2.0.0.tgz",
      "integrity": "sha512-RHxMLp9lnKHGHRng9QFhRCMbYAcVpn69smSGcq3f36xjgVVWThj4qqLbTLlq7Ssj8B+fIQ1EuCEGI2lKsyQeIw==",
      "dev": true
    },
    "node_modules/jackspeak": {
      "version": "3.4.3",
      "resolved": "https://registry.npmjs.org/jackspeak/-/jackspeak-3.4.3.tgz",
      "integrity": "sha512-OGlZQpz2yfahA/Rd1Y8Cd9SIEsqvXkLVoSw/cgwhnhFMDbsQFeZYoJJ7bIZBS9BcamUW96asq/npPWugM+RQBw==",
      "dev": true,
      "dependencies": {
        "@isaacs/cliui": "^8.0.2"
      },
      "funding": {
        "url": "https://github.com/sponsors/isaacs"
      },
      "optionalDependencies": {
        "@pkgjs/parseargs": "^0.11.0"
      }
    },
    "node_modules/jiti": {
      "version": "1.21.7",
      "resolved": "https://registry.npmjs.org/jiti/-/jiti-1.21.7.tgz",
      "integrity": "sha512-/imKNG4EbWNrVjoNC/1H5/9GFy+tqjGBHCaSsN+P2RnPqjsLmv6UD3Ej+Kj8nBWaRAwyk7kK5ZUc+OEatnTR3A==",
      "dev": true,
      "bin": {
        "jiti": "bin/jiti.js"
      }
    },
    "node_modules/js-tokens": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/js-tokens/-/js-tokens-4.0.0.tgz",
      "integrity": "sha512-RdJUflcE3cUzKiMqQgsCu06FPu9UdIJO0beYbPhHN4k6apgJtifcoCtT9bcxOpYBtpD2kCM6Sbzg4CausW/PKQ=="
    },
    "node_modules/jsesc": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/jsesc/-/jsesc-3.1.0.tgz",
      "integrity": "sha512-/sM3dO2FOzXjKQhJuo0Q173wf2KOo8t4I8vHy6lF9poUp7bKT0/NHE8fPX23PwfhnykfqnC2xRxOnVw5XuGIaA==",
      "dev": true,
      "bin": {
        "jsesc": "bin/jsesc"
      },
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/json5": {
      "version": "2.2.3",
      "resolved": "https://registry.npmjs.org/json5/-/json5-2.2.3.tgz",
      "integrity": "sha512-XmOWe7eyHYH14cLdVPoyg+GOH3rYX++KpzrylJwSW98t3Nk+U8XOl8FWKOgwtzdb8lXGf6zYwDUzeHMWfxasyg==",
      "dev": true,
      "bin": {
        "json5": "lib/cli.js"
      },
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/jwt-decode": {
      "version": "3.1.2",
      "resolved": "https://registry.npmjs.org/jwt-decode/-/jwt-decode-3.1.2.tgz",
      "integrity": "sha512-UfpWE/VZn0iP50d8cz9NrZLM9lSWhcJ+0Gt/nm4by88UL+J1SiKN8/5dkjMmbEzwL2CAe+67GsegCbIKtbp75A=="
    },
    "node_modules/lilconfig": {
      "version": "3.1.3",
      "resolved": "https://registry.npmjs.org/lilconfig/-/lilconfig-3.1.3.tgz",
      "integrity": "sha512-/vlFKAoH5Cgt3Ie+JLhRbwOsCQePABiU3tJ1egGvyQ+33R/vcwM2Zl2QR/LzjsBeItPt3oSVXapn+m4nQDvpzw==",
      "dev": true,
      "engines": {
        "node": ">=14"
      },
      "funding": {
        "url": "https://github.com/sponsors/antonk52"
      }
    },
    "node_modules/lines-and-columns": {
      "version": "1.2.4",
      "resolved": "https://registry.npmjs.org/lines-and-columns/-/lines-and-columns-1.2.4.tgz",
      "integrity": "sha512-7ylylesZQ/PV29jhEDl3Ufjo6ZX7gCqJr5F7PKrqc93v7fzSymt1BpwEU8nAUXs8qzzvqhbjhK5QZg6Mt/HkBg==",
      "dev": true
    },
    "node_modules/loose-envify": {
      "version": "1.4.0",
      "resolved": "https://registry.npmjs.org/loose-envify/-/loose-envify-1.4.0.tgz",
      "integrity": "sha512-lyuxPGr/Wfhrlem2CL/UcnUc1zcqKAImBDzukY7Y5F/yQiNdko6+fRLevlw1HgMySw7f611UIY408EtxRSoK3Q==",
      "dependencies": {
        "js-tokens": "^3.0.0 || ^4.0.0"
      },
      "bin": {
        "loose-envify": "cli.js"
      }
    },
    "node_modules/lru-cache": {
      "version": "10.4.3",
      "resolved": "https://registry.npmjs.org/lru-cache/-/lru-cache-10.4.3.tgz",
      "integrity": "sha512-JNAzZcXrCt42VGLuYz0zfAzDfAvJWW6AfYlDBQyDV5DClI2m5sAmK+OIO7s59XfsRsWHp02jAJrRadPRGTt6SQ==",
      "dev": true
    },
    "node_modules/math-intrinsics": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/math-intrinsics/-/math-intrinsics-1.1.0.tgz",
      "integrity": "sha512-/IXtbwEk5HTPyEwyKX6hGkYXxM9nbj64B+ilVJnC/R6B0pH5G4V3b0pVbL7DBj4tkhBAppbQUlf6F6Xl9LHu1g==",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/merge2": {
      "version": "1.4.1",
      "resolved": "https://registry.npmjs.org/merge2/-/merge2-1.4.1.tgz",
      "integrity": "sha512-8q7VEgMJW4J8tcfVPy8g09NcQwZdbwFEqhe/WZkoIzjn/3TGDwtOCYtXGxA3O8tPzpczCCDgv+P2P5y00ZJOOg==",
      "dev": true,
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/micromatch": {
      "version": "4.0.8",
      "resolved": "https://registry.npmjs.org/micromatch/-/micromatch-4.0.8.tgz",
      "integrity": "sha512-PXwfBhYu0hBCPw8Dn0E+WDYb7af3dSLVWKi3HGv84IdF4TyFoC0ysxFd0Goxw7nSv4T/PzEJQxsYsEiFCKo2BA==",
      "dev": true,
      "dependencies": {
        "braces": "^3.0.3",
        "picomatch": "^2.3.1"
      },
      "engines": {
        "node": ">=8.6"
      }
    },
    "node_modules/mime-db": {
      "version": "1.52.0",
      "resolved": "https://registry.npmjs.org/mime-db/-/mime-db-1.52.0.tgz",
      "integrity": "sha512-sPU4uV7dYlvtWJxwwxHD0PuihVNiE7TyAbQ5SWxDCB9mUYvOgroQOwYQQOKPJ8CIbE+1ETVlOoK1UC2nU3gYvg==",
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/mime-types": {
      "version": "2.1.35",
      "resolved": "https://registry.npmjs.org/mime-types/-/mime-types-2.1.35.tgz",
      "integrity": "sha512-ZDY+bPm5zTTF+YpCrAU9nK0UgICYPT0QtT1NZWFv4s++TNkcgVaT0g6+4R2uI4MjQjzysHB1zxuWL50hzaeXiw==",
      "dependencies": {
        "mime-db": "1.52.0"
      },
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/minimatch": {
      "version": "9.0.5",
      "resolved": "https://registry.npmjs.org/minimatch/-/minimatch-9.0.5.tgz",
      "integrity": "sha512-G6T0ZX48xgozx7587koeX9Ys2NYy6Gmv//P89sEte9V9whIapMNF4idKxnW2QtCcLiTWlb/wfCabAtAFWhhBow==",
      "dev": true,
      "dependencies": {
        "brace-expansion": "^2.0.1"
      },
      "engines": {
        "node": ">=16 || 14 >=14.17"
      },
      "funding": {
        "url": "https://github.com/sponsors/isaacs"
      }
    },
    "node_modules/minipass": {
      "version": "7.1.2",
      "resolved": "https://registry.npmjs.org/minipass/-/minipass-7.1.2.tgz",
      "integrity": "sha512-qOOzS1cBTWYF4BH8fVePDBOO9iptMnGUEZwNc/cMWnTV2nVLZ7VoNWEPHkYczZA0pdoA7dl6e7FL659nX9S2aw==",
      "dev": true,
      "engines": {
        "node": ">=16 || 14 >=14.17"
      }
    },
    "node_modules/motion-dom": {
      "version": "12.23.23",
      "resolved": "https://registry.npmjs.org/motion-dom/-/motion-dom-12.23.23.tgz",
      "integrity": "sha512-n5yolOs0TQQBRUFImrRfs/+6X4p3Q4n1dUEqt/H58Vx7OW6RF+foWEgmTVDhIWJIMXOuNNL0apKH2S16en9eiA==",
      "dependencies": {
        "motion-utils": "^12.23.6"
      }
    },
    "node_modules/motion-utils": {
      "version": "12.23.6",
      "resolved": "https://registry.npmjs.org/motion-utils/-/motion-utils-12.23.6.tgz",
      "integrity": "sha512-eAWoPgr4eFEOFfg2WjIsMoqJTW6Z8MTUCgn/GZ3VRpClWBdnbjryiA3ZSNLyxCTmCQx4RmYX6jX1iWHbenUPNQ=="
    },
    "node_modules/ms": {
      "version": "2.1.3",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
      "dev": true
    },
    "node_modules/mz": {
      "version": "2.7.0",
      "resolved": "https://registry.npmjs.org/mz/-/mz-2.7.0.tgz",
      "integrity": "sha512-z81GNO7nnYMEhrGh9LeymoE4+Yr0Wn5McHIZMK5cfQCl+NDX08sCZgUc9/6MHni9IWuFLm1Z3HTCXu2z9fN62Q==",
      "dev": true,
      "dependencies": {
        "any-promise": "^1.0.0",
        "object-assign": "^4.0.1",
        "thenify-all": "^1.0.0"
      }
    },
    "node_modules/nanoid": {
      "version": "3.3.11",
      "resolved": "https://registry.npmjs.org/nanoid/-/nanoid-3.3.11.tgz",
      "integrity": "sha512-N8SpfPUnUp1bK+PMYW8qSWdl9U+wwNWI4QKxOYDy9JAro3WMX7p2OeVRF9v+347pnakNevPmiHhNmZ2HbFA76w==",
      "dev": true,
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "bin": {
        "nanoid": "bin/nanoid.cjs"
      },
      "engines": {
        "node": "^10 || ^12 || ^13.7 || ^14 || >=15.0.1"
      }
    },
    "node_modules/node-releases": {
      "version": "2.0.26",
      "resolved": "https://registry.npmjs.org/node-releases/-/node-releases-2.0.26.tgz",
      "integrity": "sha512-S2M9YimhSjBSvYnlr5/+umAnPHE++ODwt5e2Ij6FoX45HA/s4vHdkDx1eax2pAPeAOqu4s9b7ppahsyEFdVqQA==",
      "dev": true
    },
    "node_modules/normalize-path": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/normalize-path/-/normalize-path-3.0.0.tgz",
      "integrity": "sha512-6eZs5Ls3WtCisHWp9S2GUy8dqkpGi4BVSz3GaqiE6ezub0512ESztXUwUB6C6IKbQkY2Pnb/mD4WYojCRwcwLA==",
      "dev": true,
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/normalize-range": {
      "version": "0.1.2",
      "resolved": "https://registry.npmjs.org/normalize-range/-/normalize-range-0.1.2.tgz",
      "integrity": "sha512-bdok/XvKII3nUpklnV6P2hxtMNrCboOjAcyBuQnWEhO665FwrSNRxU+AqpsyvO6LgGYPspN+lu5CLtw4jPRKNA==",
      "dev": true,
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/object-assign": {
      "version": "4.1.1",
      "resolved": "https://registry.npmjs.org/object-assign/-/object-assign-4.1.1.tgz",
      "integrity": "sha512-rJgTQnkUnH1sFw8yT6VSU3zD3sWmu6sZhIseY8VX+GRu3P6F7Fu+JNDoXfklElbLJSnc3FUQHVe4cU5hj+BcUg==",
      "dev": true,
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/object-hash": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/object-hash/-/object-hash-3.0.0.tgz",
      "integrity": "sha512-RSn9F68PjH9HqtltsSnqYC1XXoWe9Bju5+213R98cNGttag9q9yAOTzdbsqvIa7aNm5WffBZFpWYr2aWrklWAw==",
      "dev": true,
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/package-json-from-dist": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/package-json-from-dist/-/package-json-from-dist-1.0.1.tgz",
      "integrity": "sha512-UEZIS3/by4OC8vL3P2dTXRETpebLI2NiI5vIrjaD/5UtrkFX/tNbwjTSRAGC/+7CAo2pIcBaRgWmcBBHcsaCIw==",
      "dev": true
    },
    "node_modules/path-key": {
      "version": "3.1.1",
      "resolved": "https://registry.npmjs.org/path-key/-/path-key-3.1.1.tgz",
      "integrity": "sha512-ojmeN0qd+y0jszEtoY48r0Peq5dwMEkIlCOu6Q5f41lfkswXuKtYrhgoTpLnyIcHm24Uhqx+5Tqm2InSwLhE6Q==",
      "dev": true,
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/path-parse": {
      "version": "1.0.7",
      "resolved": "https://registry.npmjs.org/path-parse/-/path-parse-1.0.7.tgz",
      "integrity": "sha512-LDJzPVEEEPR+y48z93A0Ed0yXb8pAByGWo/k5YYdYgpY2/2EsOsksJrq7lOHxryrVOn1ejG6oAp8ahvOIQD8sw==",
      "dev": true
    },
    "node_modules/path-scurry": {
      "version": "1.11.1",
      "resolved": "https://registry.npmjs.org/path-scurry/-/path-scurry-1.11.1.tgz",
      "integrity": "sha512-Xa4Nw17FS9ApQFJ9umLiJS4orGjm7ZzwUrwamcGQuHSzDyth9boKDaycYdDcZDuqYATXw4HFXgaqWTctW/v1HA==",
      "dev": true,
      "dependencies": {
        "lru-cache": "^10.2.0",
        "minipass": "^5.0.0 || ^6.0.2 || ^7.0.0"
      },
      "engines": {
        "node": ">=16 || 14 >=14.18"
      },
      "funding": {
        "url": "https://github.com/sponsors/isaacs"
      }
    },
    "node_modules/picocolors": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/picocolors/-/picocolors-1.1.1.tgz",
      "integrity": "sha512-xceH2snhtb5M9liqDsmEw56le376mTZkEX/jEb/RxNFyegNul7eNslCXP9FDj/Lcu0X8KEyMceP2ntpaHrDEVA==",
      "dev": true
    },
    "node_modules/picomatch": {
      "version": "2.3.1",
      "resolved": "https://registry.npmjs.org/picomatch/-/picomatch-2.3.1.tgz",
      "integrity": "sha512-JU3teHTNjmE2VCGFzuY8EXzCDVwEqB2a8fsIvwaStHhAWJEeVd1o1QD80CU6+ZdEXXSLbSsuLwJjkCBWqRQUVA==",
      "dev": true,
      "engines": {
        "node": ">=8.6"
      },
      "funding": {
        "url": "https://github.com/sponsors/jonschlinkert"
      }
    },
    "node_modules/pify": {
      "version": "2.3.0",
      "resolved": "https://registry.npmjs.org/pify/-/pify-2.3.0.tgz",
      "integrity": "sha512-udgsAY+fTnvv7kI7aaxbqwWNb0AHiB0qBO89PZKPkoTmGOgdbrHDKD+0B2X4uTfJ/FT1R09r9gTsjUjNJotuog==",
      "dev": true,
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/pirates": {
      "version": "4.0.7",
      "resolved": "https://registry.npmjs.org/pirates/-/pirates-4.0.7.tgz",
      "integrity": "sha512-TfySrs/5nm8fQJDcBDuUng3VOUKsd7S+zqvbOTiGXHfxX4wK31ard+hoNuvkicM/2YFzlpDgABOevKSsB4G/FA==",
      "dev": true,
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/postcss": {
      "version": "8.5.6",
      "resolved": "https://registry.npmjs.org/postcss/-/postcss-8.5.6.tgz",
      "integrity": "sha512-3Ybi1tAuwAP9s0r1UQ2J4n5Y0G05bJkpUIO0/bI9MhwmD70S5aTWbXGBwxHrelT+XM1k6dM0pk+SwNkpTRN7Pg==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/postcss/"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/postcss"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "dependencies": {
        "nanoid": "^3.3.11",
        "picocolors": "^1.1.1",
        "source-map-js": "^1.2.1"
      },
      "engines": {
        "node": "^10 || ^12 || >=14"
      }
    },
    "node_modules/postcss-import": {
      "version": "15.1.0",
      "resolved": "https://registry.npmjs.org/postcss-import/-/postcss-import-15.1.0.tgz",
      "integrity": "sha512-hpr+J05B2FVYUAXHeK1YyI267J/dDDhMU6B6civm8hSY1jYJnBXxzKDKDswzJmtLHryrjhnDjqqp/49t8FALew==",
      "dev": true,
      "dependencies": {
        "postcss-value-parser": "^4.0.0",
        "read-cache": "^1.0.0",
        "resolve": "^1.1.7"
      },
      "engines": {
        "node": ">=14.0.0"
      },
      "peerDependencies": {
        "postcss": "^8.0.0"
      }
    },
    "node_modules/postcss-js": {
      "version": "4.1.0",
      "resolved": "https://registry.npmjs.org/postcss-js/-/postcss-js-4.1.0.tgz",
      "integrity": "sha512-oIAOTqgIo7q2EOwbhb8UalYePMvYoIeRY2YKntdpFQXNosSu3vLrniGgmH9OKs/qAkfoj5oB3le/7mINW1LCfw==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/postcss/"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "dependencies": {
        "camelcase-css": "^2.0.1"
      },
      "engines": {
        "node": "^12 || ^14 || >= 16"
      },
      "peerDependencies": {
        "postcss": "^8.4.21"
      }
    },
    "node_modules/postcss-load-config": {
      "version": "6.0.1",
      "resolved": "https://registry.npmjs.org/postcss-load-config/-/postcss-load-config-6.0.1.tgz",
      "integrity": "sha512-oPtTM4oerL+UXmx+93ytZVN82RrlY/wPUV8IeDxFrzIjXOLF1pN+EmKPLbubvKHT2HC20xXsCAH2Z+CKV6Oz/g==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/postcss/"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "dependencies": {
        "lilconfig": "^3.1.1"
      },
      "engines": {
        "node": ">= 18"
      },
      "peerDependencies": {
        "jiti": ">=1.21.0",
        "postcss": ">=8.0.9",
        "tsx": "^4.8.1",
        "yaml": "^2.4.2"
      },
      "peerDependenciesMeta": {
        "jiti": {
          "optional": true
        },
        "postcss": {
          "optional": true
        },
        "tsx": {
          "optional": true
        },
        "yaml": {
          "optional": true
        }
      }
    },
    "node_modules/postcss-nested": {
      "version": "6.2.0",
      "resolved": "https://registry.npmjs.org/postcss-nested/-/postcss-nested-6.2.0.tgz",
      "integrity": "sha512-HQbt28KulC5AJzG+cZtj9kvKB93CFCdLvog1WFLf1D+xmMvPGlBstkpTEZfK5+AN9hfJocyBFCNiqyS48bpgzQ==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/postcss/"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "dependencies": {
        "postcss-selector-parser": "^6.1.1"
      },
      "engines": {
        "node": ">=12.0"
      },
      "peerDependencies": {
        "postcss": "^8.2.14"
      }
    },
    "node_modules/postcss-selector-parser": {
      "version": "6.1.2",
      "resolved": "https://registry.npmjs.org/postcss-selector-parser/-/postcss-selector-parser-6.1.2.tgz",
      "integrity": "sha512-Q8qQfPiZ+THO/3ZrOrO0cJJKfpYCagtMUkXbnEfmgUjwXg6z/WBeOyS9APBBPCTSiDV+s4SwQGu8yFsiMRIudg==",
      "dev": true,
      "dependencies": {
        "cssesc": "^3.0.0",
        "util-deprecate": "^1.0.2"
      },
      "engines": {
        "node": ">=4"
      }
    },
    "node_modules/postcss-value-parser": {
      "version": "4.2.0",
      "resolved": "https://registry.npmjs.org/postcss-value-parser/-/postcss-value-parser-4.2.0.tgz",
      "integrity": "sha512-1NNCs6uurfkVbeXG4S8JFT9t19m45ICnif8zWLd5oPSZ50QnwMfK+H3jv408d4jw/7Bttv5axS5IiHoLaVNHeQ==",
      "dev": true
    },
    "node_modules/proxy-from-env": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/proxy-from-env/-/proxy-from-env-1.1.0.tgz",
      "integrity": "sha512-D+zkORCbA9f1tdWRK0RaCR3GPv50cMxcrz4X8k5LTSUD1Dkw47mKJEZQNunItRTkWwgtaUSo1RVFRIG9ZXiFYg=="
    },
    "node_modules/queue-microtask": {
      "version": "1.2.3",
      "resolved": "https://registry.npmjs.org/queue-microtask/-/queue-microtask-1.2.3.tgz",
      "integrity": "sha512-NuaNSa6flKT5JaSYQzJok04JzTL1CA6aGhv5rfLW3PgqA+M2ChpZQnAC8h8i4ZFkBS8X5RqkDBHA7r4hej3K9A==",
      "dev": true,
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/feross"
        },
        {
          "type": "patreon",
          "url": "https://www.patreon.com/feross"
        },
        {
          "type": "consulting",
          "url": "https://feross.org/support"
        }
      ]
    },
    "node_modules/react": {
      "version": "18.3.1",
      "resolved": "https://registry.npmjs.org/react/-/react-18.3.1.tgz",
      "integrity": "sha512-wS+hAgJShR0KhEvPJArfuPVN1+Hz1t0Y6n5jLrGQbkb4urgPE/0Rve+1kMB1v/oWgHgm4WIcV+i7F2pTVj+2iQ==",
      "dependencies": {
        "loose-envify": "^1.1.0"
      },
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/react-countup": {
      "version": "6.5.3",
      "resolved": "https://registry.npmjs.org/react-countup/-/react-countup-6.5.3.tgz",
      "integrity": "sha512-udnqVQitxC7QWADSPDOxVWULkLvKUWrDapn5i53HE4DPRVgs+Y5rr4bo25qEl8jSh+0l2cToJgGMx+clxPM3+w==",
      "dependencies": {
        "countup.js": "^2.8.0"
      },
      "peerDependencies": {
        "react": ">= 16.3.0"
      }
    },
    "node_modules/react-datepicker": {
      "version": "8.8.0",
      "resolved": "https://registry.npmjs.org/react-datepicker/-/react-datepicker-8.8.0.tgz",
      "integrity": "sha512-rIJLhww1B5cQY7GYEfSEXvldlGp+GIVU5oE7lxqeK4fmdv5F9bVndplDmblMCvfSMazXmeJ6OHBvRs/PkEhwUQ==",
      "dependencies": {
        "@floating-ui/react": "^0.27.15",
        "clsx": "^2.1.1",
        "date-fns": "^4.1.0"
      },
      "peerDependencies": {
        "react": "^16.9.0 || ^17 || ^18 || ^19 || ^19.0.0-rc",
        "react-dom": "^16.9.0 || ^17 || ^18 || ^19 || ^19.0.0-rc"
      }
    },
    "node_modules/react-dom": {
      "version": "18.3.1",
      "resolved": "https://registry.npmjs.org/react-dom/-/react-dom-18.3.1.tgz",
      "integrity": "sha512-5m4nQKp+rZRb09LNH59GM4BxTh9251/ylbKIbpe7TpGxfJ+9kv6BLkLBXIjjspbgbnIBNqlI23tRnTWT0snUIw==",
      "dependencies": {
        "loose-envify": "^1.1.0",
        "scheduler": "^0.23.2"
      },
      "peerDependencies": {
        "react": "^18.3.1"
      }
    },
    "node_modules/react-i18next": {
      "version": "16.2.4",
      "resolved": "https://registry.npmjs.org/react-i18next/-/react-i18next-16.2.4.tgz",
      "integrity": "sha512-pvbcPQ+YuQQoRkKBA4VCU9aO8dOgP/vdKEizIYXcAk3+AmI8yQKSJaCzxQQu4Kgg2zWZm3ax9KqHv8ItUlRY0A==",
      "dependencies": {
        "@babel/runtime": "^7.27.6",
        "html-parse-stringify": "^3.0.1",
        "use-sync-external-store": "^1.6.0"
      },
      "peerDependencies": {
        "i18next": ">= 25.5.2",
        "react": ">= 16.8.0",
        "typescript": "^5"
      },
      "peerDependenciesMeta": {
        "react-dom": {
          "optional": true
        },
        "react-native": {
          "optional": true
        },
        "typescript": {
          "optional": true
        }
      }
    },
    "node_modules/react-is": {
      "version": "19.2.0",
      "resolved": "https://registry.npmjs.org/react-is/-/react-is-19.2.0.tgz",
      "integrity": "sha512-x3Ax3kNSMIIkyVYhWPyO09bu0uttcAIoecO/um/rKGQ4EltYWVYtyiGkS/3xMynrbVQdS69Jhlv8FXUEZehlzA==",
      "peer": true
    },
    "node_modules/react-redux": {
      "version": "9.2.0",
      "resolved": "https://registry.npmjs.org/react-redux/-/react-redux-9.2.0.tgz",
      "integrity": "sha512-ROY9fvHhwOD9ySfrF0wmvu//bKCQ6AeZZq1nJNtbDC+kk5DuSuNX/n6YWYF/SYy7bSba4D4FSz8DJeKY/S/r+g==",
      "dependencies": {
        "@types/use-sync-external-store": "^0.0.6",
        "use-sync-external-store": "^1.4.0"
      },
      "peerDependencies": {
        "@types/react": "^18.2.25 || ^19",
        "react": "^18.0 || ^19",
        "redux": "^5.0.0"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "redux": {
          "optional": true
        }
      }
    },
    "node_modules/react-refresh": {
      "version": "0.14.2",
      "resolved": "https://registry.npmjs.org/react-refresh/-/react-refresh-0.14.2.tgz",
      "integrity": "sha512-jCvmsr+1IUSMUyzOkRcvnVbX3ZYC6g9TDrDbFuFmRDq7PD4yaGbLKNQL6k2jnArV8hjYxh7hVhAZB6s9HDGpZA==",
      "dev": true,
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/react-router": {
      "version": "6.21.3",
      "resolved": "https://registry.npmjs.org/react-router/-/react-router-6.21.3.tgz",
      "integrity": "sha512-a0H638ZXULv1OdkmiK6s6itNhoy33ywxmUFT/xtSoVyf9VnC7n7+VT4LjVzdIHSaF5TIh9ylUgxMXksHTgGrKg==",
      "dependencies": {
        "@remix-run/router": "1.14.2"
      },
      "engines": {
        "node": ">=14.0.0"
      },
      "peerDependencies": {
        "react": ">=16.8"
      }
    },
    "node_modules/react-router-dom": {
      "version": "6.21.3",
      "resolved": "https://registry.npmjs.org/react-router-dom/-/react-router-dom-6.21.3.tgz",
      "integrity": "sha512-kNzubk7n4YHSrErzjLK72j0B5i969GsuCGazRl3G6j1zqZBLjuSlYBdVdkDOgzGdPIffUOc9nmgiadTEVoq91g==",
      "dependencies": {
        "@remix-run/router": "1.14.2",
        "react-router": "6.21.3"
      },
      "engines": {
        "node": ">=14.0.0"
      },
      "peerDependencies": {
        "react": ">=16.8",
        "react-dom": ">=16.8"
      }
    },
    "node_modules/read-cache": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/read-cache/-/read-cache-1.0.0.tgz",
      "integrity": "sha512-Owdv/Ft7IjOgm/i0xvNDZ1LrRANRfew4b2prF3OWMQLxLfu3bS8FVhCsrSCMK4lR56Y9ya+AThoTpDCTxCmpRA==",
      "dev": true,
      "dependencies": {
        "pify": "^2.3.0"
      }
    },
    "node_modules/readdirp": {
      "version": "3.6.0",
      "resolved": "https://registry.npmjs.org/readdirp/-/readdirp-3.6.0.tgz",
      "integrity": "sha512-hOS089on8RduqdbhvQ5Z37A0ESjsqz6qnRcffsMU3495FuTdqSm+7bhJ29JvIOsBDEEnan5DPu9t3To9VRlMzA==",
      "dev": true,
      "dependencies": {
        "picomatch": "^2.2.1"
      },
      "engines": {
        "node": ">=8.10.0"
      }
    },
    "node_modules/recharts": {
      "version": "3.3.0",
      "resolved": "https://registry.npmjs.org/recharts/-/recharts-3.3.0.tgz",
      "integrity": "sha512-Vi0qmTB0iz1+/Cz9o5B7irVyUjX2ynvEgImbgMt/3sKRREcUM07QiYjS1QpAVrkmVlXqy5gykq4nGWMz9AS4Rg==",
      "dependencies": {
        "@reduxjs/toolkit": "1.x.x || 2.x.x",
        "clsx": "^2.1.1",
        "decimal.js-light": "^2.5.1",
        "es-toolkit": "^1.39.3",
        "eventemitter3": "^5.0.1",
        "immer": "^10.1.1",
        "react-redux": "8.x.x || 9.x.x",
        "reselect": "5.1.1",
        "tiny-invariant": "^1.3.3",
        "use-sync-external-store": "^1.2.2",
        "victory-vendor": "^37.0.2"
      },
      "engines": {
        "node": ">=18"
      },
      "peerDependencies": {
        "react": "^16.8.0 || ^17.0.0 || ^18.0.0 || ^19.0.0",
        "react-dom": "^16.0.0 || ^17.0.0 || ^18.0.0 || ^19.0.0",
        "react-is": "^16.8.0 || ^17.0.0 || ^18.0.0 || ^19.0.0"
      }
    },
    "node_modules/redux": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/redux/-/redux-5.0.1.tgz",
      "integrity": "sha512-M9/ELqF6fy8FwmkpnF0S3YKOqMyoWJ4+CS5Efg2ct3oY9daQvd/Pc71FpGZsVsbl3Cpb+IIcjBDUnnyBdQbq4w=="
    },
    "node_modules/redux-thunk": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/redux-thunk/-/redux-thunk-3.1.0.tgz",
      "integrity": "sha512-NW2r5T6ksUKXCabzhL9z+h206HQw/NJkcLm1GPImRQ8IzfXwRGqjVhKJGauHirT0DAuyy6hjdnMZaRoAcy0Klw==",
      "peerDependencies": {
        "redux": "^5.0.0"
      }
    },
    "node_modules/reselect": {
      "version": "5.1.1",
      "resolved": "https://registry.npmjs.org/reselect/-/reselect-5.1.1.tgz",
      "integrity": "sha512-K/BG6eIky/SBpzfHZv/dd+9JBFiS4SWV7FIujVyJRux6e45+73RaUHXLmIR1f7WOMaQ0U1km6qwklRQxpJJY0w=="
    },
    "node_modules/resolve": {
      "version": "1.22.11",
      "resolved": "https://registry.npmjs.org/resolve/-/resolve-1.22.11.tgz",
      "integrity": "sha512-RfqAvLnMl313r7c9oclB1HhUEAezcpLjz95wFH4LVuhk9JF/r22qmVP9AMmOU4vMX7Q8pN8jwNg/CSpdFnMjTQ==",
      "dev": true,
      "dependencies": {
        "is-core-module": "^2.16.1",
        "path-parse": "^1.0.7",
        "supports-preserve-symlinks-flag": "^1.0.0"
      },
      "bin": {
        "resolve": "bin/resolve"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/reusify": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/reusify/-/reusify-1.1.0.tgz",
      "integrity": "sha512-g6QUff04oZpHs0eG5p83rFLhHeV00ug/Yf9nZM6fLeUrPguBTkTQOdpAWWspMh55TZfVQDPaN3NQJfbVRAxdIw==",
      "dev": true,
      "engines": {
        "iojs": ">=1.0.0",
        "node": ">=0.10.0"
      }
    },
    "node_modules/rollup": {
      "version": "3.29.5",
      "resolved": "https://registry.npmjs.org/rollup/-/rollup-3.29.5.tgz",
      "integrity": "sha512-GVsDdsbJzzy4S/v3dqWPJ7EfvZJfCHiDqe80IyrF59LYuP+e6U1LJoUqeuqRbwAWoMNoXivMNeNAOf5E22VA1w==",
      "dev": true,
      "bin": {
        "rollup": "dist/bin/rollup"
      },
      "engines": {
        "node": ">=14.18.0",
        "npm": ">=8.0.0"
      },
      "optionalDependencies": {
        "fsevents": "~2.3.2"
      }
    },
    "node_modules/run-parallel": {
      "version": "1.2.0",
      "resolved": "https://registry.npmjs.org/run-parallel/-/run-parallel-1.2.0.tgz",
      "integrity": "sha512-5l4VyZR86LZ/lDxZTR6jqL8AFE2S0IFLMP26AbjsLVADxHdhB/c0GUsH+y39UfCi3dzz8OlQuPmnaJOMoDHQBA==",
      "dev": true,
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/feross"
        },
        {
          "type": "patreon",
          "url": "https://www.patreon.com/feross"
        },
        {
          "type": "consulting",
          "url": "https://feross.org/support"
        }
      ],
      "dependencies": {
        "queue-microtask": "^1.2.2"
      }
    },
    "node_modules/scheduler": {
      "version": "0.23.2",
      "resolved": "https://registry.npmjs.org/scheduler/-/scheduler-0.23.2.tgz",
      "integrity": "sha512-UOShsPwz7NrMUqhR6t0hWjFduvOzbtv7toDH1/hIrfRNIDBnnBWd0CwJTGvTpngVlmwGCdP9/Zl/tVrDqcuYzQ==",
      "dependencies": {
        "loose-envify": "^1.1.0"
      }
    },
    "node_modules/semver": {
      "version": "6.3.1",
      "resolved": "https://registry.npmjs.org/semver/-/semver-6.3.1.tgz",
      "integrity": "sha512-BR7VvDCVHO+q2xBEWskxS6DJE1qRnb7DxzUrogb71CWoSficBxYsiAGd+Kl0mmq/MprG9yArRkyrQxTO6XjMzA==",
      "dev": true,
      "bin": {
        "semver": "bin/semver.js"
      }
    },
    "node_modules/shebang-command": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/shebang-command/-/shebang-command-2.0.0.tgz",
      "integrity": "sha512-kHxr2zZpYtdmrN1qDjrrX/Z1rR1kG8Dx+gkpK1G4eXmvXswmcE1hTWBWYUzlraYw1/yZp6YuDY77YtvbN0dmDA==",
      "dev": true,
      "dependencies": {
        "shebang-regex": "^3.0.0"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/shebang-regex": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/shebang-regex/-/shebang-regex-3.0.0.tgz",
      "integrity": "sha512-7++dFhtcx3353uBaq8DDR4NuxBetBzC7ZQOhmTQInHEd6bSrXdiEyzCvG07Z44UYdLShWUyXt5M/yhz8ekcb1A==",
      "dev": true,
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/signal-exit": {
      "version": "4.1.0",
      "resolved": "https://registry.npmjs.org/signal-exit/-/signal-exit-4.1.0.tgz",
      "integrity": "sha512-bzyZ1e88w9O1iNJbKnOlvYTrWPDl46O1bG0D3XInv+9tkPrxrN8jUUTiFlDkkmKWgn1M6CfIA13SuGqOa9Korw==",
      "dev": true,
      "engines": {
        "node": ">=14"
      },
      "funding": {
        "url": "https://github.com/sponsors/isaacs"
      }
    },
    "node_modules/source-map-js": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/source-map-js/-/source-map-js-1.2.1.tgz",
      "integrity": "sha512-UXWMKhLOwVKb728IUtQPXxfYU+usdybtUrK/8uGE8CQMvrhOpwvzDBwj0QhSL7MQc7vIsISBG8VQ8+IDQxpfQA==",
      "dev": true,
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/string-width": {
      "version": "5.1.2",
      "resolved": "https://registry.npmjs.org/string-width/-/string-width-5.1.2.tgz",
      "integrity": "sha512-HnLOCR3vjcY8beoNLtcjZ5/nxn2afmME6lhrDrebokqMap+XbeW8n9TXpPDOqdGK5qcI3oT0GKTW6wC7EMiVqA==",
      "dev": true,
      "dependencies": {
        "eastasianwidth": "^0.2.0",
        "emoji-regex": "^9.2.2",
        "strip-ansi": "^7.0.1"
      },
      "engines": {
        "node": ">=12"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/string-width-cjs": {
      "name": "string-width",
      "version": "4.2.3",
      "resolved": "https://registry.npmjs.org/string-width/-/string-width-4.2.3.tgz",
      "integrity": "sha512-wKyQRQpjJ0sIp62ErSZdGsjMJWsap5oRNihHhu6G7JVO/9jIB6UyevL+tXuOqrng8j/cxKTWyWUwvSTriiZz/g==",
      "dev": true,
      "dependencies": {
        "emoji-regex": "^8.0.0",
        "is-fullwidth-code-point": "^3.0.0",
        "strip-ansi": "^6.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/string-width-cjs/node_modules/ansi-regex": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/ansi-regex/-/ansi-regex-5.0.1.tgz",
      "integrity": "sha512-quJQXlTSUGL2LH9SUXo8VwsY4soanhgo6LNSm84E1LBcE8s3O0wpdiRzyR9z/ZZJMlMWv37qOOb9pdJlMUEKFQ==",
      "dev": true,
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/string-width-cjs/node_modules/emoji-regex": {
      "version": "8.0.0",
      "resolved": "https://registry.npmjs.org/emoji-regex/-/emoji-regex-8.0.0.tgz",
      "integrity": "sha512-MSjYzcWNOA0ewAHpz0MxpYFvwg6yjy1NG3xteoqz644VCo/RPgnr1/GGt+ic3iJTzQ8Eu3TdM14SawnVUmGE6A==",
      "dev": true
    },
    "node_modules/string-width-cjs/node_modules/strip-ansi": {
      "version": "6.0.1",
      "resolved": "https://registry.npmjs.org/strip-ansi/-/strip-ansi-6.0.1.tgz",
      "integrity": "sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A==",
      "dev": true,
      "dependencies": {
        "ansi-regex": "^5.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/strip-ansi": {
      "version": "7.1.2",
      "resolved": "https://registry.npmjs.org/strip-ansi/-/strip-ansi-7.1.2.tgz",
      "integrity": "sha512-gmBGslpoQJtgnMAvOVqGZpEz9dyoKTCzy2nfz/n8aIFhN/jCE/rCmcxabB6jOOHV+0WNnylOxaxBQPSvcWklhA==",
      "dev": true,
      "dependencies": {
        "ansi-regex": "^6.0.1"
      },
      "engines": {
        "node": ">=12"
      },
      "funding": {
        "url": "https://github.com/chalk/strip-ansi?sponsor=1"
      }
    },
    "node_modules/strip-ansi-cjs": {
      "name": "strip-ansi",
      "version": "6.0.1",
      "resolved": "https://registry.npmjs.org/strip-ansi/-/strip-ansi-6.0.1.tgz",
      "integrity": "sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A==",
      "dev": true,
      "dependencies": {
        "ansi-regex": "^5.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/strip-ansi-cjs/node_modules/ansi-regex": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/ansi-regex/-/ansi-regex-5.0.1.tgz",
      "integrity": "sha512-quJQXlTSUGL2LH9SUXo8VwsY4soanhgo6LNSm84E1LBcE8s3O0wpdiRzyR9z/ZZJMlMWv37qOOb9pdJlMUEKFQ==",
      "dev": true,
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/sucrase": {
      "version": "3.35.0",
      "resolved": "https://registry.npmjs.org/sucrase/-/sucrase-3.35.0.tgz",
      "integrity": "sha512-8EbVDiu9iN/nESwxeSxDKe0dunta1GOlHufmSSXxMD2z2/tMZpDMpvXQGsc+ajGo8y2uYUmixaSRUc/QPoQ0GA==",
      "dev": true,
      "dependencies": {
        "@jridgewell/gen-mapping": "^0.3.2",
        "commander": "^4.0.0",
        "glob": "^10.3.10",
        "lines-and-columns": "^1.1.6",
        "mz": "^2.7.0",
        "pirates": "^4.0.1",
        "ts-interface-checker": "^0.1.9"
      },
      "bin": {
        "sucrase": "bin/sucrase",
        "sucrase-node": "bin/sucrase-node"
      },
      "engines": {
        "node": ">=16 || 14 >=14.17"
      }
    },
    "node_modules/supports-preserve-symlinks-flag": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/supports-preserve-symlinks-flag/-/supports-preserve-symlinks-flag-1.0.0.tgz",
      "integrity": "sha512-ot0WnXS9fgdkgIcePe6RHNk1WA8+muPa6cSjeR3V8K27q9BB1rTE3R1p7Hv0z1ZyAc8s6Vvv8DIyWf681MAt0w==",
      "dev": true,
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/tabbable": {
      "version": "6.3.0",
      "resolved": "https://registry.npmjs.org/tabbable/-/tabbable-6.3.0.tgz",
      "integrity": "sha512-EIHvdY5bPLuWForiR/AN2Bxngzpuwn1is4asboytXtpTgsArc+WmSJKVLlhdh71u7jFcryDqB2A8lQvj78MkyQ=="
    },
    "node_modules/tailwindcss": {
      "version": "3.4.18",
      "resolved": "https://registry.npmjs.org/tailwindcss/-/tailwindcss-3.4.18.tgz",
      "integrity": "sha512-6A2rnmW5xZMdw11LYjhcI5846rt9pbLSabY5XPxo+XWdxwZaFEn47Go4NzFiHu9sNNmr/kXivP1vStfvMaK1GQ==",
      "dev": true,
      "dependencies": {
        "@alloc/quick-lru": "^5.2.0",
        "arg": "^5.0.2",
        "chokidar": "^3.6.0",
        "didyoumean": "^1.2.2",
        "dlv": "^1.1.3",
        "fast-glob": "^3.3.2",
        "glob-parent": "^6.0.2",
        "is-glob": "^4.0.3",
        "jiti": "^1.21.7",
        "lilconfig": "^3.1.3",
        "micromatch": "^4.0.8",
        "normalize-path": "^3.0.0",
        "object-hash": "^3.0.0",
        "picocolors": "^1.1.1",
        "postcss": "^8.4.47",
        "postcss-import": "^15.1.0",
        "postcss-js": "^4.0.1",
        "postcss-load-config": "^4.0.2 || ^5.0 || ^6.0",
        "postcss-nested": "^6.2.0",
        "postcss-selector-parser": "^6.1.2",
        "resolve": "^1.22.8",
        "sucrase": "^3.35.0"
      },
      "bin": {
        "tailwind": "lib/cli.js",
        "tailwindcss": "lib/cli.js"
      },
      "engines": {
        "node": ">=14.0.0"
      }
    },
    "node_modules/thenify": {
      "version": "3.3.1",
      "resolved": "https://registry.npmjs.org/thenify/-/thenify-3.3.1.tgz",
      "integrity": "sha512-RVZSIV5IG10Hk3enotrhvz0T9em6cyHBLkH/YAZuKqd8hRkKhSfCGIcP2KUY0EPxndzANBmNllzWPwak+bheSw==",
      "dev": true,
      "dependencies": {
        "any-promise": "^1.0.0"
      }
    },
    "node_modules/thenify-all": {
      "version": "1.6.0",
      "resolved": "https://registry.npmjs.org/thenify-all/-/thenify-all-1.6.0.tgz",
      "integrity": "sha512-RNxQH/qI8/t3thXJDwcstUO4zeqo64+Uy/+sNVRBx4Xn2OX+OZ9oP+iJnNFqplFra2ZUVeKCSa2oVWi3T4uVmA==",
      "dev": true,
      "dependencies": {
        "thenify": ">= 3.1.0 < 4"
      },
      "engines": {
        "node": ">=0.8"
      }
    },
    "node_modules/tiny-invariant": {
      "version": "1.3.3",
      "resolved": "https://registry.npmjs.org/tiny-invariant/-/tiny-invariant-1.3.3.tgz",
      "integrity": "sha512-+FbBPE1o9QAYvviau/qC5SE3caw21q3xkvWKBtja5vgqOWIHHJ3ioaq1VPfn/Szqctz2bU/oYeKd9/z5BL+PVg=="
    },
    "node_modules/to-regex-range": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/to-regex-range/-/to-regex-range-5.0.1.tgz",
      "integrity": "sha512-65P7iz6X5yEr1cwcgvQxbbIw7Uk3gOy5dIdtZ4rDveLqhrdJP+Li/Hx6tyK0NEb+2GCyneCMJiGqrADCSNk8sQ==",
      "dev": true,
      "dependencies": {
        "is-number": "^7.0.0"
      },
      "engines": {
        "node": ">=8.0"
      }
    },
    "node_modules/ts-interface-checker": {
      "version": "0.1.13",
      "resolved": "https://registry.npmjs.org/ts-interface-checker/-/ts-interface-checker-0.1.13.tgz",
      "integrity": "sha512-Y/arvbn+rrz3JCKl9C4kVNfTfSm2/mEp5FSz5EsZSANGPSlQrpRI5M4PKF+mJnE52jOO90PnPSc3Ur3bTQw0gA==",
      "dev": true
    },
    "node_modules/tslib": {
      "version": "2.8.1",
      "resolved": "https://registry.npmjs.org/tslib/-/tslib-2.8.1.tgz",
      "integrity": "sha512-oJFu94HQb+KVduSUQL7wnpmqnfmLsOA/nAh6b6EH0wCEoK0/mPeXU6c3wKDV83MkOuHPRHtSXKKU99IBazS/2w=="
    },
    "node_modules/update-browserslist-db": {
      "version": "1.1.4",
      "resolved": "https://registry.npmjs.org/update-browserslist-db/-/update-browserslist-db-1.1.4.tgz",
      "integrity": "sha512-q0SPT4xyU84saUX+tomz1WLkxUbuaJnR1xWt17M7fJtEJigJeWUNGUqrauFXsHnqev9y9JTRGwk13tFBuKby4A==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/browserslist"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/browserslist"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "dependencies": {
        "escalade": "^3.2.0",
        "picocolors": "^1.1.1"
      },
      "bin": {
        "update-browserslist-db": "cli.js"
      },
      "peerDependencies": {
        "browserslist": ">= 4.21.0"
      }
    },
    "node_modules/use-sync-external-store": {
      "version": "1.6.0",
      "resolved": "https://registry.npmjs.org/use-sync-external-store/-/use-sync-external-store-1.6.0.tgz",
      "integrity": "sha512-Pp6GSwGP/NrPIrxVFAIkOQeyw8lFenOHijQWkUTrDvrF4ALqylP2C/KCkeS9dpUM3KvYRQhna5vt7IL95+ZQ9w==",
      "peerDependencies": {
        "react": "^16.8.0 || ^17.0.0 || ^18.0.0 || ^19.0.0"
      }
    },
    "node_modules/util-deprecate": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/util-deprecate/-/util-deprecate-1.0.2.tgz",
      "integrity": "sha512-EPD5q1uXyFxJpCrLnCc1nHnq3gOa6DZBocAIiI2TaSCA7VCJ1UJDMagCzIkXNsUYfD1daK//LTEQ8xiIbrHtcw==",
      "dev": true
    },
    "node_modules/victory-vendor": {
      "version": "37.3.6",
      "resolved": "https://registry.npmjs.org/victory-vendor/-/victory-vendor-37.3.6.tgz",
      "integrity": "sha512-SbPDPdDBYp+5MJHhBCAyI7wKM3d5ivekigc2Dk2s7pgbZ9wIgIBYGVw4zGHBml/qTFbexrofXW6Gu4noGxrOwQ==",
      "dependencies": {
        "@types/d3-array": "^3.0.3",
        "@types/d3-ease": "^3.0.0",
        "@types/d3-interpolate": "^3.0.1",
        "@types/d3-scale": "^4.0.2",
        "@types/d3-shape": "^3.1.0",
        "@types/d3-time": "^3.0.0",
        "@types/d3-timer": "^3.0.0",
        "d3-array": "^3.1.6",
        "d3-ease": "^3.0.1",
        "d3-interpolate": "^3.0.1",
        "d3-scale": "^4.0.2",
        "d3-shape": "^3.1.0",
        "d3-time": "^3.0.0",
        "d3-timer": "^3.0.1"
      }
    },
    "node_modules/vite": {
      "version": "4.5.14",
      "resolved": "https://registry.npmjs.org/vite/-/vite-4.5.14.tgz",
      "integrity": "sha512-+v57oAaoYNnO3hIu5Z/tJRZjq5aHM2zDve9YZ8HngVHbhk66RStobhb1sqPMIPEleV6cNKYK4eGrAbE9Ulbl2g==",
      "dev": true,
      "dependencies": {
        "esbuild": "^0.18.10",
        "postcss": "^8.4.27",
        "rollup": "^3.27.1"
      },
      "bin": {
        "vite": "bin/vite.js"
      },
      "engines": {
        "node": "^14.18.0 || >=16.0.0"
      },
      "funding": {
        "url": "https://github.com/vitejs/vite?sponsor=1"
      },
      "optionalDependencies": {
        "fsevents": "~2.3.2"
      },
      "peerDependencies": {
        "@types/node": ">= 14",
        "less": "*",
        "lightningcss": "^1.21.0",
        "sass": "*",
        "stylus": "*",
        "sugarss": "*",
        "terser": "^5.4.0"
      },
      "peerDependenciesMeta": {
        "@types/node": {
          "optional": true
        },
        "less": {
          "optional": true
        },
        "lightningcss": {
          "optional": true
        },
        "sass": {
          "optional": true
        },
        "stylus": {
          "optional": true
        },
        "sugarss": {
          "optional": true
        },
        "terser": {
          "optional": true
        }
      }
    },
    "node_modules/void-elements": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/void-elements/-/void-elements-3.1.0.tgz",
      "integrity": "sha512-Dhxzh5HZuiHQhbvTW9AMetFfBHDMYpo23Uo9btPXgdYP+3T5S+p+jgNy7spra+veYhBP2dCSgxR/i2Y02h5/6w==",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/which": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/which/-/which-2.0.2.tgz",
      "integrity": "sha512-BLI3Tl1TW3Pvl70l3yq3Y64i+awpwXqsGBYWkkqMtnbXgrMD+yj7rhW0kuEDxzJaYXGjEW5ogapKNMEKNMjibA==",
      "dev": true,
      "dependencies": {
        "isexe": "^2.0.0"
      },
      "bin": {
        "node-which": "bin/node-which"
      },
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/wrap-ansi": {
      "version": "8.1.0",
      "resolved": "https://registry.npmjs.org/wrap-ansi/-/wrap-ansi-8.1.0.tgz",
      "integrity": "sha512-si7QWI6zUMq56bESFvagtmzMdGOtoxfR+Sez11Mobfc7tm+VkUckk9bW2UeffTGVUbOksxmSw0AA2gs8g71NCQ==",
      "dev": true,
      "dependencies": {
        "ansi-styles": "^6.1.0",
        "string-width": "^5.0.1",
        "strip-ansi": "^7.0.1"
      },
      "engines": {
        "node": ">=12"
      },
      "funding": {
        "url": "https://github.com/chalk/wrap-ansi?sponsor=1"
      }
    },
    "node_modules/wrap-ansi-cjs": {
      "name": "wrap-ansi",
      "version": "7.0.0",
      "resolved": "https://registry.npmjs.org/wrap-ansi/-/wrap-ansi-7.0.0.tgz",
      "integrity": "sha512-YVGIj2kamLSTxw6NsZjoBxfSwsn0ycdesmc4p+Q21c5zPuZ1pl+NfxVdxPtdHvmNVOQ6XSYG4AUtyt/Fi7D16Q==",
      "dev": true,
      "dependencies": {
        "ansi-styles": "^4.0.0",
        "string-width": "^4.1.0",
        "strip-ansi": "^6.0.0"
      },
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/chalk/wrap-ansi?sponsor=1"
      }
    },
    "node_modules/wrap-ansi-cjs/node_modules/ansi-regex": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/ansi-regex/-/ansi-regex-5.0.1.tgz",
      "integrity": "sha512-quJQXlTSUGL2LH9SUXo8VwsY4soanhgo6LNSm84E1LBcE8s3O0wpdiRzyR9z/ZZJMlMWv37qOOb9pdJlMUEKFQ==",
      "dev": true,
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/wrap-ansi-cjs/node_modules/ansi-styles": {
      "version": "4.3.0",
      "resolved": "https://registry.npmjs.org/ansi-styles/-/ansi-styles-4.3.0.tgz",
      "integrity": "sha512-zbB9rCJAT1rbjiVDb2hqKFHNYLxgtk8NURxZ3IZwD3F6NtxbXZQCnnSi1Lkx+IDohdPlFp222wVALIheZJQSEg==",
      "dev": true,
      "dependencies": {
        "color-convert": "^2.0.1"
      },
      "engines": {
        "node": ">=8"
      },
      "funding": {
        "url": "https://github.com/chalk/ansi-styles?sponsor=1"
      }
    },
    "node_modules/wrap-ansi-cjs/node_modules/emoji-regex": {
      "version": "8.0.0",
      "resolved": "https://registry.npmjs.org/emoji-regex/-/emoji-regex-8.0.0.tgz",
      "integrity": "sha512-MSjYzcWNOA0ewAHpz0MxpYFvwg6yjy1NG3xteoqz644VCo/RPgnr1/GGt+ic3iJTzQ8Eu3TdM14SawnVUmGE6A==",
      "dev": true
    },
    "node_modules/wrap-ansi-cjs/node_modules/string-width": {
      "version": "4.2.3",
      "resolved": "https://registry.npmjs.org/string-width/-/string-width-4.2.3.tgz",
      "integrity": "sha512-wKyQRQpjJ0sIp62ErSZdGsjMJWsap5oRNihHhu6G7JVO/9jIB6UyevL+tXuOqrng8j/cxKTWyWUwvSTriiZz/g==",
      "dev": true,
      "dependencies": {
        "emoji-regex": "^8.0.0",
        "is-fullwidth-code-point": "^3.0.0",
        "strip-ansi": "^6.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/wrap-ansi-cjs/node_modules/strip-ansi": {
      "version": "6.0.1",
      "resolved": "https://registry.npmjs.org/strip-ansi/-/strip-ansi-6.0.1.tgz",
      "integrity": "sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A==",
      "dev": true,
      "dependencies": {
        "ansi-regex": "^5.0.1"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/yallist": {
      "version": "3.1.1",
      "resolved": "https://registry.npmjs.org/yallist/-/yallist-3.1.1.tgz",
      "integrity": "sha512-a4UGQaWPH59mOXUYnAG2ewncQS4i4F43Tv3JoAM+s2VDAmS9NsK8GpDMLrCHPksFT7h3K6TOoUNn2pb7RoXx4g==",
      "dev": true
    }
  }
}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\postcss.config.cjs
--------------------------------------------------------------------
module.exports = {
  plugins: {
    tailwindcss: {},
    autoprefixer: {},
  },
};

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\README.md
--------------------------------------------------------------------
# Demo-App
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src
--------------------------------------------------------------------
Contents:
api
App.jsx
components
context
i18n.js
index.css
locales
main.jsx
PrivateRoute.jsx
services
utils

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\api
--------------------------------------------------------------------
Contents:
apiClient.js

====================================================================
📄 File: G:\FINALCODE\frontend\src\api\apiClient.js
--------------------------------------------------------------------
import axios from 'axios';
import authService from '../services/authService';
// We can't use the hook here, so we import the i18n instance
import i18n from '../i18n';

const API_BASE = import.meta.env.VITE_API_BASE || 'http://localhost:8080';

const api = axios.create({
  baseURL: API_BASE,
  headers: { 'Content-Type': 'application/json' }
});

api.interceptors.request.use((config) => {
  const token = authService.getAccessToken();
  // Get language from i18n instance or localStorage
  const lang = i18n.language || localStorage.getItem('sr_lang') || 'en';

  if (token) {
    config.headers.Authorization = `Bearer ${token}`;
  }
  config.headers['Accept-Language'] = lang;

  return config;
});

let isRefreshing = false;
let refreshQueue = [];

function processQueue(err, newToken = null) {
  refreshQueue.forEach(p => (err ? p.reject(err) : p.resolve(newToken)));
  refreshQueue = [];
}

api.interceptors.response.use(
  res => res,
  async err => {
    const originalReq = err.config;

    if (!originalReq || originalReq._retry) return Promise.reject(err);

    if (err.response && err.response.status === 401) {
      originalReq._retry = true;

      try {
        if (!isRefreshing) {
          isRefreshing = true;
          const newTokens = await authService.refresh();
          isRefreshing = false;
          processQueue(null, newTokens.accessToken);
        }

        return new Promise((resolve, reject) => {
          refreshQueue.push({
            resolve: token => {
              originalReq.headers.Authorization = `Bearer ${token}`;
              resolve(api(originalReq));
            },
            reject: error => reject(error)
          });
        });
      } catch (refreshError) {
        processQueue(refreshError, null);
        // Use translated error
        return Promise.reject(new Error(i18n.t('errors.refreshFailed')));
      }
    }

    return Promise.reject(err);
  }
);

export default api;
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\App.jsx
--------------------------------------------------------------------
import React from 'react';
import { Outlet } from 'react-router-dom';

/**
 * This is the root component.
 * It only renders an <Outlet>, which will be filled by either
 * AuthLayout (for /login) or MainLayout (for /dashboard).
 */
export default function App() {
  return (
    <Outlet />
  );
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\components
--------------------------------------------------------------------
Contents:
analytics
auth
bills
checkout
common
customers
layout
products
profile
reports

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\components\analytics
--------------------------------------------------------------------
Contents:
AnalyticsDashboard.jsx
AnalyticsSummary.jsx
ChartUtils.jsx
icons.tsx
RevenueTrendChart.jsx
SalesByCategoryChart.jsx
TopProductsChart.jsx
TopProductsList.jsx

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\analytics\AnalyticsDashboard.jsx
--------------------------------------------------------------------
import React, { useEffect, useState, useMemo, useCallback } from 'react';
import api from '../../api/apiClient';
import { motion } from 'framer-motion';
import CountUp from 'react-countup';
import DatePicker from 'react-datepicker';
import 'react-datepicker/dist/react-datepicker.css';
import {
  ResponsiveContainer, AreaChart, Area, PieChart, Pie, Cell,
  XAxis, YAxis, CartesianGrid, Tooltip,
} from 'recharts';
import { useTranslation } from 'react-i18next';
import { useTheme } from '../../context/ThemeContext'; // <-- THIS IS THE FIX

/* -------------------------------------------------------------------------- */
/* ICON COMPONENTS                              */
/* -------------------------------------------------------------------------- */
const RevenueIcon = () => (
  <svg className="w-8 h-8 text-cyan-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2}
      d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.105 0 2 .895 2 2s-.895 2-2 2-2-.895-2-2 .895-2 2-2zm0-4c-3.314 0-6 2.686-6 6s2.686 6 6 6 6-2.686 6-6-2.686-6-6-6z" />
  </svg>
);
const OrdersIcon = () => (
  <svg className="w-8 h-8 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2}
      d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" />
  </svg>
);
const ProductsSoldIcon = () => (
  <svg className="w-8 h-8 text-amber-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2}
      d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
  </svg>
);
const CalendarIcon = () => (
  <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2}
      d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
  </svg>
);

/* -------------------------------------------------------------------------- */
/* CHART UTILITIES                                */
/* -------------------------------------------------------------------------- */
const CHART_TEXT = "#9ca3af"; // light text for dark charts
const CHART_TEXT_LIGHT = "#374151"; // dark text for light charts
const PIE_COLORS = ['#3b82f6', '#8b5cf6', '#10b981', '#f59e0b', '#ef4444', '#06b6d4', '#ec4899'];

// Tooltip for Area Chart
const CustomTooltip = ({ active, payload, label, t }) => { // <-- Pass t
  if (!active || !payload?.length) return null;
  const value = payload[0].value;
  const formatted = typeof value === 'number'
    ? value.toLocaleString('en-IN', { style: 'currency', currency: 'INR', maximumFractionDigits: 0 })
    : value;

  return (
    <motion.div
      initial={{ opacity: 0, scale: 0.9 }}
      animate={{ opacity: 1, scale: 1 }}
      // UPDATED: Theme-aware
      className="bg-white dark:bg-gray-900/90 shadow-2xl dark:backdrop-blur-lg border border-gray-300 dark:border-gray-700 p-4 rounded-xl"
    >
      <p className="text-xs font-bold text-gray-900 dark:text-white mb-1">{label || payload[0].name}</p>
      <p className="text-sm font-medium" style={{ color: payload[0].color }}>
        {t('dashboard.revenue')}: {formatted}
      </p>
    </motion.div>
  );
};

// Tooltip for Pie Chart
const CustomPieTooltip = ({ active, payload, t }) => { // <-- Pass t
  if (!active || !payload?.length) return null;
  const data = payload[0];
  return (
    <motion.div
      initial={{ opacity: 0, scale: 0.9 }}
      animate={{ opacity: 1, scale: 1 }}
      // UPDATED: Theme-aware
      className="bg-white dark:bg-gray-900/90 shadow-2xl dark:backdrop-blur-lg border border-gray-300 dark:border-gray-700 p-4 rounded-xl"
    >
      <p className="text-sm font-bold text-gray-900 dark:text-white mb-1">{data.payload.name}</p>
      <p className="text-sm text-cyan-600 dark:text-cyan-400 font-medium">
        {t('dashboard.revenue')}: {data.value.toLocaleString('en-IN', { style: 'currency', currency: 'INR' })}
      </p>
      <p className="text-xs text-gray-600 dark:text-gray-300 mt-1">
        {data.payload.percent?.toFixed(1)}{t('dashboard.percentOfTotal')}
      </p>
    </motion.div>
  );
};

/* -------------------------------------------------------------------------- */
/* ANIMATION VARIANTS                             */
/* -------------------------------------------------------------------------- */
const fadeUp = {
  hidden: { opacity: 0, y: 20 },
  visible: { opacity: 1, y: 0, transition: { duration: 0.6, ease: "easeOut" } },
};
const container = {
  hidden: { opacity: 0 },
  visible: { opacity: 1, transition: { staggerChildren: 0.12, delayChildren: 0.2 } },
};

/* -------------------------------------------------------------------------- */
/* PREMIUM STAT CARD                             */
/* -------------------------------------------------------------------------- */
const StatCard = ({ title, value, change, icon, color, t }) => { // <-- Pass t
  const isUp = parseFloat(change) >= 0;
  const trendColor = isUp ? "text-emerald-500 dark:text-emerald-400" : "text-red-500 dark:text-red-400";

  // UPDATED: Theme-aware gradients
  const bgGradient = {
    cyan: "from-cyan-500/10 to-cyan-600/5 dark:from-cyan-500/20 dark:to-cyan-600/10",
    blue: "from-blue-500/10 to-blue-600/5 dark:from-blue-500/20 dark:to-blue-600/10",
    amber: "from-amber-500/10 to-amber-600/5 dark:from-amber-500/20 dark:to-amber-600/10",
  }[color];

  return (
    <motion.div
      variants={fadeUp}
      whileHover={{ scale: 1.02, transition: { duration: 0.2 } }}
      // UPDATED: Theme-aware card
      className={`relative overflow-hidden rounded-2xl bg-gradient-to-br ${bgGradient} p-6
                  border border-gray-200 dark:border-gray-800 backdrop-blur-sm
                  shadow-lg hover:shadow-xl transition-all duration-300`}
    >
      <div className="relative flex items-center justify-between">
        <div className="relative">
          <div className={`absolute inset-0 rounded-full bg-${color}-500/30 blur-xl scale-75`} />
          {/* UPDATED: Theme-aware icon BG */}
          <div className="relative bg-white/70 dark:bg-gray-900/80 p-3 rounded-xl backdrop-blur-sm border border-gray-300 dark:border-gray-700">
            {icon}
          </div>
        </div>
        {change && (
          // UPDATED: Theme-aware chip
          <div className={`flex items-center gap-1 text-xs font-bold ${trendColor} bg-white/60 dark:bg-gray-900/60 px-3 py-1.5 rounded-full`}>
            {isUp ? t('dashboard.up') : t('dashboard.down')} {Math.abs(parseFloat(change)).toFixed(1)}%
          </div>
        )}
      </div>
      <div className="mt-5">
        {/* UPDATED: Theme-aware text */}
        <p className="text-sm font-medium text-gray-600 dark:text-gray-400">{title}</p>
        <p className="text-3xl font-bold text-gray-900 dark:text-white mt-1">
          <CountUp
            end={value}
            duration={2}
            separator=","
            prefix={title.includes(t('dashboard.totalRevenue')) ? "₹" : ""}
          />
        </p>
      </div>
    </motion.div>
  );
};

/* -------------------------------------------------------------------------- */
/* REVENUE HERO CHART                            */
/* -------------------------------------------------------------------------- */
const RevenueHeroChart = ({ data, totalRevenue, t, theme }) => { // <-- Pass t and theme
  const [active, setActive] = useState({ value: totalRevenue, label: t('dashboard.totalRevenue') });

  const handleHover = useCallback((payload) => {
    if (payload) setActive({ value: payload.totalRevenue, label: payload.day });
  }, []);

  const handleLeave = useCallback(() => {
    setActive({ value: totalRevenue, label: t('dashboard.totalRevenue') });
  }, [totalRevenue, t]);

  const textColor = theme === 'light' ? CHART_TEXT_LIGHT : CHART_TEXT;

  return (
    <motion.div
      variants={fadeUp}
      // UPDATED: Theme-aware card
      className="relative rounded-2xl bg-white dark:bg-gray-900/70 dark:backdrop-blur-xl border border-gray-200 dark:border-gray-800 overflow-visible shadow-2xl"
    >
      {/* UPDATED: Theme-aware header */}
      <div className="p-6 border-b border-gray-200 dark:border-gray-800 bg-gradient-to-r from-cyan-500/5 to-emerald-500/5 dark:from-cyan-900/20 dark:to-emerald-900/20">
        <p className="text-sm font-medium text-gray-600 dark:text-gray-300">{active.label}</p>
        <p className="text-4xl font-extrabold text-gray-900 dark:text-white mt-1">
          <CountUp start={active.value * 0.8} end={active.value} duration={0.6} separator="," prefix="₹" />
        </p>
      </div>

      <div className="h-80">
        <ResponsiveContainer width="100%" height="100%">
          <AreaChart
            data={data}
            margin={{ top: 10, right: 30, left: 0, bottom: 0 }}
            onMouseMove={(e) => e.activePayload && handleHover(e.activePayload[0].payload)}
            onMouseLeave={handleLeave}
          >
            <defs>
              <linearGradient id="glowStroke" x1="0" y1="0" x2="1" y2="0">
                <stop offset="0%" stopColor="#06b6d4" />
                <stop offset="100%" stopColor="#10b981" />
              </linearGradient>
              <linearGradient id="areaFill" x1="0" y1="0" x2="0" y2="1">
                <stop offset="0%" stopColor="#34d399" stopOpacity={0.6} />
                <stop offset="100%" stopColor="#064e3b" stopOpacity={0} />
              </linearGradient>
            </defs>
            {/* UPDATED: Theme-aware grid/axis */}
            <CartesianGrid stroke={theme === 'light' ? 'rgba(0,0,0,0.08)' : 'rgba(255,255,255,0.06)'} strokeDasharray="4 4" />
            <XAxis dataKey="day" stroke={textColor} tick={{ fill: textColor, fontSize: 12 }} />
            <YAxis stroke={textColor} tick={{ fill: textColor, fontSize: 12 }}
              tickFormatter={(v) => `₹${(v / 1000).toFixed(0)}k`} />
            <Tooltip content={<CustomTooltip t={t} />} cursor={{ stroke: theme === 'light' ? '#d1d5db' : '#4b5563', strokeWidth: 1 }} />
            <Area
              type="monotone"
              dataKey="totalRevenue"
              stroke="url(#glowStroke)"
              strokeWidth={3}
              fill="url(#areaFill)"
              dot={false}
              activeDot={{ r: 6, stroke: '#10b981', strokeWidth: 2 }}
              animationDuration={1200}
            />
          </AreaChart>
        </ResponsiveContainer>
      </div>
    </motion.div>
  );
};

/* -------------------------------------------------------------------------- */
/* SALES BY CATEGORY DONUT CHART                      */
/* -------------------------------------------------------------------------- */
const SalesByCategoryChart = ({ data, t, theme }) => { // <-- Pass t and theme
  const { chartData, total } = useMemo(() => {
    // ... (logic is fine, no changes needed)
    const map = data.reduce((acc, p) => {
      const cat = p.category || 'Other';
      acc[cat] = (acc[cat] || 0) + p.revenue;
      return acc;
    }, {});
    const total = Object.values(map).reduce((a, b) => a + b, 0);
    const sorted = Object.entries(map)
      .map(([name, value], i) => ({
        name,
        value,
        percent: total ? (value / total) * 100 : 0,
        color: PIE_COLORS[i % PIE_COLORS.length],
      }))
      .sort((a, b) => b.value - a.value);
    return { chartData: sorted, total };
  }, [data]);

  const textColor = theme === 'light' ? CHART_TEXT_LIGHT : CHART_TEXT;

  return (
    <motion.div
      variants={fadeUp}
      // UPDATED: Theme-aware card
      className="rounded-2xl bg-white dark:bg-gray-900/70 dark:backdrop-blur-xl border border-gray-200 dark:border-gray-800 p-6 shadow-2xl h-full flex flex-col"
    >
      <h3 className="text-lg font-bold text-gray-900 dark:text-white mb-4">{t('dashboard.salesByCategory')}</h3>
      <div className="flex-grow relative min-h-[300px]">
        <ResponsiveContainer width="100%" height="100%">
          <PieChart>
            {/* UPDATED: Theme-aware text */}
            <text x="50%" y="45%" textAnchor="middle" className="text-xs fill-gray-600 dark:fill-gray-400 font-medium">
              {t('dashboard.total')}
            </text>
            <text x="50%" y="55%" textAnchor="middle" className="text-2xl font-bold fill-gray-900 dark:fill-white">
              {total.toLocaleString('en-IN', { style: 'currency', currency: 'INR', maximumFractionDigits: 0 })}
            </text>
            <Pie
              data={chartData}
              dataKey="value"
              nameKey="name"
              cx="50%"
              cy="50%"
              innerRadius="60%"
              outerRadius="80%"
              paddingAngle={3}
              animationDuration={1000}
              labelLine={false}
            >
              {chartData.map((entry, index) => (
                <Cell key={`cell-${index}`} fill={entry.color} />
              ))}
            </Pie>
            <Tooltip content={<CustomPieTooltip t={t} />} />
          </PieChart>
        </ResponsiveContainer>
      </div>

      <div className="mt-4 space-y-2 max-h-32 overflow-y-auto custom-scrollbar">
        {chartData.map((d, index) => (
          <motion.div
            key={d.name}
            initial={{ opacity: 0, x: -10 }}
            animate={{ opacity: 1, x: 0 }}
            transition={{ delay: index * 0.1 }}
            // UPDATED: Theme-aware legend item
            className="flex items-center justify-between text-sm group hover:bg-gray-100 dark:hover:bg-gray-800/50 px-3 py-2 rounded-lg transition-colors duration-200"
          >
            <div className="flex items-center gap-3 flex-1 min-w-0">
              <div
                className="w-3 h-3 rounded-full flex-shrink-0 shadow-sm"
                style={{ backgroundColor: d.color }}
              />
              <span className="text-gray-700 dark:text-gray-300 truncate font-medium group-hover:text-gray-900 dark:group-hover:text-white transition-colors">
                {d.name}
              </span>
            </div>
            <div className="flex items-center gap-3 flex-shrink-0">
              <span className="text-emerald-600 dark:text-emerald-400 font-bold text-xs">
                {d.percent.toFixed(1)}%
              </span>
              <span className="text-gray-900 dark:text-white font-semibold text-xs w-20 text-right">
                {d.value.toLocaleString('en-IN', {
                  style: 'currency',
                  currency: 'INR',
                  maximumFractionDigits: 0
                })}
              </span>
            </div>
          </motion.div>
        ))}
      </div>
    </motion.div>
  );
};

/* -------------------------------------------------------------------------- */
/* TOP PRODUCTS LEADERBOARD                         */
/* -------------------------------------------------------------------------- */
const TopProductsList = ({ data, t }) => { // <-- Pass t
  const top7 = data.slice(0, 7);
  const max = top7[0]?.revenue || 1;

  return (
    <motion.div
      variants={fadeUp}
      // UPDATED: Theme-aware
      className="rounded-2xl bg-white dark:bg-gray-900/70 dark:backdrop-blur-xl border border-gray-200 dark:border-gray-800 p-6 shadow-2xl h-full flex flex-col"
    >
      <h3 className="text-lg font-bold text-gray-900 dark:text-white mb-4">{t('dashboard.topProducts')}</h3>
      <div className="space-y-4 flex-grow overflow-y-auto custom-scrollbar">
        {top7.map((p, i) => (
          <motion.div
            key={p.productId}
            initial={{ opacity: 0, x: -20 }}
            animate={{ opacity: 1, x: 0 }}
            transition={{ delay: i * 0.1 }}
            // UPDATED: Theme-aware
            className="group hover:bg-gray-100 dark:hover:bg-gray-800/30 p-3 rounded-xl transition-all duration-200"
          >
            <div className="flex items-center justify-between mb-2">
              <span className="text-sm font-medium text-gray-900 dark:text-white truncate pr-2 group-hover:text-cyan-600 dark:group-hover:text-cyan-100 transition-colors">
                {i + 1}. {p.name}
              </span>
              <span className="text-sm font-bold text-emerald-600 dark:text-emerald-400 flex-shrink-0">
                {p.revenue.toLocaleString('en-IN', { style: 'currency', currency: 'INR', maximumFractionDigits: 0 })}
              </span>
            </div>
            {/* UPDATED: Theme-aware */}
            <div className="h-2 bg-gray-200 dark:bg-gray-800 rounded-full overflow-hidden">
              <motion.div
                initial={{ width: 0 }}
                animate={{ width: `${(p.revenue / max) * 100}%` }}
                transition={{ duration: 0.8, delay: 0.3 + i * 0.05, ease: "easeOut" }}
                className="h-full bg-gradient-to-r from-cyan-500 to-emerald-500 rounded-full shadow-glow"
              />
            </div>
          </motion.div>
        ))}
      </div>
    </motion.div>
  );
};

/* -------------------------------------------------------------------------- */
/* MAIN COMPONENT                             */
/* -------------------------------------------------------------------------- */
export default function AnalyticsDashboard() {
  const { t } = useTranslation(); // <-- 2. Get hook
  const { theme } = useTheme(); // <-- 3. Get theme

  const [reportData, setReportData] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);
  const [startDate, setStartDate] = useState(new Date(new Date().setDate(new Date().getDate() - 30)));
  const [endDate, setEndDate] = useState(new Date());

  const formatAPI = (d) => d.toISOString().split('T')[0];

  /* ------------------------------- FETCH DATA ------------------------------ */
  useEffect(() => {
    const fetchData = async () => {
      if (!startDate || !endDate) {
        setReportData(null);
        setLoading(false);
        return;
      }
      try {
        setLoading(true);
        const params = { startDate: formatAPI(startDate), endDate: formatAPI(endDate) };
        const res = await api.get('/api/analytics/report', { params });
        setReportData(res.data);
      } catch (err) {
        setError(t('dashboard.error')); // <-- Use translation
        console.error(err);
      } finally {
        setLoading(false);
      }
    };
    fetchData();
  }, [startDate, endDate, t]); // <-- Add t to dependency array

  const { summary = {}, revenue_trend = [], top_products = [] } = reportData || {};

  const changes = useMemo(() => {
    // ... (logic is fine, no changes)
    if (!revenue_trend.length) return { revenue: "0%", orders: "0%", products: "0%" };
    const first = revenue_trend[0].totalRevenue;
    const last = revenue_trend[revenue_trend.length - 1].totalRevenue;
    const rev = first > 0 ? ((last - first) / first) * 100 : 0;
    return {
      revenue: `${rev.toFixed(1)}%`,
      orders: `+${(Math.random() * 8 + 2).toFixed(1)}%`,
      products: `+${(Math.random() * 6 + 1).toFixed(1)}%`,
    };
  }, [revenue_trend]);

  /* --------------------------------- LOADING -------------------------------- */
  if (loading && !reportData) {
    return (
      <div className="flex items-center justify-center h-screen">
        <div className="text-2xl font-bold text-gray-500 dark:text-gray-400 animate-pulse">
          {t('dashboard.loading')}
        </div>
      </div>
    );
  }

  /* ---------------------------------- ERROR --------------------------------- */
  if (error) {
    return (
      <div className="p-8 text-center">
        <p className="text-red-500 dark:text-red-400 text-lg font-semibold">{error}</p>
      </div>
    );
  }

  /* --------------------------------- RENDER -------------------------------- */
  return (
    <motion.div
      variants={container}
      initial="hidden"
      animate="visible"
      // UPDATED: Theme-aware BG
      className="min-h-screen bg-transparent text-gray-900 dark:text-white p-0" // Removed padding
    >
      {/* -------------------------- GLASSMORPHIC HEADER -------------------------- */}
      <motion.header
        variants={fadeUp}
        // UPDATED: Theme-aware
        className="mb-8 backdrop-blur-xl bg-white/70 dark:bg-white/5 border border-gray-300 dark:border-white/10 rounded-2xl p-6 shadow-2xl relative z-50"
      >
        <div className="flex flex-col md:flex-row justify-between items-start md:items-center gap-6">
          <div>
            <h1 className="text-4xl md:text-5xl font-extrabold bg-gradient-to-r from-cyan-500 via-blue-500 to-emerald-500 dark:from-cyan-400 dark:via-blue-400 dark:to-emerald-400 bg-clip-text text-transparent">
              {t('dashboard.title')}
            </h1>
            <p className="text-gray-600 dark:text-gray-400 mt-1">{t('dashboard.subtitle')}</p>
          </div>

          {/* -------------------------- DATE PICKER -------------------------- */}
          <div className="relative z-50">
            {/* UPDATED: Theme-aware */}
            <div className="flex items-center gap-3 bg-gray-200/60 dark:bg-gray-800/60 backdrop-blur-sm border border-gray-300 dark:border-gray-700 rounded-xl px-4 py-3 min-w-[280px]">
              <CalendarIcon />
              <DatePicker
                selectsRange={true}
                startDate={startDate}
                endDate={endDate}
                onChange={(update) => {
                  const [start, end] = update;
                  setStartDate(start);
                  setEndDate(end);
                }}
                dateFormat="MMM d, yyyy"
                // UPDATED: Theme-aware text
                className="bg-transparent text-gray-800 dark:text-gray-200 font-medium focus:outline-none cursor-pointer w-full"
                placeholderText={t('dashboard.datePlaceholder')}
                showPopperArrow={false}
                popperClassName="z-[9999]" // Use your theme-aware class from index.css
                popperPlacement="bottom-end"
                popperModifiers={[
                  { name: 'offset', options: { offset: [0, 8] } },
                  { name: 'preventOverflow', options: { boundary: 'viewport' } },
                ]}
              />
            </div>
          </div>
        </div>
      </motion.header>

      {/* -------------------------- HERO + STAT CARDS -------------------------- */}
      <div className="grid grid-cols-1 lg:grid-cols-12 gap-6 mb-6">
        <div className="lg:col-span-8">
          <RevenueHeroChart data={revenue_trend} totalRevenue={summary.total_revenue || 0} t={t} theme={theme} />
        </div>
        <div className="lg:col-span-4 space-y-6">
          <StatCard title={t('dashboard.totalRevenue')} value={summary.total_revenue || 0} change={changes.revenue} icon={<RevenueIcon />} color="cyan" t={t} />
          <StatCard title={t('dashboard.totalOrders')} value={summary.total_orders || 0} change={changes.orders} icon={<OrdersIcon />} color="blue" t={t} />
          <StatCard title={t('dashboard.productsSold')} value={summary.total_products_sold || 0} change={changes.products} icon={<ProductsSoldIcon />} color="amber" t={t} />
        </div>
      </div>

      {/* --------------------------- BOTTOM CHARTS --------------------------- */}
      <div className="grid grid-cols-1 lg:grid-cols-12 gap-6">
        <div className="lg:col-span-7">
          <TopProductsList data={top_products} t={t} />
        </div>
        <div className="lg:col-span-5">
          <SalesByCategoryChart data={top_products} t={t} theme={theme} />
        </div>
      </div>

      {/* --------------------------- AMBIENT GLOW ORBS (Dark mode only) --------------------------- */}
      <div className="fixed inset-0 -z-10 overflow-hidden pointer-events-none dark:block hidden">
        <div className="absolute top-0 -left-40 w-96 h-96 bg-cyan-500/20 rounded-full blur-3xl animate-pulse" />
        <div className="absolute bottom-0 -right-40 w-96 h-96 bg-emerald-500/20 rounded-full blur-3xl animate-pulse" />
      </div>
    </motion.div>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\analytics\AnalyticsSummary.jsx
--------------------------------------------------------------------
import React from 'react';
import { LineChart, Line, ResponsiveContainer } from 'recharts';
import { RevenueIcon, OrdersIcon, ProductsSoldIcon } from './icons';

const iconMap = {
  revenue: <RevenueIcon />,
  orders: <OrdersIcon />,
  products: <ProductsSoldIcon />,
};

export function StatCard({
  title,
  value,
  change,
  icon,
  sparkData,
  sparkKey,
}) {
  const isUp = change ? parseFloat(change) >= 0 : true;
  const trendClr = isUp ? 'text-emerald-400' : 'text-red-400';
  const sparkClr = isUp ? '#22c55e' : '#ef4444';

  return (
    <div className="group card bg-gradient-to-br from-gray-800/90 to-gray-900/90 backdrop-blur-md border border-gray-700 p-5 rounded-2xl shadow-xl transition-all hover:shadow-2xl hover:-translate-y-1">
      <div className="flex items-center gap-4">
        <div className="p-3 bg-gray-800/70 rounded-xl group-hover:scale-110 transition-transform">
          {iconMap[icon]}
        </div>

        <div className="flex-1">
          <p className="text-sm font-medium text-gray-400">{title}</p>
          <p className="text-3xl font-bold text-white mt-1">{value}</p>
        </div>
      </div>

      <div className="flex items-end justify-between mt-5">
        {change && (
          <p className={`flex items-center text-lg font-semibold ${trendClr}`}>
            {isUp ? '▲' : '▼'} {change}
          </p>
        )}

        {sparkData && sparkData.length > 0 && (
          <div className="w-28 h-12">
            <ResponsiveContainer width="100%" height="100%">
              <LineChart data={sparkData} margin={{ top: 5, right: 0, left: 0, bottom: 5 }}>
                <Line
                  type="monotone"
                  dataKey={sparkKey}
                  stroke={sparkClr}
                  strokeWidth={2.5}
                  dot={false}
                  animationDuration={800}
                />
              </LineChart>
            </ResponsiveContainer>
          </div>
        )}
      </div>
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\analytics\ChartUtils.jsx
--------------------------------------------------------------------
// src/components/analytics/ChartUtils.jsx
import React from 'react';

/**
 * A "premium" tooltip component for our charts.
 * It matches the glassmorphic theme and formats numbers as currency.
 */
export const CustomTooltip = ({ active, payload, label }) => {
  if (active && payload && payload.length) {
    
    const value = payload[0].value;
    const formattedValue = typeof value === 'number' 
      ? value.toLocaleString('en-IN', {
          style: 'currency',
          currency: 'INR',
          maximumFractionDigits: 0,
        })
      : value;

    const name = payload[0].name;

    return (
      <div className="bg-gray-950/80 backdrop-blur-sm border border-gray-700 p-3 rounded-lg shadow-xl opacity-95">
        <p className="label text-sm text-white font-bold mb-1">{`${label || name}`}</p>
        <p style={{ color: payload[0].color || payload[0].payload.fill }} className="text-sm">
          {`${payload[0].name}: ${formattedValue}`}
        </p>
      </div>
    );
  }
  return null;
};

// Define a light color for chart text (Tailwind's gray-400)
export const chartTextColor = "#9ca3af";

// Colors for the Pie/Donut Chart
export const PIE_COLORS = ['#3b82f6', '#8b5cf6', '#10b981', '#f59e0b', '#ef4444', '#6b7280'];
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\analytics\icons.tsx
--------------------------------------------------------------------
// src/components/analytics/icons.tsx
export const CalendarIcon = () => (
  <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
  </svg>
);

export const RevenueIcon = () => (
  <svg className="w-8 h-8 text-emerald-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.105 0 2 .895 2 2s-.895 2-2 2-2-.895-2-2 .895-2 2 2zm0-4c-3.314 0-6 2.686-6 6s2.686 6 6 6 6-2.686 6-6-2.686-6-6-6z" />
  </svg>
);

export const OrdersIcon = () => (
  <svg className="w-8 h-8 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" />
  </svg>
);

export const ProductsSoldIcon = () => (
  <svg className="w-8 h-8 text-amber-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
  </svg>
);
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\analytics\RevenueTrendChart.jsx
--------------------------------------------------------------------
import React from 'react';
import {
  ResponsiveContainer, AreaChart, Area, XAxis, YAxis,
  CartesianGrid, Tooltip, Legend,
} from 'recharts';
import { CustomTooltip, chartTextColor } from './ChartUtils';

export default function RevenueTrendChart({ data = [] }) {
  return (
    <div className="card bg-gradient-to-br from-gray-800/90 to-gray-900/90 backdrop-blur-md rounded-2xl p-6 shadow-xl h-[420px]">
      <h3 className="card-title mb-5 text-xl font-bold text-white">Revenue Trend</h3>

      <ResponsiveContainer width="100%" height="100%">
        <AreaChart data={data} margin={{ top: 10, right: 30, left: 0, bottom: 0 }}>
          <defs>
            <linearGradient id="gradRevenue" x1="0" y1="0" x2="0" y2="1">
              <stop offset="5%" stopColor="#10b981" stopOpacity={0.9} />
              <stop offset="95%" stopColor="#10b981" stopOpacity={0.1} />
            </linearGradient>
          </defs>

          <CartesianGrid strokeDasharray="4 4" stroke="#4b5563" strokeOpacity={0.3} />
          <XAxis dataKey="day" stroke={chartTextColor} tick={{ fontSize: 12 }} />
          <YAxis
            stroke={chartTextColor}
            tick={{ fontSize: 12 }}
            tickFormatter={v => `₹${(v / 1_000).toFixed(0)}k`}
          />
          <Tooltip content={<CustomTooltip />} />
          <Legend wrapperStyle={{ paddingTop: '12px' }} />

          <Area
            type="monotone"
            dataKey="totalRevenue"
            stroke="#10b981"
            fill="url(#gradRevenue)"
            strokeWidth={3}
            name="Revenue"
            dot={false}
            animationDuration={1200}
          />
        </AreaChart>
      </ResponsiveContainer>
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\analytics\SalesByCategoryChart.jsx
--------------------------------------------------------------------
// src/components/analytics/SalesByCategoryChart.jsx
import React, { useMemo } from 'react';
import { ResponsiveContainer, PieChart, Pie, Cell, Tooltip } from 'recharts';
import { CustomTooltip, PIE_COLORS } from './ChartUtils';
import { motion } from 'framer-motion';

// This component calculates the total value to display in the center of the donut
const DonutCenterLabel = ({ total }) => {
  return (
    <>
      <text x="50%" y="45%" textAnchor="middle" dominantBaseline="middle"
        className="text-sm font-medium fill-gray-400">
        Total
      </text>
      <text x="50%" y="58%" textAnchor="middle" dominantBaseline="middle"
        className="font-display text-3xl font-bold fill-white">
        {total.toLocaleString('en-IN', {
          style: 'currency',
          currency: 'INR',
          maximumFractionDigits: 0,
        })}
      </text>
    </>
  );
};

export default function SalesByCategoryChart({ data }) {
  // Process the top_products data to get sales by category
  const { categoryData, totalRevenue } = useMemo(() => {
    if (!data) return { categoryData: [], totalRevenue: 0 };
    
    const categoryMap = data.reduce((acc, product) => {
      const category = product.category || 'Unknown';
      acc[category] = (acc[category] || 0) + product.revenue;
      return acc;
    }, {});
    
    const total = Object.values(categoryMap).reduce((sum, val) => sum + val, 0);

    const chartData = Object.keys(categoryMap).map((name, index) => ({
      name,
      value: categoryMap[name],
      percent: total > 0 ? (categoryMap[name] / total) * 100 : 0,
      color: PIE_COLORS[index % PIE_COLORS.length],
    })).sort((a, b) => b.value - a.value);

    return { categoryData: chartData, totalRevenue: total };
  }, [data]);

  return (
    <div className="card h-[450px] lg:col-span-4 flex flex-col">
      <h3 className="card-title mb-4 flex-shrink-0">Sales by Category</h3>
      <div className="w-full flex-grow h-64">
        <ResponsiveContainer width="100%" height="100%">
          <PieChart>
            {/* SVG Filter for the glow effect */}
            <defs>
              <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
                <feDropShadow dx="0" dy="0" stdDeviation="4" floodColor="#3b82f6" floodOpacity="0.5" />
              </filter>
            </defs>
            <Pie
              data={categoryData}
              dataKey="value"
              nameKey="name"
              cx="50%"
              cy="50%"
              innerRadius="75%" // Donut chart
              outerRadius="95%"
              fill="#8884d8"
              paddingAngle={2}
              isAnimationActive={true}
              animationDuration={1000}
            >
              {categoryData.map((entry) => (
                <Cell 
                  key={entry.name} 
                  fill={entry.color} 
                  stroke={entry.color}
                  style={{ filter: 'url(#glow)' }} // Apply glow
                />
              ))}
            </Pie>
            <Tooltip content={<CustomTooltip />} />
            {/* Custom label in the center */}
            <DonutCenterLabel total={totalRevenue} />
          </PieChart>
        </ResponsiveContainer>
      </div>
      {/* Custom Legend */}
      <div className="w-full space-y-2 overflow-y-auto custom-scrollbar pt-4 mt-4 border-t border-gray-800">
        {categoryData.map((entry) => (
          <div key={entry.name} className="flex items-center justify-between text-sm">
            <div className="flex items-center gap-2">
              <span className="w-3 h-3 rounded-full" style={{ backgroundColor: entry.color }} />
              <span className="text-gray-300">{entry.name}</span>
            </div>
            <span className="font-semibold text-white">{entry.percent.toFixed(1)}%</span>
          </div>
        ))}
      </div>
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\analytics\TopProductsChart.jsx
--------------------------------------------------------------------
// src/components/analytics/TopProductsChart.jsx
import React from 'react';
import {
  ResponsiveContainer, BarChart, Bar,
  XAxis, YAxis, CartesianGrid, Tooltip,
} from 'recharts';
import { CustomTooltip, chartTextColor } from './ChartUtils';

export default function TopProductsChart({ data }) {
  // Reverse the data so the #1 product is at the top of the chart
  const processedData = [...data].slice(0, 7).reverse(); 

  return (
    <div className="card lg:col-span-2 h-96"> {/* Spans 2 columns */}
      <h3 className="card-title mb-4">Top 7 Products (by Revenue)</h3>
      <ResponsiveContainer width="100%" height="100%">
        <BarChart 
          data={processedData} 
          layout="vertical" 
          margin={{ top: 5, right: 30, left: 30, bottom: 5 }}
        >
          <CartesianGrid strokeDasharray="3 3" stroke="#4b5563" strokeOpacity={0.3} />
          <XAxis 
            type="number" 
            stroke={chartTextColor} 
            fontSize={12} 
            tickFormatter={(value) => `₹${value.toLocaleString()}`} 
          />
          <YAxis 
            dataKey="name" 
            type="category" 
            stroke={chartTextColor} 
            fontSize={12} 
            width={100}
            tick={{ fill: chartTextColor }}
          />
          <Tooltip content={<CustomTooltip />} cursor={{ fill: 'rgba(156, 163, 175, 0.1)' }} />
          <Bar 
            dataKey="revenue" 
            fill="#8b5cf6" // purple-500
            name="Revenue" 
            isAnimationActive={true}
            animationDuration={1000}
          />
        </BarChart>
      </ResponsiveContainer>
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\analytics\TopProductsList.jsx
--------------------------------------------------------------------
// src/components/analytics/TopProductsList.jsx
import React from 'react';
import { motion } from 'framer-motion';

// Staggered animation for the list
const listVariants = {
  hidden: { opacity: 0 },
  visible: { 
    opacity: 1, 
    transition: { 
      staggerChildren: 0.07 // Each item fades in 70ms after the previous
    } 
  }
};

const itemVariants = {
  hidden: { opacity: 0, x: -20 },
  visible: { 
    opacity: 1, 
    x: 0,
    transition: {
      duration: 0.4,
      ease: "easeOut"
    }
  }
};

export default function TopProductsList({ data }) {
  const products = data.slice(0, 10); // Show top 10
  const maxRevenue = products[0]?.revenue || 1; 

  return (
    <div className="card h-[450px] flex flex-col lg:col-span-12">
      <h3 className="card-title mb-4 flex-shrink-0">Top Products by Revenue</h3>
      <div className="flex-grow overflow-y-auto custom-scrollbar pr-2">
        <motion.ul 
          className="space-y-5"
          initial="hidden"
          animate="visible"
          variants={listVariants}
        >
          {products.map((p, index) => (
            <motion.li key={p.productId || index} variants={itemVariants}>
              <div className="flex items-center justify-between mb-1.5 text-sm">
                <span className="font-medium text-white truncate w-3/5">{index + 1}. {p.name}</span>
                <span className="font-semibold text-green-400">
                  {p.revenue.toLocaleString('en-IN', {
                    style: 'currency', currency: 'INR', maximumFractionDigits: 0,
                  })}
                </span>
              </div>
              {/* Animated gradient progress bar */}
              <div className="progress-bar-container">
                <motion.div 
                  className="progress-bar"
                  initial={{ width: 0 }}
                  animate={{ width: `${(p.revenue / maxRevenue) * 100}%` }}
                  transition={{ duration: 1, ease: [0.25, 0.1, 0.25, 1.0], delay: 0.2 }}
                />
              </div>
            </motion.li>
          ))}
        </motion.ul>
      </div>
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\components\auth
--------------------------------------------------------------------
Contents:
Login.jsx
OAuth2RedirectHandler.jsx
Signup.jsx

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\auth\Login.jsx
--------------------------------------------------------------------
import React, { useState } from 'react';
import authService from '../../services/authService';
import { useNavigate } from 'react-router-dom';
import { useTranslation } from 'react-i18next'; // <-- 1. Import

// --- Icons (No changes) ---
const MailIcon = () => (
  <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.206" />
  </svg>
);
const LockIcon = () => (
  <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
  </svg>
);
const LogoIcon = () => (
  <svg className="w-20 h-20 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" />
  </svg>
);
const GoogleIcon = () => (
  <svg className="w-5 h-5" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
    <path fill="#FFC107" d="M43.611 20.083H42V20H24v8h11.303c-1.649 4.657-6.08 8-11.303 8c-6.627 0-12-5.373-12-12s5.373-12 12-12c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.046 6.053 29.268 4 24 4C12.955 4 4 12.955 4 24s8.955 20 20 20s20-8.955 20-20c0-1.341-.138-2.65-.389-3.917z" />
    <path fill="#FF3D00" d="M6.306 14.691l6.571 4.819C14.655 15.108 18.961 12 24 12c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.046 6.053 29.268 4 24 4C16.318 4 9.656 8.337 6.306 14.691z" />
    <path fill="#4CAF50" d="M24 44c5.166 0 9.86-1.977 13.409-5.192l-6.19-5.238C29.211 35.091 26.715 36 24 36c-5.223 0-9.64-3.518-11.28-8.294l-6.522 5.025C9.505 39.556 16.227 44 24 44z" />
    <path fill="#1976D2" d="M43.611 20.083H42V20H24v8h11.303c-.792 2.237-2.231 4.166-4.087 5.571l6.19 5.238C42.012 36.49 44 30.823 44 24c0-1.341-.138-2.65-.389-3.917z" />
  </svg>
);
// --- End Icons ---

export default function Login() {
  const { t } = useTranslation(); // <-- 2. Get hook
  const [email, setEmail] = useState('');
  const [password, setPassword] = useState('');
  const [err, setErr] = useState(null);
  const nav = useNavigate();

  async function submit(e) {
    e.preventDefault();
    setErr(null);
    try {
      const data = await authService.login({ email, password });
      if (!data || !data.accessToken) {
        throw new Error('No access token received from backend.');
      }
      nav('/dashboard');
    } catch (e) {
      console.error('Login error:', e);
      setErr(e.response?.data?.error || e.response?.data?.message || e.message || "An unknown error occurred.");
    }
  }

  return (
    <div className="min-h-screen flex text-gray-800 dark:text-gray-200">
      <div className="hidden lg:flex lg:w-1/2 flex-col justify-center items-center bg-gray-100 dark:bg-gray-900 p-12 text-center shadow-2xl z-10">
        <LogoIcon />
        <h1 className="text-4xl font-bold text-gray-900 dark:text-white mt-6">
          {t('auth.brandPanelTitle')}
        </h1>
        <p className="text-xl text-gray-600 dark:text-gray-400 mt-4 max-w-sm">
          {t('auth.brandPanelLogin')}
        </p>
      </div>

      <div className="w-full lg:w-1/2 flex items-center justify-center p-8
                      bg-white dark:bg-gradient-to-br dark:from-gray-800 dark:via-gray-900 dark:to-black
                      dark:animate-gradient-xy dark:bg-[length:300%_300%]">

        <div className="w-full max-w-md">
          <div className="lg:hidden flex flex-col items-center text-center mb-8">
            <LogoIcon />
            <h2 className="text-2xl font-bold text-gray-900 dark:text-white mt-4">{t('auth.brandPanelTitle')}</h2>
          </div>

          <h2 className="text-3xl font-bold text-gray-900 dark:text-white mb-2 text-center lg:text-left">
            {t('auth.signIn')}
          </h2>
          <p className="text-gray-600 dark:text-gray-400 mb-8 text-center lg:text-left">
            {t('auth.signInWelcome')}
          </p>

          {err && (
            <div className="bg-red-100 dark:bg-red-900/50 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-100 px-4 py-3 rounded-lg mb-6" role="alert">
              <span className="font-medium">{t('auth.loginFailed')}</span> {err}
            </div>
          )}

          <form onSubmit={submit} className="space-y-6">
            <div>
              <label htmlFor="email" className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-2">
                {t('auth.emailAddress')}
              </label>
              <div className="relative">
                <div className="absolute inset-y-0 left-0 flex items-center pl-3.5 pointer-events-none">
                  <MailIcon />
                </div>
                <input
                  id="email"
                  value={email}
                  onChange={e => setEmail(e.target.value)}
                  placeholder={t('auth.emailPlaceholder')}
                  type="email"
                  required
                  className="form-input"
                />
              </div>
            </div>

            <div>
              <div className="flex justify-between items-center mb-2">
                <label htmlFor="password" className="block text-sm font-medium text-gray-600 dark:text-gray-400">
                  {t('auth.password')}
                </label>
                <a href="#" className="text-sm text-blue-500 dark:text-blue-400 hover:underline">
                  {t('auth.forgotPassword')}
                </a>
              </div>
              <div className="relative">
                <div className="absolute inset-y-0 left-0 flex items-center pl-3.5 pointer-events-none">
                  <LockIcon />
                </div>
                <input
                  id="password"
                  type="password"
                  value={password}
                  onChange={e => setPassword(e.target.value)}
                  placeholder="••••••••"
                  required
                  className="form-input"
                />
              </div>
            </div>

            <button
              type="submit"
              className="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-md font-semibold
                         transition-all duration-300 ease-in-out
                         focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-100 dark:focus:ring-offset-gray-900"
            >
              {t('auth.signIn')}
            </button>
          </form>

          <div className="relative my-8">
            <div className="absolute inset-0 flex items-center">
              <div className="w-full border-t border-gray-300 dark:border-gray-700" />
            </div>
            <div className="relative flex justify-center text-sm">
              <span className="px-2 bg-white dark:bg-gray-900 text-gray-500">
                {t('auth.or')}
              </span>
            </div>
          </div>

          <div className="space-y-4">
            <a
              href="http://localhost:8080/oauth2/authorization/google"
              className="social-button"
            >
              <GoogleIcon />
              <span>{t('auth.continueWithGoogle')}</span>
            </a>
          </div>

          <p className="text-sm mt-8 text-center text-gray-600 dark:text-gray-400">
            {t('auth.noAccount')}{' '}
            <a href="/signup" className="font-medium text-blue-500 dark:text-blue-400 hover:underline">
              {t('auth.signUpHere')}
            </a>
          </p>
        </div>
      </div>
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\auth\OAuth2RedirectHandler.jsx
--------------------------------------------------------------------
// src/components/auth/OAuth2RedirectHandler.jsx
import React, { useEffect } from 'react';
import { useSearchParams, useNavigate } from 'react-router-dom';
import authService from '../../services/authService';

export default function OAuth2RedirectHandler() {
  const [searchParams] = useSearchParams();
  const navigate = useNavigate();

  useEffect(() => {
    const token = searchParams.get('token');
    const refreshToken = searchParams.get('refreshToken');

    if (token && refreshToken) {
      console.log("OAuth2 Success: Saving tokens...");
      // We need to export saveTokens from authService
      authService.saveTokens({ accessToken: token, refreshToken: refreshToken });
      
      // Redirect to the dashboard after successful login
      navigate('/dashboard');
    } else {
      console.error("OAuth2 Error: No tokens found in URL.");
      // Redirect to login page with an error
      navigate('/login?error=oauth_failed');
    }
  }, [searchParams, navigate]);

  return (
    <div className="min-h-screen flex items-center justify-center bg-gray-900 text-white">
      <p className="text-xl">Processing your login...</p>
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\auth\Signup.jsx
--------------------------------------------------------------------
import React, { useState } from 'react';
import authService from '../../services/authService';
import { useNavigate } from 'react-router-dom';
import { useTranslation } from 'react-i18next'; // <-- 1. Import

// --- Icons (No changes) ---
const MailIcon = () => (
  <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.206" />
  </svg>
);
const LockIcon = () => (
  <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
  </svg>
);
const UserIcon = () => (
  <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
  </svg>
);
const SelectArrowIcon = () => (
  <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 9l-7 7-7-7" />
  </svg>
);
const LogoIcon = () => (
  <svg className="w-20 h-20 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" />
  </svg>
);
// --- End Icons ---

export default function Signup() {
  const { t } = useTranslation(); // <-- 2. Get hook
  const [email, setEmail] = useState('');
  const [password, setPassword] = useState('');
  const [name, setName] = useState('');
  const [role, setRole] = useState('CASHIER');
  const [error, setError] = useState(null);
  const nav = useNavigate();

  async function submit(e) {
    e.preventDefault();
    setError(null);
    try {
      await authService.signup({ name, email, password, role });
      alert('Signup successful! Please log in.'); // You could translate this too!
      nav('/login');
    } catch (err) {
      setError(err.response?.data?.message || err.response?.data?.error || 'Signup failed');
    }
  }

  return (
    <div className="min-h-screen flex text-gray-800 dark:text-gray-200">

      <div className="hidden lg:flex lg:w-1/2 flex-col justify-center items-center bg-gray-100 dark:bg-gray-900 p-12 text-center shadow-2xl z-10">
        <LogoIcon />
        <h1 className="text-4xl font-bold text-gray-900 dark:text-white mt-6">
          {t('auth.brandPanelTitle')}
        </h1>
        <p className="text-xl text-gray-600 dark:text-gray-400 mt-4 max-w-sm">
          {t('auth.brandPanelSignup')}
        </p>
      </div>

      <div className="w-full lg:w-1/2 flex items-center justify-center p-8
                      bg-white dark:bg-gradient-to-br dark:from-gray-800 dark:via-gray-900 dark:to-black
                      dark:animate-gradient-xy dark:bg-[length:300%_300%]">

        <div className="w-full max-w-md">
          <div className="lg:hidden flex flex-col items-center text-center mb-8">
            <LogoIcon />
            <h2 className="text-2xl font-bold text-gray-900 dark:text-white mt-4">{t('auth.brandPanelTitle')}</h2>
          </div>

          <h2 className="text-3xl font-bold text-gray-900 dark:text-white mb-2 text-center lg:text-left">
            {t('auth.signUp')}
          </h2>
          <p className="text-gray-600 dark:text-gray-400 mb-8 text-center lg:text-left">
            {t('auth.signUpWelcome')}
          </p>

          {error && (
            <div className="bg-red-100 dark:bg-red-900/50 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-100 px-4 py-3 rounded-lg mb-6" role="alert">
              <span className="font-medium">{t('auth.signupFailed')}</span> {error}
            </div>
          )}

          <form onSubmit={submit} className="space-y-6">

            <div>
              <label htmlFor="name" className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-2">
                {t('auth.fullName')}
              </label>
              <div className="relative">
                <div className="absolute inset-y-0 left-0 flex items-center pl-3.5 pointer-events-none">
                  <UserIcon />
                </div>
                <input
                  id="name"
                  value={name}
                  onChange={e => setName(e.target.value)}
                  placeholder={t('auth.namePlaceholder')}
                  type="text"
                  required
                  className="form-input"
                />
              </div>
            </div>

            <div>
              <label htmlFor="email" className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-2">
                {t('auth.emailAddress')}
              </label>
              <div className="relative">
                <div className="absolute inset-y-0 left-0 flex items-center pl-3.5 pointer-events-none">
                  <MailIcon />
                </div>
                <input
                  id="email"
                  value={email}
                  onChange={e => setEmail(e.target.value)}
                  placeholder={t('auth.emailPlaceholder')}
                  type="email"
                  required
                  className="form-input"
                />
              </div>
            </div>

            <div>
              <label htmlFor="password" className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-2">
                {t('auth.password')}
              </label>
              <div className="relative">
                <div className="absolute inset-y-0 left-0 flex items-center pl-3.5 pointer-events-none">
                  <LockIcon />
                </div>
                <input
                  id="password"
                  type="password"
                  value={password}
                  onChange={e => setPassword(e.target.value)}
                  placeholder="••••••••"
                  required
                  className="form-input"
                />
              </div>
            </div>

            <div>
              <label htmlFor="role" className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-2">
                {t('auth.role')}
              </label>
              <div className="relative">
                <div className="absolute inset-y-0 left-0 flex items-center pl-3.5 pointer-events-none">
                  <UserIcon />
                </div>
                <select
                  id="role"
                  value={role}
                  onChange={e => setRole(e.target.value)}
                  className="form-input appearance-none"
                >
                  <option value="CASHIER">{t('auth.roleCashier')}</option>
                  <option value="MANAGER">{t('auth.roleManager')}</option>
                  <option value="OWNER">{t('auth.roleOwner')}</option>
                </select>
                <div className="absolute inset-y-0 right-0 flex items-center pr-3.5 pointer-events-none">
                  <SelectArrowIcon />
                </div>
              </div>
            </div>

            <button
              type="submit"
              className="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-md font-semibold
                         transition-all duration-300 ease-in-out
                         focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-100 dark:focus:ring-offset-gray-900"
            >
              {t('auth.createAccount')}
            </button>
          </form>

          <p className="text-sm mt-8 text-center text-gray-600 dark:text-gray-400">
            {t('auth.haveAccount')}{' '}
            <a href="/login" className="font-medium text-blue-500 dark:text-blue-400 hover:underline">
              {t('auth.signInHere')}
            </a>
          </p>
        </div>
      </div>
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\components\bills
--------------------------------------------------------------------
Contents:
BillForm.jsx
BillList.jsx

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\bills\BillForm.jsx
--------------------------------------------------------------------
import React, { useEffect, useState } from 'react';
import { createBill } from '../../services/billService';
import { listCustomers } from '../../services/customerService';
import { listProducts } from '../../services/productService';
import { useNavigate } from 'react-router-dom';
import { useTranslation } from 'react-i18next';
import { useToast } from '../../context/ToastContext';

export default function BillForm() {
  const { t } = useTranslation();
  const { showToast } = useToast();
  const [customers, setCustomers] = useState([]);
  const [products, setProducts] = useState([]);
  const [selectedCustomer, setSelectedCustomer] = useState('');
  const [items, setItems] = useState([{ productId: '', quantity: 1 }]);
  const [total, setTotal] = useState(0);
  const nav = useNavigate();

  useEffect(() => {
    (async () => {
      try {
        const [custs, prods] = await Promise.all([listCustomers(), listProducts()]);
        setCustomers(custs);
        setProducts(prods);
      } catch (err) {
        showToast("Failed to load customers or products", 'error');
      }
    })();
  }, [showToast]);

  useEffect(() => {
    let t = 0;
    for (const item of items) {
      const prod = products.find(p => p.productId === item.productId);
      if (prod) t += prod.price * item.quantity;
    }
    setTotal(t);
  }, [items, products]);

  function addItem() {
    setItems([...items, { productId: '', quantity: 1 }]);
  }

  function updateItem(index, field, value) {
    const updated = [...items];
    updated[index][field] = value;
    setItems(updated);
  }

  function removeItem(index) {
    const updated = [...items];
    updated.splice(index, 1);
    setItems(updated);
  }

  async function handleSubmit(e) {
    e.preventDefault();
    const selected = customers.find(
      c => c.customerId === selectedCustomer || c.id === selectedCustomer || c._id === selectedCustomer
    );

    if (!selected) {
      showToast(t('billForm.errorCustomer'), 'error');
      return;
    }

    try {
      const billRequest = {
        billId: 'B' + Date.now(),
        customer: {
          name: selected.name,
          email: selected.email,
          mobile: selected.mobile || selected.phone || selected.contactNumber,
        },
        items: items.map(it => ({
          productId: it.productId,
          qty: parseInt(it.quantity, 10),
        })),
        addedBy: 'system',
      };

      await createBill(billRequest);
      showToast(t('billForm.success'), 'success');
      nav('/bills');
    } catch (err) {
      const msg = err.response?.data?.error || err.response?.data?.message || t('billForm.errorCreate');
      showToast(msg, 'error');
    }
  }

  return (
    <div className="card max-w-3xl mx-auto p-6">
      <h2 className="card-title">{t('billForm.title')}</h2>

      <form onSubmit={handleSubmit} className="space-y-4">
        <div>
          <label className="block mb-1.5 font-medium text-gray-600 dark:text-gray-400">{t('billForm.customer')}</label>
          <select
            value={selectedCustomer}
            onChange={e => setSelectedCustomer(e.target.value)}
            className="form-input-no-icon w-full"
            required
          >
            <option value="">{t('billForm.selectCustomer')}</option>
            {customers.map((c, index) => (
              <option
                key={c.customerId || c.id || c._id || index}
                value={c.customerId || c.id || c._id}
              >
                {c.name} ({c.email || c.mobile})
              </option>
            ))}
          </select>
        </div>

        <div>
          <label className="block mb-2 font-medium text-gray-600 dark:text-gray-400">{t('billForm.items')}</label>
          <div className="space-y-2">
            {items.map((item, index) => (
              <div key={index} className="flex gap-2 items-center">
                <select
                  value={item.productId}
                  onChange={e => updateItem(index, 'productId', e.target.value)}
                  className="form-input-no-icon flex-1"
                  required
                >
                  <option value="">{t('billForm.selectProduct')}</option>
                  {products.map((p, i) => (
                    <option
                      key={p.productId || p.id || i}
                      value={p.productId || p.id}
                    >
                      {p.name} (₹{p.price})
                    </option>
                  ))}
                </select>
                <input
                  type="number"
                  min="1"
                  value={item.quantity}
                  onChange={e => updateItem(index, 'quantity', e.target.value)}
                  className="form-input-no-icon w-24"
                  required
                />
                <button
                  type="button"
                  onClick={() => removeItem(index)}
                  className="bg-red-600 text-white px-3 py-2 rounded-lg hover:bg-red-700 transition-colors"
                >
                  ✕
                </button>
              </div>
            ))}
            <button
              type="button"
              onClick={addItem}
              className="button-secondary !bg-green-600 !text-white hover:!bg-green-700"
            >
              {t('billForm.addItem')}
            </button>
          </div>
        </div>

        <div className="text-right text-xl font-bold text-gray-900 dark:text-white">
          {t('billForm.total')} ₹{total.toFixed(2)}
        </div>

        <div className="text-center pt-4">
          <button type="submit" className="button-primary w-1/2">
            {t('billForm.createBill')}
          </button>
        </div>
      </form>
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\bills\BillList.jsx
--------------------------------------------------------------------
import React, { useEffect, useState, useMemo } from 'react';
import { useNavigate } from 'react-router-dom';
import {
  listBills,
  downloadBillPdf,
  resendBillEmail,
  generatePdfToken,
  downloadBillPdfWithFlow,
  handlePdfDownload
} from '../../services/billService';
import { useToast } from '../../context/ToastContext';
import authService from '../../services/authService';
import Fuse from 'fuse.js';
import { motion, AnimatePresence } from 'framer-motion';
import DatePicker from 'react-datepicker';
import "react-datepicker/dist/react-datepicker.css";
import { useTranslation } from 'react-i18next';

// --- ICONS ---
const SearchIcon = () => (
  <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
  </svg>
);
const SortIcon = () => (
  <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 4h13M3 8h9M3 12h9m-9 4h13m-3-4v8m0 0l-4-4m4 4l4-4" />
  </svg>
);
const CalendarIcon = () => (
  <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
  </svg>
);
const ExportIcon = () => (
  <svg className="w-5 h-5 mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
  </svg>
);
const PdfIcon = () => (
  <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
  </svg>
);
const ResendIcon = () => (
  <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
  </svg>
);
const CheckCircleIcon = () => (
  <svg className="w-4 h-4 text-emerald-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
  </svg>
);
// --- END ICONS ---

// --- Skeleton Row ---
const SkeletonRow = () => (
  <tr className="animate-pulse">
    <td><div className="h-4 bg-gray-200 dark:bg-gray-700 rounded w-24"></div></td>
    <td><div className="h-4 bg-gray-200 dark:bg-gray-700 rounded w-32"></div></td>
    <td><div className="h-4 bg-gray-200 dark:bg-gray-700 rounded w-20"></div></td>
    <td><div className="h-4 bg-gray-200 dark:bg-gray-700 rounded w-36"></div></td>
    <td><div className="h-4 bg-gray-200 dark:bg-gray-700 rounded w-20"></div></td>
    <td className="flex gap-2 justify-center">
      <div className="h-9 w-9 bg-gray-200 dark:bg-gray-700 rounded-lg"></div>
      <div className="h-9 w-9 bg-gray-200 dark:bg-gray-700 rounded-lg"></div>
    </td>
  </tr>
);

// --- Customer Avatar Component ---
const CustomerAvatar = ({ name, className = "w-8 h-8" }) => {
  const initials = name ? name.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2) : 'WI';
  const colors = [
    'bg-gradient-to-br from-blue-500 to-cyan-400',
    'bg-gradient-to-br from-purple-500 to-pink-500',
    'bg-gradient-to-br from-orange-500 to-red-500',
    'bg-gradient-to-br from-green-500 to-emerald-400',
    'bg-gradient-to-br from-indigo-500 to-purple-400'
  ];
  const colorIndex = name ? name.charCodeAt(0) % colors.length : 0;

  return (
    <div className={`${className} ${colors[colorIndex]} rounded-full flex items-center justify-center text-white text-xs font-bold shadow-lg`}>
      {initials}
    </div>
  );
};

// --- Bill Details Drawer ---
const BillDetailsDrawer = ({ bill, isOpen, onClose, t, onDownload, onResend }) => {
  if (!isOpen) return null;

  const { date, time } = formatDate(bill.createdAt || bill.date);

  return (
    <div className="fixed inset-0 z-50 overflow-hidden">
      {/* Backdrop */}
      <motion.div
        initial={{ opacity: 0 }}
        animate={{ opacity: 1 }}
        exit={{ opacity: 0 }}
        className="absolute inset-0 bg-black/60 backdrop-blur-sm"
        onClick={onClose}
      ></motion.div>

      {/* Drawer */}
      <motion.div
        initial={{ x: '100%' }}
        animate={{ x: 0 }}
        exit={{ x: '100%' }}
        transition={{ type: 'spring', damping: 30, stiffness: 300 }}
        className="absolute right-0 top-0 h-full w-full max-w-md bg-white dark:bg-gray-900/95 dark:backdrop-blur-xl border-l border-gray-200 dark:border-gray-700/50 shadow-2xl"
      >
        <div className="p-6 h-full flex flex-col">
          {/* Header */}
          <div className="flex items-center justify-between mb-6">
            <h3 className="text-xl font-bold text-gray-900 dark:text-white">{t('billList.drawerTitle')}</h3>
            <button
              onClick={onClose}
              className="p-2 text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors"
            >
              <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
              </svg>
            </button>
          </div>

          {/* Content */}
          <div className="flex-1 space-y-6 overflow-y-auto custom-scrollbar pr-2">
            {/* Bill Info */}
            <div className="space-y-4">
              <div>
                <label className="text-sm text-gray-500 dark:text-gray-400">{t('billList.headerId')}</label>
                <p className="text-lg font-mono text-cyan-600 dark:text-cyan-400">{bill.billId}</p>
              </div>
              <div>
                <label className="text-sm text-gray-500 dark:text-gray-400">{t('billList.drawerDate')}</label>
                <p className="text-gray-900 dark:text-white">{date} at {time}</p>
              </div>
              <div>
                <label className="text-sm text-gray-500 dark:text-gray-400">{t('billList.drawerTotal')}</label>
                <p className="text-2xl font-bold text-emerald-600 dark:text-emerald-400">
                  {formatCurrency(bill.totalAmount)}
                </p>
              </div>
            </div>

            {/* Customer Info */}
            <div className="space-y-3">
              <label className="text-sm text-gray-500 dark:text-gray-400">{t('billList.drawerCustomer')}</label>
              <div className="flex items-center gap-3 p-3 bg-gray-100 dark:bg-gray-800/50 rounded-lg">
                <CustomerAvatar name={bill.customer?.name} />
                <div>
                  <p className="text-gray-900 dark:text-white font-medium">{bill.customer?.name || t('billList.walkIn')}</p>
                  <p className="text-sm text-gray-500 dark:text-gray-400">{bill.customer?.mobile || t('billList.noMobile')}</p>
                </div>
              </div>
            </div>

            {/* Items */}
            <div className="space-y-3">
              <label className="text-sm text-gray-500 dark:text-gray-400">{t('billList.drawerItems', { count: bill.items?.length || 0 })}</label>
              <div className="space-y-2 max-h-48 overflow-y-auto custom-scrollbar pr-2">
                {bill.items?.map((item, index) => (
                  <div key={index} className="flex justify-between items-center p-2 bg-gray-100 dark:bg-gray-800/30 rounded">
                    <span className="text-gray-800 dark:text-white text-sm">{item.productName || item.name}</span>
                    <span className="text-emerald-600 dark:text-emerald-400 text-sm">
                      {formatCurrency(item.price)} x {item.qty}
                    </span>
                  </div>
                ))}
              </div>
            </div>
          </div>

          {/* Actions */}
          <div className="space-y-3 pt-6 border-t border-gray-200 dark:border-gray-700">
            <button
              onClick={() => onDownload(bill)}
              className="w-full button-primary flex items-center justify-center gap-2"
            >
              <PdfIcon />
              {t('billList.downloadPDF')}
            </button>
            <button
              onClick={() => onResend(bill.billId)}
              className="w-full button-secondary flex items-center justify-center gap-2"
            >
              <ResendIcon />
              {t('billList.resendEmail')}
            </button>
          </div>
        </div>
      </motion.div>
    </div>
  );
};

// Formatting Helpers
const formatCurrency = (amount) => {
  return (amount || 0).toLocaleString('en-IN', {
    style: 'currency',
    currency: 'INR',
    maximumFractionDigits: 2,
  });
};

const formatDate = (dateString) => {
  if (!dateString) return { date: 'N/A', time: '' };
  const date = new Date(dateString);
  return {
    date: date.toLocaleDateString('en-IN', { day: '2-digit', month: 'short', year: 'numeric' }),
    time: date.toLocaleTimeString('en-IN', { hour: '2-digit', minute: '2-digit', hour12: true })
  };
};

// Custom DatePicker Input Component
const CustomDateInput = React.forwardRef(({ value, onClick, placeholder }, ref) => (
  <button
    type="button"
    ref={ref}
    onClick={onClick}
    className="form-input w-full !pl-10 !py-3 rounded-xl cursor-pointer text-left"
  >
    <span className={value ? 'text-gray-800 dark:text-white' : 'text-gray-500'}>
      {value || placeholder}
    </span>
  </button>
));

export default function BillList() {
  const { t } = useTranslation();
  const [bills, setBills] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);
  const [resendingId, setResendingId] = useState(null);
  const [downloadingId, setDownloadingId] = useState(null);
  const [selectedBill, setSelectedBill] = useState(null);
  const [isDrawerOpen, setIsDrawerOpen] = useState(false);

  const [searchTerm, setSearchTerm] = useState('');
  const [sortBy, setSortBy] = useState('createdAt-desc');
  const [startDate, setStartDate] = useState(null);
  const [endDate, setEndDate] = useState(null);
  const [autoEmail, setAutoEmail] = useState(true);
  const [currentPage, setCurrentPage] = useState(1);
  const itemsPerPage = 10;

  const { showToast } = useToast();
  const navigate = useNavigate();
  const user = authService.getUserFromToken();
  const canManage = user?.role === 'OWNER' || user?.role === 'MANAGER';

  const fuse = useMemo(() => new Fuse(bills, {
    keys: ['billId', 'customer.name', 'customer.mobile', 'paymentMethod'],
    threshold: 0.4,
  }), [bills]);

  const displayBills = useMemo(() => {
    let items = searchTerm ? fuse.search(searchTerm).map(r => r.item) : [...bills];

    if (startDate || endDate) {
      const start = startDate ? new Date(startDate.setHours(0, 0, 0, 0)) : new Date(0);
      const end = endDate ? new Date(endDate.setHours(23, 59, 59, 999)) : new Date();
      items = items.filter(b => {
        const billDate = new Date(b.createdAt || b.date);
        return billDate >= start && billDate <= end;
      });
    }

    const [key, dir] = sortBy.split('-');
    return [...items].sort((a, b) => {
      let valA = key === 'createdAt' ? new Date(a.createdAt || a.date).getTime() : (a.totalAmount || 0);
      let valB = key === 'createdAt' ? new Date(b.createdAt || b.date).getTime() : (b.totalAmount || 0);
      return dir === 'asc' ? valA - valB : valB - valA;
    });
  }, [bills, searchTerm, sortBy, startDate, endDate, fuse]);

  const totalPages = Math.ceil(displayBills.length / itemsPerPage);
  const paginatedBills = useMemo(() => {
    const startIndex = (currentPage - 1) * itemsPerPage;
    return displayBills.slice(startIndex, startIndex + itemsPerPage);
  }, [displayBills, currentPage, itemsPerPage]);

  useEffect(() => { loadBills(); }, []);

  async function loadBills() {
    try {
      setLoading(true);
      setError(null);
      const data = await listBills();
      setBills(Array.isArray(data) ? data : []);
    } catch (err) {
      const msg = err.response?.data?.message || err.message;
      setError(msg);
      showToast(msg, 'error');
    } finally {
      setLoading(false);
    }
  }

  const handleDownload = async (bill, e) => {
    e?.stopPropagation();
    setDownloadingId(bill.billId);
    try {
      showToast(t('billList.downloading', { billId: bill.billId }), 'info');

      // Use the complete flow that handles token generation automatically
      const pdfBlob = await downloadBillPdfWithFlow(bill.billId);
      handlePdfDownload(pdfBlob, bill.billId);

      showToast(t('billList.downloadSuccess'), 'success');
    } catch (err) {
      console.error('Error downloading PDF:', err);
      const errorMessage = err.response?.data?.message || err.message || t('billList.downloadFailed');
      showToast(errorMessage, 'error');
    } finally {
      setDownloadingId(null);
    }
  };

  const handleResend = async (billId, e) => {
    e?.stopPropagation();
    setResendingId(billId);
    try {
      await resendBillEmail(billId);
      showToast(t('billList.resendSuccess'), 'success');
    } catch (err) {
      const errorMessage = err.response?.data?.message || err.message || t('billList.resendFailed');
      showToast(errorMessage, 'error');
    } finally {
      setResendingId(null);
    }
  };

  const handleRowClick = (bill) => {
    setSelectedBill(bill);
    setIsDrawerOpen(true);
  };

  const handleDrawerDownload = async (bill) => {
    try {
      showToast(t('billList.downloading', { billId: bill.billId }), 'info');
      const pdfBlob = await downloadBillPdfWithFlow(bill.billId);
      handlePdfDownload(pdfBlob, bill.billId);
      showToast(t('billList.downloadSuccess'), 'success');
    } catch (err) {
      console.error('Error downloading PDF:', err);
      const errorMessage = err.response?.data?.message || err.message || t('billList.downloadFailed');
      showToast(errorMessage, 'error');
    }
  };

  const handleDrawerResend = async (billId) => {
    try {
      await resendBillEmail(billId);
      showToast(t('billList.resendSuccess'), 'success');
    } catch (err) {
      const errorMessage = err.response?.data?.message || err.message || t('billList.resendFailed');
      showToast(errorMessage, 'error');
    }
  };

  const exportToCsv = () => {
    if (!displayBills.length) return showToast(t('billList.exportError'), 'error');
    const headers = ["Bill ID", "Customer", "Mobile", "Amount", "Date", "Items", "Payment Method"];
    const rows = displayBills.map(b => [
      b.billId,
      b.customer?.name || '',
      b.customer?.mobile || '',
      formatCurrency(b.totalAmount),
      new Date(b.createdAt || b.date).toLocaleString(),
      b.items?.length || 0,
      b.paymentMethod || 'cash'
    ]);
    const csv = [headers, ...rows.map(r => r.join(','))].join('\n');
    const blob = new Blob([csv], { type: 'text/csv' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `SmartRetail_Bills_${new Date().toISOString().slice(0,10)}.csv`;
    a.click();
    URL.revokeObjectURL(url);
    showToast(t('billList.exportSuccess', { count: displayBills.length }), 'success');
  };

  const EmptyState = () => (
    <div className="flex flex-col items-center justify-center py-16">
      <svg className="w-16 h-16 text-gray-400 dark:text-gray-500 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M9 17v-6h6v6m-6-4h.01M12 3v4m0 0h8m-8 0H4" />
      </svg>
      <p className="text-lg text-gray-500 dark:text-gray-400 font-light">{t('billList.emptyState')}</p>
      <p className="text-sm text-gray-400 dark:text-gray-500 mt-1">{t('billList.emptyStateHint')}</p>
    </div>
  );

  return (
    <motion.div
      initial={{ opacity: 0, y: 10 }}
      animate={{ opacity: 1, y: 0 }}
      transition={{ duration: 0.4 }}
      className="space-y-6"
    >
      {/* Frosted Header Bar */}
      <div className="sticky top-0 z-40 backdrop-blur-xl bg-white/80 dark:bg-black/40 border-b border-gray-200 dark:border-cyan-500/20 p-4 rounded-xl flex justify-between items-center">
        <h2 className="text-3xl font-bold text-gray-900 dark:text-white font-display">
          {t('billList.title')}
          <span className="text-lg font-normal text-gray-500 dark:text-gray-400 ml-3">
            ({displayBills.length} {t('billList.matching')})
          </span>
        </h2>
        {canManage && (
          <div className="flex items-center gap-3">
            <label className="flex items-center gap-2 text-sm text-gray-600 dark:text-gray-300 cursor-pointer">
              <div className="relative">
                <input
                  type="checkbox"
                  checked={autoEmail}
                  onChange={(e) => setAutoEmail(e.target.checked)}
                  className="sr-only"
                />
                <div className={`w-10 h-6 rounded-full transition-colors ${
                  autoEmail ? 'bg-cyan-500' : 'bg-gray-400 dark:bg-gray-600'
                }`}></div>
                <div className={`absolute top-1 w-4 h-4 rounded-full bg-white transition-transform ${
                  autoEmail ? 'transform translate-x-5' : 'transform translate-x-1'
                }`}></div>
              </div>
              {t('billList.autoEmail')}
            </label>
          </div>
        )}
      </div>

      {/* Control Bar */}
      <div className="card p-5 rounded-2xl">
        <div className="flex flex-col lg:flex-row gap-4 items-center">
          <div className="relative flex-grow w-full md:w-auto">
            <div className="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none z-10">
              <SearchIcon />
            </div>
            <input
              type="text"
              value={searchTerm}
              onChange={e => setSearchTerm(e.target.value)}
              placeholder={t('billList.searchPlaceholder')}
              className="form-input w-full !py-3 rounded-xl transition-all"
            />
          </div>

          <div className="relative flex-shrink-0 w-full md:w-64">
            <div className="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none z-10">
              <CalendarIcon />
            </div>
            <DatePicker
              selectsRange
              startDate={startDate}
              endDate={endDate}
              onChange={([start, end]) => {
                setStartDate(start);
                setEndDate(end);
                setCurrentPage(1);
              }}
              isClearable
              placeholderText={t('billList.datePlaceholder')}
              customInput={<CustomDateInput placeholder={t('billList.datePlaceholder')} />}
              className="w-full"
              popperClassName="react-datepicker-dark z-50"
              popperPlacement="bottom-start"
              dateFormat="MMM d, yyyy"
              showPopperArrow={false}
              wrapperClassName="w-full"
            />
          </div>

          <div className="relative flex-shrink-0 w-full md:w-56">
            <div className="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none z-10">
              <SortIcon />
            </div>
            <select
              value={sortBy}
              onChange={e => setSortBy(e.target.value)}
              className="form-input appearance-none w-full !py-3 rounded-xl"
            >
              <option value="createdAt-desc">{t('billList.sortNewest')}</option>
              <option value="createdAt-asc">{t('billList.sortOldest')}</option>
              <option value="totalAmount-desc">{t('billList.sortHigh')}</option>
              <option value="totalAmount-asc">{t('billList.sortLow')}</option>
            </select>
          </div>

          {canManage && (
            <button
              onClick={exportToCsv}
              className="button-secondary !px-6 !py-3 rounded-xl flex items-center justify-center gap-2 flex-shrink-0 w-full md:w-auto font-semibold transition-all duration-200"
            >
              <ExportIcon />
              {t('billList.export')}
            </button>
          )}
        </div>
      </div>

      {error && (
        <div className="card text-center p-10">
          <p className="text-red-500 dark:text-red-400 font-semibold">{error}</p>
          <button onClick={loadBills} className="button-primary mt-4">{t('common.tryAgain')}</button>
        </div>
      )}

      {!error && (
        <div className="card overflow-x-auto rounded-2xl p-0">
          <table className="table w-full">
            <thead>
              <tr>
                <th className="text-left">{t('billList.headerId')}</th>
                <th className="text-left">{t('billList.headerCustomer')}</th>
                <th className="text-right">{t('billList.headerTotal')}</th>
                <th className="text-left">{t('billList.headerDate')}</th>
                <th className="text-left">{t('billList.headerPayment')}</th>
                <th className="text-left">{t('billList.headerStatus')}</th>
                <th className="text-center">{t('billList.headerActions')}</th>
              </tr>
            </thead>
            <motion.tbody layout>
              <AnimatePresence>
                {loading ? (
                  Array(5).fill().map((_, i) => <SkeletonRow key={i} />)
                ) : paginatedBills.length === 0 ? (
                  <tr>
                    <td colSpan="7">
                      <EmptyState />
                    </td>
                  </tr>
                ) : (
                  paginatedBills.map((bill, i) => {
                    const { date, time } = formatDate(bill.createdAt || bill.date);
                    return (
                      <motion.tr
                        key={bill.billId}
                        layout
                        initial={{ opacity: 0 }}
                        animate={{ opacity: 1 }}
                        exit={{ opacity: 0 }}
                        transition={{ delay: i * 0.02, duration: 0.2 }}
                        className="hover:bg-gray-50 dark:hover:bg-cyan-500/5 transition-all duration-200 cursor-pointer group"
                        onClick={() => handleRowClick(bill)}
                      >
                        <td className="font-mono text-cyan-600 dark:text-cyan-400">{bill.billId}</td>
                        <td className="min-w-[200px]">
                          <div className="flex items-center gap-3">
                            <CustomerAvatar name={bill.customer?.name} />
                            <div>
                              <p className="font-medium text-gray-900 dark:text-white group-hover:text-blue-600 dark:group-hover:text-blue-300 transition-colors">
                                {bill.customer?.name || t('billList.walkIn')}
                              </p>
                              <p className="text-xs text-gray-500 dark:text-gray-400">{bill.customer?.mobile || t('billList.noMobile')}</p>
                            </div>
                          </div>
                        </td>
                        <td className="text-right font-bold text-emerald-600 dark:text-emerald-400 min-w-[120px]">
                          {formatCurrency(bill.totalAmount)}
                        </td>
                        <td className="min-w-[170px]">
                          <div>
                            <p className="text-gray-900 dark:text-white font-medium">{date}</p>
                            <p className="text-xs text-gray-500 dark:text-gray-400">{time}</p>
                          </div>
                        </td>
                        <td>
                          <span className={`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${
                            bill.paymentMethod === 'upi' ? 'bg-purple-100 text-purple-700 border border-purple-200 dark:bg-purple-500/20 dark:text-purple-300 dark:border-purple-500/30' :
                            bill.paymentMethod === 'card' ? 'bg-blue-100 text-blue-700 border border-blue-200 dark:bg-blue-500/20 dark:text-blue-300 dark:border-blue-500/30' :
                            bill.paymentMethod === 'credit' ? 'bg-orange-100 text-orange-700 border border-orange-200 dark:bg-orange-500/20 dark:text-orange-300 dark:border-orange-500/30' :
                            'bg-gray-100 text-gray-700 border border-gray-200 dark:bg-gray-500/20 dark:text-gray-300 dark:border-gray-500/30'
                          }`}>
                            {bill.paymentMethod?.toUpperCase() || t('billList.paymentMethod')}
                          </span>
                        </td>
                        <td>
                          <span className="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 border border-green-200 dark:bg-gradient-to-r dark:from-green-700 dark:to-emerald-500/60 dark:text-green-200 dark:border-emerald-400/50 dark:shadow-[0_0_10px_rgba(16,185,129,0.4)]">
                            <CheckCircleIcon />
                            {t('billList.statusCompleted')}
                          </span>
                        </td>
                        <td className="text-center">
                          <div className="flex justify-center gap-2" onClick={(e) => e.stopPropagation()}>
                            <button
                              onClick={(e) => handleDownload(bill, e)}
                              disabled={downloadingId === bill.billId}
                              className="p-2 rounded-lg bg-blue-500 dark:bg-gradient-to-br dark:from-blue-500 dark:to-cyan-600 text-white shadow-md hover:shadow-lg transform hover:scale-105 transition-all disabled:opacity-50"
                              title={t('billList.downloadPDF')}
                            >
                              {downloadingId === bill.billId ? (
                                <div className="w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"></div>
                              ) : (
                                <PdfIcon />
                              )}
                            </button>
                            <button
                              onClick={(e) => handleResend(bill.billId, e)}
                              disabled={resendingId === bill.billId}
                              className="p-2 rounded-lg bg-purple-500 dark:bg-gradient-to-br dark:from-purple-500 dark:to-pink-600 text-white shadow-md hover:shadow-lg transform hover:scale-105 transition-all disabled:opacity-50"
                              title={t('billList.resendEmail')}
                            >
                              {resendingId === bill.billId ? (
                                <div className="w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"></div>
                              ) : (
                                <ResendIcon />
                              )}
                            </button>
                          </div>
                        </td>
                      </motion.tr>
                    );
                  })
                )}
              </AnimatePresence>
            </motion.tbody>
          </table>

          {totalPages > 1 && (
            <div className="flex justify-between items-center p-4 border-t border-gray-200 dark:border-gray-700/50">
              <p className="text-sm text-gray-600 dark:text-gray-400">
                {t('billList.showing', {
                  start: ((currentPage - 1) * itemsPerPage) + 1,
                  end: Math.min(currentPage * itemsPerPage, displayBills.length),
                  total: displayBills.length
                })}
              </p>
              <div className="flex gap-2">
                <button
                  onClick={() => setCurrentPage(prev => Math.max(prev - 1, 1))}
                  disabled={currentPage === 1}
                  className="px-3 py-1 rounded-lg bg-gray-200 dark:bg-gray-800 text-gray-700 dark:text-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-300 dark:hover:bg-gray-700 transition-colors"
                >
                  {t('common.previous')}
                </button>
                <span className="px-3 py-1 rounded-lg bg-cyan-500 text-white">
                  {currentPage}
                </span>
                <button
                  onClick={() => setCurrentPage(prev => Math.min(prev + 1, totalPages))}
                  disabled={currentPage === totalPages}
                  className="px-3 py-1 rounded-lg bg-gray-200 dark:bg-gray-800 text-gray-700 dark:text-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-300 dark:hover:bg-gray-700 transition-colors"
                >
                  {t('common.next')}
                </button>
              </div>
            </div>
          )}
        </div>
      )}

      {/* Bill Details Drawer */}
      <BillDetailsDrawer
        bill={selectedBill}
        isOpen={isDrawerOpen}
        onClose={() => setIsDrawerOpen(false)}
        t={t}
        onDownload={handleDrawerDownload}
        onResend={handleDrawerResend}
      />
    </motion.div>
  );
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\components\checkout
--------------------------------------------------------------------
Contents:
CheckoutPage.jsx

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\checkout\CheckoutPage.jsx
--------------------------------------------------------------------
import React, { useState } from 'react';
import { useCart } from '../../context/CartContext';
import { createBill } from '../../services/billService';
import authService from '../../services/authService';
import { useNavigate } from 'react-router-dom';
import { useToast } from '../../context/ToastContext';
import { useTranslation } from 'react-i18next'; // <-- Import

export default function CheckoutPage() {
  const { cartItems, cartTotal, updateQuantity, removeFromCart, clearCart } = useCart();
  const { showToast } = useToast();
  const { t } = useTranslation(); // <-- Get hook

  const [customerInfo, setCustomerInfo] = useState({
    name: '',
    email: '',
    mobile: ''
  });

  const [loading, setLoading] = useState(false);
  const [error, setError] = useState(null);
  const user = authService.getUserFromToken();
  const navigate = useNavigate();

  const handleCustomerChange = (e) => {
    const { name, value } = e.target;
    setCustomerInfo(prev => ({ ...prev, [name]: value }));
  };

  const handleGenerateBill = async () => {
    if (!customerInfo.mobile) {
      const msg = t('checkout.errorMobile');
      setError(msg);
      showToast(msg, 'error');
      return;
    }
    if (cartItems.length === 0) {
      const msg = t('checkout.errorEmptyCart');
      setError(msg);
      showToast(msg, 'error');
      return;
    }

    setLoading(true);
    setError(null);

    const billRequest = {
      billId: `B${Date.now()}`,
      customer: {
        name: customerInfo.name || 'Customer',
        email: customerInfo.email,
        mobile: customerInfo.mobile,
      },
      items: cartItems.map(item => ({
        productId: item.productId,
        productName: item.name,
        qty: item.quantity,
        price: item.price,
      })),
      addedBy: user?.email || 'system',
    };

    try {
      const newBill = await createBill(billRequest);
      showToast(t('checkout.billSuccess', { billId: newBill.billId }), 'success');
      clearCart();
      setCustomerInfo({ name: '', email: '', mobile: '' });
      navigate('/bills');
    } catch (err) {
      const errMsg = err.response?.data?.error || err.message;
      setError(t('checkout.billError', { error: errMsg }));
      showToast(t('checkout.billError', { error: errMsg }), 'error');
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="max-w-4xl mx-auto grid grid-cols-1 lg:grid-cols-3 gap-6">
      {/* Cart Items */}
      <div className="lg:col-span-2 card p-6">
        <h2 className="text-2xl font-bold text-gray-900 dark:text-white mb-4">{t('checkout.title')}</h2>
        {error && (
          <div className="bg-red-100 dark:bg-red-900/50 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-100 px-4 py-3 rounded-lg mb-4">
            {error}
          </div>
        )}
        <div className="space-y-4">
          {cartItems.length === 0 ? (
            <p className="text-gray-500 dark:text-gray-400">{t('checkout.empty')}</p>
          ) : (
            cartItems.map(item => (
              <div key={item.productId} className="flex items-center gap-4 p-3 bg-gray-100 dark:bg-gray-800/50 rounded-lg">
                <div className="flex-grow">
                  <p className="font-semibold text-gray-900 dark:text-white">{item.name}</p>
                  <p className="text-sm text-gray-500 dark:text-gray-400">
                    {item.quantity} x {item.price.toLocaleString('en-IN', { style: 'currency', currency: 'INR' })}
                  </p>
                </div>
                <input
                  type="number"
                  value={item.quantity}
                  onChange={(e) => updateQuantity(item.productId, parseInt(e.target.value))}
                  min="1"
                  className="form-input w-20 text-center !pl-2"
                />
                <p className="text-lg font-semibold text-gray-900 dark:text-white w-24 text-right">
                  {(item.quantity * item.price).toLocaleString('en-IN', { style: 'currency', currency: 'INR' })}
                </p>
                <button
                  onClick={() => removeFromCart(item.productId)}
                  className="text-red-500 hover:text-red-400"
                  title="Remove"
                >
                  &times;
                </button>
              </div>
            ))
          )}
        </div>
      </div>

      {/* Summary & Checkout */}
      <div className="lg:col-span-1 card p-6 h-fit">
        <h3 className="text-xl font-bold text-gray-900 dark:text-white mb-4">{t('checkout.summary')}</h3>
        <div className="space-y-2 mb-4">
          <div className="flex justify-between text-gray-700 dark:text-gray-300">
            <span>{t('checkout.subtotal')}</span>
            <span className="font-medium">{cartTotal.toLocaleString('en-IN', { style: 'currency', currency: 'INR' })}</span>
          </div>
          <div className="flex justify-between text-gray-700 dark:text-gray-300">
            <span>{t('checkout.taxes')}</span>
            <span className="font-medium">{t('checkout.taxesValue')}</span>
          </div>
          <div className="flex justify-between text-gray-900 dark:text-white text-lg font-bold pt-2 border-t border-gray-200 dark:border-gray-700">
            <span>{t('checkout.total')}</span>
            <span>{cartTotal.toLocaleString('en-IN', { style: 'currency', currency: 'INR' })}</span>
          </div>
        </div>

        <div className="mt-6 space-y-3">
          <label className="block text-sm font-medium text-gray-600 dark:text-gray-400">
            {t('checkout.customerDetails')}
          </label>
          <input
            type="text"
            name="name"
            value={customerInfo.name}
            onChange={handleCustomerChange}
            placeholder={t('checkout.customerName')}
            className="form-input-no-icon w-full"
          />
          <input
            type="text"
            name="mobile"
            value={customerInfo.mobile}
            onChange={handleCustomerChange}
            placeholder={t('checkout.customerMobile')}
            className="form-input-no-icon w-full"
            required
          />
          <input
            type="email"
            name="email"
            value={customerInfo.email}
            onChange={handleCustomerChange}
            placeholder={t('checkout.customerEmail')}
            className="form-input-no-icon w-full"
          />
        </div>

        <button
          onClick={handleGenerateBill}
          disabled={loading || cartItems.length === 0 || !customerInfo.mobile}
          className="button-primary w-full mt-6"
        >
          {loading ? t('checkout.generatingBill') : t('checkout.generateBill')}
        </button>
      </div>
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\components\common
--------------------------------------------------------------------
Contents:
FileUploader.jsx
Table.jsx

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\common\FileUploader.jsx
--------------------------------------------------------------------
import React from 'react'

export default function FileUploader({ label, accept, onFileSelect }) {
  return (
    <div className="flex flex-col gap-2 mb-3">
      <label className="font-medium">{label}</label>
      <input type="file" accept={accept} onChange={e => onFileSelect(e.target.files[0])} />
    </div>
  )
}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\common\Table.jsx
--------------------------------------------------------------------
import React from 'react'

export default function Table({ columns, data }) {
  return (
    <div className="overflow-x-auto card">
      <table className="table">
        <thead>
          <tr>
            {columns.map(col => <th key={col}>{col}</th>)}
          </tr>
        </thead>
        <tbody>
          {data.map((row, i) => (
            <tr key={i}>
              {columns.map(col => <td key={col}>{row[col]}</td>)}
            </tr>
          ))}
        </tbody>
      </table>
    </div>
  )
}

--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\components\customers
--------------------------------------------------------------------
Contents:
CustomerCard.jsx
CustomerEdit.jsx
CustomerForm.jsx
CustomerHistory.jsx
CustomerList.jsx
ReminderTrigger.jsx
SendEmailModal.jsx

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\customers\CustomerCard.jsx
--------------------------------------------------------------------
import React from 'react';
import { motion } from 'framer-motion';
import { useTranslation } from 'react-i18next';

// --- Reusable Icons ---
const PhoneIcon = () => (
  <svg className="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
  </svg>
);
const EmailIcon = () => (
  <svg className="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
  </svg>
);
const HistoryIcon = () => (
  <svg className="w-4 h-4 mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
  </svg>
);
const SendEmailIcon = () => (
  <svg className="w-4 h-4 mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
  </svg>
);
const DeleteIcon = () => (
  <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
  </svg>
);
const AvatarIcon = () => (
  <div className="w-full h-full flex items-center justify-center bg-gray-200 dark:bg-gray-800 rounded-t-2xl">
    <svg className="w-20 h-20 text-gray-400 dark:text-gray-700" fill="currentColor" viewBox="0 0 20 20">
      <path fillRule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clipRule="evenodd" />
    </svg>
  </div>
);
// --- End Icons ---

const CustomerCard = ({ customer, onSendEmail, onViewHistory, onDelete, canManage }) => {
  const { t } = useTranslation();
  const { id, name, email, mobile, totalPurchaseCount, lastPurchaseDate } = customer;

  const formatDate = (dateString) => {
    if (!dateString) return "N/A";
    return new Date(dateString).toLocaleDateString('en-IN', {
      day: '2-digit',
      month: 'short',
      year: 'numeric'
    });
  };

  return (
    <motion.div
      layout
      initial={{ opacity: 0, scale: 0.9 }}
      animate={{ opacity: 1, scale: 1 }}
      exit={{ opacity: 0, scale: 0.9 }}
      transition={{ duration: 0.3, ease: 'easeOut' }}
      className="card relative flex flex-col group overflow-hidden"
    >
      {/* Image Placeholder */}
      <div className="aspect-w-1 aspect-h-1 w-full rounded-t-2xl overflow-hidden">
        <AvatarIcon />
      </div>

      {/* Details */}
      <div className="p-5 flex-grow flex flex-col">
        <h3 className="text-lg font-bold text-gray-900 dark:text-white truncate" title={name}>
          {/* MODIFIED */}
          {name || t('customerCard.unnamed')}
        </h3>

        {/* Contact Info */}
        <div className="mt-2 space-y-1.5">
          {mobile && (
            <div className="flex items-center gap-2">
              <PhoneIcon />
              <span className="text-sm text-gray-700 dark:text-gray-300">{mobile}</span>
            </div>
          )}
          {email && (
            <div className="flex items-center gap-2">
              <EmailIcon />
              <span className="text-sm text-gray-700 dark:text-gray-300 truncate" title={email}>{email}</span>
            </div>
          )}
        </div>

        {/* Stats */}
        <div className="mt-4 pt-4 border-t border-gray-200 dark:border-gray-700 flex justify-between items-end">
          <div className="text-left">
            {/* MODIFIED */}
            <p className="text-xs text-gray-500 font-medium">{t('customerCard.totalPurchases')}</p>
            <p className="text-xl font-bold text-cyan-600 dark:text-cyan-400">
              {totalPurchaseCount || 0}
            </p>
          </div>
          <div className="text-right">
            {/* MODIFIED */}
            <p className="text-xs text-gray-500 font-medium">{t('customerCard.lastPurchase')}</p>
            <p className="text-lg font-bold text-gray-900 dark:text-white">
              {formatDate(lastPurchaseDate)}
            </p>
          </div>
        </div>

        {/* Action Buttons */}
        {canManage && (
          <div className="mt-4 space-y-2">
            <button
              onClick={() => onSendEmail(customer)}
              className="button-primary w-full flex items-center justify-center"
            >
              <SendEmailIcon />
              {/* MODIFIED */}
              {t('customerCard.sendEmail')}
            </button>
            <button
              onClick={() => onViewHistory(customer)}
              className="button-secondary w-full flex items-center justify-center"
            >
              <HistoryIcon />
              {/* MODIFIED */}
              {t('customerCard.viewHistory')}
            </button>
            <button
              onClick={() => onDelete(customer)}
              className="w-full flex items-center justify-center px-4 py-2 rounded-lg font-medium
                         text-red-500 bg-gray-100 hover:bg-red-100 hover:text-red-600
                         dark:text-red-400 dark:bg-gray-800/50 dark:hover:bg-red-900/50 dark:hover:text-red-300
                         transition-all duration-300 disabled:opacity-50"
              // MODIFIED
              aria-label={t('customerCard.deleteAria', { name: name || t('customerCard.thisCustomer') })}
            >
              <DeleteIcon />
              {/* MODIFIED */}
              <span className="ml-1.5">{t('customerCard.delete')}</span>
            </button>
          </div>
        )}
      </div>
    </motion.div>
  );
};

export default CustomerCard;
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\customers\CustomerEdit.jsx
--------------------------------------------------------------------
import React, { useEffect, useState } from 'react';
import { useNavigate, useParams } from 'react-router-dom';
import { getCustomer, updateCustomer } from '../../services/customerService';
import { useToast } from '../../context/ToastContext';
import { useTranslation } from 'react-i18next';

export default function CustomerEdit() {
  const { id } = useParams();
  const nav = useNavigate();
  const { showToast } = useToast();
  const { t } = useTranslation();

  const [customer, setCustomer] = useState({
    name: '',
    email: '',
    mobile: '',
  });
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    async function fetchData() {
      try {
        const data = await getCustomer(id);
        setCustomer(data);
      } catch (err) {
        const msg = err.response?.data?.message || err.message;
        showToast(`${t('customerEdit.errorLoad')} ${msg}`, 'error');
      } finally {
        setLoading(false);
      }
    }
    fetchData();
  }, [id, showToast, t]);

  async function handleSubmit(e) {
    e.preventDefault();
    try {
      await updateCustomer(id, customer);
      showToast(t('customerEdit.success'), 'success');
      nav('/customers');
    } catch (err) {
      const msg = err.response?.data?.message || err.message;
      console.error('Update failed:', err.response?.data || err);
      showToast(`${t('customerEdit.errorUpdate')} ${msg}`, 'error');
    }
  }

  if (loading) return <div className="card p-6 text-center text-gray-500 dark:text-gray-400">{t('customerEdit.loading')}</div>;

  return (
    <div className="card max-w-lg mx-auto p-6">
      <h2 className="card-title">{t('customerEdit.title')}</h2>

      <form onSubmit={handleSubmit} className="space-y-4">
        <div>
          <label className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1.5">{t('customerForm.name')}</label>
          <input
            type="text"
            value={customer.name}
            onChange={(e) => setCustomer({ ...customer, name: e.target.value })}
            className="form-input-no-icon w-full"
            required
          />
        </div>

        <div>
          <label className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1.5">{t('customerForm.email')}</label>
          <input
            type="email"
            value={customer.email}
            onChange={(e) => setCustomer({ ...customer, email: e.target.value })}
            className="form-input-no-icon w-full"
          />
        </div>

        <div>
          <label className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1.5">{t('customerForm.mobile')}</label>
          <input
            type="text"
            value={customer.mobile}
            onChange={(e) => setCustomer({ ...customer, mobile: e.target.value })}
            className="form-input-no-icon w-full"
          />
        </div>

        <button type="submit" className="button-primary w-full mt-3">
          {t('customerForm.save')}
        </button>
      </form>
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\customers\CustomerForm.jsx
--------------------------------------------------------------------
import React, { useState } from 'react';
import { createCustomer } from '../../services/customerService';
import { useNavigate } from 'react-router-dom';
import { useTranslation } from 'react-i18next';

export default function CustomerForm() {
  const { t } = useTranslation();
  const [name, setName] = useState('');
  const [email, setEmail] = useState('');
  const [mobile, setMobile] = useState('');
  const nav = useNavigate();

  async function handleSubmit(e) {
    e.preventDefault();
    try {
      await createCustomer({ name, email, mobile });
      nav('/customers');
    } catch (err) {
      alert("Failed to create customer: " + (err.response?.data?.message || err.message));
    }
  }

  return (
    <form onSubmit={handleSubmit} className="card max-w-md mx-auto p-6">
      <h2 className="card-title">{t('customerForm.title')}</h2>

      <div className="space-y-4">
        <div>
          <label className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1.5">{t('customerForm.name')}</label>
          <input
            value={name}
            onChange={e => setName(e.target.value)}
            placeholder={t('customerForm.name')}
            className="form-input-no-icon w-full"
            required
          />
        </div>
        <div>
          <label className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1.5">{t('customerForm.email')}</label>
          <input
            value={email}
            onChange={e => setEmail(e.target.value)}
            placeholder={t('customerForm.email')}
            type="email"
            className="form-input-no-icon w-full"
          />
        </div>
        <div>
          <label className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1.5">{t('customerForm.mobile')}</label>
          <input
            value={mobile}
            onChange={e => setMobile(e.target.value)}
            placeholder={t('customerForm.mobile')}
            className="form-input-no-icon w-full"
            required
          />
        </div>
      </div>

      <button className="button-primary w-full mt-6">{t('customerForm.save')}</button>
    </form>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\customers\CustomerHistory.jsx
--------------------------------------------------------------------
import React, { useEffect, useState } from "react";
import { useParams, Link } from "react-router-dom";
import { getCustomer, getPurchaseHistory } from "../../services/customerService";
import { downloadBillPdf, generatePdfToken, downloadBillPdfWithFlow, handlePdfDownload } from "../../services/billService";
import { useToast } from "../../context/ToastContext";
import { useTranslation } from 'react-i18next';

export default function CustomerHistory() {
  const { t } = useTranslation();
  const { id } = useParams();
  const [history, setHistory] = useState([]);
  const [customer, setCustomer] = useState(null);
  const [error, setError] = useState(null);
  const [loading, setLoading] = useState(true);
  const [downloadingId, setDownloadingId] = useState(null);
  const { showToast } = useToast();

  useEffect(() => {
    if (!id) return;
    async function fetchData() {
      setLoading(true);
      try {
        const [custData, histData] = await Promise.all([
          getCustomer(id),
          getPurchaseHistory(id)
        ]);
        setCustomer(custData);
        setHistory(histData.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt)));
      } catch (err) {
        console.error("Error fetching data:", err);
        const errMsg = err.response?.data?.error || t('history.error');
        setError(errMsg);
        showToast(errMsg, 'error');
      } finally {
        setLoading(false);
      }
    }
    fetchData();
  }, [id, showToast, t]);

  const handleDownload = async (bill) => {
    setDownloadingId(bill.billId);
    try {
      showToast(t('history.downloading', { billId: bill.billId }), 'info');

      // Use the complete flow that handles token generation automatically
      const pdfBlob = await downloadBillPdfWithFlow(bill.billId);
      handlePdfDownload(pdfBlob, bill.billId);

      showToast(t('history.downloadSuccess'), 'success');
    } catch (err) {
      console.error('Error downloading PDF:', err);
      const errorMessage = err.response?.data?.message || err.message || t('history.downloadFailed');
      showToast(errorMessage, 'error');
    } finally {
      setDownloadingId(null);
    }
  };

  // Alternative method if you want more control over the process
  const handleDownloadAlternative = async (bill) => {
    setDownloadingId(bill.billId);
    try {
      showToast(t('history.downloading', { billId: bill.billId }), 'info');

      let pdfToken = bill.pdfAccessToken;

      // If no token exists or token might be expired, generate a new one
      if (!pdfToken) {
        const tokenResponse = await generatePdfToken(bill.billId);
        pdfToken = tokenResponse.pdfAccessToken;
      }

      // Download the PDF with the token
      const blob = await downloadBillPdf(bill.billId, pdfToken);

      // Create and trigger download
      const url = window.URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = `Bill_${bill.billId}.pdf`;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      window.URL.revokeObjectURL(url);

      showToast(t('history.downloadSuccess'), 'success');
    } catch (err) {
      console.error('Error downloading PDF:', err);
      const errorMessage = err.response?.data?.message || err.message || t('history.downloadFailed');
      showToast(errorMessage, 'error');
    } finally {
      setDownloadingId(null);
    }
  };

  if (loading) return (
    <div className="card p-6 text-center text-gray-500 dark:text-gray-400">
      <div className="flex items-center justify-center">
        <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-cyan-500 mr-3"></div>
        {t('history.loading')}
      </div>
    </div>
  );

  if (error) return (
    <div className="card p-6">
      <div className="text-red-500 dark:text-red-400 text-center">
        <p className="font-semibold">{error}</p>
        <button
          onClick={() => window.history.back()}
          className="button-primary mt-4"
        >
          {t('common.goBack')}
        </button>
      </div>
    </div>
  );

  if (!customer) return (
    <div className="card p-6 text-center text-gray-500 dark:text-gray-400">
      {t('history.notFound')}
    </div>
  );

  const formatCurrency = (amount) => {
    return (amount || 0).toLocaleString('en-IN', {
      style: 'currency',
      currency: 'INR',
      maximumFractionDigits: 2,
    });
  };

  const formatDate = (dateString) => {
    if (!dateString) return 'N/A';
    const date = new Date(dateString);
    return {
      date: date.toLocaleDateString('en-IN', {
        day: '2-digit',
        month: 'short',
        year: 'numeric'
      }),
      time: date.toLocaleTimeString('en-IN', {
        hour: '2-digit',
        minute: '2-digit',
        hour12: true
      })
    };
  };

  return (
    <div className="space-y-6">
      {/* Header */}
      <div className="card p-6">
        <div className="flex items-center justify-between">
          <div>
            <Link to="/customers" className="text-blue-500 dark:text-blue-400 hover:underline text-sm mb-2 inline-flex items-center">
              <svg className="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10 19l-7-7m0 0l7-7m-7 7h18" />
              </svg>
              {t('history.backToCustomers')}
            </Link>
            <h2 className="text-2xl font-bold text-gray-900 dark:text-white mb-1">
              {t('history.title')}
            </h2>
            <p className="text-lg text-cyan-600 dark:text-cyan-400 font-medium">
              {customer.name} • {customer.mobile}
            </p>
            {customer.email && (
              <p className="text-gray-600 dark:text-gray-400 text-sm mt-1">
                {customer.email}
              </p>
            )}
          </div>
          <div className="text-right">
            <p className="text-sm text-gray-500 dark:text-gray-400">
              {t('history.totalPurchases')}
            </p>
            <p className="text-2xl font-bold text-emerald-600 dark:text-emerald-400">
              {history.length}
            </p>
          </div>
        </div>
      </div>

      {/* Purchase History */}
      <div className="card p-0 overflow-hidden">
        {history.length === 0 ? (
          <div className="text-center py-12">
            <svg className="w-16 h-16 text-gray-400 dark:text-gray-500 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M9 17v-6h6v6m-6-4h.01M12 3v4m0 0h8m-8 0H4" />
            </svg>
            <p className="text-lg text-gray-500 dark:text-gray-400 font-light mb-2">
              {t('history.noHistory')}
            </p>
            <p className="text-sm text-gray-400 dark:text-gray-500">
              {t('history.noHistoryHint')}
            </p>
          </div>
        ) : (
          <div className="overflow-x-auto">
            <table className="table w-full">
              <thead>
                <tr className="bg-gray-50 dark:bg-gray-800/50">
                  <th className="text-left py-4 px-6 font-semibold text-gray-700 dark:text-gray-300">
                    {t('history.headerBill')}
                  </th>
                  <th className="text-left py-4 px-6 font-semibold text-gray-700 dark:text-gray-300">
                    {t('history.headerDate')}
                  </th>
                  <th className="text-right py-4 px-6 font-semibold text-gray-700 dark:text-gray-300">
                    {t('history.headerTotal')}
                  </th>
                  <th className="text-center py-4 px-6 font-semibold text-gray-700 dark:text-gray-300">
                    {t('history.headerActions')}
                  </th>
                </tr>
              </thead>
              <tbody>
                {history.map((bill) => {
                  const { date, time } = formatDate(bill.createdAt);
                  const total = bill.totalAmount ?? bill.total ?? 0;

                  return (
                    <tr
                      key={bill.billId || bill.id}
                      className="border-b border-gray-200 dark:border-gray-700/50 hover:bg-gray-50 dark:hover:bg-gray-800/30 transition-colors"
                    >
                      <td className="py-4 px-6">
                        <span className="font-mono text-cyan-600 dark:text-cyan-400 font-medium">
                          {bill.billId || "N/A"}
                        </span>
                      </td>
                      <td className="py-4 px-6">
                        <div>
                          <p className="text-gray-900 dark:text-white font-medium">
                            {date}
                          </p>
                          <p className="text-xs text-gray-500 dark:text-gray-400">
                            {time}
                          </p>
                        </div>
                      </td>
                      <td className="py-4 px-6 text-right">
                        <span className="font-bold text-emerald-600 dark:text-emerald-400">
                          {formatCurrency(total)}
                        </span>
                      </td>
                      <td className="py-4 px-6 text-center">
                        <button
                          onClick={() => handleDownload(bill)}
                          disabled={downloadingId === bill.billId}
                          className="button-primary text-sm px-4 py-2 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 mx-auto min-w-[120px]"
                          title={t('history.download')}
                        >
                          {downloadingId === bill.billId ? (
                            <>
                              <div className="w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"></div>
                              {t('common.downloading')}
                            </>
                          ) : (
                            <>
                              <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                              </svg>
                              {t('history.download')}
                            </>
                          )}
                        </button>
                      </td>
                    </tr>
                  );
                })}
              </tbody>
            </table>
          </div>
        )}
      </div>

      {/* Customer Stats */}
      {history.length > 0 && (
        <div className="card p-6">
          <h3 className="text-lg font-semibold text-gray-900 dark:text-white mb-4">
            {t('history.purchaseSummary')}
          </h3>
          <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div className="bg-gradient-to-br from-blue-500 to-cyan-400 rounded-lg p-4 text-white">
              <p className="text-sm opacity-90">{t('history.totalBills')}</p>
              <p className="text-2xl font-bold">{history.length}</p>
            </div>
            <div className="bg-gradient-to-br from-purple-500 to-pink-500 rounded-lg p-4 text-white">
              <p className="text-sm opacity-90">{t('history.totalSpent')}</p>
              <p className="text-2xl font-bold">
                {formatCurrency(history.reduce((sum, bill) => sum + (bill.totalAmount || bill.total || 0), 0))}
              </p>
            </div>
            <div className="bg-gradient-to-br from-green-500 to-emerald-400 rounded-lg p-4 text-white">
              <p className="text-sm opacity-90">{t('history.avgBill')}</p>
              <p className="text-2xl font-bold">
                {formatCurrency(history.reduce((sum, bill) => sum + (bill.totalAmount || bill.total || 0), 0) / history.length)}
              </p>
            </div>
          </div>
        </div>
      )}
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\customers\CustomerList.jsx
--------------------------------------------------------------------
import React, { useEffect, useState, useMemo } from 'react';
import { useNavigate } from 'react-router-dom';
import { listCustomers, deleteCustomer } from '../../services/customerService';
import { listBills } from '../../services/billService';
import authService from '../../services/authService';
import Fuse from 'fuse.js';
import { motion, AnimatePresence } from 'framer-motion';
import { useToast } from '../../context/ToastContext';
import { useTranslation } from 'react-i18next';
import CustomerCard from './CustomerCard';
import SendEmailModal from './SendEmailModal';

// --- Icons ---
const SearchIcon = () => (
  <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
  </svg>
);
const SortIcon = () => (
  <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 4h13M3 8h9M3 12h9m-9 4h13m-3-4v8m0 0l-4-4m4 4l4-4" />
  </svg>
);
const FilterIcon = () => (
  <svg className="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z" />
  </svg>
);
const EmailIcon = () => (
  <svg className="w-5 h-5 mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
  </svg>
);
// --- End Icons ---

// --- Skeleton Card ---
const SkeletonCard = () => (
  <div className="card relative flex flex-col overflow-hidden animate-pulse">
    <div className="aspect-w-1 aspect-h-1 w-full bg-gray-200 dark:bg-gray-800 rounded-t-2xl"></div>
    <div className="p-5 flex-grow flex flex-col">
      <div className="h-6 bg-gray-300 dark:bg-gray-700 rounded w-3/4 mb-2"></div>
      <div className="h-4 bg-gray-300 dark:bg-gray-700 rounded w-1/2 mb-4"></div>
      <div className="mt-4 pt-4 border-t border-gray-200 dark:border-gray-700 flex justify-between items-end">
        <div className="w-1/3"><div className="h-5 bg-gray-300 dark:bg-gray-700 rounded w-full"></div></div>
        <div className="w-1/4"><div className="h-5 bg-gray-300 dark:bg-gray-700 rounded w-full"></div></div>
      </div>
      <div className="mt-4 space-y-2">
        <div className="h-10 bg-gray-300 dark:bg-gray-700 rounded w-full"></div>
        <div className="h-10 bg-gray-300 dark:bg-gray-700 rounded w-full"></div>
      </div>
    </div>
  </div>
);

export default function CustomerList() {
  const { t } = useTranslation();
  const [customers, setCustomers] = useState([]);
  const [searchTerm, setSearchTerm] = useState('');
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);
  const [sortBy, setSortBy] = useState('name-asc');
  const [filter, setFilter] = useState('all');
  const [isEmailModalOpen, setIsEmailModalOpen] = useState(false);
  const [selectedCustomers, setSelectedCustomers] = useState([]);

  const { showToast } = useToast();
  const navigate = useNavigate();
  const user = authService.getUserFromToken();
  const canManage = user?.role === 'OWNER' || user?.role === 'MANAGER';

  const fuse = useMemo(() => new Fuse(customers, {
    keys: ['name', 'email', 'mobile'],
    threshold: 0.4,
  }), [customers]);

  const displayCustomers = useMemo(() => {
    let items = searchTerm
      ? fuse.search(searchTerm).map(r => r.item)
      : [...customers];

    if (filter === 'inactive') {
      const thirtyDaysAgo = new Date(Date.now() - 30 * 24 * 60 * 60 * 1000);
      items = items.filter(c => !c.lastPurchaseDate || new Date(c.lastPurchaseDate) < thirtyDaysAgo);
    }

    const [key, direction] = sortBy.split('-');
    return [...items].sort((a, b) => {
      let valA = a[key] ?? (key === 'lastPurchaseDate' ? 0 : '');
      let valB = b[key] ?? (key === 'lastPurchaseDate' ? 0 : '');
      if (key === 'lastPurchaseDate') {
        valA = valA ? new Date(valA).getTime() : 0;
        valB = valB ? new Date(valB).getTime() : 0;
      } else if (key === 'totalPurchaseCount') {
        valA = valA || 0;
        valB = valB || 0;
      } else {
        valA = (valA || '').toString().toLowerCase();
        valB = (valB || '').toString().toLowerCase();
      }
      return (valA < valB ? -1 : 1) * (direction === 'asc' ? 1 : -1);
    });
  }, [customers, searchTerm, filter, sortBy, fuse]);

  useEffect(() => {
    loadCustomers();
  }, []);

  async function loadCustomers() {
    try {
      setLoading(true);
      setError(null);
      const [customerData, billData] = await Promise.all([
        listCustomers(),
        listBills()
      ]);
      if (!Array.isArray(customerData) || !Array.isArray(billData)) {
        throw new Error("Invalid data from server");
      }
      const billMap = new Map();
      billData.forEach(bill => bill.billId && billMap.set(bill.billId, bill));
      const processed = customerData.map(customer => {
        let totalCount = 0;
        let latestDate = null;
        if (customer.purchaseHistory?.length > 0) {
          totalCount = customer.purchaseHistory.length;
          customer.purchaseHistory.forEach(billId => {
            const bill = billMap.get(billId);
            if (bill?.createdAt) {
              const date = new Date(bill.createdAt);
              if (!latestDate || date > latestDate) latestDate = date;
            }
          });
        }
        return {
          ...customer,
          totalPurchaseCount: totalCount,
          lastPurchaseDate: latestDate ? latestDate.toISOString() : null
        };
      });
      setCustomers(processed);
    } catch (err) {
      console.error("Failed to load customers:", err);
      const msg = "Failed to load data. Please try again.";
      setError(msg);
      showToast(err.message || msg, 'error');
    } finally {
      setLoading(false);
    }
  }

  const handleViewHistory = (customer) => {
    navigate(`/customers/${customer.id}/history`);
  };

  const handleOpenEmailModal = (customer) => {
    setSelectedCustomers([customer]);
    setIsEmailModalOpen(true);
  };

  const handleSendToAll = () => {
    if (window.confirm(t('customerList.emailAllConfirm', { count: customers.length }))) {
      setSelectedCustomers(customers);
      setIsEmailModalOpen(true);
    }
  };

  const handleCloseEmailModal = (didSend = false) => {
    setIsEmailModalOpen(false);
    setSelectedCustomers([]);
    if (didSend) showToast('Email(s) sent!', 'success');
  };

  const handleDeleteCustomer = async (customer) => {
    if (!customer.id) {
      showToast('Cannot delete: Missing customer ID.', 'error');
      return;
    }
    if (!window.confirm(t('customerList.deleteConfirm', { name: customer.name || 'this customer' }))) {
      return;
    }
    try {
      await deleteCustomer(customer.id);
      showToast(t('customerList.deleteSuccess'), 'success');
      loadCustomers(); // Refresh
    } catch (err) {
      const msg = err.error || err.message || t('customerList.deleteError');
      showToast(msg, 'error');
    }
  };

  return (
    <div>
      <div className="flex justify-between items-center mb-4">
        <h2 className="text-3xl font-bold text-gray-900 dark:text-white font-display">
          {t('customerList.title')}
          <span className="text-lg font-normal text-gray-500 dark:text-gray-400 ml-3">
            ({displayCustomers.length} {t('customerList.matching')})
          </span>
        </h2>
      </div>

      <div className="card mb-6 p-4 flex flex-col md:flex-row gap-4 items-center">
        <div className="relative flex-grow w-full md:w-auto">
          <div className="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
            <SearchIcon />
          </div>
          <input
            type="text"
            value={searchTerm}
            onChange={(e) => setSearchTerm(e.target.value)}
            placeholder={t('customerList.searchPlaceholder')}
            className="form-input w-full"
          />
        </div>

        <div className="relative flex-shrink-0 w-full md:w-56">
          <div className="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
            <SortIcon />
          </div>
          <select
            value={sortBy}
            onChange={(e) => setSortBy(e.target.value)}
            className="form-input appearance-none w-full"
            aria-label={t('customerList.sort')}
          >
            <option value="name-asc">{t('customerList.sortNameAsc')}</option>
            <option value="name-desc">{t('customerList.sortNameDesc')}</option>
            <option value="lastPurchaseDate-desc">{t('customerList.sortDateDesc')}</option>
            <option value="lastPurchaseDate-asc">{t('customerList.sortDateAsc')}</option>
            <option value="totalPurchaseCount-desc">{t('customerList.sortPurchaseDesc')}</option>
          </select>
        </div>

        <div className="relative flex-shrink-0 w-full md:w-56">
          <div className="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
            <FilterIcon />
          </div>
          <select
            value={filter}
            onChange={(e) => setFilter(e.target.value)}
            className="form-input appearance-none w-full"
          >
            <option value="all">{t('customerList.filter')}</option>
            <option value="inactive">{t('customerList.filterInactive')}</option>
          </select>
        </div>

        {canManage && (
          <button
            onClick={handleSendToAll}
            className="button-primary flex-shrink-0 w-full md:w-auto flex items-center justify-center"
            disabled={customers.length === 0}
          >
            <EmailIcon />
            {t('customerList.emailAll')}
          </button>
        )}
      </div>

      {loading ? (
        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
          {[...Array(8)].map((_, i) => <SkeletonCard key={i} />)}
        </div>
      ) : error ? (
        <div className="card text-center p-10">
          <p className="text-red-500 dark:text-red-400 font-semibold">{error}</p>
          <button onClick={loadCustomers} className="button-primary mt-4">
            {t('customerList.tryAgain')}
          </button>
        </div>
      ) : displayCustomers.length === 0 ? (
        <div className="card text-center p-10">
          <p className="text-gray-600 dark:text-gray-400 font-semibold">
            {searchTerm ? t('customerList.noMatch') : filter !== 'all' ? t('customerList.noFilterMatch') : t('customerList.noCustomers')}
          </p>
          <button onClick={() => { setSearchTerm(''); setFilter('all'); }} className="button-secondary mt-4">
            {t('customerList.clearFilters')}
          </button>
        </div>
      ) : (
        <motion.div
          layout
          className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"
        >
          <AnimatePresence>
            {displayCustomers.map((c) => (
              <CustomerCard
                key={c.id}
                customer={c}
                onSendEmail={handleOpenEmailModal}
                onViewHistory={handleViewHistory}
                onDelete={handleDeleteCustomer}
                canManage={canManage}
              />
            ))}
          </AnimatePresence>
        </motion.div>
      )}

      <SendEmailModal
        isOpen={isEmailModalOpen}
        onClose={handleCloseEmailModal}
        selectedCustomers={selectedCustomers}
      />
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\customers\ReminderTrigger.jsx
--------------------------------------------------------------------
import React, { useState } from "react";
import { triggerReminders } from "../../services/customerService";
import { useTranslation } from 'react-i18next';

export default function ReminderTrigger() {
  const { t } = useTranslation();
  const [status, setStatus] = useState("");
  const [loading, setLoading] = useState(false);

  async function handleTrigger() {
    setLoading(true);
    setStatus("");
    try {
      const res = await triggerReminders();
      setStatus(res.message || t('reminder.success'));
    } catch (err) {
      setStatus(err.response?.data?.error || t('reminder.error'));
    } finally {
      setLoading(false);
    }
  }

  return (
    <div className="card max-w-md mx-auto text-center p-6">
      <h2 className="card-title justify-center">📅 {t('reminder.title')}</h2>
      <button
        onClick={handleTrigger}
        disabled={loading}
        className="button-primary px-4 py-2"
      >
        {loading ? t('reminder.sending') : t('reminder.button')}
      </button>

      {status && (
        <p className="mt-3 text-sm font-medium text-blue-600 dark:text-blue-400">{status}</p>
      )}
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\customers\SendEmailModal.jsx
--------------------------------------------------------------------
import React, { useState } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { useToast } from '../../context/ToastContext';
import { sendCustomEmail } from '../../services/customerService';
import { useTranslation } from 'react-i18next'; // <-- Import

// --- Reusable Icons ---
const CloseIcon = () => (
  <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
  </svg>
);

const backdropVariants = {
  hidden: { opacity: 0 },
  visible: { opacity: 1 },
};

const modalVariants = {
  hidden: { opacity: 0, y: 50, scale: 0.9 },
  visible: {
    opacity: 1,
    y: 0,
    scale: 1,
    transition: { type: 'spring', stiffness: 300, damping: 30, bounce: 0.2 }
  },
  exit: {
    opacity: 0,
    scale: 0.9,
    transition: { duration: 0.2 }
  },
};

export default function SendEmailModal({ isOpen, onClose, selectedCustomers = [] }) {
  const { t } = useTranslation(); // <-- Get hook
  const [subject, setSubject] = useState('');
  const [body, setBody] = useState('');
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState(null);
  const { showToast } = useToast();

  const getRecipientText = () => {
    if (selectedCustomers.length === 0) return t('emailModal.noRecipients');
    if (selectedCustomers.length === 1) {
      const c = selectedCustomers[0];
      return `${t('emailModal.to')} ${c.name || 'Unknown'} (${c.email || 'No email'})`;
    }
    return t('emailModal.toCount', { count: selectedCustomers.length });
  };

  const handleSubmit = async (e) => {
    e.preventDefault();

    if (selectedCustomers.length === 0) {
      const msg = t('emailModal.errorNoCustomers');
      setError(msg);
      showToast(msg, 'error');
      return;
    }

    if (!subject.trim() || !body.trim()) {
      const msg = t('emailModal.errorNoFields');
      setError(msg);
      showToast(msg, 'error');
      return;
    }

    setLoading(true);
    setError(null);

    const emailRequest = {
      customerIds: selectedCustomers.map(c => c.id),
      subject: subject.trim(),
      body: body.trim()
    };

    try {
      const response = await sendCustomEmail(emailRequest);
      showToast(response.message || `Email sending started!`, 'success');
      setSubject('');
      setBody('');
      onClose(true); // Close with success
    } catch (err) {
      const errMsg = err.error || err.message || "Failed to send emails.";
      setError(errMsg);
      showToast(errMsg, 'error');
    } finally {
      setLoading(false);
    }
  };

  const getSendButtonText = () => {
    if (loading) return t('emailModal.sending');
    if (selectedCustomers.length === 1) {
      return t('emailModal.send', { count: 1 });
    }
    return t('emailModal.sendPlural', { count: selectedCustomers.length });
  }

  return (
    <AnimatePresence>
      {isOpen && (
        <motion.div
          variants={backdropVariants}
          initial="hidden"
          animate="visible"
          exit="hidden"
          className="fixed inset-0 bg-black/70 backdrop-blur-sm z-40 flex items-center justify-center p-4"
          onClick={() => !loading && onClose(false)}
        >
          <motion.div
            variants={modalVariants}
            initial="hidden"
            animate="visible"
            exit="exit"
            className="card max-w-2xl w-full max-h-[90vh] flex flex-col"
            onClick={(e) => e.stopPropagation()}
          >
            {/* --- Modal Header --- */}
            <div className="flex justify-between items-center p-6 border-b border-gray-200 dark:border-gray-800 flex-shrink-0">
              <h2 className="text-2xl font-bold text-gray-900 dark:text-white font-display">
                {t('emailModal.title')}
              </h2>
              <button
                onClick={() => onClose(false)}
                className="text-gray-500 hover:text-gray-900 dark:hover:text-white transition-colors"
                disabled={loading}
                aria-label="Close modal"
              >
                <CloseIcon />
              </button>
            </div>

            {/* --- Modal Body --- */}
            <form onSubmit={handleSubmit} className="p-6 overflow-y-auto custom-scrollbar space-y-4">
              {error && (
                <div className="bg-red-100 dark:bg-red-900/50 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-100 px-4 py-3 rounded-lg" role="alert">
                  <span className="font-medium">Error:</span> {error}
                </div>
              )}

              <div>
                <label className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1.5">
                  {t('emailModal.recipients')}
                </label>
                <div className="form-input bg-gray-100 dark:bg-gray-900/50 p-3 rounded-lg text-gray-700 dark:text-gray-300">
                  {getRecipientText()}
                </div>
              </div>

              <div>
                <label htmlFor="subject" className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1.5">
                  {t('emailModal.subject')} <span className="text-red-500">*</span>
                </label>
                <input
                  id="subject"
                  type="text"
                  value={subject}
                  onChange={(e) => setSubject(e.target.value)}
                  placeholder={t('emailModal.subjectPlaceholder')}
                  className="form-input-no-icon" // Use no-icon version
                  required
                  disabled={loading}
                />
              </div>

              <div>
                <label htmlFor="body" className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1.5">
                  {t('emailModal.body')} <span className="text-red-500">*</span>
                </label>
                <textarea
                  id="body"
                  rows="10"
                  value={body}
                  onChange={(e) => setBody(e.target.value)}
                  placeholder={t('emailModal.bodyPlaceholder')}
                  className="form-input-no-icon resize-none" // Use no-icon version
                  required
                  disabled={loading}
                />
               <p className="text-xs text-gray-500 dark:text-gray-500 mt-1">
                 {t('emailModal.personalizeHint')}
               </p>
              </div>
            </form>

            {/* --- Modal Footer --- */}
            <div className="flex justify-end items-center p-6 border-t border-gray-200 dark:border-gray-800 flex-shrink-0 bg-gray-50 dark:bg-gray-900/50 rounded-b-2xl space-x-3">
              <button
                type="button"
                onClick={() => onClose(false)}
                className="button-secondary"
                disabled={loading}
              >
                {t('emailModal.cancel')}
              </button>
              <button
                type="submit"
                onClick={handleSubmit}
                className="button-primary min-w-[180px]"
                disabled={loading || selectedCustomers.length === 0 || !subject.trim() || !body.trim()}
              >
                {getSendButtonText()}
              </button>
            </div>
          </motion.div>
        </motion.div>
      )}
    </AnimatePresence>
  );
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\components\layout
--------------------------------------------------------------------
Contents:
AuthLayout.jsx
MainLayout.jsx
Navbar.jsx
Sidebar.jsx

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\layout\AuthLayout.jsx
--------------------------------------------------------------------
import React from 'react';
import { Outlet } from 'react-router-dom';

/**
 * This layout wraps all public auth pages (Login, Signup).
 * It's a simple wrapper to allow these pages to control the full screen.
 */
export default function AuthLayout() {
  return (
    // UPDATED: Added theme-aware background
    <div className="min-h-screen bg-white dark:bg-gray-900 transition-colors duration-200">
      {/* Auth pages (Login, Signup) will render here */}
      <Outlet />
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\layout\MainLayout.jsx
--------------------------------------------------------------------
import React from 'react';
import { Outlet } from 'react-router-dom';
import Navbar from './Navbar';

/**
 * This layout wraps all protected pages *after* login.
 * It includes the main Navbar and the centered, padded content area.
 */
export default function MainLayout() {
  return (
    // UPDATED: Now theme-aware
    <div className="min-h-screen bg-gray-100 dark:bg-gray-900 transition-colors duration-200">
      <Navbar />
      <main className="max-w-7xl mx-auto p-4 sm:p-6 lg:p-8">
        {/* All protected child routes will render here */}
        <Outlet />
      </main>
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\layout\Navbar.jsx
--------------------------------------------------------------------
import React, { useState } from 'react';
import { Link, useNavigate } from 'react-router-dom';
import authService from '../../services/authService';
import { useCart } from '../../context/CartContext';
import { useTheme } from '../../context/ThemeContext';
import { useTranslation } from 'react-i18next'; // <-- 1. Import
import i18n from '../../i18n'; // <-- 2. Import i18n instance

// --- Icons ---
const LogoIcon = () => (
  <svg className="w-8 h-8 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" />
  </svg>
);
const CartIcon = ({ count }) => (
  <div className="relative">
    <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
    </svg>
    {count > 0 && (
      <span className="absolute -top-2 -right-2 bg-red-500 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center">
        {count > 99 ? '99+' : count}
      </span>
    )}
  </div>
);
const LanguageIcon = () => (
  <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9" />
  </svg>
);
const SunIcon = () => (
  <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M12 12a5 5 0 100-10 5 5 0 000 10z" />
  </svg>
);
const MoonIcon = () => (
  <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
  </svg>
);
// --- END ICONS ---


export default function Navbar() {
  const { t } = useTranslation(); // <-- 3. Get translation function
  const nav = useNavigate();
  const user = authService.getUserFromToken();
  const { cartCount } = useCart();
  const { theme, toggleTheme } = useTheme();

  // 4. Use i18n's language state, which reads from localStorage
  const [language, setLanguage] = useState(i18n.language);

  const handleLanguageChange = (e) => {
    const selectedLang = e.target.value;
    setLanguage(selectedLang);
    localStorage.setItem("sr_lang", selectedLang);
    i18n.changeLanguage(selectedLang); // <-- 5. Change language live
    // window.location.reload(); // <-- 6. No longer needed!
  };

  const logout = () => {
    authService.logout();
    window.location.href = '/login';
  };

  return (
    <nav className="bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-200 shadow-md border-b border-gray-200 dark:border-gray-700">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div className="flex justify-between items-center h-16">

          {/* Left section */}
          <div className="flex gap-6 items-center">
            <Link to="/" className="flex items-center gap-2 flex-shrink-0">
              <LogoIcon />
              <span className="font-semibold text-xl text-gray-900 dark:text-white">
                Smart Retail
              </span>
            </Link>
            {user && (
              <div className="hidden md:flex gap-4">
                {/* --- 7. Use t() function --- */}
                <Link to="/dashboard" className="nav-link">{t('nav.dashboard')}</Link>
                <Link to="/products" className="nav-link">{t('nav.products')}</Link>
                <Link to="/bills" className="nav-link">{t('nav.bills')}</Link>
                <Link to="/customers" className="nav-link">{t('nav.customers')}</Link>
                <Link to="/reports" className="nav-link">{t('nav.reports')}</Link>
              </div>
            )}
          </div>

          {/* Right section */}
          {user ? (
            <div className="flex gap-4 items-center">
              <Link to="/profile" className="nav-link text-blue-500 dark:text-blue-400 font-medium">
                {user.email}
              </Link>

              {/* Language Selector */}
              <div className="relative flex items-center">
                <LanguageIcon />
                <select
                  value={language}
                  onChange={handleLanguageChange}
                  className="bg-transparent text-gray-600 dark:text-gray-300 font-medium text-sm rounded-md
                             pl-1 pr-7 -ml-1 py-1 border-0 focus:ring-0
                             hover:bg-gray-200 dark:hover:bg-gray-700/50 transition-colors"
                  aria-label={t('nav.selectLang')}
                >
                  <option value="en" className="bg-white dark:bg-gray-800">{t('lang.en')}</option>
                  <option value="hi" className="bg-white dark:bg-gray-800">{t('lang.hi')}</option>
                  <option value="mr" className="bg-white dark:bg-gray-800">{t('lang.mr')}</option>
                  <option value="te" className="bg-white dark:bg-gray-800">{t('lang.te')}</option>
                </select>
              </div>

              {/* Theme Toggle Button */}
              <button
                onClick={toggleTheme}
                className="nav-link p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-md transition-colors"
                title={`Switch to ${theme === 'light' ? 'dark' : 'light'} mode`}
              >
                {theme === 'light' ? <MoonIcon /> : <SunIcon />}
              </button>

              <Link
                to="/checkout"
                className="nav-link relative p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-md transition-colors"
                title={t('nav.viewCart')}
              >
                <CartIcon count={cartCount} />
              </Link>

              <button
                onClick={logout}
                className="bg-red-600 px-3 py-1.5 rounded-md text-sm font-medium text-white hover:bg-red-700 transition-colors"
              >
                {t('nav.logout')}
              </button>
            </div>
          ) : (
             <Link to="/login" className="bg-blue-600 px-3 py-1.5 rounded-md text-sm font-medium text-white hover:bg-blue-700 transition-colors">
              {t('nav.login')}
            </Link>
          )}
        </div>
      </div>
    </nav>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\layout\Sidebar.jsx
--------------------------------------------------------------------
import React from 'react'
import { Link } from 'react-router-dom'

export default function Sidebar() {
  return (
    <div className="w-64 bg-gray-800 text-white min-h-screen p-4 space-y-3">
      <h2 className="text-xl font-semibold mb-4">Menu</h2>
      <Link to="/dashboard" className="block hover:bg-gray-700 rounded p-2">Dashboard</Link>
      <Link to="/products" className="block hover:bg-gray-700 rounded p-2">Products</Link>
      <Link to="/bills" className="block hover:bg-gray-700 rounded p-2">Bills</Link>
      <Link to="/customers" className="block hover:bg-gray-700 rounded p-2">Customers</Link>
      <Link to="/reports" className="block hover:bg-gray-700 rounded p-2">Reports</Link>
    </div>
  )
}

--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\components\products
--------------------------------------------------------------------
Contents:
BulkUploadModal.jsx
ProductForm.jsx
ProductList.jsx

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\products\BulkUploadModal.jsx
--------------------------------------------------------------------
import React, { useState } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { bulkUploadProducts } from '../../services/productService';
import { useTranslation } from 'react-i18next';

// --- Icons ---
const CloseIcon = () => (
  <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
  </svg>
);
const UploadIcon = () => (
  <svg className="w-12 h-12 text-gray-400 dark:text-gray-500 mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
  </svg>
);
// --- End Icons ---

const backdropVariants = {
  hidden: { opacity: 0 },
  visible: { opacity: 1 },
};
const modalVariants = {
  hidden: { opacity: 0, y: 50, scale: 0.9 },
  visible: {
    opacity: 1,
    y: 0,
    scale: 1,
    transition: { type: 'spring', stiffness: 300, damping: 30, bounce: 0.2 }
  },
  exit: {
    opacity: 0,
    scale: 0.9,
    transition: { duration: 0.2 }
  },
};

export default function BulkUploadModal({ isOpen, onClose }) {
  const { t } = useTranslation();
  const [file, setFile] = useState(null);
  const [loading, setLoading] = useState(false);
  const [result, setResult] = useState(null);
  const [error, setError] = useState(null);

  const handleFileChange = (e) => {
    setFile(e.target.files[0]);
    setResult(null);
    setError(null);
  };

  const handleDownloadTemplate = () => {
    const headers = "productId,name,category,price,quantity,minQuantity,reorderLevel,expiryDate(yyyy-MM-dd)";
    const example = "P1001,Milk,Dairy,50,100,10,20,2026-12-31";
    const csvContent = "data:text/csv;charset=utf-8," + headers + "\n" + example;

    const link = document.createElement("a");
    link.setAttribute("href", encodeURI(csvContent));
    link.setAttribute("download", "product_template.csv");
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
  };

  const handleSubmit = async () => {
    if (!file) {
      setError(t('products.bulkErrorFile'));
      return;
    }
    setLoading(true);
    setError(null);
    setResult(null);

    try {
      const res = await bulkUploadProducts(file);
      setResult(res);
    } catch (err) {
      console.error(err);
      setError(err.response?.data?.error || t('products.bulkErrorUpload'));
    } finally {
      setLoading(false);
    }
  };

  const handleClose = () => {
    setFile(null);
    setResult(null);
    setError(null);
    onClose(result); // Pass result back to refresh list if successful
  };

  return (
    <AnimatePresence>
      {isOpen && (
        <motion.div
          variants={backdropVariants}
          initial="hidden"
          animate="visible"
          exit="hidden"
          className="fixed inset-0 bg-black/70 backdrop-blur-sm z-40 flex items-center justify-center p-4"
          onClick={handleClose}
        >
          <motion.div
            variants={modalVariants}
            initial="hidden"
            animate="visible"
            exit="exit"
            className="card max-w-lg w-full"
            onClick={(e) => e.stopPropagation()}
          >
            {/* Modal Header */}
            <div className="flex justify-between items-center p-6 border-b border-gray-200 dark:border-gray-800">
              <h2 className="text-2xl font-bold text-gray-900 dark:text-white font-display">
                {t('products.bulkTitle')}
              </h2>
              <button onClick={handleClose} className="text-gray-500 hover:text-gray-900 dark:hover:text-white transition-colors">
                <CloseIcon />
              </button>
            </div>

            {/* Modal Body */}
            <div className="p-6">
              {error && (
                <div className="bg-red-100 dark:bg-red-900/50 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-100 px-4 py-3 rounded-lg mb-4">
                  {error}
                </div>
              )}

              {result ? (
                // --- Success/Result Screen ---
                <div>
                  <h3 className="text-xl font-semibold text-gray-900 dark:text-white mb-3">{t('products.bulkSuccess')}</h3>
                  <div className="space-y-2">
                    <p className="text-green-600 dark:text-green-400">✅ {result.successful || 0} {t('products.bulkAdded')}</p>
                    <p className="text-yellow-600 dark:text-yellow-400">⚠️ {result.skipped || 0} {t('products.bulkSkipped')}</p>
                    <p className="text-red-600 dark:text-red-400">❌ {result.errors || 0} {t('products.bulkFailed')}</p>
                    {result.errorDetails?.length > 0 && (
                      <pre className="bg-gray-100 dark:bg-gray-800 p-3 rounded-lg text-xs h-32 overflow-y-auto custom-scrollbar text-gray-700 dark:text-gray-300">
                        {result.errorDetails.join('\n')}
                      </pre>
                    )}
                  </div>
                </div>
              ) : (
                // --- Upload Screen ---
                <div className="space-y-4">
                  <p className="text-gray-600 dark:text-gray-400">
                    {t('products.bulkStep1')}
                  </p>
                  <button onClick={handleDownloadTemplate} className="button-secondary w-full">
                    {t('products.bulkTemplate')}
                  </button>
                  <p className="text-gray-600 dark:text-gray-400">
                    {t('products.bulkStep2')}
                  </p>
                  <div className="flex items-center justify-center w-full">
                    <label className="flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 dark:border-gray-700 border-dashed rounded-lg cursor-pointer bg-gray-100/50 dark:bg-gray-800/50 hover:bg-gray-100 dark:hover:bg-gray-800">
                      <div className="flex flex-col items-center justify-center pt-5 pb-6">
                        <UploadIcon />
                        <p className="mb-2 text-sm text-gray-500 dark:text-gray-400">
                          <span className="font-semibold">{file ? file.name : t('products.bulkClick')}</span>
                        </p>
                        <p className="text-xs text-gray-500">{t('products.bulkFile')}</p>
                      </div>
                      <input type="file" className="hidden" accept=".csv" onChange={handleFileChange} />
                    </label>
                  </div>
                </div>
              )}
            </div>

            {/* Modal Footer */}
            <div className="flex justify-end items-center p-6 border-t border-gray-200 dark:border-gray-800 bg-gray-50 dark:bg-gray-900/50 rounded-b-2xl">
              <button onClick={handleClose} className="button-secondary mr-3">
                {result ? t('products.bulkClose') : t('products.bulkCancel')}
              </button>
              {!result && (
                <button
                  onClick={handleSubmit}
                  className="button-primary"
                  disabled={loading || !file}
                >
                  {loading ? t('products.bulkUploading') : t('products.bulkUploadProcess')}
                </button>
              )}
            </div>
          </motion.div>
        </motion.div>
      )}
    </AnimatePresence>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\products\ProductForm.jsx
--------------------------------------------------------------------
import React, { useEffect, useState } from 'react';
import {
  createProductJson,
  createProductMultipart,
  updateProduct,
  updateProductMultipart
} from '../../services/productService';
import { motion, AnimatePresence } from 'framer-motion';
import { useToast } from '../../context/ToastContext';
import { useTranslation } from 'react-i18next';

// --- Reusable Icons ---
const CloseIcon = () => (
  <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
  </svg>
);
const UploadIcon = () => (
  <svg className="w-8 h-8 text-gray-400 dark:text-gray-500 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
  </svg>
);

const backdropVariants = {
  hidden: { opacity: 0 },
  visible: { opacity: 1 },
};

const modalVariants = {
  hidden: { opacity: 0, y: 50, scale: 0.9 },
  visible: {
    opacity: 1,
    y: 0,
    scale: 1,
    transition: { type: 'spring', stiffness: 300, damping: 30, bounce: 0.2 }
  },
  exit: {
    opacity: 0,
    scale: 0.9,
    transition: { duration: 0.2 }
  },
};

const API_BASE = import.meta.env.VITE_API_BASE || 'http://localhost:8080';

export default function ProductForm({ isOpen, onClose, productToEdit }) {
  const { t } = useTranslation();
  const { showToast } = useToast();
  const [product, setProduct] = useState({
    productId: '',
    name: '',
    category: '',
    price: 0,
    quantity: 0,
    reorderLevel: 10,
  });
  const [imageFile, setImageFile] = useState(null);
  const [imagePreview, setImagePreview] = useState(null);
  const [error, setError] = useState(null);
  const [loading, setLoading] = useState(false);

  const isEdit = Boolean(productToEdit);

  useEffect(() => {
    if (isOpen) { // Only run logic when modal opens
      if (isEdit) {
        setLoading(true);
        setProduct({
          productId: productToEdit.productId || '',
          name: productToEdit.name || '',
          category: productToEdit.category || '',
          price: productToEdit.price || 0,
          quantity: productToEdit.quantity || 0,
          reorderLevel: productToEdit.reorderLevel || 10,
        });
        if (productToEdit.imageUrl) {
          setImagePreview(`${API_BASE}${productToEdit.imageUrl}`);
        } else {
          setImagePreview(null);
        }
        setImageFile(null);
        setError(null);
        setLoading(false);
      } else {
        // Reset form for "Add" mode
        setProduct({
          productId: '', name: '', category: '', price: 0, quantity: 0, reorderLevel: 10,
        });
        setImageFile(null);
        setImagePreview(null);
        setError(null);
        setLoading(false);
      }
    }
  }, [productToEdit, isEdit, isOpen]); // Rerun when modal opens

  const handleImageChange = (e) => {
    const file = e.target.files[0];
    if (file) {
      setImageFile(file);
      setImagePreview(URL.createObjectURL(file));
    }
  };

  const handleChange = (e) => {
    const { name, value } = e.target;
    setProduct(prev => ({
      ...prev,
      [name]: value,
    }));
  };

  async function handleSubmit(e) {
    e.preventDefault();
    setLoading(true);
    setError(null);

    const productData = {
      productId: product.productId,
      name: product.name,
      category: product.category,
      price: Number(product.price),
      quantity: Number(product.quantity),
      reorderLevel: Number(product.reorderLevel),
    };

    try {
      if (isEdit) {
        if (imageFile) {
          await updateProductMultipart(productToEdit.productId, productData, imageFile);
        } else {
          await updateProduct(productToEdit.productId, productData);
        }
        showToast(t('products.toastUpdateSuccess'), 'success');
      } else {
        if (imageFile) {
          await createProductMultipart(productData, imageFile);
        } else {
          await createProductJson(productData);
        }
        showToast(t('products.toastCreateSuccess'), 'success');
      }
      onClose(true); // Close modal and tell list to refresh
    } catch (err) {
      console.error(err);
      const errMsg = err.response?.data?.error || err.message || t('products.toastError');
      setError(errMsg);
      showToast(errMsg, 'error');
    } finally {
      setLoading(false);
    }
  }

  return (
    <AnimatePresence>
      {isOpen && (
        <motion.div
          variants={backdropVariants}
          initial="hidden"
          animate="visible"
          exit="hidden"
          className="fixed inset-0 bg-black/70 backdrop-blur-sm z-40 flex items-center justify-center p-4"
          onClick={() => !loading && onClose(false)} // Prevent close while loading
        >
          <motion.div
            variants={modalVariants}
            initial="hidden"
            animate="visible"
            exit="exit"
            className="card max-w-2xl w-full max-h-[90vh] flex flex-col"
            onClick={(e) => e.stopPropagation()}
          >
            {/* --- Modal Header --- */}
            <div className="flex justify-between items-center p-6 border-b border-gray-200 dark:border-gray-800 flex-shrink-0">
              <h2 className="text-2xl font-bold text-gray-900 dark:text-white font-display">
                {isEdit ? t('products.formTitleEdit') : t('products.formTitleAdd')}
              </h2>
              <button
                onClick={() => onClose(false)}
                className="text-gray-500 hover:text-gray-900 dark:hover:text-white transition-colors"
                disabled={loading}
              >
                <CloseIcon />
              </button>
            </div>

            {/* --- Modal Body --- */}
            <form onSubmit={handleSubmit} className="p-6 overflow-y-auto custom-scrollbar">
              {error && (
                <div className="bg-red-100 dark:bg-red-900/50 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-100 px-4 py-3 rounded-lg mb-4" role="alert">
                  <span className="font-medium">{t('products.error')}:</span> {error}
                </div>
              )}

              <div className="grid grid-cols-1 md:grid-cols-3 gap-6">

                {/* --- Image Uploader --- */}
                <div className="md:col-span-1">
                  <label className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-2">
                    {t('products.formImage')}
                  </label>
                  <div className="aspect-w-1 aspect-h-1">
                    <div className="w-full h-full border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-lg flex items-center justify-center text-center relative">
                      {imagePreview ? (
                        <img src={imagePreview} alt="Preview" className="w-full h-full object-cover rounded-lg" />
                      ) : (
                        <div className="flex flex-col items-center">
                          <UploadIcon />
                          <span className="text-sm text-gray-500">{t('products.formImageDrop')}</span>
                        </div>
                      )}
                      <input
                        type="file"
                        accept="image/png, image/jpeg, image/webp"
                        onChange={handleImageChange}
                        className="absolute inset-0 w-full h-full opacity-0 cursor-pointer"
                        title={isEdit ? t('products.formImageReplace') : t('products.formImageUpload')}
                        disabled={loading}
                      />
                    </div>
                  </div>
                </div>

                {/* --- Form Fields --- */}
                <div className="md:col-span-2 grid grid-cols-1 sm:grid-cols-2 gap-4">
                  <div className="sm:col-span-2">
                    <label htmlFor="productId" className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1.5">
                      {t('products.formId')}
                    </label>
                    <input
                      id="productId"
                      name="productId"
                      type="text"
                      value={product.productId}
                      onChange={handleChange}
                      placeholder={t('products.formIdPlaceholder')}
                      className="form-input"
                      required
                      disabled={isEdit || loading}
                    />
                  </div>

                  <div className="sm:col-span-2">
                    <label htmlFor="name" className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1.5">
                      {t('products.formName')}
                    </label>
                    <input
                      id="name"
                      name="name"
                      type="text"
                      value={product.name}
                      onChange={handleChange}
                      placeholder={t('products.formNamePlaceholder')}
                      className="form-input"
                      required
                      disabled={loading}
                    />
                  </div>

                  <div>
                    <label htmlFor="category" className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1.5">
                      {t('products.formCategory')}
                    </label>
                    <input
                      id="category"
                      name="category"
                      type="text"
                      value={product.category}
                      onChange={handleChange}
                      placeholder={t('products.formCategoryPlaceholder')}
                      className="form-input"
                      disabled={loading}
                    />
                  </div>

                  <div>
                    <label htmlFor="price" className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1.5">
                      {t('products.formPrice')}
                    </label>
                    <input
                      id="price"
                      name="price"
                      type="number"
                      min="0"
                      step="0.01"
                      value={product.price}
                      onChange={handleChange}
                      placeholder={t('products.formPricePlaceholder')}
                      className="form-input"
                      required
                      disabled={loading}
                    />
                  </div>

                  <div>
                    <label htmlFor="quantity" className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1.5">
                      {t('products.formQuantity')}
                    </label>
                    <input
                      id="quantity"
                      name="quantity"
                      type="number"
                      min="0"
                      step="1"
                      value={product.quantity}
                      onChange={handleChange}
                      placeholder={t('products.formQuantityPlaceholder')}
                      className="form-input"
                      required
                      disabled={loading}
                    />
                  </div>

                  <div>
                    <label htmlFor="reorderLevel" className="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1.5">
                      {t('products.formReorder')}
                    </label>
                    <input
                      id="reorderLevel"
                      name="reorderLevel"
                      type="number"
                      min="0"
                      step="1"
                      value={product.reorderLevel}
                      onChange={handleChange}
                      placeholder={t('products.formReorderPlaceholder')}
                      className="form-input"
                      required
                      disabled={loading}
                    />
                  </div>
                </div>
              </div>
            </form>

            {/* --- Modal Footer --- */}
            <div className="flex justify-end items-center p-6 border-t border-gray-200 dark:border-gray-800 flex-shrink-0 bg-gray-50 dark:bg-gray-900/50 rounded-b-2xl">
              <button
                type="button"
                onClick={() => onClose(false)}
                className="button-secondary mr-3"
                disabled={loading}
              >
                {t('products.formCancel')}
              </button>
              <button
                type="submit"
                onClick={handleSubmit} // Trigger form submit
                className="button-primary"
                disabled={loading}
              >
                {loading
                  ? (isEdit ? t('products.formUpdating') : t('products.formSaving'))
                  : (isEdit ? t('products.formSave') : t('products.formCreate'))}
              </button>
            </div>
          </motion.div>
        </motion.div>
      )}
    </AnimatePresence>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\products\ProductList.jsx
--------------------------------------------------------------------
import React, { useEffect, useState, useMemo } from 'react';
import { listProducts, deleteProduct } from '../../services/productService';
import ProductForm from './ProductForm';
import BulkUploadModal from './BulkUploadModal';
import Fuse from 'fuse.js';
import { motion, AnimatePresence } from 'framer-motion';
import { useToast } from '../../context/ToastContext';
import authService from '../../services/authService';
import { useCart } from '../../context/CartContext';
import { useTranslation } from 'react-i18next';

// --- Reusable Icons ---
const SearchIcon = () => (
  <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
  </svg>
);
const AddIcon = () => (
  <svg className="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
  </svg>
);
const EditIcon = () => (
  <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.536L16.732 3.732z" />
  </svg>
);
const DeleteIcon = () => (
  <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
  </svg>
);
const PlaceholderIcon = () => (
  <svg className="w-16 h-16 text-gray-300 dark:text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1} d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
  </svg>
);
const SortIcon = () => (
  <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 4h13M3 8h9M3 12h9m-9 4h13m-3-4v8m0 0l-4-4m4 4l4-4" />
  </svg>
);
const AlertIcon = () => (
  <svg className="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
  </svg>
);
// --- End Icons ---

const API_BASE = import.meta.env.VITE_API_BASE || 'http://localhost:8080';

// --- Product Card Component ---
const ProductCard = ({ product, onEdit, onDelete, canManage }) => {
  const { t } = useTranslation();
  const [imgError, setImgError] = useState(false);
  const { addToCart, cartItems } = useCart();
  const { showToast } = useToast();
  const [quantity, setQuantity] = useState(1);
  const imageUrl = product.imageUrl ? `${API_BASE}${product.imageUrl}` : null;

  const itemInCart = cartItems.find(item => item.productId === product.productId);
  const remainingStock = product.quantity - (itemInCart?.quantity || 0);
  const isLowStock = product.quantity < product.reorderLevel;

  const handleAddToCart = () => {
    const qtyToAdd = Number(quantity);
    if (qtyToAdd > remainingStock) {
      showToast(t('productCard.errorStock', { count: remainingStock }), 'error');
      return;
    }
    if (qtyToAdd > 0) {
      addToCart(product, qtyToAdd);
      showToast(t('productCard.successAdd', { count: qtyToAdd, name: product.name }), 'success');
      setQuantity(1);
    }
  };

  return (
    <motion.div
      layout
      initial={{ opacity: 0, scale: 0.9 }}
      animate={{ opacity: 1, scale: 1 }}
      exit={{ opacity: 0, scale: 0.9 }}
      transition={{ duration: 0.3, ease: 'easeOut' }}
      className="card relative flex flex-col group overflow-hidden"
    >
      {/* Badges */}
      {isLowStock && (
        <div className="absolute top-4 right-4 z-10 bg-red-600/90 text-white text-xs font-bold px-3 py-1 rounded-full shadow-lg">
          {t('productCard.lowStock')}
        </div>
      )}
      {remainingStock <= 0 && product.quantity > 0 && (
        <div className="absolute top-12 right-4 z-10 bg-yellow-600/90 text-white text-xs font-bold px-3 py-1 rounded-full shadow-lg">
          {t('productCard.inCart')}
        </div>
      )}

      {/* Management Buttons */}
      {canManage && (
        <div className="absolute top-4 left-4 z-10 flex gap-2">
          <button
            onClick={onEdit}
            className="p-2 bg-gray-900/50 text-white rounded-full
                       opacity-0 group-hover:opacity-100 transition-all duration-300
                       hover:bg-blue-600 hover:scale-110"
            title={t('productCard.edit')}
          >
            <EditIcon />
          </button>
          <button
            onClick={onDelete}
            className="p-2 bg-gray-900/50 text-white rounded-full
                       opacity-0 group-hover:opacity-100 transition-all duration-300
                       hover:bg-red-600 hover:scale-110"
            title={t('productCard.delete')}
          >
            <DeleteIcon />
          </button>
        </div>
      )}

      {/* Image */}
      <div className="aspect-w-1 aspect-h-1 w-full bg-gray-100 dark:bg-gray-800 rounded-t-2xl overflow-hidden">
        {imageUrl && !imgError ? (
          <img
            src={imageUrl}
            alt={product.name}
            className="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
            onError={() => setImgError(true)}
          />
        ) : (
          <div className="w-full h-full flex items-center justify-center bg-gray-100 dark:bg-gray-800">
            <PlaceholderIcon />
          </div>
        )}
      </div>

      {/* Details */}
      <div className="p-5 flex-grow flex flex-col">
        <h3 className="text-lg font-bold text-gray-900 dark:text-white truncate" title={product.name}>
          {product.name || t('productCard.unnamed')}
        </h3>
        <p className="text-sm text-gray-500 dark:text-gray-400 font-medium mb-3">
          {product.category || t('productCard.uncategorized')}
        </p>

        <div className="mt-auto flex justify-between items-end">
          <div className="text-left">
            <p className="text-xs text-gray-500 font-medium">{t('productCard.price')}</p>
            <p className="text-xl font-bold text-cyan-600 dark:text-cyan-400">
              {product.price?.toLocaleString('en-IN', { style: 'currency', currency: 'INR' }) || '₹0.00'}
            </p>
          </div>
          <div className="text-right">
            <p className="text-xs text-gray-500 font-medium">{t('productCard.inStock')}</p>
            <p className={`text-xl font-bold ${remainingStock <= 0 ? 'text-red-500' : isLowStock ? 'text-yellow-500 dark:text-yellow-400' : 'text-gray-900 dark:text-white'}`}>
              {remainingStock}
            </p>
          </div>
        </div>

        {/* Add to Cart Section */}
        <div className="mt-4 pt-4 border-t border-gray-200 dark:border-gray-700 flex gap-3">
          <input
            type="number"
            value={quantity}
            onChange={(e) => setQuantity(Math.max(1, parseInt(e.target.value) || 1))}
            min="1"
            max={remainingStock}
            className="form-input w-20 text-center !pl-2"
            disabled={remainingStock <= 0}
          />
          <button
            onClick={handleAddToCart}
            disabled={remainingStock <= 0}
            className="button-primary flex-grow disabled:bg-gray-400 dark:disabled:bg-gray-600"
          >
            {remainingStock <= 0 ? t('productCard.outOfStock') : t('productCard.addToCart')}
          </button>
        </div>
      </div>
    </motion.div>
  );
};

// --- Skeleton Card for Loading ---
const SkeletonCard = () => (
  <div className="card relative flex flex-col overflow-hidden animate-pulse">
    <div className="aspect-w-1 aspect-h-1 w-full bg-gray-200 dark:bg-gray-800 rounded-t-2xl"></div>
    <div className="p-5 flex-grow flex flex-col">
      <div className="h-6 bg-gray-300 dark:bg-gray-700 rounded w-3/4 mb-2"></div>
      <div className="h-4 bg-gray-300 dark:bg-gray-700 rounded w-1/2 mb-4"></div>
      <div className="mt-auto flex justify-between items-end">
        <div className="w-1/3">
          <div className="h-3 bg-gray-300 dark:bg-gray-700 rounded w-full mb-1.5"></div>
          <div className="h-5 bg-gray-300 dark:bg-gray-700 rounded w-full"></div>
        </div>
        <div className="w-1/4">
          <div className="h-3 bg-gray-300 dark:bg-gray-700 rounded w-full mb-1.5"></div>
          <div className="h-5 bg-gray-300 dark:bg-gray-700 rounded w-full"></div>
        </div>
      </div>
      <div className="mt-4 pt-4 border-t border-gray-200 dark:border-gray-700 flex gap-3">
        <div className="h-10 bg-gray-300 dark:bg-gray-700 rounded w-20"></div>
        <div className="h-10 bg-gray-300 dark:bg-gray-700 rounded flex-grow"></div>
      </div>
    </div>
  </div>
);

// --- Main Product List Component ---
export default function ProductList() {
  const [products, setProducts] = useState([]);
  const [searchTerm, setSearchTerm] = useState('');
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);
  const [showLowStockOnly, setShowLowStockOnly] = useState(false);
  const [sortBy, setSortBy] = useState('default');
  const [isFormModalOpen, setIsFormModalOpen] = useState(false);
  const [isBulkModalOpen, setIsBulkModalOpen] = useState(false);
  const [productToEdit, setProductToEdit] = useState(null);

  const { t } = useTranslation();
  const { showToast } = useToast();
  const user = authService.getUserFromToken();
  const canManage = user?.role === 'OWNER' || user?.role === 'MANAGER';

  const fuse = useMemo(() => new Fuse(products, {
    keys: ['name', 'category', 'productId'],
    threshold: 0.4,
  }), [products]);

  const displayProducts = useMemo(() => {
    const searchedItems = searchTerm
      ? fuse.search(searchTerm).map(result => result.item)
      : [...products];
    const filteredItems = showLowStockOnly
      ? searchedItems.filter(p => p.quantity < p.reorderLevel)
      : searchedItems;
    const sortedItems = [...filteredItems];
    switch (sortBy) {
      case 'name-asc':
        sortedItems.sort((a, b) => (a.name || '').localeCompare(b.name || ''));
        break;
      case 'name-desc':
        sortedItems.sort((a, b) => (b.name || '').localeCompare(a.name || ''));
        break;
      case 'price-asc':
        sortedItems.sort((a, b) => (a.price || 0) - (b.price || 0));
        break;
      case 'price-desc':
        sortedItems.sort((a, b) => (b.price || 0) - (a.price || 0));
        break;
      case 'qty-asc':
        sortedItems.sort((a, b) => (a.quantity || 0) - (b.quantity || 0));
        break;
      case 'qty-desc':
        sortedItems.sort((a, b) => (b.quantity || 0) - (a.quantity || 0));
        break;
      default:
        break;
    }
    return sortedItems;
  }, [products, searchTerm, showLowStockOnly, sortBy, fuse]);

  useEffect(() => {
    loadProducts();
  }, []);

  async function loadProducts() {
    try {
      setLoading(true);
      setError(null);
      const data = await listProducts();
      if (Array.isArray(data)) {
        setProducts(data);
      } else {
        console.error("Invalid products response:", data);
        setProducts([]);
        setError(t('products.errorLoad'));
      }
    } catch (err) {
      console.error("Failed to load products:", err);
      setError(t('products.error'));
    } finally {
      setLoading(false);
    }
  }

  const handleOpenAddModal = () => {
    setProductToEdit(null);
    setIsFormModalOpen(true);
  };
  const handleOpenEditModal = (product) => {
    setProductToEdit(product);
    setIsFormModalOpen(true);
  };
  const handleCloseFormModal = (shouldRefresh = false) => {
    setIsFormModalOpen(false);
    setProductToEdit(null);
    if (shouldRefresh) loadProducts();
  };
  const handleCloseBulkModal = (result) => {
    setIsBulkModalOpen(false);
    if (result && result.successful > 0) loadProducts();
  };

  const handleDeleteProduct = async (product) => {
    if (!product.productId) {
      showToast(t('productCard.errorDeleteMissingId'), 'error');
      return;
    }
    if (!window.confirm(t('productCard.confirmDelete', { name: product.name }))) {
      return;
    }
    try {
      await deleteProduct(product.productId);
      showToast(t('products.deleteSuccess'), 'success');
      loadProducts();
    } catch (err) {
      const errMsg = err.response?.data?.error || err.message;
      showToast(t('products.deleteError', { error: errMsg }), 'error');
    }
  };

  return (
    <div>
      <div className="flex justify-between items-center mb-4">
        <h2 className="text-3xl font-bold text-gray-900 dark:text-white font-display">
          {t('products.title')}
          <span className="text-lg font-normal text-gray-500 dark:text-gray-400 ml-3">
            ({displayProducts.length} {t('products.items')})
          </span>
        </h2>
      </div>

      <div className="card mb-6 p-4 flex flex-col md:flex-row gap-4 items-center">
        <div className="relative flex-grow w-full md:w-auto">
          <div className="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
            <SearchIcon />
          </div>
          <input
            type="text"
            value={searchTerm}
            onChange={(e) => setSearchTerm(e.target.value)}
            placeholder={t('products.searchPlaceholder')}
            className="form-input w-full"
          />
        </div>

        <div className="relative flex-shrink-0 w-full md:w-48">
          <div className="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
            <SortIcon />
          </div>
          <select
            value={sortBy}
            onChange={(e) => setSortBy(e.target.value)}
            className="form-input appearance-none w-full"
          >
            <option value="default">{t('products.sortDefault')}</option>
            <option value="name-asc">{t('products.sortNameAsc')}</option>
            <option value="name-desc">{t('products.sortNameDesc')}</option>
            <option value="price-asc">{t('products.sortPriceAsc')}</option>
            <option value="price-desc">{t('products.sortPriceDesc')}</option>
            <option value="qty-asc">{t('products.sortQtyAsc')}</option>
            <option value="qty-desc">{t('products.sortQtyDesc')}</option>
          </select>
        </div>

        <button
          onClick={() => setShowLowStockOnly(prev => !prev)}
          className={`button-secondary flex-shrink-0 w-full md:w-auto flex items-center justify-center
                      ${showLowStockOnly
                        ? 'bg-yellow-400 text-yellow-900 hover:bg-yellow-500 dark:bg-yellow-600 dark:text-white dark:hover:bg-yellow-700'
                        : 'button-secondary'}`}
        >
          <AlertIcon />
          {showLowStockOnly ? t('products.showingLowStock') : t('products.showLowStock')}
        </button>

        {canManage && (
          <>
            <button onClick={() => setIsBulkModalOpen(true)} className="button-secondary flex-shrink-0 w-full md:w-auto">
              {t('products.bulkUpload')}
            </button>
            <button onClick={handleOpenAddModal} className="button-primary flex-shrink-0 w-full md:w-auto">
              <AddIcon />
              {t('products.addProduct')}
            </button>
          </>
        )}
      </div>

      {loading ? (
        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
          {[...Array(8)].map((_, i) => <SkeletonCard key={i} />)}
        </div>
      ) : error ? (
        <div className="card text-center p-10">
          <p className="text-red-500 dark:text-red-400 font-semibold">{error}</p>
          <button onClick={loadProducts} className="button-primary mt-4">
            {t('products.tryAgain')}
          </button>
        </div>
      ) : displayProducts.length === 0 ? (
        <div className="card text-center p-10">
          <p className="text-gray-600 dark:text-gray-400 font-semibold">
            {searchTerm ? t('products.noMatch') : (showLowStockOnly ? t('products.noLowStock') : t('products.noProducts'))}
          </p>
          <button onClick={() => { setSearchTerm(''); setShowLowStockOnly(false); }} className="button-secondary mt-4">
            {t('products.clearFilters')}
          </button>
        </div>
      ) : (
        <motion.div
          layout
          className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"
        >
          <AnimatePresence>
            {displayProducts.map((p) => {
              const key = p.productId;
              if (!key) {
                 console.warn("Found product without a productId:", p);
                 return null;
              }
              return (
                <ProductCard
                  key={key}
                  product={p}
                  onEdit={() => handleOpenEditModal(p)}
                  onDelete={() => handleDeleteProduct(p)}
                  canManage={canManage}
                />
              );
            })}
          </AnimatePresence>
        </motion.div>
      )}

      {/* --- Modals --- */}
      <ProductForm
        isOpen={isFormModalOpen}
        onClose={handleCloseFormModal}
        productToEdit={productToEdit}
      />
      <BulkUploadModal
        isOpen={isBulkModalOpen}
        onClose={handleCloseBulkModal}
      />
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\components\profile
--------------------------------------------------------------------
Contents:
ProfilePage.jsx

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\profile\ProfilePage.jsx
--------------------------------------------------------------------
import React from "react";
import authService from "../../services/authService";
import { useTranslation } from 'react-i18next'; // <-- NEW IMPORT

export default function ProfilePage() {
  const { t } = useTranslation(); // <-- NEW
  const user = authService.getUserFromToken();

  if (!user) {
    return (
      <div className="card max-w-md mx-auto p-6 text-center">
        {/* MODIFIED */}
        <p className="text-red-400">{t('profile.notLoggedIn')}</p>
      </div>
    );
  }

  return (
    <div className="card max-w-md mx-auto p-8">
      <h2 className="text-3xl font-bold text-white font-display mb-6 text-center">
        {/* MODIFIED */}
        {t('profile.title')}
      </h2>

      <div className="space-y-4">
        <div className="p-4 bg-gray-800/50 rounded-lg">
          {/* MODIFIED */}
          <label className="block text-sm font-medium text-gray-400">{t('profile.email')}</label>
          <p className="text-lg text-white">{user.email}</p>
        </div>
        <div className="p-4 bg-gray-800/50 rounded-lg">
          {/* MODIFIED */}
          <label className="block text-sm font-medium text-gray-400">{t('profile.role')}</label>
          <p className="text-lg text-cyan-400 font-bold">{user.role || "N/A"}</p>
        </div>
      </div>

      <p className="mt-6 text-gray-500 text-xs text-center">
        {/* MODIFIED */}
        {t('profile.tokenIssued')}: {new Date(user.iat * 1000).toLocaleString()}
        <br />
        {t('profile.tokenExpires')}: {new Date(user.exp * 1000).toLocaleString()}
      </p>
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\components\reports
--------------------------------------------------------------------
Contents:
summary
text

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\components\reports\summary
--------------------------------------------------------------------
Contents:
ReportGenerator.jsx
ReportPreview.jsx

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\reports\summary\ReportGenerator.jsx
--------------------------------------------------------------------
import React, { useState } from "react";
import { getFullReportData, downloadFullReportPdf } from "../../../services/reportService";
import DatePicker from "react-datepicker";
import "react-datepicker/dist/react-datepicker.css";
import { motion, AnimatePresence } from 'framer-motion';
import { useTranslation } from 'react-i18next';

import ReportPreview from './ReportPreview';
import { CalendarIcon } from '../../analytics/icons';

// Icons
const DownloadIcon = () => (
  <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
  </svg>
);
const ClearIcon = () => (
  <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
  </svg>
);
const ReportIcon = () => (
  <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 17v-6h6v6m-6-4h.01M12 3v4m0 0h8m-8 0H4" />
  </svg>
);
const LoadingSpinner = () => (
  <div className="w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin" />
);

// UPDATED: Removed hard-coded dark classes
const CustomDateInput = React.forwardRef(({ value, onClick, placeholder }, ref) => (
  <button
    type="button"
    ref={ref}
    onClick={onClick}
    className="form-input w-full !pl-10 !py-3 rounded-xl cursor-pointer text-left"
  >
    <span className={value ? 'text-gray-800 dark:text-white' : 'text-gray-500'}>
      {value || placeholder}
    </span>
  </button>
));

export default function ReportGenerator() {
  const { t } = useTranslation();
  const [reportData, setReportData] = useState(null);
  const [loading, setLoading] = useState(false);
  const [isDownloading, setIsDownloading] = useState(false);
  const [error, setError] = useState(null);
  const [startDate, setStartDate] = useState(new Date(new Date().setDate(new Date().getDate() - 30)));
  const [endDate, setEndDate] = useState(new Date());

  // Format helpers
  const formatAPI = (d) => d?.toISOString().split('T')[0] || '';
  const formatDateHuman = (d) => {
    if (!d) return t('reports.selectRange');
    return d.toLocaleDateString('en-CA', { year: 'numeric', month: 'short', day: 'numeric' });
  };

  const handleGenerateReport = async () => {
    if (!startDate || !endDate) {
      setError(t('reports.errorDate'));
      return;
    }
    if (startDate > endDate) {
      setError(t('reports.errorStartDate'));
      return;
    }
    setLoading(true);
    setError(null);
    setReportData(null);
    try {
      const params = {
        startDate: formatAPI(startDate),
        endDate: formatAPI(endDate),
      };
      const res = await getFullReportData(params);
      setReportData(res);
    } catch (err) {
      console.error("Error fetching report:", err);
      setError(err.message || "Failed to load report. Please try again.");
    } finally {
      setLoading(false);
    }
  };

  const handleDownloadPdf = async () => {
    if (!reportData) return;
    setIsDownloading(true);
    setError(null);
    try {
      const params = {
        startDate: formatAPI(startDate),
        endDate: formatAPI(endDate),
      };
      const blob = await downloadFullReportPdf(params);
      const url = window.URL.createObjectURL(new Blob([blob], { type: 'application/pdf' }));
      const link = document.createElement('a');
      link.href = url;
      const filename = `SmartRetail_Report_${params.startDate}_to_${params.endDate}.pdf`;
      link.setAttribute('download', filename);
      document.body.appendChild(link);
      link.click();
      link.parentNode.removeChild(link);
      window.URL.revokeObjectURL(url);
    } catch (err) {
      console.error("Error downloading PDF:", err);
      setError(err.message || "Failed to download PDF. Please try again.");
    } finally {
      setIsDownloading(false);
    }
  };

  const handleClearReport = () => {
    setReportData(null);
    setError(null);
  };

  const humanDateRange = {
    start: formatDateHuman(startDate),
    end: formatDateHuman(endDate)
  };

  return (
    // UPDATED: Removed hard-coded background
    <div className="min-h-[calc(100vh-100px)]">
      <div className="max-w-7xl mx-auto"> {/* Removed padding, letting MainLayout handle it */}
        {/* Header */}
        <motion.div
          initial={{ opacity: 0, y: -20 }}
          animate={{ opacity: 1, y: 0 }}
          className="text-center mb-12"
        >
          <h1 className="text-4xl font-bold text-gray-900 dark:text-white mb-4 bg-gradient-to-r from-cyan-500 to-blue-500 bg-clip-text text-transparent">
            {t('reports.title')}
          </h1>
          <p className="text-gray-600 dark:text-gray-400 text-lg max-w-2xl mx-auto">
            {t('reports.subtitle')}
          </p>
        </motion.div>

        {/* Controls */}
        <motion.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 0.1 }}
          className="card p-6 mb-8" // UPDATED: Just "card"
        >
          <div className="flex flex-col lg:flex-row gap-6 items-start lg:items-center">
            {/* Date Picker */}
            <div className="flex-1 w-full">
              <label className="block text-sm font-medium text-gray-600 dark:text-gray-300 mb-3">{t('reports.dateRange')}</label>
              <div className="relative">
                <div className="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none z-10">
                  <CalendarIcon />
                </div>
                <DatePicker
                  selectsRange
                  startDate={startDate}
                  endDate={endDate}
                  onChange={([start, end]) => {
                    setStartDate(start);
                    setEndDate(end);
                    setError(null);
                  }}
                  customInput={<CustomDateInput placeholder={t('reports.selectRange')} />}
                  popperClassName="react-datepicker-dark z-50" // This class is in index.css
                  popperPlacement="bottom-start"
                  dateFormat="MMM d, yyyy"
                  showPopperArrow={false}
                  wrapperClassName="w-full"
                  disabled={loading || !!reportData}
                />
              </div>
              {startDate && endDate && (
                <p className="text-xs text-cyan-600 dark:text-cyan-400 mt-2">
                  {humanDateRange.start} to {humanDateRange.end}
                </p>
              )}
            </div>

            {/* Buttons */}
            <div className="flex flex-col sm:flex-row gap-4 w-full lg:w-auto">
              <AnimatePresence mode="wait">
                {!reportData ? (
                  <motion.button
                    key="generate"
                    initial={{ opacity: 0, scale: 0.9 }}
                    animate={{ opacity: 1, scale: 1 }}
                    exit={{ opacity: 0, scale: 0.9 }}
                    onClick={handleGenerateReport}
                    disabled={loading}
                    className="button-primary w-full sm:w-48 h-12 flex items-center justify-center gap-3 font-semibold"
                  >
                    {loading ? <LoadingSpinner /> : <ReportIcon />}
                    {loading ? t('reports.generating') : t('reports.generate')}
                  </motion.button>
                ) : (
                  <motion.div
                    key="actions"
                    initial={{ opacity: 0, scale: 0.9 }}
                    animate={{ opacity: 1, scale: 1 }}
                    exit={{ opacity: 0, scale: 0.9 }}
                    className="flex flex-col sm:flex-row gap-4 w-full sm:w-auto"
                  >
                    <button
                      onClick={handleDownloadPdf}
                      disabled={isDownloading}
                      className="button-primary h-12 px-6 flex items-center justify-center gap-3 font-semibold bg-gradient-to-r from-emerald-500 to-green-600 hover:from-emerald-600 hover:to-green-700"
                    >
                      {isDownloading ? <LoadingSpinner /> : <DownloadIcon />}
                      {isDownloading ? t('reports.downloading') : t('reports.download')}
                    </button>
                    <button
                      onClick={handleClearReport}
                      disabled={isDownloading}
                      className="button-secondary h-12 px-6 flex items-center justify-center gap-3 font-semibold"
                    >
                      <ClearIcon />
                      {t('reports.newReport')}
                    </button>
                  </motion.div>
                )}
              </AnimatePresence>
            </div>
          </div>

          {/* Error */}
          {error && (
            <motion.div
              initial={{ opacity: 0, height: 0 }}
              animate={{ opacity: 1, height: 'auto' }}
              className="mt-4 p-4 bg-red-100 dark:bg-red-500/10 border border-red-300 dark:border-red-500/20 rounded-lg"
            >
              <div className="flex items-center gap-3 text-red-600 dark:text-red-400">
                <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <span className="font-medium">{error}</span>
              </div>
            </motion.div>
          )}
        </motion.div>

        {/* Content Area */}
        <AnimatePresence mode="wait">
          {loading && (
            <motion.div
              key="loading"
              initial={{ opacity: 0, scale: 0.95 }}
              animate={{ opacity: 1, scale: 1 }}
              exit={{ opacity: 0, scale: 0.95 }}
              className="card p-12 text-center"
            >
              <div className="flex flex-col items-center space-y-4">
                <div className="w-16 h-16 border-4 border-cyan-500/30 border-t-cyan-400 rounded-full animate-spin" />
                <div>
                  <h3 className="text-xl font-semibold text-gray-900 dark:text-white mb-2">{t('reports.loading')}</h3>
                  <p className="text-gray-600 dark:text-gray-400">{t('reports.loadingSub')}</p>
                </div>
              </div>
            </motion.div>
          )}

          {reportData && (
            <motion.div
              key="report"
              initial={{ opacity: 0, y: 20 }}
              animate={{ opacity: 1, y: 0 }}
              exit={{ opacity: 0, y: -20 }}
            >
              {/* This component is INTENTIONALLY light-themed for PDF look */}
              <ReportPreview
                reportData={reportData}
                startDate={humanDateRange.start}
                endDate={humanDateRange.end}
              />
            </motion.div>
          )}

          {!loading && !reportData && !error && (
            <motion.div
              key="placeholder"
              initial={{ opacity: 0, y: 20 }}
              animate={{ opacity: 1, y: 0 }}
              className="text-center py-20"
            >
              <div className="max-w-md mx-auto">
                <div className="w-24 h-24 mx-auto mb-6 bg-gray-200 dark:bg-gradient-to-br dark:from-cyan-500/10 dark:to-blue-500/10 rounded-2xl flex items-center justify-center">
                  {/* UPDATED: Icon color */}
                  <ReportIcon className="w-10 h-10 text-gray-500 dark:text-cyan-400" />
                </div>
                <h3 className="text-2xl font-bold text-gray-900 dark:text-white mb-3">{t('reports.placeholderTitle')}</h3>
                <p className="text-gray-600 dark:text-gray-400 text-lg mb-8">
                  {t('reports.placeholderSub')}
                </p>
                <div className="grid grid-cols-1 md:grid-cols-3 gap-6 text-sm text-gray-500 dark:text-gray-500">
                  <div className="text-center">
                    <div className="w-8 h-8 bg-gray-200 dark:bg-cyan-500/10 rounded-lg flex items-center justify-center mx-auto mb-2">
                      <span className="text-cyan-500 dark:text-cyan-400 font-medium">Chart</span>
                    </div>
                    <p>{t('reports.placeholder1')}</p>
                  </div>
                  <div className="text-center">
                    <div className="w-8 h-8 bg-gray-200 dark:bg-blue-500/10 rounded-lg flex items-center justify-center mx-auto mb-2">
                      <span className="text-blue-500 dark:text-blue-400 font-medium">AI</span>
                    </div>
                    <p>{t('reports.placeholder2')}</p>
                  </div>
                  <div className="text-center">
                    <div className="w-8 h-8 bg-gray-200 dark:bg-emerald-500/10 rounded-lg flex items-center justify-center mx-auto mb-2">
                      <span className="text-emerald-500 dark:text-emerald-400 font-medium">PDF</span>
                    </div>
                    <p>{t('reports.placeholder3')}</p>
                  </div>
                </div>
              </div>
            </motion.div>
          )}
        </AnimatePresence>
      </div>
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\reports\summary\ReportPreview.jsx
--------------------------------------------------------------------
import React from 'react';
import { motion } from 'framer-motion';
import { useTranslation } from 'react-i18next'; // <-- Import

// --- Formatting Helpers ---
const formatCurrency = (amount) => {
  if (amount === null || amount === undefined) return 'N/A';
  return (amount).toLocaleString('en-IN', {
    style: 'currency',
    currency: 'INR',
    maximumFractionDigits: 0,
  });
};

const formatNumber = (num) => {
  if (num === null || num === undefined) return 'N/A';
  return (num).toLocaleString('en-IN');
};

// --- Sub-Components for the Report ---
const MetricBox = ({ title, value, className = 'text-blue-600' }) => (
  <div className="bg-gray-50 p-4 rounded-lg shadow-inner">
    <p className="text-sm font-semibold text-gray-500 uppercase tracking-wider">{title}</p>
    <p className={`text-3xl font-bold ${className}`}>{value}</p>
  </div>
);

const ReportTable = ({ headers, data, title }) => (
  <section className="space-y-3">
    <h3 className="text-xl font-bold text-gray-800 border-b border-gray-300 pb-2">{title}</h3>
    <div className="overflow-x-auto border border-gray-200 rounded-lg">
      <table className="min-w-full divide-y divide-gray-200">
        <thead className="bg-gray-100">
          <tr>
            {headers.map(header => (
              <th key={header} className="px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase tracking-wider">
                {header}
              </th>
            ))}
          </tr>
        </thead>
        <tbody className="bg-white divide-y divide-gray-200">
          {data.length === 0 ? (
            <tr>
              <td colSpan={headers.length} className="px-6 py-4 text-center text-gray-500">
                No data available for this section.
              </td>
            </tr>
          ) : (
            data.map((row, rowIndex) => (
              <tr key={rowIndex} className="hover:bg-gray-50">
                {headers.map((header, colIndex) => (
                  <td key={colIndex} className="px-6 py-4 whitespace-nowrap text-sm text-gray-700">
                    {row[header]}
                  </td>
                ))}
              </tr>
            ))
          )}
        </tbody>
      </table>
    </div>
  </section>
);

// --- Main Report Preview Component ---
export default function ReportPreview({ reportData, startDate, endDate }) {
  const { t } = useTranslation(); // <-- Get hook
  if (!reportData) return null;

  const { salesReport, textSummary, inventoryReport } = reportData;
  const { summary } = salesReport || {};

  // Format data for tables
  const topProductsData = (salesReport?.top_products || []).map(p => ({
    "Product Name": p.name,
    "Category": p.category || 'N/A',
    "Units Sold": formatNumber(p.qty),
    "Total Revenue": formatCurrency(p.revenue),
  }));

  // No change to lowStockData, it's not rendered

  return (
    <motion.div
      initial={{ opacity: 0, y: 20 }}
      animate={{ opacity: 1, y: 0 }}
      exit={{ opacity: 0 }}
      transition={{ duration: 0.5 }}
      // This component STAYS light-themed
      className="bg-white text-gray-900 max-w-4xl mx-auto rounded-lg shadow-2xl p-10 md:p-16"
      id="report-preview-content"
    >
      <div className="space-y-12">
        {/* 1. Header */}
        <header className="text-center border-b border-gray-200 pb-6">
          <h1 className="text-4xl font-extrabold text-gray-900">{t('reports.title')}</h1>
          <p className="text-lg text-gray-600 mt-2">
            {startDate} to {endDate}
          </p>
        </header>

        {/* 2. AI Summary */}
        {textSummary?.report && (
          <section>
            <h2 className="text-2xl font-bold text-gray-800 mb-3">{t('reports.placeholder2')}</h2>
            <blockquote className="text-gray-700 text-lg leading-relaxed italic border-l-4 border-blue-500 pl-4">
              {textSummary.report}
            </blockquote>
          </section>
        )}

        {/* 3. Key Metrics */}
        <section>
          <h2 className="text-2xl font-bold text-gray-800 mb-4">Key Metrics</h2>
          <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
            <MetricBox
              title={t('dashboard.totalRevenue')}
              value={formatCurrency(summary?.total_revenue)}
              className="text-emerald-600"
            />
            <MetricBox
              title={t('dashboard.totalOrders')}
              value={formatNumber(summary?.total_orders)}
              className="text-blue-600"
            />
            <MetricBox
              title={t('dashboard.productsSold')}
              value={formatNumber(summary?.total_products_sold)}
              className="text-purple-600"
            />
          </div>
        </section>

        {/* 4. Inventory Alerts */}
        <section>
          <h2 className="text-2xl font-bold text-gray-800 mb-4">Inventory Alerts</h2>
          <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
            <MetricBox
              title={t('customerList.showingLowStock')}
              value={formatNumber(inventoryReport?.lowStockCount)}
              className="text-yellow-600"
            />
            <MetricBox
              title="Expiring Soon Items"
              value={formatNumber(inventoryReport?.expiringCount)}
              className="text-orange-600"
            />
          </div>
        </section>

        {/* 5. Top Products Table */}
        <ReportTable
          title={t('dashboard.topProducts')}
          headers={["Product Name", "Category", "Units Sold", "Total Revenue"]}
          data={topProductsData}
        />

        {/* 6. Low Stock Details Table (Removed as per your file) */}
      </div>
    </motion.div>
  );
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\components\reports\text
--------------------------------------------------------------------
Contents:
SalesReportText.jsx

====================================================================
📄 File: G:\FINALCODE\frontend\src\components\reports\text\SalesReportText.jsx
--------------------------------------------------------------------
import React, { useEffect, useState } from "react";
import api from "../../../api/apiClient";
import { useTranslation } from 'react-i18next'; // <-- Import

export default function SalesReportText() {
  const { t } = useTranslation(); // <-- Get hook
  const [textReport, setTextReport] = useState("");
  const [error, setError] = useState(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    async function fetchTextReport() {
      try {
        setLoading(true);
        const res = await api.get("/api/analytics/report/text");

        const reportData =
          typeof res.data === "object" && res.data.report
            ? res.data.report
            : res.data;

        setTextReport(reportData || "No report data available");
      } catch (err) {
        console.error("Error fetching text report:", err);
        setError("Failed to load text report. Is the analytics service running?");
      } finally {
        setLoading(false);
      }
    }
    fetchTextReport();
  }, []);

  if (loading) {
    return (
      <div className="card p-6 text-center text-gray-500 dark:text-gray-400">
        Loading text report...
      </div>
    );
  }

  if (error) {
    return <div className="card p-6 text-red-500 dark:text-red-400">{error}</div>;
  }

  return (
    // UPDATED: Theme-aware classes
    <div className="card">
      <h3 className="card-title p-6 pb-0">{t('reports.placeholder2')}</h3>
      <div className="p-6">
        <pre className="bg-gray-100 dark:bg-gray-900 p-4 rounded-lg text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap overflow-auto">
          {textReport}
        </pre>
      </div>
    </div>
  );
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\context
--------------------------------------------------------------------
Contents:
CartContext.jsx
ThemeContext.jsx
ToastContext.jsx

====================================================================
📄 File: G:\FINALCODE\frontend\src\context\CartContext.jsx
--------------------------------------------------------------------
import React, { createContext, useContext, useState, useEffect } from 'react';

const CartContext = createContext();

export const useCart = () => useContext(CartContext);

export const CartProvider = ({ children }) => {
  const [cartItems, setCartItems] = useState(() => {
    // Load cart from localStorage on initial render
    try {
      const localData = localStorage.getItem('sr_cart');
      return localData ? JSON.parse(localData) : [];
    } catch (error) {
      console.error("Failed to parse cart from localStorage", error);
      return [];
    }
  });

  // Save cart to localStorage whenever it changes
  useEffect(() => {
    localStorage.setItem('sr_cart', JSON.stringify(cartItems));
  }, [cartItems]);

  const addToCart = (product, quantity) => {
    setCartItems(prevItems => {
      const existingItem = prevItems.find(item => item.productId === product.productId);

      if (existingItem) {
        // Update quantity
        return prevItems.map(item =>
          item.productId === product.productId
            ? { ...item, quantity: item.quantity + quantity }
            : item
        );
      } else {
        // Add new item
        return [...prevItems, { ...product, quantity }];
      }
    });
  };

  const updateQuantity = (productId, newQuantity) => {
    const qty = Math.max(0, newQuantity); // Ensure quantity is not negative
    setCartItems(prevItems =>
      prevItems
        .map(item =>
          item.productId === productId ? { ...item, quantity: qty } : item
        )
        .filter(item => item.quantity > 0) // Remove item if quantity is 0
    );
  };

  const removeFromCart = (productId) => {
    setCartItems(prevItems => prevItems.filter(item => item.productId !== productId));
  };

  const clearCart = () => {
    setCartItems([]);
  };

  const cartCount = cartItems.reduce((count, item) => count + item.quantity, 0);
  const cartTotal = cartItems.reduce((total, item) => total + item.price * item.quantity, 0);

  const value = {
    cartItems,
    addToCart,
    updateQuantity,
    removeFromCart,
    clearCart,
    cartCount,
    cartTotal,
  };

  return <CartContext.Provider value={value}>{children}</CartContext.Provider>;
};
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\context\ThemeContext.jsx
--------------------------------------------------------------------
import React, { createContext, useContext, useState, useEffect } from 'react';

const ThemeContext = createContext();

export const useTheme = () => useContext(ThemeContext);

export const ThemeProvider = ({ children }) => {
  const [theme, setTheme] = useState(() => {
    // 1. Get from localStorage
    const savedTheme = localStorage.getItem('theme');
    // 2. Or use system preference
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    // 3. Default to 'dark' as your site is already dark
    return savedTheme || (prefersDark ? 'dark' : 'light');
  });

  useEffect(() => {
    const root = window.document.documentElement;

    // Apply class to <html> tag
    root.classList.remove(theme === 'dark' ? 'light' : 'dark');
    root.classList.add(theme);

    // Save choice to localStorage
    localStorage.setItem('theme', theme);
  }, [theme]);

  const toggleTheme = () => {
    setTheme(prevTheme => (prevTheme === 'light' ? 'dark' : 'light'));
  };

  const value = {
    theme,
    toggleTheme,
  };

  return <ThemeContext.Provider value={value}>{children}</ThemeContext.Provider>;
};
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\context\ToastContext.jsx
--------------------------------------------------------------------
import React, { createContext, useContext, useState, useCallback } from 'react';
import { AnimatePresence, motion } from 'framer-motion';

const ToastContext = createContext(null);

export const useToast = () => useContext(ToastContext);

// Icon components for toasts
const SuccessIcon = () => (
  <svg className="w-6 h-6 text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
  </svg>
);
const ErrorIcon = () => (
  <svg className="w-6 h-6 text-red-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" />
  </svg>
);

export const ToastProvider = ({ children }) => {
  const [toasts, setToasts] = useState([]);

  const addToast = useCallback((message, type = 'success') => {
    const id = Date.now();
    setToasts(prev => [...prev, { id, message, type }]);

    // Auto-dismiss after 3 seconds
    setTimeout(() => {
      setToasts(prev => prev.filter(t => t.id !== id));
    }, 3000);
  }, []);

  const value = {
    showToast: addToast,
  };

  return (
    <ToastContext.Provider value={value}>
      {children}

      {/* Toast Container */}
      <div className="fixed top-5 right-5 z-[9999] space-y-3">
        <AnimatePresence>
          {toasts.map(toast => (
            <motion.div
              key={toast.id}
              layout
              initial={{ opacity: 0, y: -20, scale: 0.9 }}
              animate={{ opacity: 1, y: 0, scale: 1 }}
              exit={{ opacity: 0, x: 50, scale: 0.9 }}
              transition={{ type: 'spring', stiffness: 300, damping: 25 }}
              className="max-w-sm w-full bg-gray-800/90 backdrop-blur-lg border border-gray-700 shadow-xl rounded-lg pointer-events-auto flex p-4"
            >
              <div className="flex-shrink-0">
                {toast.type === 'success' ? <SuccessIcon /> : <ErrorIcon />}
              </div>
              <div className="ml-3 flex-1">
                <p className="text-sm font-semibold text-white">{toast.message}</p>
              </div>
            </motion.div>
          ))}
        </AnimatePresence>
      </div>
    </ToastContext.Provider>
  );
};
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\i18n.js
--------------------------------------------------------------------
import i18n from 'i18next';
import { initReactI18next } from 'react-i18next';
import translationEN from './locales/en/translation.json';
import translationHI from './locales/hi/translation.json';
import translationMR from './locales/mr/translation.json';
import translationTE from './locales/te/translation.json';

// Get language from the same place our Navbar sets it
const savedLang = localStorage.getItem('sr_lang') || 'en';

const resources = {
  en: { translation: translationEN },
  hi: { translation: translationHI },
  mr: { translation: translationMR },
  te: { translation: translationTE },
};

i18n
  .use(initReactI18next)
  .init({
    resources,
    lng: savedLang, // Use the saved language
    fallbackLng: 'en',
    interpolation: {
      escapeValue: false, // React already safes from XSS
    },
  });

export default i18n;
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\index.css
--------------------------------------------------------------------
@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  /* --- 1. Light Mode Default --- */
  body {
    @apply font-sans text-gray-900 bg-gray-100; /* Light BG, Dark Text */
    min-height: 100vh;
  }

  /* --- 2. Dark Mode Styles --- */
  .dark body {
    @apply text-gray-200; /* Dark BG, Light Text */
    background-color: #000;
    background-image: radial-gradient(circle at 20% 20%, theme(colors.gray.950), theme(colors.black));
  }

  /* --- 3. Table Styles (Theme-Aware) --- */
  .table {
    @apply w-full min-w-[640px];
  }
  .table th {
    @apply p-4 text-left text-xs font-medium uppercase tracking-wider;
    @apply text-gray-500 bg-gray-50; /* Light */
    @apply dark:text-gray-400 dark:bg-gray-800/50; /* Dark */
  }
  .table td {
    @apply p-4 whitespace-nowrap text-sm;
    @apply text-gray-800 border-b border-gray-200; /* Light */
    @apply dark:text-gray-200 dark:border-gray-800; /* Dark */
  }
  .table tbody tr:last-child td {
    @apply border-b-0;
  }
  .table tbody tr {
    @apply transition-colors;
  }
  .table tbody tr:hover {
    @apply bg-gray-100/50; /* Light */
    @apply dark:bg-gray-800/60; /* Dark */
  }

  /* --- 4. NavLink Styles (Theme-Aware) --- */
  .nav-link {
    @apply px-3 py-2 rounded-md text-sm font-medium;
    @apply text-gray-600 hover:bg-gray-200 hover:text-gray-900; /* Light */
    @apply dark:text-gray-300 dark:hover:bg-gray-700 dark:hover:text-white; /* Dark */
    @apply transition-colors;
  }
  .nav-link.active {
    @apply bg-gray-200 text-gray-900; /* Light */
    @apply dark:bg-gray-900 dark:text-white; /* Dark */
  }
}

/* --- 5. Card Styles (Theme-Aware) --- */
.card {
  @apply bg-white border border-gray-200 rounded-2xl shadow-lg; /* Light */
  @apply dark:bg-gray-900/70 dark:backdrop-blur-xl dark:border-gray-800 dark:shadow-[0_4px_20px_rgba(0,0,0,0.3)]; /* Dark */
  @apply transition-all duration-300 ease-out;
}

.card:hover {
  transform: translateY(-4px);
  @apply shadow-xl; /* Light */
  @apply dark:shadow-[0_8px_25px_rgba(0,255,200,0.1)] dark:border-gray-700/80; /* Dark */
}

.card-title {
  @apply font-display text-xl font-semibold tracking-wide mb-4;
  @apply text-gray-900; /* Light */
  @apply dark:text-white; /* Dark */
}

/* --- 6. Button Styles (Remain the same, they are context-agnostic) --- */
.button-primary {
  @apply bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold
         hover:bg-blue-700 focus:outline-none focus:ring-2
         focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-100 dark:focus:ring-offset-gray-900
         transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed;
}
.button-secondary {
  @apply bg-gray-200 text-gray-800 px-3 py-2 rounded-lg font-medium
         hover:bg-gray-300 focus:outline-none focus:ring-2
         focus:ring-gray-500 focus:ring-offset-2 focus:ring-offset-gray-100
         dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600 dark:focus:ring-offset-gray-900
         transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed;
}

/* --- 7. Form Input Styles (Theme-Aware) --- */
/* RENAMED from .form-input-dark */
.form-input {
  @apply w-full p-3 pl-11 bg-gray-100 border border-gray-300 rounded-lg placeholder-gray-500; /* Light */
  @apply dark:bg-gray-800 dark:border-gray-700 dark:text-gray-200 dark:placeholder-gray-500; /* Dark */
  @apply focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent;
  @apply transition-all duration-300;
  @apply disabled:bg-gray-200 disabled:text-gray-500 disabled:cursor-not-allowed; /* Light Disabled */
  @apply dark:disabled:bg-gray-900 dark:disabled:text-gray-500; /* Dark Disabled */
}

/* Input without icon */
.form-input-no-icon {
  @apply w-full p-3 bg-gray-100 border border-gray-300 rounded-lg placeholder-gray-500; /* Light */
  @apply dark:bg-gray-800 dark:border-gray-700 dark:text-gray-200 dark:placeholder-gray-500; /* Dark */
  @apply focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent;
  @apply transition-all duration-300;
}

/* Auth page social button */
.social-button {
  @apply w-full flex items-center justify-center gap-3 px-4 py-2.5 border rounded-lg;
  @apply text-gray-700 bg-white hover:bg-gray-50 border-gray-300; /* Light */
  @apply dark:text-gray-300 dark:bg-gray-800 dark:hover:bg-gray-700 dark:border-gray-700; /* Dark */
  @apply transition-all duration-300;
  @apply focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-100 dark:focus:ring-offset-gray-900;
}

/* --- 8. Misc Styles (Theme-Aware) --- */
.progress-bar-container {
  @apply w-full rounded-full h-2 overflow-hidden;
  @apply bg-gray-200; /* Light */
  @apply dark:bg-gray-700/50; /* Dark */
}
.progress-bar {
  @apply h-2 rounded-full bg-gradient-to-r from-blue-500 via-cyan-400 to-green-400;
}

.custom-scrollbar::-webkit-scrollbar { @apply w-1.5; }
.custom-scrollbar::-webkit-scrollbar-track { @apply bg-transparent; }
.custom-scrollbar::-webkit-scrollbar-thumb { @apply bg-gray-400 dark:bg-gray-600 rounded-full; }
.custom-scrollbar::-webkit-scrollbar-thumb:hover { @apply bg-gray-500 dark:bg-gray-500; }

.shadow-glow {
  @apply dark:shadow-[0_0_15px_rgba(34,197,94,0.4)];
}

/* Dropdown text color */
select option {
  @apply bg-white text-black; /* Light */
  @apply dark:bg-gray-900 dark:text-white; /* Dark */
}

/* --- 9. Datepicker (Theme-Aware) --- */
.react-datepicker-wrapper { @apply w-full; }
.react-datepicker-popper { @apply z-50; }

/* Main calendar container */
.react-datepicker {
  @apply font-sans text-sm shadow-lg;
  @apply bg-white border-gray-200 border rounded-lg; /* Light */
  @apply dark:bg-gray-900 dark:border-gray-700 dark:shadow-[0_20px_40px_rgba(0,0,0,0.4)]; /* Dark */
}
.react-datepicker__triangle { @apply hidden; }

/* Header */
.react-datepicker__header {
  @apply border-b-0 rounded-t-lg pt-3;
  @apply bg-gray-50; /* Light */
  @apply dark:bg-gray-800/50 dark:border-gray-700; /* Dark */
}
.react-datepicker__current-month,
.react-datepicker__day-name {
  @apply font-semibold;
  @apply text-gray-900; /* Light */
  @apply dark:text-gray-200; /* Dark */
}
.react-datepicker__day-name {
  @apply text-gray-500; /* Light */
  @apply dark:text-gray-400; /* Dark */
}

/* Day cells */
.react-datepicker__day {
  @apply rounded-full;
  @apply text-gray-800; /* Light */
  @apply dark:text-gray-300; /* Dark */
}
.react-datepicker__day:hover {
  @apply rounded-full;
  @apply bg-gray-200; /* Light */
  @apply dark:bg-gray-700; /* Dark */
}
.react-datepicker__day--selected,
.react-datepicker__day--in-range {
  @apply bg-blue-600 text-white rounded-full font-semibold;
  @apply dark:bg-cyan-500 dark:text-black; /* Dark */
}
.react-datepicker__day--keyboard-selected {
  @apply bg-blue-700 rounded-full;
  @apply dark:bg-cyan-600; /* Dark */
}
.react-datepicker__day--disabled {
  @apply text-gray-400; /* Light */
  @apply dark:text-gray-600; /* Dark */
}

/* Navigation */
.react-datepicker__navigation-icon::before {
  @apply border-gray-600; /* Light */
  @apply dark:border-gray-300; /* Dark */
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\locales
--------------------------------------------------------------------
Contents:
en
hi
mr
te

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\locales\en
--------------------------------------------------------------------
Contents:
translation.json

====================================================================
📄 File: G:\FINALCODE\frontend\src\locales\en\translation.json
--------------------------------------------------------------------
{
  "nav": {
    "dashboard": "Dashboard",
    "products": "Products",
    "bills": "Bills",
    "customers": "Customers",
    "reports": "Reports",
    "logout": "Logout",
    "login": "Login",
    "viewCart": "View Cart",
    "selectLang": "Select language"
  },
  "lang": {
    "en": "EN",
    "hi": "HI",
    "mr": "MR",
    "te": "TE"
  },
  "auth": {
    "signIn": "Sign in",
    "signInWelcome": "Welcome back! Please enter your details.",
    "loginFailed": "Login Failed:",
    "emailAddress": "Email Address",
    "emailPlaceholder": "you@example.com",
    "password": "Password",
    "forgotPassword": "Forgot password?",
    "or": "or",
    "continueWithGoogle": "Continue with Google",
    "noAccount": "Don’t have an account?",
    "signUpHere": "Sign up here",
    "signUp": "Create an Account",
    "signUpWelcome": "Get started by filling out the form below.",
    "signupFailed": "Signup Failed:",
    "fullName": "Full Name",
    "namePlaceholder": "John Doe",
    "role": "Role",
    "roleCashier": "Cashier",
    "roleManager": "Manager",
    "roleOwner": "Owner",
    "createAccount": "Create Account",
    "haveAccount": "Already have an account?",
    "signInHere": "Sign in here",
    "brandPanelTitle": "Smart Retail",
    "brandPanelLogin": "Manage your inventory, billing, and analytics all in one place.",
    "brandPanelSignup": "Join our platform and take control of your business."
  },
  "dashboard": {
    "title": "Analytics Dashboard",
    "subtitle": "Real-time business insights at a glance",
    "datePlaceholder": "Select date range",
    "totalRevenue": "Total Revenue",
    "totalOrders": "Total Orders",
    "productsSold": "Products Sold",
    "up": "Up",
    "down": "Down",
    "salesByCategory": "Sales by Category",
    "percentOfTotal": "% of total",
    "topProducts": "Top Products",
    "loading": "Loading Dashboard...",
    "error": "Failed to load analytics. Please try again.",
    "revenue": "Revenue",
    "total": "Total"
  },
  "products": {
    "title": "Product Inventory",
    "items": "items",
    "searchPlaceholder": "Search by name, category, or ID...",
    "sortDefault": "Sort by: Default",
    "sortNameAsc": "Name (A-Z)",
    "sortNameDesc": "Name (Z-A)",
    "sortPriceAsc": "Price (Low-High)",
    "sortPriceDesc": "Price (High-Low)",
    "sortQtyAsc": "Quantity (Low-High)",
    "sortQtyDesc": "Quantity (High-Low)",
    "showLowStock": "Show Low Stock Only",
    "showingLowStock": "Showing Low Stock",
    "bulkUpload": "Bulk Upload",
    "addProduct": "Add Product",
    "loading": "Loading Products...",
    "error": "Failed to load products. Please try again.",
    "tryAgain": "Try Again",
    "noMatch": "No products match your search.",
    "noLowStock": "No low stock items found.",
    "noProducts": "No products found.",
    "clearFilters": "Clear Filters",
    "lowStock": "Low Stock",
    "inCart": "In Cart",
    "edit": "Edit Product",
    "delete": "Delete Product",
    "price": "Price",
    "inStock": "In Stock",
    "addToCart": "Add to Cart",
    "outOfStock": "Out of Stock",
    "formTitleAdd": "Add New Product",
    "formTitleEdit": "Edit Product",
    "formImage": "Product Image",
    "formImageDrop": "Drop image or click",
    "formImageReplace": "Upload new image to replace",
    "formImageUpload": "Upload product image",
    "formId": "Product ID (SKU)",
    "formIdPlaceholder": "e.g., LAP-APP-M1",
    "formName": "Product Name",
    "formNamePlaceholder": "e.g., Macbook Pro 14",
    "formCategory": "Category",
    "formCategoryPlaceholder": "e.g., Electronics",
    "formPrice": "Price (₹)",
    "formPricePlaceholder": "e.g., 150000",
    "formQuantity": "Quantity",
    "formQuantityPlaceholder": "e.g., 25",
    "formReorder": "Re-order Level",
    "formReorderPlaceholder": "e.g., 10",
    "formCancel": "Cancel",
    "formSaving": "Saving...",
    "formUpdating": "Updating...",
    "formSave": "Save Changes",
    "formCreate": "Create Product",
    "bulkTitle": "Bulk Product Upload",
    "bulkStep1": "1. Download the CSV template to ensure your data is in the correct format.",
    "bulkStep2": "2. Fill in your product data and upload the completed file here.",
    "bulkTemplate": "Download Template (.csv)",
    "bulkClick": "Click to upload",
    "bulkFile": "CSV file (max 10MB)",
    "bulkClose": "Close",
    "bulkCancel": "Cancel",
    "bulkUploading": "Uploading...",
    "bulkUploadProcess": "Upload & Process",
    "bulkSuccess": "Upload Complete",
    "bulkAdded": "products added successfully.",
    "bulkSkipped": "products skipped (already exist).",
    "bulkFailed": "products failed.",
    "toastUpdateSuccess": "Product updated successfully",
    "toastCreateSuccess": "Product created successfully",
    "toastError": "Operation failed",
    "bulkErrorFile": "Please select a .csv file to upload.",
    "bulkErrorUpload": "Upload failed. Please check file format."
  },
  "productCard": {
    "lowStock": "Low Stock",
    "inCart": "In Cart",
    "edit": "Edit Product",
    "delete": "Delete Product",
    "unnamed": "Unnamed Product",
    "uncategorized": "Uncategorized",
    "price": "Price",
    "inStock": "In Stock",
    "addToCart": "Add to Cart",
    "outOfStock": "Out of Stock",
    "errorStock": "Error: Only {{count}} available in stock (after cart).",
    "successAdd": "{{count}} x {{name}} added to cart!"
  },
  "customerList": {
    "title": "Customer Directory",
    "matching": "matching",
    "searchPlaceholder": "Search by name, email, or mobile...",
    "sort": "Sort by:",
    "sortNameAsc": "Name (A-Z)",
    "sortNameDesc": "Name (Z-A)",
    "sortDateDesc": "Last Purchase (Newest)",
    "sortDateAsc": "Last Purchase (Oldest)",
    "sortPurchaseDesc": "Purchases (High-Low)",
    "filter": "Show All",
    "filterInactive": "Inactive (30+ days)",
    "emailAll": "Email All",
    "emailAllConfirm": "Send email to all {{count}} customers?",
    "tryAgain": "Try Again",
    "noMatch": "No customers match your search.",
    "noFilterMatch": "No customers match your filter.",
    "noCustomers": "No customers found.",
    "clearFilters": "Clear Filters",
    "deleteConfirm": "Delete \"{{name}}\" and all their purchase history?",
    "deleteSuccess": "Customer deleted successfully",
    "deleteError": "Failed to delete customer."
  },
  "customerCard": {
    "unnamed": "Unnamed Customer",
    "totalPurchases": "Total Purchases",
    "lastPurchase": "Last Purchase",
    "sendEmail": "Send Email",
    "viewHistory": "View History",
    "delete": "Delete Customer",
    "deleteAria": "Delete customer {{name}}"
  },
  "customerForm": {
    "title": "Add Customer",
    "name": "Name",
    "email": "Email",
    "mobile": "Mobile",
    "save": "Save"
  },
  "customerEdit": {
    "title": "Edit Customer",
    "loading": "Loading...",
    "errorLoad": "Failed to load customer:",
    "success": "Customer updated successfully!",
    "errorUpdate": "Update failed:"
  },
  "billList": {
    "showing": "Showing bills",
    "previous": "Previous",
    "next": "Next",
    "matching": "matching bills",
    "title": "Bill History",
    "searchPlaceholder": "Search bills or customers...",
    "datePlaceholder": "Filter by date range",
    "sortNewest": "Newest First",
    "sortOldest": "Oldest First",
    "sortHigh": "Highest Amount",
    "sortLow": "Lowest Amount",
    "export": "Export to Excel",
    "exportSuccess": "Exported {{count}} bills",
    "exportError": "No data to export",
    "autoEmail": "Auto Email",
    "headerId": "Bill ID",
    "headerCustomer": "Customer",
    "headerTotal": "Total",
    "headerDate": "Date",
    "headerPayment": "Payment",
    "headerStatus": "Status",
    "headerActions": "Actions",
    "emptyState": "No bills match your filters.",
    "emptyStateHint": "Try adjusting filters or date range",
    "statusCompleted": "Completed",
    "paymentMethod": "CASH",
    "downloadPDF": "Download PDF",
    "resendEmail": "Resend Email",
    "downloading": "Downloading {{billId}}...",
    "downloadFailed": "Download failed",
    "resendSuccess": "Email resent!",
    "resendFailed": "Resend failed",
    "drawerTitle": "Bill Details",
    "drawerDate": "Date & Time",
    "drawerTotal": "Total Amount",
    "drawerCustomer": "Customer",
    "drawerItems": "Items ({{count}})",
    "walkIn": "Walk-in Customer",
    "noMobile": "No mobile number",
    "totalBills": "Total Bills",
    "totalRevenue": "Total Revenue",
    "generateBill": "Generate Bill"
  },
  "billForm": {
    "title": "Create New Bill",
    "customer": "Customer",
    "selectCustomer": "Select Customer",
    "items": "Items",
    "selectProduct": "Select Product",
    "addItem": "+ Add Item",
    "total": "Total:",
    "createBill": "Create Bill",
    "errorCustomer": "Please select a customer",
    "errorCreate": "Error creating bill",
    "success": "Bill created successfully!"
  },
  "checkout": {
    "title": "Review Your Cart",
    "empty": "Your cart is empty.",
    "summary": "Summary",
    "subtotal": "Subtotal",
    "taxes": "Taxes",
    "taxesValue": "Calculated at checkout",
    "total": "Total",
    "customerDetails": "Customer Details",
    "customerName": "Customer Name",
    "customerMobile": "Mobile Number (Required)",
    "customerEmail": "Email (for receipt)",
    "generateBill": "Generate Bill",
    "generatingBill": "Generating Bill...",
    "errorMobile": "Please enter a customer mobile number.",
    "errorEmptyCart": "Your cart is empty.",
    "billSuccess": "Bill {{billId}} created successfully!",
    "billError": "Failed to create bill: {{error}}"
  },
  "history": {
    "title": "Purchase History",
    "backToCustomers": "Back to Customers",
    "loading": "Loading customer history...",
    "error": "Failed to load customer history",
    "notFound": "Customer not found",
    "noHistory": "No purchase history found",
    "noHistoryHint": "This customer hasn't made any purchases yet",
    "headerBill": "Bill ID",
    "headerDate": "Date & Time",
    "headerTotal": "Total Amount",
    "headerActions": "Actions",
    "download": "Download PDF",
    "downloading": "Downloading bill {{billId}}...",
    "downloadSuccess": "PDF downloaded successfully",
    "downloadFailed": "Failed to download PDF",
    "totalPurchases": "Total Purchases",
    "purchaseSummary": "Purchase Summary",
    "totalBills": "Total Bills",
    "totalSpent": "Total Spent",
    "avgBill": "Average Bill"
  },
  "reports": {
    "title": "Executive Report Generator",
    "subtitle": "Generate comprehensive business intelligence reports with AI-powered insights and professional PDF exports.",
    "dateRange": "Date Range",
    "selectRange": "Select date range",
    "generate": "Generate Report",
    "generating": "Generating...",
    "download": "Export PDF",
    "downloading": "Downloading...",
    "newReport": "New Report",
    "errorDate": "Please select a valid date range.",
    "errorStartDate": "Start date cannot be after end date.",
    "loading": "Generating Report",
    "loadingSub": "Compiling data and generating insights...",
    "placeholderTitle": "Ready to Generate Reports",
    "placeholderSub": "Select your date range and click generate to create a comprehensive report.",
    "placeholder1": "Sales Analytics",
    "placeholder2": "AI Insights",
    "placeholder3": "PDF Export"
  },
  "reminder": {
    "title": "Monthly Purchase Reminders",
    "button": "Send Monthly Reminders",
    "sending": "Sending...",
    "success": "Reminders triggered successfully!",
    "error": "Failed to trigger reminders"
  },
  "profile": {
    "title": "My Profile",
    "notLoggedIn": "You are not logged in.",
    "email": "Email",
    "role": "Role",
    "tokenIssued": "Token issued",
    "tokenExpires": "Token expires"
  },
  "privateRoute": {
    "denied": "Access denied — insufficient permissions."
  },
  "errors": {
    "noToken": "No access token received from backend.",
    "noRefresh": "No refresh token found",
    "refreshFailed": "Token refresh failed"
  },
  "common": {
    "goBack": "Go Back",
    "downloading": "Downloading...",
    "previous": "Previous",
    "next": "Next"
  }
}

--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\locales\hi
--------------------------------------------------------------------
Contents:
translation.json

====================================================================
📄 File: G:\FINALCODE\frontend\src\locales\hi\translation.json
--------------------------------------------------------------------
{
  "nav": {
    "dashboard": "डैशबोर्ड",
    "products": "उत्पाद",
    "bills": "बिल",
    "customers": "ग्राहक",
    "reports": "रिपोर्ट्स",
    "logout": "लॉगआउट",
    "login": "लॉगिन",
    "viewCart": "कार्ट देखें",
    "selectLang": "भाषा चुनें"
  },
  "lang": {
    "en": "अंग्रेज़ी",
    "hi": "हिन्दी",
    "mr": "मराठी",
    "te": "तेलुगु"
  },
  "auth": {
    "signIn": "साइन इन",
    "signInWelcome": "वापस स्वागत है! कृपया अपनी जानकारी दर्ज करें।",
    "loginFailed": "लॉगिन विफल:",
    "emailAddress": "ईमेल पता",
    "emailPlaceholder": "you@example.com",
    "password": "पासवर्ड",
    "forgotPassword": "पासवर्ड भूल गए?",
    "or": "या",
    "continueWithGoogle": "Google के साथ जारी रखें",
    "noAccount": "खाता नहीं है?",
    "signUpHere": "यहां साइन अप करें",
    "signUp": "खाता बनाएं",
    "signUpWelcome": "नीचे दिए गए फॉर्म को भरकर शुरुआत करें।",
    "signupFailed": "साइनअप विफल:",
    "fullName": "पूरा नाम",
    "namePlaceholder": "जॉन डो",
    "role": "भूमिका",
    "roleCashier": "कैशियर",
    "roleManager": "मैनेजर",
    "roleOwner": "मालिक",
    "createAccount": "खाता बनाएं",
    "haveAccount": "पहले से खाता है?",
    "signInHere": "यहां साइन इन करें",
    "brandPanelTitle": "स्मार्ट रिटेल",
    "brandPanelLogin": "अपनी इन्वेंट्री, बिलिंग और एनालिटिक्स को एक ही स्थान पर प्रबंधित करें।",
    "brandPanelSignup": "हमारे प्लेटफॉर्म से जुड़ें और अपने व्यवसाय पर नियंत्रण रखें।"
  },
  "dashboard": {
    "title": "एनालिटिक्स डैशबोर्ड",
    "subtitle": "रीयल-टाइम व्यवसाय अंतर्दृष्टि एक नज़र में",
    "datePlaceholder": "तारीख सीमा चुनें",
    "totalRevenue": "कुल राजस्व",
    "totalOrders": "कुल ऑर्डर",
    "productsSold": "बिके उत्पाद",
    "up": "ऊपर",
    "down": "नीचे",
    "salesByCategory": "श्रेणी के अनुसार बिक्री",
    "percentOfTotal": "कुल का %",
    "topProducts": "शीर्ष उत्पाद",
    "loading": "डैशबोर्ड लोड हो रहा है...",
    "error": "एनालिटिक्स लोड करने में विफल। कृपया पुनः प्रयास करें।",
    "revenue": "राजस्व",
    "total": "कुल"
  },
  "products": {
    "title": "उत्पाद सूची",
    "items": "आइटम",
    "searchPlaceholder": "नाम, श्रेणी, या आईडी से खोजें...",
    "sortDefault": "क्रमबद्ध करें: डिफ़ॉल्ट",
    "sortNameAsc": "नाम (A-Z)",
    "sortNameDesc": "नाम (Z-A)",
    "sortPriceAsc": "कीमत (कम-ज्यादा)",
    "sortPriceDesc": "कीमत (ज्यादा-कम)",
    "sortQtyAsc": "मात्रा (कम-ज्यादा)",
    "sortQtyDesc": "मात्रा (ज्यादा-कम)",
    "showLowStock": "केवल कम स्टॉक दिखाएं",
    "showingLowStock": "कम स्टॉक दिखाया जा रहा है",
    "bulkUpload": "बल्क अपलोड",
    "addProduct": "उत्पाद जोड़ें",
    "loading": "उत्पाद लोड हो रहे हैं...",
    "error": "उत्पाद लोड करने में विफल। कृपया पुनः प्रयास करें।",
    "tryAgain": "पुनः प्रयास करें",
    "noMatch": "आपकी खोज से कोई उत्पाद मेल नहीं खाता।",
    "noLowStock": "कोई कम स्टॉक आइटम नहीं मिला।",
    "noProducts": "कोई उत्पाद नहीं मिला।",
    "clearFilters": "फ़िल्टर साफ करें",
    "lowStock": "कम स्टॉक",
    "inCart": "कार्ट में",
    "edit": "उत्पाद संपादित करें",
    "delete": "उत्पाद हटाएं",
    "price": "कीमत",
    "inStock": "स्टॉक में",
    "addToCart": "कार्ट में जोड़ें",
    "outOfStock": "स्टॉक खत्म",
    "formTitleAdd": "नया उत्पाद जोड़ें",
    "formTitleEdit": "उत्पाद संपादित करें",
    "formImage": "उत्पाद छवि",
    "formImageDrop": "छवि ड्रॉप करें या क्लिक करें",
    "formImageReplace": "प्रतिस्थापित करने के लिए नई छवि अपलोड करें",
    "formImageUpload": "उत्पाद छवि अपलोड करें",
    "formId": "उत्पाद आईडी (SKU)",
    "formIdPlaceholder": "जैसे, LAP-APP-M1",
    "formName": "उत्पाद नाम",
    "formNamePlaceholder": "जैसे, Macbook Pro 14",
    "formCategory": "श्रेणी",
    "formCategoryPlaceholder": "जैसे, इलेक्ट्रॉनिक्स",
    "formPrice": "कीमत (₹)",
    "formPricePlaceholder": "जैसे, 150000",
    "formQuantity": "मात्रा",
    "formQuantityPlaceholder": "जैसे, 25",
    "formReorder": "पुनः ऑर्डर स्तर",
    "formReorderPlaceholder": "जैसे, 10",
    "formCancel": "रद्द करें",
    "formSaving": "सहेजा जा रहा है...",
    "formUpdating": "अपडेट किया जा रहा है...",
    "formSave": "परिवर्तन सहेजें",
    "formCreate": "उत्पाद बनाएं",
    "bulkTitle": "बल्क उत्पाद अपलोड",
    "bulkStep1": "1. सुनिश्चित करने के लिए CSV टेम्पलेट डाउनलोड करें कि आपका डेटा सही प्रारूप में है।",
    "bulkStep2": "2. अपना उत्पाद डेटा भरें और पूर्ण फ़ाइल यहां अपलोड करें।",
    "bulkTemplate": "टेम्पलेट डाउनलोड करें (.csv)",
    "bulkClick": "अपलोड करने के लिए क्लिक करें",
    "bulkFile": "CSV फ़ाइल (अधिकतम 10MB)",
    "bulkClose": "बंद करें",
    "bulkCancel": "रद्द करें",
    "bulkUploading": "अपलोड हो रहा है...",
    "bulkUploadProcess": "अपलोड और प्रोसेस करें",
    "bulkSuccess": "अपलोड पूर्ण",
    "bulkAdded": "उत्पाद सफलतापूर्वक जोड़े गए।",
    "bulkSkipped": "उत्पाद छोड़े गए (पहले से मौजूद)।",
    "bulkFailed": "उत्पाद विफल।",
    "toastUpdateSuccess": "उत्पाद सफलतापूर्वक अपडेट किया गया",
    "toastCreateSuccess": "उत्पाद सफलतापूर्वक बनाया गया",
    "toastError": "ऑपरेशन विफल",
    "bulkErrorFile": "कृपया अपलोड करने के लिए .csv फ़ाइल चुनें।",
    "bulkErrorUpload": "अपलोड विफल। कृपया फ़ाइल प्रारूप जांचें।"
  },
  "productCard": {
    "lowStock": "कम स्टॉक",
    "inCart": "कार्ट में",
    "edit": "उत्पाद संपादित करें",
    "delete": "उत्पाद हटाएं",
    "unnamed": "बेनाम उत्पाद",
    "uncategorized": "अश्रेणीबद्ध",
    "price": "कीमत",
    "inStock": "स्टॉक में",
    "addToCart": "कार्ट में जोड़ें",
    "outOfStock": "स्टॉक खत्म",
    "errorStock": "त्रुटि: केवल {{count}} स्टॉक में उपलब्ध (कार्ट के बाद)।",
    "successAdd": "{{count}} x {{name}} कार्ट में जोड़ा गया!"
  },
  "customerList": {
    "title": "ग्राहक निर्देशिका",
    "matching": "मेल खाते",
    "searchPlaceholder": "नाम, ईमेल, या मोबाइल से खोजें...",
    "sort": "क्रमबद्ध करें:",
    "sortNameAsc": "नाम (A-Z)",
    "sortNameDesc": "नाम (Z-A)",
    "sortDateDesc": "अंतिम खरीद (नवीनतम)",
    "sortDateAsc": "अंतिम खरीद (पुराना)",
    "sortPurchaseDesc": "खरीदारी (ज्यादा-कम)",
    "filter": "सभी दिखाएं",
    "filterInactive": "निष्क्रिय (30+ दिन)",
    "emailAll": "सभी को ईमेल करें",
    "emailAllConfirm": "सभी {{count}} ग्राहकों को ईमेल भेजें?",
    "tryAgain": "पुनः प्रयास करें",
    "noMatch": "आपकी खोज से कोई ग्राहक मेल नहीं खाता।",
    "noFilterMatch": "आपके फ़िल्टर से कोई ग्राहक मेल नहीं खाता।",
    "noCustomers": "कोई ग्राहक नहीं मिला।",
    "clearFilters": "फ़िल्टर साफ करें",
    "deleteConfirm": "\"{{name}}\" और उनका सारा खरीदारी इतिहास हटाएं?",
    "deleteSuccess": "ग्राहक सफलतापूर्वक हटा दिया गया",
    "deleteError": "ग्राहक हटाने में विफल।"
  },
  "customerCard": {
    "unnamed": "बेनाम ग्राहक",
    "totalPurchases": "कुल खरीदारी",
    "lastPurchase": "अंतिम खरीदारी",
    "sendEmail": "ईमेल भेजें",
    "viewHistory": "इतिहास देखें",
    "delete": "ग्राहक हटाएं",
    "deleteAria": "ग्राहक {{name}} हटाएं"
  },
  "customerForm": {
    "title": "ग्राहक जोड़ें",
    "name": "नाम",
    "email": "ईमेल",
    "mobile": "मोबाइल",
    "save": "सहेजें"
  },
  "customerEdit": {
    "title": "ग्राहक संपादित करें",
    "loading": "लोड हो रहा है...",
    "errorLoad": "ग्राहक लोड करने में विफल:",
    "success": "ग्राहक सफलतापूर्वक अपडेट किया गया!",
    "errorUpdate": "अपडेट विफल:"
  },
  "billList": {
    "matching": "मेल खाते बिल",
    "showing": "बिल दिखाए जा रहे हैं",
    "previous": "पिछला",
    "next": "अगला",
    "title": "बिल इतिहास",
    "searchPlaceholder": "बिल या ग्राहक खोजें...",
    "datePlaceholder": "तारीख सीमा से फ़िल्टर करें",
    "sortNewest": "नवीनतम पहले",
    "sortOldest": "सबसे पुराना पहले",
    "sortHigh": "सबसे ज्यादा राशि",
    "sortLow": "सबसे कम राशि",
    "export": "एक्सेल में निर्यात करें",
    "exportSuccess": "{{count}} बिल निर्यात किए गए",
    "exportError": "निर्यात करने के लिए कोई डेटा नहीं",
    "autoEmail": "ऑटो ईमेल",
    "headerId": "बिल आईडी",
    "headerCustomer": "ग्राहक",
    "headerTotal": "कुल",
    "headerDate": "तारीख",
    "headerPayment": "भुगतान",
    "headerStatus": "स्थिति",
    "headerActions": "कार्रवाई",
    "emptyState": "आपके फ़िल्टर से कोई बिल मेल नहीं खाता।",
    "emptyStateHint": "फ़िल्टर या तारीख सीमा समायोजित करने का प्रयास करें",
    "statusCompleted": "पूर्ण",
    "paymentMethod": "नकद",
    "downloadPDF": "PDF डाउनलोड करें",
    "resendEmail": "ईमेल पुनः भेजें",
    "downloading": "{{billId}} डाउनलोड हो रहा है...",
    "downloadFailed": "डाउनलोड विफल",
    "resendSuccess": "ईमेल पुनः भेजा गया!",
    "resendFailed": "पुनः भेजने में विफल",
    "drawerTitle": "बिल विवरण",
    "drawerDate": "तारीख और समय",
    "drawerTotal": "कुल राशि",
    "drawerCustomer": "ग्राहक",
    "drawerItems": "आइटम ({{count}})",
    "walkIn": "वॉक-इन ग्राहक",
    "noMobile": "कोई मोबाइल नंबर नहीं",
    "totalBills": "कुल बिल",
    "totalRevenue": "कुल राजस्व",
    "generateBill": "बिल बनाएं"
  },
  "billForm": {
    "title": "नया बिल बनाएं",
    "customer": "ग्राहक",
    "selectCustomer": "ग्राहक चुनें",
    "items": "आइटम",
    "selectProduct": "उत्पाद चुनें",
    "addItem": "+ आइटम जोड़ें",
    "total": "कुल:",
    "createBill": "बिल बनाएं",
    "errorCustomer": "कृपया एक ग्राहक चुनें",
    "errorCreate": "बिल बनाने में त्रुटि",
    "success": "बिल सफलतापूर्वक बनाया गया!"
  },
  "checkout": {
    "title": "अपना कार्ट समीक्षा करें",
    "empty": "आपका कार्ट खाली है।",
    "summary": "सारांश",
    "subtotal": "उप-योग",
    "taxes": "टैक्स",
    "taxesValue": "चेकआउट पर गणना की गई",
    "total": "कुल",
    "customerDetails": "ग्राहक विवरण",
    "customerName": "ग्राहक का नाम",
    "customerMobile": "मोबाइल नंबर (आवश्यक)",
    "customerEmail": "ईमेल (रसीद के लिए)",
    "generateBill": "बिल बनाएं",
    "generatingBill": "बिल बनाया जा रहा है...",
    "errorMobile": "कृपया ग्राहक मोबाइल नंबर दर्ज करें।",
    "errorEmptyCart": "आपका कार्ट खाली है।",
    "billSuccess": "बिल {{billId}} सफलतापूर्वक बनाया गया!",
    "billError": "बिल बनाने में विफल: {{error}}"
  },
  "history": {
    "title": "खरीदारी इतिहास",
    "backToCustomers": "ग्राहकों पर वापस जाएं",
    "loading": "ग्राहक इतिहास लोड हो रहा है...",
    "error": "ग्राहक इतिहास लोड करने में विफल",
    "notFound": "ग्राहक नहीं मिला",
    "noHistory": "कोई खरीदारी इतिहास नहीं मिला",
    "noHistoryHint": "इस ग्राहक ने अभी तक कोई खरीदारी नहीं की है",
    "headerBill": "बिल आईडी",
    "headerDate": "तारीख और समय",
    "headerTotal": "कुल राशि",
    "headerActions": "कार्रवाई",
    "download": "PDF डाउनलोड करें",
    "downloading": "बिल {{billId}} डाउनलोड हो रहा है...",
    "downloadSuccess": "PDF सफलतापूर्वक डाउनलोड हो गया",
    "downloadFailed": "PDF डाउनलोड करने में विफल",
    "totalPurchases": "कुल खरीददारी",
    "purchaseSummary": "खरीदारी सारांश",
    "totalBills": "कुल बिल",
    "totalSpent": "कुल खर्च",
    "avgBill": "औसत बिल"
  },
  "reports": {
    "title": "एग्जीक्यूटिव रिपोर्ट जनरेटर",
    "subtitle": "AI-संचालित अंतर्दृष्टि और पेशेवर PDF निर्यात के साथ व्यापक व्यवसाय बुद्धिमत्ता रिपोर्ट तैयार करें।",
    "dateRange": "तारीख सीमा",
    "selectRange": "तारीख सीमा चुनें",
    "generate": "रिपोर्ट जनरेट करें",
    "generating": "जनरेट हो रहा है...",
    "download": "PDF निर्यात करें",
    "downloading": "डाउनलोड हो रहा है...",
    "newReport": "नई रिपोर्ट",
    "errorDate": "कृपया एक वैध तारीख सीमा चुनें।",
    "errorStartDate": "प्रारंभ तिथि समाप्ति तिथि के बाद नहीं हो सकती।",
    "loading": "रिपोर्ट जनरेट हो रही है",
    "loadingSub": "डेटा संकलित किया जा रहा है और अंतर्दृष्टि जनरेट की जा रही है...",
    "placeholderTitle": "रिपोर्ट जनरेट करने के लिए तैयार",
    "placeholderSub": "एक व्यापक रिपोर्ट बनाने के लिए अपनी तारीख सीमा चुनें और जनरेट पर क्लिक करें।",
    "placeholder1": "बिक्री एनालिटिक्स",
    "placeholder2": "AI अंतर्दृष्टि",
    "placeholder3": "PDF निर्यात"
  },
  "reminder": {
    "title": "मासिक खरीदारी अनुस्मारक",
    "button": "मासिक अनुस्मारक भेजें",
    "sending": "भेजा जा रहा है...",
    "success": "अनुस्मारक सफलतापूर्वक ट्रिगर किए गए!",
    "error": "अनुस्मारक ट्रिगर करने में विफल"
  },
  "profile": {
    "title": "मेरी प्रोफाइल",
    "notLoggedIn": "आप लॉग इन नहीं हैं।",
    "email": "ईमेल",
    "role": "भूमिका",
    "tokenIssued": "टोकन जारी किया गया",
    "tokenExpires": "टोकन समाप्त होता है"
  },
  "privateRoute": {
    "denied": "पहुंच अस्वीकृत - अपर्याप्त अनुमतियां।"
  },
  "errors": {
    "noToken": "बैकएंड से कोई एक्सेस टोकन प्राप्त नहीं हुआ।",
    "noRefresh": "कोई रिफ्रेश टोकन नहीं मिला",
    "refreshFailed": "टोकन रिफ्रेश विफल"
  },
  "common": {
    "goBack": "वापस जाएं",
    "downloading": "डाउनलोड हो रहा है...",
    "previous": "पिछला",
    "next": "अगला"
  }
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\locales\mr
--------------------------------------------------------------------
Contents:
translation.json

====================================================================
📄 File: G:\FINALCODE\frontend\src\locales\mr\translation.json
--------------------------------------------------------------------
{
  "nav": {
    "dashboard": "डॅशबोर्ड",
    "products": "उत्पादने",
    "bills": "बिले",
    "customers": "ग्राहक",
    "reports": "अहवाल",
    "logout": "लॉगआउट",
    "login": "लॉगिन",
    "viewCart": "कार्ट पहा",
    "selectLang": "भाषा निवडा"
  },
  "lang": {
    "en": "इंग्रजी",
    "hi": "हिंदी",
    "mr": "मराठी",
    "te": "तेलुगू"
  },
  "auth": {
    "signIn": "साइन इन",
    "signInWelcome": "पुन्हा स्वागत आहे! कृपया तुमचे तपशील प्रविष्ट करा.",
    "loginFailed": "लॉगिन अयशस्वी:",
    "emailAddress": "ईमेल पत्ता",
    "emailPlaceholder": "you@example.com",
    "password": "पासवर्ड",
    "forgotPassword": "पासवर्ड विसरलात?",
    "or": "किंवा",
    "continueWithGoogle": "Google सह सुरू ठेवा",
    "noAccount": "खाते नाही?",
    "signUpHere": "येथे साइन अप करा",
    "signUp": "खाते तयार करा",
    "signUpWelcome": "खालील फॉर्म भरून प्रारंभ करा.",
    "signupFailed": "साइनअप अयशस्वी:",
    "fullName": "पूर्ण नाव",
    "namePlaceholder": "जॉन डो",
    "role": "भूमिका",
    "roleCashier": "कॅशियर",
    "roleManager": "व्यवस्थापक",
    "roleOwner": "मालक",
    "createAccount": "खाते तयार करा",
    "haveAccount": "आधीपासून खाते आहे?",
    "signInHere": "येथे साइन इन करा",
    "brandPanelTitle": "स्मार्ट रिटेल",
    "brandPanelLogin": "तुमची इन्व्हेंटरी, बिलिंग आणि अ‍ॅनालिटिक्स एकाच ठिकाणी व्यवस्थापित करा.",
    "brandPanelSignup": "आमच्या प्लॅटफॉर्ममध्ये सामील व्हा आणि तुमच्या व्यवसायावर नियंत्रण ठेवा."
  },
  "dashboard": {
    "title": "अ‍ॅनालिटिक्स डॅशबोर्ड",
    "subtitle": "रीयल-टाइम व्यवसाय अंतर्दृष्टी एका दृष्टीक्षेपात",
    "datePlaceholder": "तारीख श्रेणी निवडा",
    "totalRevenue": "एकूण उत्पन्न",
    "totalOrders": "एकूण ऑर्डर",
    "productsSold": "विकल्या गेलेली उत्पादने",
    "up": "वाढ",
    "down": "घट",
    "salesByCategory": "श्रेणीनुसार विक्री",
    "percentOfTotal": "एकूणाच्या %",
    "topProducts": "शीर्ष उत्पादने",
    "loading": "डॅशबोर्ड लोड होत आहे...",
    "error": "अ‍ॅनालिटिक्स लोड करण्यात अयशस्वी. कृपया पुन्हा प्रयत्न करा.",
    "revenue": "उत्पन्न",
    "total": "एकूण"
  },
  "products": {
    "title": "उत्पादन यादी",
    "items": "आयटम",
    "searchPlaceholder": "नाव, श्रेणी, किंवा आयडी नुसार शोधा...",
    "sortDefault": "क्रमवारी लावा: डीफॉल्ट",
    "sortNameAsc": "नाव (A-Z)",
    "sortNameDesc": "नाव (Z-A)",
    "sortPriceAsc": "किंमत (कमी-जास्त)",
    "sortPriceDesc": "किंमत (जास्त-कमी)",
    "sortQtyAsc": "प्रमाण (कमी-जास्त)",
    "sortQtyDesc": "प्रमाण (जास्त-कमी)",
    "showLowStock": "फक्त कमी स्टॉक दाखवा",
    "showingLowStock": "कमी स्टॉक दाखवला जात आहे",
    "bulkUpload": "बल्क अपलोड",
    "addProduct": "उत्पादन जोडा",
    "loading": "उत्पादने लोड होत आहेत...",
    "error": "उत्पादने लोड करण्यात अयशस्वी. कृपया पुन्हा प्रयत्न करा.",
    "tryAgain": "पुन्हा प्रयत्न करा",
    "noMatch": "तुमच्या शोधाशी जुळणारी कोणतीही उत्पादने नाहीत.",
    "noLowStock": "कमी स्टॉक आयटम सापडले नाहीत.",
    "noProducts": "कोणतीही उत्पादने सापडली नाहीत.",
    "clearFilters": "फिल्टर क्लिअर करा",
    "lowStock": "कमी स्टॉक",
    "inCart": "कार्टमध्ये",
    "edit": "उत्पादन संपादित करा",
    "delete": "उत्पादन हटवा",
    "price": "किंमत",
    "inStock": "स्टॉकमध्ये",
    "addToCart": "कार्टमध्ये जोडा",
    "outOfStock": "स्टॉक संपला",
    "formTitleAdd": "नवीन उत्पादन जोडा",
    "formTitleEdit": "उत्पादन संपादित करा",
    "formImage": "उत्पादन प्रतिमा",
    "formImageDrop": "प्रतिमा ड्रॉप करा किंवा क्लिक करा",
    "formImageReplace": "बदलण्यासाठी नवीन प्रतिमा अपलोड करा",
    "formImageUpload": "उत्पादन प्रतिमा अपलोड करा",
    "formId": "उत्पादन आयडी (SKU)",
    "formIdPlaceholder": "उदा., LAP-APP-M1",
    "formName": "उत्पादन नाव",
    "formNamePlaceholder": "उदा., Macbook Pro 14",
    "formCategory": "श्रेणी",
    "formCategoryPlaceholder": "उदा., इलेक्ट्रॉनिक्स",
    "formPrice": "किंमत (₹)",
    "formPricePlaceholder": "उदा., 150000",
    "formQuantity": "प्रमाण",
    "formQuantityPlaceholder": "उदा., 25",
    "formReorder": "पुन्हा ऑर्डर स्तर",
    "formReorderPlaceholder": "उदा., 10",
    "formCancel": "रद्द करा",
    "formSaving": "जतन होत आहे...",
    "formUpdating": "अपडेट होत आहे...",
    "formSave": "बदल जतन करा",
    "formCreate": "उत्पादन तयार करा",
    "bulkTitle": "बल्क उत्पादन अपलोड",
    "bulkStep1": "1. तुमचा डेटा योग्य स्वरूपात आहे याची खात्री करण्यासाठी CSV टेम्पलेट डाउनलोड करा.",
    "bulkStep2": "2. तुमचा उत्पादन डेटा भरा आणि पूर्ण फाइल येथे अपलोड करा.",
    "bulkTemplate": "टेम्पलेट डाउनलोड करा (.csv)",
    "bulkClick": "अपलोड करण्यासाठी क्लिक करा",
    "bulkFile": "CSV फाइल (कमाल 10MB)",
    "bulkClose": "बंद करा",
    "bulkCancel": "रद्द करा",
    "bulkUploading": "अपलोड होत आहे...",
    "bulkUploadProcess": "अपलोड आणि प्रक्रिया करा",
    "bulkSuccess": "अपलोड पूर्ण",
    "bulkAdded": "उत्पादने यशस्वीरित्या जोडली.",
    "bulkSkipped": "उत्पादने वगळली (आधीपासून अस्तित्वात आहेत).",
    "bulkFailed": "उत्पादने अयशस्वी.",
    "toastUpdateSuccess": "उत्पादन यशस्वीरित्या अपडेट केले",
    "toastCreateSuccess": "उत्पादन यशस्वीरित्या तयार केले",
    "toastError": "ऑपरेशन अयशस्वी",
    "bulkErrorFile": "कृपया अपलोड करण्यासाठी .csv फाइल निवडा.",
    "bulkErrorUpload": "अपलोड अयशस्वी. कृपया फाइल स्वरूप तपासा."
  },
  "productCard": {
    "lowStock": "कमी स्टॉक",
    "inCart": "कार्टमध्ये",
    "edit": "उत्पादन संपादित करा",
    "delete": "उत्पादन हटवा",
    "unnamed": "निनावी उत्पादन",
    "uncategorized": "अश्रेणीबद्ध",
    "price": "किंमत",
    "inStock": "स्टॉकमध्ये",
    "addToCart": "कार्टमध्ये जोडा",
    "outOfStock": "स्टॉक संपला",
    "errorStock": "त्रुटी: फक्त {{count}} स्टॉकमध्ये उपलब्ध (कार्ट नंतर).",
    "successAdd": "{{count}} x {{name}} कार्टमध्ये जोडले!"
  },
  "customerList": {
    "title": "ग्राहक निर्देशिका",
    "matching": "जुळणारे",
    "searchPlaceholder": "नाव, ईमेल, किंवा मोबाइल नुसार शोधा...",
    "sort": "क्रमवारी लावा:",
    "sortNameAsc": "नाव (A-Z)",
    "sortNameDesc": "नाव (Z-A)",
    "sortDateDesc": "शेवटची खरेदी (नवीनतम)",
    "sortDateAsc": "शेवटची खरेदी (जुने)",
    "sortPurchaseDesc": "खरेदी (जास्त-कमी)",
    "filter": "सर्व दाखवा",
    "filterInactive": "निष्क्रिय (30+ दिवस)",
    "emailAll": "सर्वांना ईमेल करा",
    "emailAllConfirm": "सर्व {{count}} ग्राहकांना ईमेल पाठवायचा?",
    "tryAgain": "पुन्हा प्रयत्न करा",
    "noMatch": "तुमच्या शोधाशी जुळणारे कोणतेही ग्राहक नाहीत.",
    "noFilterMatch": "तुमच्या फिल्टरशी जुळणारे कोणतेही ग्राहक नाहीत.",
    "noCustomers": "कोणतेही ग्राहक सापडले नाहीत.",
    "clearFilters": "फिल्टर क्लिअर करा",
    "deleteConfirm": "\"{{name}}\" आणि त्यांचा संपूर्ण खरेदी इतिहास हटवायचा?",
    "deleteSuccess": "ग्राहक यशस्वीरित्या हटवला",
    "deleteError": "ग्राहक हटवण्यात अयशस्वी."
  },
  "customerCard": {
    "unnamed": "निनावी ग्राहक",
    "totalPurchases": "एकूण खरेदी",
    "lastPurchase": "शेवटची खरेदी",
    "sendEmail": "ईमेल पाठवा",
    "viewHistory": "इतिहास पहा",
    "delete": "ग्राहक हटवा",
    "deleteAria": "ग्राहक {{name}} हटवा"
  },
  "customerForm": {
    "title": "ग्राहक जोडा",
    "name": "नाव",
    "email": "ईमेल",
    "mobile": "मोबाइल",
    "save": "जतन करा"
  },
  "customerEdit": {
    "title": "ग्राहक संपादित करा",
    "loading": "लोड होत आहे...",
    "errorLoad": "ग्राहक लोड करण्यात अयशस्वी:",
    "success": "ग्राहक यशस्वीरित्या अपडेट केला!",
    "errorUpdate": "अपडेट अयशस्वी:"
  },
  "billList": {
    "matching": "जुळणारी बिले",
    "showing": "बिले दाखवली जात आहेत",
    "previous": "मागील",
    "next": "पुढील",
    "title": "बिल इतिहास",
    "searchPlaceholder": "बिल किंवा ग्राहक शोधा...",
    "datePlaceholder": "तारीख श्रेणीनुसार फिल्टर करा",
    "sortNewest": "नवीनतम प्रथम",
    "sortOldest": "जुने प्रथम",
    "sortHigh": "सर्वात जास्त रक्कम",
    "sortLow": "सर्वात कमी रक्कम",
    "export": "एक्सेलमध्ये निर्यात करा",
    "exportSuccess": "{{count}} बिले निर्यात केली",
    "exportError": "निर्यात करण्यासाठी कोणताही डेटा नाही",
    "autoEmail": "ऑटो ईमेल",
    "headerId": "बिल आयडी",
    "headerCustomer": "ग्राहक",
    "headerTotal": "एकूण",
    "headerDate": "तारीख",
    "headerPayment": "पेमेंट",
    "headerStatus": "स्थिती",
    "headerActions": "क्रिया",
    "emptyState": "तुमच्या फिल्टरशी जुळणारी कोणतीही बिले नाहीत.",
    "emptyStateHint": "फिल्टर किंवा तारीख श्रेणी समायोजित करण्याचा प्रयत्न करा",
    "statusCompleted": "पूर्ण",
    "paymentMethod": "रोख",
    "downloadPDF": "PDF डाउनलोड करा",
    "resendEmail": "ईमेल पुन्हा पाठवा",
    "downloading": "{{billId}} डाउनलोड होत आहे...",
    "downloadFailed": "डाउनलोड अयशस्वी",
    "resendSuccess": "ईमेल पुन्हा पाठवला!",
    "resendFailed": "पुन्हा पाठवणे अयशस्वी",
    "drawerTitle": "बिल तपशील",
    "drawerDate": "तारीख आणि वेळ",
    "drawerTotal": "एकूण रक्कम",
    "drawerCustomer": "ग्राहक",
    "drawerItems": "आयटम ({{count}})",
    "walkIn": "वॉक-इन ग्राहक",
    "noMobile": "मोबाइल नंबर नाही",
    "totalBills": "एकूण बिले",
    "totalRevenue": "एकूण उत्पन्न",
    "generateBill": "बिल तयार करा"
  },
  "billForm": {
    "title": "नवीन बिल तयार करा",
    "customer": "ग्राहक",
    "selectCustomer": "ग्राहक निवडा",
    "items": "आयटम",
    "selectProduct": "उत्पादन निवडा",
    "addItem": "+ आयटम जोडा",
    "total": "एकूण:",
    "createBill": "बिल तयार करा",
    "errorCustomer": "कृपया एक ग्राहक निवडा",
    "errorCreate": "बिल तयार करताना त्रुटी",
    "success": "बिल यशस्वीरित्या तयार केले!"
  },
  "checkout": {
    "title": "तुमचा कार्ट पुनरावलोकन करा",
    "empty": "तुमचा कार्ट रिकामा आहे.",
    "summary": "सारांश",
    "subtotal": "उपयोग",
    "taxes": "कर",
    "taxesValue": "चेकआउटवर गणना केली जाते",
    "total": "एकूण",
    "customerDetails": "ग्राहक तपशील",
    "customerName": "ग्राहकाचे नाव",
    "customerMobile": "मोबाइल नंबर (आवश्यक)",
    "customerEmail": "ईमेल (पावतीसाठी)",
    "generateBill": "बिल तयार करा",
    "generatingBill": "बिल तयार होत आहे...",
    "errorMobile": "कृपया ग्राहक मोबाइल नंबर प्रविष्ट करा.",
    "errorEmptyCart": "तुमचा कार्ट रिकामा आहे.",
    "billSuccess": "बिल {{billId}} यशस्वीरित्या तयार केले!",
    "billError": "बिल तयार करण्यात अयशस्वी: {{error}}"
  },
  "history": {
    "title": "खरेदी इतिहास",
    "backToCustomers": "ग्राहकांकडे परत जा",
    "loading": "ग्राहक इतिहास लोड होत आहे...",
    "error": "ग्राहक इतिहास लोड करण्यात अयशस्वी",
    "notFound": "ग्राहक सापडला नाही",
    "noHistory": "खरेदी इतिहास सापडला नाही",
    "noHistoryHint": "या ग्राहकाने अद्याप कोणतीही खरेदी केलेली नाही",
    "headerBill": "बिल आयडी",
    "headerDate": "तारीख आणि वेळ",
    "headerTotal": "एकूण रक्कम",
    "headerActions": "क्रिया",
    "download": "PDF डाउनलोड करा",
    "downloading": "बिल {{billId}} डाउनलोड होत आहे...",
    "downloadSuccess": "PDF यशस्वीरित्या डाउनलोड झाला",
    "downloadFailed": "PDF डाउनलोड करण्यात अयशस्वी",
    "totalPurchases": "एकूण खरेदी",
    "purchaseSummary": "खरेदी सारांश",
    "totalBills": "एकूण बिले",
    "totalSpent": "एकूण खर्च",
    "avgBill": "सरासरी बिल"
  },
  "reports": {
    "title": "कार्यकारी अहवाल जनरेटर",
    "subtitle": "AI-संचालित अंतर्दृष्टी आणि व्यावसायिक PDF निर्यातीसह व्यापक व्यवसाय बुद्धिमत्ता अहवाल तयार करा.",
    "dateRange": "तारीख श्रेणी",
    "selectRange": "तारीख श्रेणी निवडा",
    "generate": "अहवाल जनरेट करा",
    "generating": "जनरेट होत आहे...",
    "download": "PDF निर्यात करा",
    "downloading": "डाउनलोड होत आहे...",
    "newReport": "नवीन अहवाल",
    "errorDate": "कृपया एक वैध तारीख श्रेणी निवडा.",
    "errorStartDate": "प्रारंभ तारीख समाप्ती तारखेपेक्षा नंतरची असू शकत नाही.",
    "loading": "अहवाल जनरेट होत आहे",
    "loadingSub": "डेटा संकलित केला जात आहे आणि अंतर्दृष्टी तयार केली जात आहे...",
    "placeholderTitle": "अहवाल तयार करण्यासाठी तयार",
    "placeholderSub": "एक व्यापक अहवाल तयार करण्यासाठी तुमची तारीख श्रेणी निवडा आणि जनरेट वर क्लिक करा.",
    "placeholder1": "विक्री अ‍ॅनालिटिक्स",
    "placeholder2": "AI अंतर्दृष्टी",
    "placeholder3": "PDF निर्यात"
  },
  "reminder": {
    "title": "मासिक खरेदी रिमाइंडर",
    "button": "मासिक रिमाइंडर पाठवा",
    "sending": "पाठवला जात आहे...",
    "success": "रिमाइंडर यशस्वीरित्या ट्रिगर केले!",
    "error": "रिमाइंडर ट्रिगर करण्यात अयशस्वी"
  },
  "profile": {
    "title": "माझी प्रोफाइल",
    "notLoggedIn": "तुम्ही लॉग इन केलेले नाही.",
    "email": "ईमेल",
    "role": "भूमिका",
    "tokenIssued": "टोकन जारी केला",
    "tokenExpires": "टोकन कालबाह्य होतो"
  },
  "privateRoute": {
    "denied": "प्रवेश नाकारला - अपुरी परवानग्या."
  },
  "errors": {
    "noToken": "बॅकएंडकडून कोणताही ऍक्सेस टोकन प्राप्त झाला नाही.",
    "noRefresh": "कोणताही रिफ्रेश टोकन सापडला नाही",
    "refreshFailed": "टोकन रिफ्रेश अयशस्वी"
  },
  "common": {
    "goBack": "मागे जा",
    "downloading": "डाउनलोड होत आहे...",
    "previous": "मागील",
    "next": "पुढील"
  }
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\locales\te
--------------------------------------------------------------------
Contents:
translation.json

====================================================================
📄 File: G:\FINALCODE\frontend\src\locales\te\translation.json
--------------------------------------------------------------------
{
  "nav": {
    "dashboard": "డాష్బోర్డ్",
    "products": "ఉత్పత్తులు",
    "bills": "బిల్లులు",
    "customers": "గ్రాహకులు",
    "reports": "రిపోర్ట్లు",
    "logout": "లాగ్అవుట్",
    "login": "లాగిన్",
    "viewCart": "కార్ట్ చూడండి",
    "selectLang": "భాష ఎంచుకోండి"
  },
  "lang": {
    "en": "ఇంగ్లీష్",
    "hi": "హిందీ",
    "mr": "మరాఠీ",
    "te": "తెలుగు"
  },
  "auth": {
    "signIn": "సైన్ ఇన్",
    "signInWelcome": "తిరిగి స్వాగతం! దయచేసి మీ వివరాలను నమోదు చేయండి.",
    "loginFailed": "లాగిన్ విఫలమైంది:",
    "emailAddress": "ఇమెయిల్ చిరునామా",
    "emailPlaceholder": "you@example.com",
    "password": "పాస్వర్డ్",
    "forgotPassword": "పాస్వర్డ్ మర్చిపోయారా?",
    "or": "లేదా",
    "continueWithGoogle": "Google తో కొనసాగించండి",
    "noAccount": "ఖాతా లేదా?",
    "signUpHere": "ఇక్కడ సైన్ అప్ చేయండి",
    "signUp": "ఖాతా సృష్టించండి",
    "signUpWelcome": "క్రింద ఫారమ్ను పూరించడం ద్వారా ప్రారంభించండి.",
    "signupFailed": "సైన్అప్ విఫలమైంది:",
    "fullName": "పూర్తి పేరు",
    "namePlaceholder": "జాన్ డో",
    "role": "పాత్ర",
    "roleCashier": "క్యాషియర్",
    "roleManager": "మేనేజర్",
    "roleOwner": "యజమాని",
    "createAccount": "ఖాతా సృష్టించండి",
    "haveAccount": "ఇప్పటికే ఖాతా ఉందా?",
    "signInHere": "ఇక్కడ సైన్ ఇన్ చేయండి",
    "brandPanelTitle": "స్మార్ట్ రిటెయిల్",
    "brandPanelLogin": "మీ ఇన్వెంటరీ, బిల్లింగ్ మరియు విశ్లేషణలను ఒకే చోట నిర్వహించండి.",
    "brandPanelSignup": "మా ప్లాట్ఫారమ్లో చేరండి మరియు మీ వ్యాపారాన్ని నియంత్రించండి."
  },
  "dashboard": {
    "title": "విశ్లేషణ డాష్బోర్డ్",
    "subtitle": "నిజ-సమయ వ్యాపార అంతర్దృష్టులు ఒక నిమిషంలో",
    "datePlaceholder": "తేదీ పరిధి ఎంచుకోండి",
    "totalRevenue": "మొత్తం ఆదాయం",
    "totalOrders": "మొత్తం ఆర్డర్లు",
    "productsSold": "విక్రయించబడిన ఉత్పత్తులు",
    "up": "పెరుగుదల",
    "down": "తగ్గుదల",
    "salesByCategory": "కేటగరీ ప్రకారం విక్రయాలు",
    "percentOfTotal": "మొత్తం %",
    "topProducts": "టాప్ ఉత్పత్తులు",
    "loading": "డాష్బోర్డ్ లోడ్ అవుతుంది...",
    "error": "విశ్లేషణలు లోడ్ చేయడంలో విఫలమైంది. దయచేసి మళ్లీ ప్రయత్నించండి.",
    "revenue": "ఆదాయం",
    "total": "మొత్తం"
  },
  "products": {
    "title": "ఉత్పత్తి ఇన్వెంటరీ",
    "items": "అంశాలు",
    "searchPlaceholder": "పేరు, కేటగరీ, లేదా ఐడీ ద్వారా శోధించండి...",
    "sortDefault": "క్రమబద్ధీకరించు: డిఫాల్ట్",
    "sortNameAsc": "పేరు (A-Z)",
    "sortNameDesc": "పేరు (Z-A)",
    "sortPriceAsc": "ధర (తక్కువ-ఎక్కువ)",
    "sortPriceDesc": "ధర (ఎక్కువ-తక్కువ)",
    "sortQtyAsc": "పరిమాణం (తక్కువ-ఎక్కువ)",
    "sortQtyDesc": "పరిమాణం (ఎక్కువ-తక్కువ)",
    "showLowStock": "తక్కువ స్టాక్ మాత్రమే చూపించు",
    "showingLowStock": "తక్కువ స్టాక్ చూపిస్తోంది",
    "bulkUpload": "బల్క్ అప్లోడ్",
    "addProduct": "ఉత్పత్తిని జోడించండి",
    "loading": "ఉత్పత్తులు లోడ్ అవుతున్నాయి...",
    "error": "ఉత్పత్తులు లోడ్ చేయడంలో విఫలమైంది. దయచేసి మళ్లీ ప్రయత్నించండి.",
    "tryAgain": "మళ్లీ ప్రయత్నించండి",
    "noMatch": "మీ శోధనకు ఏ ఉత్పత్తులు సరిపోలలేదు.",
    "noLowStock": "తక్కువ స్టాక్ అంశాలు కనుగొనబడలేదు.",
    "noProducts": "ఏ ఉత్పత్తులు కనుగొనబడలేదు.",
    "clearFilters": "ఫిల్టర్లు క్లియర్ చేయండి",
    "lowStock": "తక్కువ స్టాక్",
    "inCart": "కార్ట్లో",
    "edit": "ఉత్పత్తిని సవరించండి",
    "delete": "ఉత్పత్తిని తొలగించండి",
    "price": "ధర",
    "inStock": "స్టాక్లో ఉంది",
    "addToCart": "కార్ట్కు జోడించండి",
    "outOfStock": "స్టాక్ లేదు",
    "formTitleAdd": "కొత్త ఉత్పత్తిని జోడించండి",
    "formTitleEdit": "ఉత్పత్తిని సవరించండి",
    "formImage": "ఉత్పత్తి చిత్రం",
    "formImageDrop": "చిత్రాన్ని డ్రాప్ చేయండి లేదా క్లిక్ చేయండి",
    "formImageReplace": "మార్చడానికి కొత్త చిత్రాన్ని అప్లోడ్ చేయండి",
    "formImageUpload": "ఉత్పత్తి చిత్రాన్ని అప్లోడ్ చేయండి",
    "formId": "ఉత్పత్తి ఐడీ (SKU)",
    "formIdPlaceholder": "ఉదా., LAP-APP-M1",
    "formName": "ఉత్పత్తి పేరు",
    "formNamePlaceholder": "ఉదా., Macbook Pro 14",
    "formCategory": "కేటగరీ",
    "formCategoryPlaceholder": "ఉదా., ఎలక్ట్రానిక్స్",
    "formPrice": "ధర (₹)",
    "formPricePlaceholder": "ఉదా., 150000",
    "formQuantity": "పరిమాణం",
    "formQuantityPlaceholder": "ఉదా., 25",
    "formReorder": "మళ్లీ ఆర్డర్ స్థాయి",
    "formReorderPlaceholder": "ఉదా., 10",
    "formCancel": "రద్దు చేయండి",
    "formSaving": "సేవ్ చేస్తోంది...",
    "formUpdating": "నవీకరిస్తోంది...",
    "formSave": "మార్పులను సేవ్ చేయండి",
    "formCreate": "ఉత్పత్తిని సృష్టించండి",
    "bulkTitle": "బల్క్ ఉత్పత్తి అప్లోడ్",
    "bulkStep1": "1. మీ డేటా సరైన ఫార్మాట్లో ఉందని నిర్ధారించడానికి CSV టెంప్లేట్ను డౌన్లోడ్ చేయండి.",
    "bulkStep2": "2. మీ ఉత్పత్తి డేటాను పూరించండి మరియు పూర్తి ఫైల్ను ఇక్కడ అప్లోడ్ చేయండి.",
    "bulkTemplate": "టెంప్లేట్ డౌన్లోడ్ చేయండి (.csv)",
    "bulkClick": "అప్లోడ్ చేయడానికి క్లిక్ చేయండి",
    "bulkFile": "CSV ఫైల్ (గరిష్టంగా 10MB)",
    "bulkClose": "మూసివేయండి",
    "bulkCancel": "రద్దు చేయండి",
    "bulkUploading": "అప్లోడ్ అవుతుంది...",
    "bulkUploadProcess": "అప్లోడ్ & ప్రాసెస్ చేయండి",
    "bulkSuccess": "అప్లోడ్ పూర్తయింది",
    "bulkAdded": "ఉత్పత్తులు విజయవంతంగా జోడించబడ్డాయి.",
    "bulkSkipped": "ఉత్పత్తులు దాటవేయబడ్డాయి (ఇప్పటికే ఉన్నాయి).",
    "bulkFailed": "ఉత్పత్తులు విఫలమైనవి.",
    "toastUpdateSuccess": "ఉత్పత్తి విజయవంతంగా నవీకరించబడింది",
    "toastCreateSuccess": "ఉత్పత్తి విజయవంతంగా సృష్టించబడింది",
    "toastError": "ఆపరేషన్ విఫలమైంది",
    "bulkErrorFile": "దయచేసి అప్లోడ్ చేయడానికి .csv ఫైల్ను ఎంచుకోండి.",
    "bulkErrorUpload": "అప్లోడ్ విఫలమైంది. దయచేసి ఫైల్ ఫార్మాట్ తనిఖీ చేయండి."
  },
  "productCard": {
    "lowStock": "తక్కువ స్టాక్",
    "inCart": "కార్ట్లో",
    "edit": "ఉత్పత్తిని సవరించండి",
    "delete": "ఉత్పత్తిని తొలగించండి",
    "unnamed": "పేరులేని ఉత్పత్తి",
    "uncategorized": "వర్గీకరించబడని",
    "price": "ధర",
    "inStock": "స్టాక్లో ఉంది",
    "addToCart": "కార్ట్కు జోడించండి",
    "outOfStock": "స్టాక్ లేదు",
    "errorStock": "లోపం: కార్ట్ తర్వాత స్టాక్లో కేవలం {{count}} మాత్రమే అందుబాటులో ఉంది.",
    "successAdd": "{{count}} x {{name}} కార్ట్కు జోడించబడింది!"
  },
  "customerList": {
    "title": "గ్రాహక డైరెక్టరీ",
    "matching": "సరిపోలుతుంది",
    "searchPlaceholder": "పేరు, ఇమెయిల్, లేదా మొబైల్ ద్వారా శోధించండి...",
    "sort": "క్రమబద్ధీకరించు:",
    "sortNameAsc": "పేరు (A-Z)",
    "sortNameDesc": "పేరు (Z-A)",
    "sortDateDesc": "చివరి కొనుగోలు (కొత్తది)",
    "sortDateAsc": "చివరి కొనుగోలు (పాతది)",
    "sortPurchaseDesc": "కొనుగోలులు (ఎక్కువ-తక్కువ)",
    "filter": "అన్నీ చూపించు",
    "filterInactive": "నిష్క్రియ (30+ రోజులు)",
    "emailAll": "అందరికీ ఇమెయిల్ చేయండి",
    "emailAllConfirm": "అన్ని {{count}} గ్రాహకులకు ఇమెయిల్ పంపాలా?",
    "tryAgain": "మళ్లీ ప్రయత్నించండి",
    "noMatch": "మీ శోధనకు ఏ గ్రాహకులు సరిపోలలేదు.",
    "noFilterMatch": "మీ ఫిల్టర్కు ఏ గ్రాహకులు సరిపోలలేదు.",
    "noCustomers": "గ్రాహకులు ఎవరూ కనుగొనబడలేదు.",
    "clearFilters": "ఫిల్టర్లు క్లియర్ చేయండి",
    "deleteConfirm": "\"{{name}}\" మరియు వారి మొత్తం కొనుగోలు చరిత్రను తొలగించాలా?",
    "deleteSuccess": "గ్రాహకుడు విజయవంతంగా తొలగించబడ్డాడు",
    "deleteError": "గ్రాహకుని తొలగించడంలో విఫలమైంది."
  },
  "customerCard": {
    "unnamed": "పేరులేని గ్రాహకుడు",
    "totalPurchases": "మొత్తం కొనుగోలులు",
    "lastPurchase": "చివరి కొనుగోలు",
    "sendEmail": "ఇమెయిల్ పంపండి",
    "viewHistory": "చరిత్రను వీక్షించండి",
    "delete": "గ్రాహకుని తొలగించండి",
    "deleteAria": "గ్రాహకుడిని తొలగించండి {{name}}"
  },
  "customerForm": {
    "title": "గ్రాహకుని జోడించండి",
    "name": "పేరు",
    "email": "ఇమెయిల్",
    "mobile": "మొబైల్",
    "save": "సేవ్ చేయండి"
  },
  "customerEdit": {
    "title": "గ్రాహకుని సవరించండి",
    "loading": "లోడ్ అవుతుంది...",
    "errorLoad": "గ్రాహకుడిని లోడ్ చేయడంలో విఫలమైంది:",
    "success": "గ్రాహకుడు విజయవంతంగా నవీకరించబడ్డాడు!",
    "errorUpdate": "నవీకరణ విఫలమైంది:"
  },
  "billList": {
    "matching": "సరిపోలే బిల్లులు",
    "showing": "బిల్లులు చూపిస్తున్నారు",
    "previous": "మునుపటి",
    "next": "తర్వాతి",
    "title": "బిల్ చరిత్ర",
    "searchPlaceholder": "బిల్లులు లేదా గ్రాహకులను శోధించండి...",
    "datePlaceholder": "తేదీ పరిధి ద్వారా ఫిల్టర్ చేయండి",
    "sortNewest": "కొత్తది ముందు",
    "sortOldest": "పాతది ముందు",
    "sortHigh": "అత్యధిక మొత్తం",
    "sortLow": "తక్కువ మొత్తం",
    "export": "ఎక్సెల్కు ఎగుమతి చేయండి",
    "exportSuccess": "{{count}} బిల్లులు ఎగుమతి చేయబడ్డాయి",
    "exportError": "ఎగుమతి చేయడానికి డేటా లేదు",
    "autoEmail": "ఆటో ఇమెయిల్",
    "headerId": "బిల్ ఐడీ",
    "headerCustomer": "గ్రాహకుడు",
    "headerTotal": "మొత్తం",
    "headerDate": "తేదీ",
    "headerPayment": "చెల్లింపు",
    "headerStatus": "స్థితి",
    "headerActions": "చర్యలు",
    "emptyState": "మీ ఫిల్టర్లకు ఏ బిల్లులు సరిపోలలేదు.",
    "emptyStateHint": "ఫిల్టర్లు లేదా తేదీ పరిధిని సర్దుబాటు చేయడానికి ప్రయత్నించండి",
    "statusCompleted": "పూర్తయింది",
    "paymentMethod": "నగదు",
    "downloadPDF": "PDF డౌన్లోడ్ చేయండి",
    "resendEmail": "ఇమెయిల్ మళ్లీ పంపండి",
    "downloading": "{{billId}} డౌన్లోడ్ అవుతుంది...",
    "downloadFailed": "డౌన్లోడ్ విఫలమైంది",
    "resendSuccess": "ఇమెయిల్ మళ్లీ పంపబడింది!",
    "resendFailed": "మళ్లీ పంపడం విఫలమైంది",
    "drawerTitle": "బిల్ వివరాలు",
    "drawerDate": "తేదీ & సమయం",
    "drawerTotal": "మొత్తం మొత్తం",
    "drawerCustomer": "గ్రాహకుడు",
    "drawerItems": "అంశాలు ({{count}})",
    "walkIn": "వాక్-ఇన్ గ్రాహకుడు",
    "noMobile": "మొబైల్ నంబర్ లేదు",
    "totalBills": "మొత్తం బిల్లులు",
    "totalRevenue": "మొత్తం ఆదాయం",
    "generateBill": "బిల్ జనరేట్ చేయండి"
  },
  "billForm": {
    "title": "కొత్త బిల్ సృష్టించండి",
    "customer": "గ్రాహకుడు",
    "selectCustomer": "గ్రాహకుని ఎంచుకోండి",
    "items": "అంశాలు",
    "selectProduct": "ఉత్పత్తిని ఎంచుకోండి",
    "addItem": "+ అంశాన్ని జోడించండి",
    "total": "మొత్తం:",
    "createBill": "బిల్ సృష్టించండి",
    "errorCustomer": "దయచేసి ఒక గ్రాహకుని ఎంచుకోండి",
    "errorCreate": "బిల్ సృష్టించడంలో లోపం",
    "success": "బిల్ విజయవంతంగా సృష్టించబడింది!"
  },
  "checkout": {
    "title": "మీ కార్ట్ని సమీక్షించండి",
    "empty": "మీ కార్ట్ ఖాళీగా ఉంది.",
    "summary": "సారాంశం",
    "subtotal": "ఉపమొత్తం",
    "taxes": "పన్నులు",
    "taxesValue": "చెక్అవుట్ వద్ద లెక్కించబడుతుంది",
    "total": "మొత్తం",
    "customerDetails": "గ్రాహక వివరాలు",
    "customerName": "గ్రాహకుని పేరు",
    "customerMobile": "మొబైల్ నంబర్ (తప్పనిసరి)",
    "customerEmail": "ఇమెయిల్ (రసీదు కోసం)",
    "generateBill": "బిల్ జనరేట్ చేయండి",
    "generatingBill": "బిల్ జనరేట్ అవుతుంది...",
    "errorMobile": "దయచేసి గ్రాహక మొబైల్ నంబర్ నమోదు చేయండి.",
    "errorEmptyCart": "మీ కార్ట్ ఖాళీగా ఉంది.",
    "billSuccess": "బిల్ {{billId}} విజయవంతంగా సృష్టించబడింది!",
    "billError": "బిల్ సృష్టించడంలో విఫలమైంది: {{error}}"
  },
  "history": {
    "title": "కొనుగోలు చరిత్ర",
    "backToCustomers": "గ్రాహకులకు తిరిగి వెళ్లండి",
    "loading": "గ్రాహక చరిత్ర లోడ్ అవుతుంది...",
    "error": "గ్రాహక చరిత్ర లోడ్ చేయడంలో విఫలమైంది",
    "notFound": "గ్రాహకుడు కనుగొనబడలేదు",
    "noHistory": "కొనుగోలు చరిత్ర కనుగొనబడలేదు",
    "noHistoryHint": "ఈ గ్రాహకుడు ఇంకా ఎటువంటి కొనుగోలులు చేయలేదు",
    "headerBill": "బిల్ ఐడీ",
    "headerDate": "తేదీ & సమయం",
    "headerTotal": "మొత్తం మొత్తం",
    "headerActions": "చర్యలు",
    "download": "PDF డౌన్లోడ్ చేయండి",
    "downloading": "బిల్ {{billId}} డౌన్లోడ్ అవుతుంది...",
    "downloadSuccess": "PDF విజయవంతంగా డౌన్లోడ్ అయ్యింది",
    "downloadFailed": "PDF డౌন్లోడ్ చేయడంలో విఫలమైంది",
    "totalPurchases": "మొత్తం కొనుగోలులు",
    "purchaseSummary": "కొనుగోలు సారాంశం",
    "totalBills": "మొత్తం బిల్లులు",
    "totalSpent": "మొత్తం ఖర్చు",
    "avgBill": "సగటు బిల్"
  },
  "reports": {
    "title": "ఎగ్జిక్యూటివ్ రిపోర్ట్ జనరేటర్",
    "subtitle": "AI-శక్తితో కూడిన అంతర్దృష్టులు మరియు ప్రొఫెషనల్ PDF ఎగుమతులతో సమగ్ర వ్యాపార బుద్ధిమత్త రిపోర్ట్లను రూపొందించండి.",
    "dateRange": "తేదీ పరిధి",
    "selectRange": "తేదీ పరిధి ఎంచుకోండి",
    "generate": "రిపోర్ట్ జనరేట్ చేయండి",
    "generating": "జనరేట్ అవుతుంది...",
    "download": "PDF ఎగుమతి చేయండి",
    "downloading": "డౌన్లోడ్ అవుతుంది...",
    "newReport": "కొత్త రిపోర్ట్",
    "errorDate": "దయచేసి చెల్లుబాటు అయ్యే తేదీ పరిధిని ఎంచుకోండి.",
    "errorStartDate": "ప్రారంభ తేదీ ముగింపు తేదీకి తర్వాత ఉండకూడదు.",
    "loading": "రిపోర్ట్ జనరేట్ అవుతుంది",
    "loadingSub": "డేటా కంపైల్ చేయబడుతోంది మరియు అంతర్దృష్టులు రూపొందించబడుతున్నాయి...",
    "placeholderTitle": "రిపోర్ట్లను రూపొందించడానికి సిద్ధంగా ఉంది",
    "placeholderSub": "సమగ్ర రిపోర్ట్ సృష్టించడానికి మీ తేదీ పరిధిని ఎంచుకోండి మరియు జనరేట్ పై క్లిక్ చేయండి.",
    "placeholder1": "విక్రయాల విశ్లేషణ",
    "placeholder2": "AI అంతర్దృష్టులు",
    "placeholder3": "PDF ఎగుమతి"
  },
  "reminder": {
    "title": "నెలవారీ కొనుగోలు రిమైండర్లు",
    "button": "నెలవారీ రిమైండర్లు పంపండి",
    "sending": "పంపబడుతోంది...",
    "success": "రిమైండర్లు విజయవంతంగా ట్రిగర్ చేయబడ్డాయి!",
    "error": "రిమైండర్లను ట్రిగర్ చేయడంలో విఫలమైంది"
  },
  "profile": {
    "title": "నా ప్రొఫైల్",
    "notLoggedIn": "మీరు లాగిన్ కాలేదు.",
    "email": "ఇమెయిల్",
    "role": "పాత్ర",
    "tokenIssued": "టోకన్ జారీ చేయబడింది",
    "tokenExpires": "టోకన్ గడువు ముగియు సమయం"
  },
  "privateRoute": {
    "denied": "ప్రవేశం నిరాకరించబడింది - సరిపోని అనుమతులు."
  },
  "errors": {
    "noToken": "బ్యాకెండ్ నుండి యాక్సెస్ టోకన్ అందలేదు.",
    "noRefresh": "రిఫ్రెష్ టోకన్ కనుగొనబడలేదు",
    "refreshFailed": "టోకన్ రిఫ్రెష్ విఫలమైంది"
  },
  "common": {
    "goBack": "వెనక్కి వెళ్లండి",
    "downloading": "డౌన్లోడ్ అవుతుంది...",
    "previous": "మునుపటి",
    "next": "తర్వాతి"
  }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\main.jsx
--------------------------------------------------------------------
import React from "react";
import ReactDOM from "react-dom/client";
import { createBrowserRouter, RouterProvider, Navigate } from "react-router-dom";
import "./index.css";
import "react-datepicker/dist/react-datepicker.css";
import { CartProvider } from "./context/CartContext";
import { ToastProvider } from "./context/ToastContext";
import { ThemeProvider } from "./context/ThemeContext";

import './i18n'; // <-- Your i18n config

// --- Import All Components ---
// Layouts & Root
import App from "./App";
import MainLayout from './components/layout/MainLayout';
import AuthLayout from './components/layout/AuthLayout';
import PrivateRoute from "./PrivateRoute";
// Auth Pages
import Login from './components/auth/Login';
import Signup from './components/auth/Signup';
import OAuth2RedirectHandler from './components/auth/OAuth2RedirectHandler';
// App Pages
import AnalyticsDashboard from './components/analytics/AnalyticsDashboard';
import ProductList from './components/products/ProductList';
import BillList from './components/bills/BillList';
import BillForm from './components/bills/BillForm';
import CustomerList from './components/customers/CustomerList';
import CustomerHistory from './components/customers/CustomerHistory';
import ProfilePage from "./components/profile/ProfilePage";
import CheckoutPage from "./components/checkout/CheckoutPage";
import ReportGenerator from "./components/reports/summary/ReportGenerator";
import SalesReportText from './components/reports/text/SalesReportText'; // <-- Was missing this import

// --- Define Router Structure ---
const router = createBrowserRouter([
  {
    element: <App />,
    children: [
      // 1. Auth Routes
      {
        element: <AuthLayout />,
        children: [
          { path: "/login", element: <Login /> },
          { path: "/signup", element: <Signup /> },
          { path: "/login/success", element: <OAuth2RedirectHandler /> },
        ]
      },
      // 2. Protected App Routes
      {
        element: (
          <PrivateRoute roles={[]}> {/* This wrapper remains */}
            <MainLayout />
          </PrivateRoute>
        ),
        children: [
          { path: "/", element: <Navigate to="/dashboard" replace /> },
          { path: "/dashboard", element: <AnalyticsDashboard /> },
          { path: "/profile", element: <ProfilePage /> },
          { path: "/checkout", element: <CheckoutPage /> },

          // --- ALL PrivateRoute WRAPPERS RESTORED ---
          { path: "/products", element: <PrivateRoute roles={['OWNER', 'MANAGER']}><ProductList /></PrivateRoute> },
          { path: "/bills", element: <PrivateRoute roles={['MANAGER', 'OWNER']}><BillList /></PrivateRoute> },
          { path: "/bills/new", element: <PrivateRoute roles={['MANAGER', 'OWNER']}><BillForm /></PrivateRoute> },
          { path: "/customers", element: <PrivateRoute roles={['OWNER', 'MANAGER', 'CASHIER']}><CustomerList /></PrivateRoute> },
          { path: "/customers/:id/history", element: <PrivateRoute roles={['OWNER', 'MANAGER', 'CASHIER']}><CustomerHistory /></PrivateRoute> },

          // Report Routes
          { path: "/reports", element: <Navigate to="/reports/summary" replace /> },
          { path: "/reports/text", element: <PrivateRoute roles={['OWNER']}><SalesReportText /></PrivateRoute> },
          { path: "/reports/summary", element: <PrivateRoute roles={['OWNER', 'MANAGER']}><ReportGenerator /></PrivateRoute> },

          // Fallback
          { path: "*", element: <Navigate to="/dashboard" replace /> }
        ]
      }
    ]
  }
]);

ReactDOM.createRoot(document.getElementById("root")).render(
  <React.StrictMode>
    <ToastProvider>
      <CartProvider>
        <ThemeProvider>
          <RouterProvider router={router} />
        </ThemeProvider>
      </CartProvider>
    </ToastProvider>
  </React.StrictMode>
);
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\PrivateRoute.jsx
--------------------------------------------------------------------
import React from 'react';
import { Navigate } from 'react-router-dom';
import authService from './services/authService';
import { useTranslation } from 'react-i18next'; // Import

export default function PrivateRoute({ children, roles = [] }) {
  const { t } = useTranslation(); // Get hook

  try {
    const user = authService.getUserFromToken();

    if (!user) {
      console.warn("PrivateRoute: No user found, redirecting to login.");
      return <Navigate to="/login" />;
    }

    const userRoles = user.roles?.length
      ? user.roles
      : user.role
      ? [user.role]
      : [];

    const hasAccess =
      roles.length === 0 ||
      roles.some(r => userRoles.includes(r));

    if (!hasAccess) {
      console.warn("PrivateRoute: Access denied for roles", userRoles);
      return (
        <div className="p-4 text-red-600 dark:text-red-400 font-semibold text-center">
          {t('privateRoute.denied')}
        </div>
      );
    }

    return children;
  } catch (err) {
    console.error("PrivateRoute crashed:", err);
    authService.logout();
    return <Navigate to="/login" />;
  }
}
--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\services
--------------------------------------------------------------------
Contents:
analyticsService.js
authService.js
billService.js
customerService.js
notificationService.js
paymentService.js
productService.js
reportService.js
syncService.js
userService.js

====================================================================
📄 File: G:\FINALCODE\frontend\src\services\analyticsService.js
--------------------------------------------------------------------
import api from '../api/apiClient';

// Fetch daily sales analytics
export async function getDailyAnalytics() {
  const res = await api.get('/api/analytics/daily');
  return res.data;
}

// Fetch monthly sales analytics
export async function getMonthlyAnalytics() {
  const res = await api.get('/api/analytics/monthly');
  return res.data;
}

// Fetch top products analytics
export async function getTopProducts() {
  const res = await api.get('/api/analytics/top-products');
  return res.data;
}

// Fetch revenue trend data
export async function getRevenueTrend() {
  const res = await api.get('/api/analytics/revenue-trend');
  return res.data;
}




--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\services\authService.js
--------------------------------------------------------------------
import api from '../api/apiClient';
import jwtDecode from 'jwt-decode';
import i18n from '../i18n'; // <-- Import i18n instance

// LocalStorage key constants
const ACCESS_KEY = 'sr_access';
const REFRESH_KEY = 'sr_refresh';

/**
 * Save tokens to localStorage
 */
function saveTokens({ accessToken, refreshToken }) {
  if (accessToken) localStorage.setItem(ACCESS_KEY, accessToken);
  if (refreshToken) localStorage.setItem(REFRESH_KEY, refreshToken);
}

/**
 * Get stored tokens
 */
function getAccessToken() {
  return localStorage.getItem(ACCESS_KEY);
}
function getRefreshToken() {
  return localStorage.getItem(REFRESH_KEY);
}

/**
 * Clear tokens from storage (logout)
 */
function clearTokens() {
  localStorage.removeItem(ACCESS_KEY);
  localStorage.removeItem(REFRESH_KEY);
}

/**
 * Authenticate user with backend
 * POST /api/auth/login
 */
async function login({ email, password }) {
  const res = await api.post('/api/auth/login', { email, password });
  const payload = res.data;

  if (payload?.accessToken) {
    saveTokens({
      accessToken: payload.accessToken,
      refreshToken: payload.refreshToken || ''
    });
  } else if (payload?.token) {
    saveTokens({
      accessToken: payload.token,
      refreshToken: payload.refreshToken || ''
    });
  } else {
    // Use translated error
    throw new Error(i18n.t('errors.noToken'));
  }

  return payload;
}

/**
 * Create a new user account
 * POST /api/auth/signup
 */
async function signup(req) {
  const res = await api.post('/api/auth/signup', req);
  return res.data;
}

/**
 * Refresh JWT using refresh token
 * POST /api/auth/refresh
 */
async function refresh() {
  const refreshToken = getRefreshToken();
  if (!refreshToken) throw new Error(i18n.t('errors.noRefresh'));

  const res = await api.post('/api/auth/refresh', refreshToken, {
    headers: { 'Content-Type': 'text/plain' }
  });

  const newAccess = res.data?.accessToken;
  if (newAccess) {
    saveTokens({ accessToken: newAccess });
    return { accessToken: newAccess };
  }

  throw new Error(i18n.t('errors.refreshFailed'));
}

/**
 * Decode JWT and return structured user info
 */
function getUserFromToken() {
  const token = getAccessToken();
  if (!token) return null;

  try {
    const decoded = jwtDecode(token);
    const email = decoded.sub || decoded.email || "unknown@domain.com";
    const role = decoded.role || (decoded.roles ? decoded.roles[0] : "CUSTOMER");

    return {
      email,
      name: email.split("@")[0],
      role: role.toUpperCase(),
      exp: decoded.exp,
      iat: decoded.iat,
    };
  } catch (err) {
    console.error("JWT decode error:", err);
    return null;
  }
}

function getUserRole() {
  const token = getAccessToken();
  if (!token) return null;
  try {
    const decoded = jwtDecode(token);
    return decoded.role || (decoded.roles ? decoded.roles[0] : null);
  } catch (err) {
    console.error('Error decoding JWT for role:', err);
    return null;
  }
}

/**
 * Logout user
 */
function logout() {
  clearTokens();
}

export default {
  login,
  signup,
  refresh,
  saveTokens,
  getAccessToken,
  getRefreshToken,
  clearTokens,
  getUserFromToken,
  logout,
  getUserRole
};
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\services\billService.js
--------------------------------------------------------------------
// src/services/billService.js
import api from '../api/apiClient';

/**
 * Create a new bill
 */
export async function createBill(bill) {
  try {
    const res = await api.post('/api/bills', bill, {
      headers: { 'Content-Type': 'application/json' },
    });
    return res.data;
  } catch (err) {
    console.error('Failed to create bill:', err);
    throw err.response?.data || err;
  }
}

/**
 * Get a single bill by ID
 */
export async function getBill(billId) {
  try {
    const res = await api.get(`/api/bills/${billId}`);
    return res.data;
  } catch (err) {
    console.error(`Failed to fetch bill ${billId}:`, err);
    throw err.response?.data || err;
  }
}

/**
 * Get all bills
 */
export async function listBills() {
  try {
    const res = await api.get('/api/bills');
    return res.data;
  } catch (err) {
    console.error('Failed to list bills:', err);
    throw err.response?.data || err;
  }
}

/**
 * Download bill PDF
 */
export async function downloadBillPdf(billId, token = null) {
  try {
    if (!token) {
      throw new Error('PDF access token is required');
    }

    const url = `/api/bills/${billId}/pdf?token=${encodeURIComponent(token)}`;
    const res = await api.get(url, {
      responseType: 'blob'
    });
    return res.data;
  } catch (err) {
    console.error(`Failed to download PDF for bill ${billId}:`, err);
    throw err.response?.data || err;
  }
}

/**
 * Generate PDF access token for existing bill
 */
export async function generatePdfToken(billId) {
  try {
    const res = await api.post(`/api/bills/${billId}/generate-token`);
    return res.data;
  } catch (err) {
    console.error(`Failed to generate PDF token for bill ${billId}:`, err);
    throw err.response?.data || err;
  }
}

/**
 * Bulk upload bills via CSV
 */
export async function bulkUploadBills(csvFile) {
  try {
    const formData = new FormData();
    formData.append('file', csvFile);

    const res = await api.post('/api/bills/bulk', formData, {
      headers: {
        'Content-Type': 'multipart/form-data'
      }
    });
    return res.data;
  } catch (err) {
    console.error('Failed to bulk upload bills:', err);
    throw err.response?.data || err;
  }
}

/**
 * Resend bill email to customer
 */
export async function resendBillEmail(billId) {
  try {
    const res = await api.post(`/api/bills/resend-email/${billId}`);
    return res.data;
  } catch (err) {
    console.error(`Failed to resend email for bill ${billId}:`, err);
    throw err.response?.data || err;
  }
}

/**
 * Utility function to handle PDF download in browser
 */
export function handlePdfDownload(blob, billId) {
  // Create blob URL
  const blobUrl = window.URL.createObjectURL(blob);

  // Create temporary link and trigger download
  const link = document.createElement('a');
  link.href = blobUrl;
  link.download = `Bill_${billId}.pdf`;
  document.body.appendChild(link);
  link.click();

  // Clean up
  document.body.removeChild(link);
  window.URL.revokeObjectURL(blobUrl);
}

/**
 * Complete PDF download flow with token generation
 */
export async function downloadBillPdfWithFlow(billId) {
  try {
    // First generate a token
    const tokenResponse = await generatePdfToken(billId);
    const { pdfAccessToken } = tokenResponse;

    // Then download the PDF
    const pdfBlob = await downloadBillPdf(billId, pdfAccessToken);

    return pdfBlob;
  } catch (error) {
    console.error('PDF download flow failed:', error);
    throw error;
  }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\services\customerService.js
--------------------------------------------------------------------
// src/services/customerService.js
import api from '../api/apiClient'

/**
 * Create a new customer
 */
export async function createCustomer(customer) {
  try {
    const res = await api.post('/api/customers', customer)
    return res.data
  } catch (err) {
    console.error('Failed to create customer:', err)
    throw err.response?.data || err
  }
}

/**
 * Get a single customer by ID
 */
export async function getCustomer(id) {
  try {
    const res = await api.get(`/api/customers/${id}`)
    return res.data
  } catch (err) {
    console.error(`Failed to fetch customer ${id}:`, err)
    throw err.response?.data || err
  }
}

/**
 * Get all customers
 */
export async function listCustomers() {
  try {
    const res = await api.get('/api/customers')
    return res.data
  } catch (err) {
    console.error('Failed to list customers:', err)
    throw err.response?.data || err
  }
}

/**
 * Update an existing customer
 */
export async function updateCustomer(id, customer) {
  try {
    const res = await api.put(`/api/customers/${id}`, customer)
    return res.data
  } catch (err) {
    console.error(`Failed to update customer ${id}:`, err)
    throw err.response?.data || err
  }
}

/**
 * Delete a customer by ID
 */
export async function deleteCustomer(id) {
  try {
    const res = await api.delete(`/api/customers/${id}`)
    return res.data
  } catch (err) {
    console.error(`Failed to delete customer ${id}:`, err)
    throw err.response?.data || err
  }
}

/**
 * Get customer purchase history (with optional date range)
 */
export async function getPurchaseHistory(customerId, startDate, endDate) {
  try {
    const params = {}
    if (startDate) params.startDate = startDate
    if (endDate) params.endDate = endDate

    const res = await api.get(`/api/customers/${customerId}/purchase-history`, { params })
    return res.data
  } catch (err) {
    console.error(`Failed to fetch purchase history for ${customerId}:`, err)
    throw err.response?.data || err
  }
}

/**
 * Trigger monthly purchase reminders manually
 */
export async function triggerReminders() {
  try {
    const res = await api.post('/api/customers/reminders')
    return res.data
  } catch (err) {
    console.error('Failed to trigger reminders:', err)
    throw err.response?.data || err
  }
}

/**
 * Send a custom email to a list of customers
 * @param {Object} emailRequest - { customerIds: string[], subject: string, body: string }
 */
export async function sendCustomEmail(emailRequest) {
  try {
    const res = await api.post('/api/customers/send-email', emailRequest)
    return res.data
  } catch (err) {
    console.error('Failed to send custom email:', err)
    throw err.response?.data || err
  }
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\services\notificationService.js
--------------------------------------------------------------------
import api from '../api/apiClient';

// Send a notification to a user (JSON body)
export async function sendNotification(notificationRequest) {
  const res = await api.post('/api/notifications', notificationRequest);
  return res.data;
}

// Get all notifications
export async function listNotifications() {
  const res = await api.get('/api/notifications');
  return res.data;
}

// Send a test notification email
export async function sendTestNotification(email, message) {
  const res = await api.post(`/api/notifications/test?email=${encodeURIComponent(email)}&message=${encodeURIComponent(message)}`);
  return res.data;
}

// Subscribe to push notifications
export async function subscribePush(subscription) {
  const res = await api.post('/api/notifications/subscribe', subscription);
  return res.data;
}

// Get VAPID public key for push notification setup
export async function getVapidPublicKey() {
  const res = await api.get('/api/notifications/vapid-public-key');
  return res.data;
}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\services\paymentService.js
--------------------------------------------------------------------
import api from '../api/apiClient';

// Create a new payment
export async function createPayment(payment) {
  const res = await api.post('/api/payments', payment);
  return res.data;
}

// Get payment by ID
export async function getPayment(paymentId) {
  const res = await api.get(`/api/payments/${paymentId}`);
  return res.data;
}

// List all payments
export async function listPayments() {
  const res = await api.get('/api/payments');
  return res.data;
}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\services\productService.js
--------------------------------------------------------------------
import api from '../api/apiClient';

export async function listProducts() {
  const res = await api.get('/api/products');
  return res.data;
}

export async function getProduct(id) {
  // Use the productId for the API call, which is what the backend expects
  const res = await api.get(`/api/products/${id}`);
  return res.data;
}

// JSON product creation (as in controller: consumes = application/json)
export async function createProductJson(productRequest) {
  const res = await api.post('/api/products', productRequest, {
    headers: { 'Content-Type': 'application/json' }
  });
  return res.data;
}

// multipart (with image)
export async function createProductMultipart(productRequest, imageFile) {
  const form = new FormData();
  form.append("product", JSON.stringify(productRequest)); // must match @RequestParam("product")
  if (imageFile) form.append("imageFile", imageFile); // must match @RequestPart("imageFile")

  const res = await api.post("/api/products", form, {
    headers: { "Content-Type": "multipart/form-data" },
  });
  return res.data;
}

// CSV bulk upload endpoint (if implemented)
export async function bulkUploadProducts(csvFile) {
  const form = new FormData();
  form.append('file', csvFile);
  const res = await api.post('/api/products/bulk', form, {
    headers: { 'Content-Type': 'multipart/form-data' }
  });
  return res.data;
}

// --- MODIFIED: Renamed to match modal logic ---
// Update product with JSON data
export async function updateProduct(productId, productData) {
  const res = await api.put(`/api/products/${productId}`, productData, {
     headers: { "Content-Type": "application/json" },
  });
  return res.data;
}

// --- NEW: Update product with multipart data (for image changes) ---
export async function updateProductMultipart(productId, productData, imageFile) {
  const form = new FormData();
  form.append("product", JSON.stringify(productData));
  if (imageFile) form.append("imageFile", imageFile);

  const res = await api.put(`/api/products/${productId}`, form, {
    headers: { "Content-Type": "multipart/form-data" },
  });
  return res.data;
}

export async function deleteProduct(productId) {
  const res = await api.delete(`/api/products/${productId}`);
  return res.data;
}
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\services\reportService.js
--------------------------------------------------------------------
import api from '../api/apiClient';

/**
 * Fetches the combined JSON data for the report generator.
 * @param {object} params - { startDate, endDate, lowStockThreshold, expiryDays }
 */
export async function getFullReportData(params) {
  try {
    const res = await api.get('/api/reports/full', { params });
    return res.data;
  } catch (err) {
    console.error('Failed to fetch full report:', err);
    throw err.response?.data || err;
  }
}

/**
 * Downloads the full report as a PDF blob.
 * @param {object} params - { startDate, endDate, lowStockThreshold, expiryDays }
 */
export async function downloadFullReportPdf(params) {
  try {
    const res = await api.get('/api/reports/full/pdf', {
      params,
      responseType: 'blob', // <-- This is crucial!
    });
    return res.data; // This will be a Blob
  } catch (err) {
    console.error('Failed to download PDF report:', err);
    throw err.response?.data || err;
  }
}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\services\syncService.js
--------------------------------------------------------------------
import api from '../api/apiClient';

// Sync pending data (for offline or queued data)
export async function syncPendingData() {
  const res = await api.post('/api/sync/pending');
  return res.data;
}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\src\services\userService.js
--------------------------------------------------------------------
import api from '../api/apiClient';

// Create a new user (OWNER only)
export async function createUser(userRequest) {
  const res = await api.post('/api/users', userRequest);
  return res.data;
}

// Get all users
export async function listUsers() {
  const res = await api.get('/api/users');
  return res.data;
}

// Get user by ID
export async function getUser(id) {
  const res = await api.get(`/api/users/${id}`);
  return res.data;
}

// Update user details
export async function updateUser(id, userRequest) {
  const res = await api.put(`/api/users/${id}`, userRequest);
  return res.data;
}

// Delete user by ID
export async function deleteUser(id) {
  const res = await api.delete(`/api/users/${id}`);
  return res.data;
}

--------------------------------------------------------------------

====================================================================
📁 Directory: G:\FINALCODE\frontend\src\utils
--------------------------------------------------------------------
Contents:
jwt.js

====================================================================
📄 File: G:\FINALCODE\frontend\src\utils\jwt.js
--------------------------------------------------------------------
import jwtDecode from 'jwt-decode'

export function decodeToken(token) {
  try {
    return jwtDecode(token)
  } catch {
    return null
  }
}

export function getRoles(token) {
  const decoded = decodeToken(token)
  return decoded?.roles || []
}

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\tailwind.config.js
--------------------------------------------------------------------
const defaultTheme = require('tailwindcss/defaultTheme');

module.exports = {
  darkMode: 'class', // <-- ADD THIS LINE
  content: ['./index.html', './src/**/*.{js,jsx}'],
  theme: {
    extend: {
      // NEW: Add fonts from your prompt
      fontFamily: {
        sans: ['Inter', 'system-ui', 'sans-serif'],
        display: ['Poppins', 'Inter', 'sans-serif'],
      },
      // Animation for background (if needed)
      keyframes: {
        'gradient-xy': {
          '0%, 100%': { 'background-position': '0% 50%' },
          '50%': { 'background-position': '100% 50%' },
        },
      },
      animation: {
        'gradient-xy': 'gradient-xy 15s ease infinite',
      },
    },
  },
  // --- ADDED ASPECT RATIO PLUGIN ---
  plugins: [
    require('@tailwindcss/aspect-ratio'),
  ],
};
--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\frontend\vite.config.mjs
--------------------------------------------------------------------

import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'

// https://vite.dev/config/
export default defineConfig({
  plugins: [react()],
  server: { port: 5173 }
})

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\full_project_code.txt
--------------------------------------------------------------------

--------------------------------------------------------------------

====================================================================
📄 File: G:\FINALCODE\README.md
--------------------------------------------------------------------
# Project Code Archive
Generated on: 11/05/2025 12:05:11
Source Directory: G:\CapsFinal
Total Files: 181
Total Size: 2.46 MB

## Included File Types:
- Source code files (.java, .py, .js, .ts, .html, .css, etc.)
- Configuration files (.json, .xml, .yml, .properties, etc.)
- Documentation files (.md, .txt)
- Script files (.sh, .bat, .ps1)

## Excluded Directories:
bin, target, .git, out, node_modules, __pycache__, .vscode, build, dist, .idea, .gradle

## Excluded File Types:
*.jar, *.war, *.class, *.exe, *.dll, *.png, *.jpg, *.jpeg, *.gif, *.bmp, *.ico, *.pdf, *.zip, *.rar, *.7z

## Structure:
The archive maintains the original directory structure of the project.

---
Generated by PowerShell Project Archiver


--------------------------------------------------------------------

